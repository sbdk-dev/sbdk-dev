[0m19:50:22.193847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106595a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f3d90>]}


============================== 19:50:22.216811 | b582a1a1-7b80-4af9-baf8-3f670e7f9f36 ==============================
[0m19:50:22.216811 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:50:22.217151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:50:22.401231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b582a1a1-7b80-4af9-baf8-3f670e7f9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a516e0>]}
[0m19:50:22.443894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b582a1a1-7b80-4af9-baf8-3f670e7f9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0aad0>]}
[0m19:50:22.446017 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:50:22.534900 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:50:22.535490 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:50:22.535697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b582a1a1-7b80-4af9-baf8-3f670e7f9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ad5a50>]}
[0m19:50:23.282471 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m19:50:23.290495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b582a1a1-7b80-4af9-baf8-3f670e7f9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d86f30>]}
[0m19:50:23.343398 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m19:50:23.346918 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m19:50:23.400076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b582a1a1-7b80-4af9-baf8-3f670e7f9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140ee970>]}
[0m19:50:23.400386 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m19:50:23.400568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b582a1a1-7b80-4af9-baf8-3f670e7f9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110be9bf0>]}
[0m19:50:23.401638 [info ] [MainThread]: 
[0m19:50:23.401826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:50:23.401971 [info ] [MainThread]: 
[0m19:50:23.402223 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:50:23.404901 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:50:23.461053 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:50:23.461341 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:50:23.461499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:23.528214 [debug] [ThreadPool]: SQL status: OK in 0.067 seconds
[0m19:50:23.529132 [debug] [ThreadPool]: On list_dev: Close
[0m19:50:23.529581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m19:50:23.529862 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m19:50:23.533376 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:50:23.533571 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m19:50:23.533716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:23.534503 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:50:23.535227 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:50:23.535637 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m19:50:23.535862 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:50:23.540665 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:50:23.540816 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m19:50:23.541380 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:50:23.541892 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:50:23.542063 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:50:23.542207 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:50:23.542425 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:50:23.542575 [debug] [ThreadPool]: On create_dev_main: Close
[0m19:50:23.543755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_dbt_test__audit)
[0m19:50:23.546725 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m19:50:23.546898 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m19:50:23.547034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:23.547321 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:50:23.547490 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m19:50:23.547643 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m19:50:23.557255 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m19:50:23.558017 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m19:50:23.558841 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m19:50:23.559043 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m19:50:23.559344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m19:50:23.560741 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:50:23.560908 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m19:50:23.561042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:23.561330 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:50:23.561466 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:50:23.561602 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m19:50:23.563817 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:50:23.564587 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m19:50:23.564912 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m19:50:23.565055 [debug] [ThreadPool]: On list_dev_main: Close
[0m19:50:23.565883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b582a1a1-7b80-4af9-baf8-3f670e7f9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144d0950>]}
[0m19:50:23.566148 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:23.566303 [debug] [MainThread]: On master: BEGIN
[0m19:50:23.566441 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:23.566697 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:50:23.566853 [debug] [MainThread]: On master: COMMIT
[0m19:50:23.566997 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:23.567127 [debug] [MainThread]: On master: COMMIT
[0m19:50:23.567350 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:50:23.567485 [debug] [MainThread]: On master: Close
[0m19:50:23.568951 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m19:50:23.569217 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_events .................................... [RUN]
[0m19:50:23.569439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.sbdk_project.stg_events)
[0m19:50:23.569609 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m19:50:23.573634 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m19:50:23.574269 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m19:50:23.591750 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m19:50:23.592721 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m19:50:23.592939 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m19:50:23.593110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:23.593512 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.593716 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m19:50:23.593936 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_events
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m19:50:23.594778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:23.598151 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m19:50:23.598353 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m19:50:23.598880 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.600521 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m19:50:23.600708 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m19:50:23.601007 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.607538 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m19:50:23.607778 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m19:50:23.607953 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m19:50:23.609136 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:23.612043 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m19:50:23.612255 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m19:50:23.612767 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.614095 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m19:50:23.615409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b582a1a1-7b80-4af9-baf8-3f670e7f9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114480cb0>]}
[0m19:50:23.615753 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.04s]
[0m19:50:23.616054 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m19:50:23.616252 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m19:50:23.616530 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_orders .................................... [RUN]
[0m19:50:23.616769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m19:50:23.616949 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m19:50:23.618669 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m19:50:23.619046 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m19:50:23.620653 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m19:50:23.620994 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m19:50:23.621163 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m19:50:23.621318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:23.621673 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.621980 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m19:50:23.622307 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_orders
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m19:50:23.623938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:23.626148 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m19:50:23.626415 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m19:50:23.626985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.629113 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m19:50:23.629323 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:50:23.629776 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.630651 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m19:50:23.630865 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m19:50:23.631062 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m19:50:23.631689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.632891 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m19:50:23.633086 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m19:50:23.633502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.634218 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m19:50:23.634530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b582a1a1-7b80-4af9-baf8-3f670e7f9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114947bb0>]}
[0m19:50:23.634859 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.02s]
[0m19:50:23.635166 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m19:50:23.635365 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m19:50:23.635631 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_users ..................................... [RUN]
[0m19:50:23.635847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m19:50:23.636021 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m19:50:23.637723 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m19:50:23.638103 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m19:50:23.639662 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m19:50:23.640116 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m19:50:23.640300 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m19:50:23.640458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:23.640805 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.640963 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m19:50:23.641151 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_users
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m19:50:23.643456 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:23.645453 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m19:50:23.645669 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m19:50:23.646080 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.647759 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m19:50:23.647944 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m19:50:23.648252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.649002 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m19:50:23.649176 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m19:50:23.649332 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m19:50:23.649769 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.650813 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m19:50:23.650979 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m19:50:23.651327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.651965 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m19:50:23.652237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b582a1a1-7b80-4af9-baf8-3f670e7f9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114478a50>]}
[0m19:50:23.652549 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.02s]
[0m19:50:23.652812 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m19:50:23.653217 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m19:50:23.653512 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_user_activity ............................. [RUN]
[0m19:50:23.653741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now model.sbdk_project.int_user_activity)
[0m19:50:23.653920 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m19:50:23.655995 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m19:50:23.656513 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m19:50:23.658431 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.int_user_activity"
[0m19:50:23.659077 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m19:50:23.659267 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: BEGIN
[0m19:50:23.659435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:23.659947 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.660278 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m19:50:23.660883 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

  
  create view "dev"."main"."int_user_activity__dbt_tmp" as (
    

with users as (
    select * from "dev"."main"."stg_users"
),

events as (
    select * from "dev"."main"."stg_events"
),

orders as (
    select * from "dev"."main"."stg_orders"
),

user_events as (
    select
        user_id,
        count(*) as total_events,
        count(*) filter (where event_type = 'page_view') as pageviews,
        count(*) filter (where event_type = 'click') as clicks,
        count(*) filter (where event_type = 'signup') as signups,
        count(*) filter (where event_type = 'login') as logins,
        count(*) filter (where event_type = 'purchase') as purchase_events,
        count(*) filter (where is_conversion_event = true) as conversion_events,
        count(*) filter (where is_revenue_event = true) as revenue_events,
        coalesce(sum(revenue), 0) as total_event_revenue,
        coalesce(sum(duration_seconds), 0) as total_time_on_site,
        count(distinct session_id) filter (where session_id is not null) as unique_sessions,
        count(distinct event_date) as active_days,
        min(timestamp) as first_event_at,
        max(timestamp) as last_event_at,
        count(distinct traffic_category) as traffic_sources_used
    from events
    group by user_id
),

user_orders as (
    select
        user_id,
        count(*) as total_orders,
        count(*) filter (where is_completed = true) as completed_orders,
        count(*) filter (where is_failed = true) as failed_orders,
        count(*) filter (where is_recurring = true) as recurring_orders,
        coalesce(sum(total_amount) filter (where is_completed = true), 0) as total_order_revenue,
        coalesce(avg(total_amount) filter (where is_completed = true), 0) as avg_order_value,
        coalesce(sum(discount_amount), 0) as total_discounts_used,
        count(distinct product_category) as product_categories_purchased,
        min(created_at) as first_order_at,
        max(created_at) as last_order_at,
        count(distinct payment_method) as payment_methods_used
    from orders
    group by user_id
),

combined as (
    select
        u.user_id,
        u.username,
        u.email,
        u.first_name,
        u.last_name,
        u.created_at as user_created_at,
        u.country,
        u.city,
        u.subscription_tier,
        u.referrer,
        u.is_active,
        u.age,
        u.is_paid_subscriber,
        u.days_since_signup,
        u.has_complete_profile,
        
        -- Event metrics
        coalesce(e.total_events, 0) as total_events,
        coalesce(e.pageviews, 0) as pageviews,
        coalesce(e.clicks, 0) as clicks,
        coalesce(e.signups, 0) as signups,
        coalesce(e.logins, 0) as logins,
        coalesce(e.purchase_events, 0) as purchase_events,
        coalesce(e.conversion_events, 0) as conversion_events,
        coalesce(e.revenue_events, 0) as revenue_events,
        coalesce(e.total_event_revenue, 0) as total_event_revenue,
        coalesce(e.total_time_on_site, 0) as total_time_on_site,
        coalesce(e.unique_sessions, 0) as unique_sessions,
        coalesce(e.active_days, 0) as active_days,
        e.first_event_at,
        e.last_event_at,
        coalesce(e.traffic_sources_used, 0) as traffic_sources_used,
        
        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.failed_orders, 0) as failed_orders,
        coalesce(o.recurring_orders, 0) as recurring_orders,
        coalesce(o.total_order_revenue, 0) as total_order_revenue,
        coalesce(o.avg_order_value, 0) as avg_order_value,
        coalesce(o.total_discounts_used, 0) as total_discounts_used,
        coalesce(o.product_categories_purchased, 0) as product_categories_purchased,
        o.first_order_at,
        o.last_order_at,
        coalesce(o.payment_methods_used, 0) as payment_methods_used,
        
        -- Calculated metrics
        case 
            when e.pageviews > 0 and o.completed_orders > 0 
            then round(o.completed_orders::float / e.pageviews * 100, 2)
            else 0 
        end as purchase_conversion_rate,
        
        case 
            when e.total_events > 0 
            then round(e.conversion_events::float / e.total_events * 100, 2)
            else 0 
        end as event_conversion_rate,
        
        case 
            when e.unique_sessions > 0 
            then round(e.total_events::float / e.unique_sessions, 2)
            else 0 
        end as events_per_session,
        
        case 
            when u.days_since_signup > 0 and e.active_days > 0
            then round(e.active_days::float / u.days_since_signup * 100, 2)
            else 0 
        end as activity_frequency_percentage,
        
        -- Total combined revenue
        coalesce(e.total_event_revenue, 0) + coalesce(o.total_order_revenue, 0) as total_revenue,
        
        -- User activity classification
        case 
            when o.completed_orders > 0 then 'customer'
            when e.signups > 0 then 'signed_up'
            when e.total_events > 10 then 'engaged_visitor'
            when e.total_events > 0 then 'visitor'
            else 'inactive'
        end as user_type
        
    from users u
    left join user_events e on u.user_id = e.user_id
    left join user_orders o on u.user_id = o.user_id
)

select * from combined
  );

[0m19:50:23.664752 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:50:23.666414 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m19:50:23.666609 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity" rename to "int_user_activity__dbt_backup"
[0m19:50:23.666969 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.670692 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m19:50:23.670919 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity__dbt_tmp" rename to "int_user_activity"
[0m19:50:23.671343 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.672170 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m19:50:23.672357 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m19:50:23.672522 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m19:50:23.673167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.674375 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m19:50:23.674577 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

      drop view if exists "dev"."main"."int_user_activity__dbt_backup" cascade
    
[0m19:50:23.675003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.675724 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: Close
[0m19:50:23.676023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b582a1a1-7b80-4af9-baf8-3f670e7f9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11493e120>]}
[0m19:50:23.676354 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_user_activity ........................ [[32mOK[0m in 0.02s]
[0m19:50:23.676731 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m19:50:23.677289 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m19:50:23.677615 [info ] [Thread-1 (]: 5 of 5 START sql table model main.user_metrics ................................. [RUN]
[0m19:50:23.677891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m19:50:23.678075 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m19:50:23.679857 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m19:50:23.680362 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m19:50:23.691748 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.user_metrics"
[0m19:50:23.692390 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m19:50:23.692580 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: BEGIN
[0m19:50:23.692741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:23.693166 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.693339 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m19:50:23.693646 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

  
    
    

    create  table
      "dev"."main"."user_metrics__dbt_tmp"
  
    as (
      

with user_activity as (
    select * from "dev"."main"."int_user_activity"
),

final as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        user_created_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        age,
        is_paid_subscriber,
        days_since_signup,
        has_complete_profile,
        
        -- Engagement metrics
        total_events,
        pageviews,
        clicks,
        logins,
        unique_sessions,
        active_days,
        traffic_sources_used,
        events_per_session,
        activity_frequency_percentage,
        total_time_on_site,
        
        -- Conversion metrics
        signups,
        purchase_events,
        conversion_events,
        purchase_conversion_rate,
        event_conversion_rate,
        
        -- Revenue metrics
        total_orders,
        completed_orders,
        failed_orders,
        recurring_orders,
        total_order_revenue,
        total_event_revenue,
        total_revenue,
        avg_order_value,
        total_discounts_used,
        product_categories_purchased,
        payment_methods_used,
        
        -- Timing metrics
        first_event_at,
        last_event_at,
        first_order_at,
        last_order_at,
        
        -- User classification
        user_type,
        
        -- Customer lifetime value estimate
        case 
            when recurring_orders > 0 and days_since_signup > 0
            then round(total_revenue * (365.0 / days_since_signup) * 2, 2)  -- Rough 2-year CLV estimate
            else total_revenue 
        end as estimated_clv,
        
        -- Engagement score (0-100)
        least(100, 
            (case when active_days > 0 then least(25, active_days) else 0 end) +
            (case when unique_sessions > 0 then least(25, unique_sessions) else 0 end) +
            (case when total_events > 0 then least(25, least(25, total_events / 10)) else 0 end) +
            (case when completed_orders > 0 then 25 else 0 end)
        ) as engagement_score,
        
        -- Risk classification
        case 
            when last_event_at < current_date - interval '90 days' and total_orders > 0 then 'churn_risk'
            when last_event_at < current_date - interval '30 days' and user_type = 'customer' then 'at_risk'
            when activity_frequency_percentage < 10 and days_since_signup > 30 then 'low_engagement'
            when user_type = 'customer' and recurring_orders = 0 then 'one_time_buyer'
            when user_type = 'customer' and recurring_orders > 0 then 'loyal_customer'
            when user_type = 'engaged_visitor' then 'potential_customer'
            else 'standard'
        end as risk_category,
        
        -- Value tier
        case 
            when total_revenue >= 1000 then 'high_value'
            when total_revenue >= 500 then 'medium_value'
            when total_revenue >= 100 then 'low_value'
            when total_revenue > 0 then 'minimal_value'
            else 'no_value'
        end as value_tier,
        
        -- Recency, Frequency, Monetary (RFM) components
        case 
            when last_order_at >= current_date - interval '30 days' then 5
            when last_order_at >= current_date - interval '60 days' then 4
            when last_order_at >= current_date - interval '90 days' then 3
            when last_order_at >= current_date - interval '180 days' then 2
            when last_order_at is not null then 1
            else 0
        end as recency_score,
        
        case 
            when completed_orders >= 10 then 5
            when completed_orders >= 5 then 4
            when completed_orders >= 3 then 3
            when completed_orders >= 2 then 2
            when completed_orders >= 1 then 1
            else 0
        end as frequency_score,
        
        case 
            when total_revenue >= 1000 then 5
            when total_revenue >= 500 then 4
            when total_revenue >= 200 then 3
            when total_revenue >= 50 then 2
            when total_revenue > 0 then 1
            else 0
        end as monetary_score,
        
        -- Data freshness
        current_timestamp as updated_at
        
    from user_activity
)

select * from final
    );
  
  
[0m19:50:23.751903 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m19:50:23.754219 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m19:50:23.754464 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics" rename to "user_metrics__dbt_backup"
[0m19:50:23.754953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.756887 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m19:50:23.757100 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics__dbt_tmp" rename to "user_metrics"
[0m19:50:23.757456 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.760591 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m19:50:23.760827 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m19:50:23.761027 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m19:50:23.770500 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m19:50:23.771846 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m19:50:23.772034 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

      drop table if exists "dev"."main"."user_metrics__dbt_backup" cascade
    
[0m19:50:23.772634 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:50:23.773346 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: Close
[0m19:50:23.773642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b582a1a1-7b80-4af9-baf8-3f670e7f9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11446bb90>]}
[0m19:50:23.773964 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.user_metrics ............................ [[32mOK[0m in 0.10s]
[0m19:50:23.774237 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m19:50:23.774824 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:23.774971 [debug] [MainThread]: On master: BEGIN
[0m19:50:23.775111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:50:23.775367 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:50:23.775499 [debug] [MainThread]: On master: COMMIT
[0m19:50:23.775626 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:23.775752 [debug] [MainThread]: On master: COMMIT
[0m19:50:23.775934 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:50:23.776062 [debug] [MainThread]: On master: Close
[0m19:50:23.776227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:23.776351 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m19:50:23.776524 [info ] [MainThread]: 
[0m19:50:23.776679 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m19:50:23.777237 [debug] [MainThread]: Command end result
[0m19:50:23.792942 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m19:50:23.794383 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m19:50:23.797773 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m19:50:23.797952 [info ] [MainThread]: 
[0m19:50:23.798141 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:50:23.798325 [info ] [MainThread]: 
[0m19:50:23.798526 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m19:50:23.804458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6644993, "process_in_blocks": "0", "process_kernel_time": 0.263788, "process_mem_max_rss": "231079936", "process_out_blocks": "0", "process_user_time": 2.083966}
[0m19:50:23.804754 [debug] [MainThread]: Command `dbt run` succeeded at 19:50:23.804706 after 1.66 seconds
[0m19:50:23.804953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffbad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145dfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145dfd70>]}
[0m19:50:23.805147 [debug] [MainThread]: Flushing usage events
[0m19:50:24.377039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:12.046870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104555a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b3d90>]}


============================== 19:56:12.050687 | a0f8b09e-2ad9-4ed3-9fcd-55e27d278a3c ==============================
[0m19:56:12.050687 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:56:12.051028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:56:12.212470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0f8b09e-2ad9-4ed3-9fcd-55e27d278a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048116e0>]}
[0m19:56:12.253533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0f8b09e-2ad9-4ed3-9fcd-55e27d278a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103edaad0>]}
[0m19:56:12.255118 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:56:12.313482 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:56:12.390006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:12.390246 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:12.393839 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m19:56:12.416940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0f8b09e-2ad9-4ed3-9fcd-55e27d278a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c3b50>]}
[0m19:56:12.464395 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m19:56:12.466061 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m19:56:12.479653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0f8b09e-2ad9-4ed3-9fcd-55e27d278a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f3f20>]}
[0m19:56:12.479909 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m19:56:12.480074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0f8b09e-2ad9-4ed3-9fcd-55e27d278a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b50830>]}
[0m19:56:12.481097 [info ] [MainThread]: 
[0m19:56:12.481272 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:12.481410 [info ] [MainThread]: 
[0m19:56:12.481654 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:56:12.484145 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:56:12.529360 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:56:12.529588 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:56:12.529734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:12.600646 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m19:56:12.601466 [debug] [ThreadPool]: On list_dev: Close
[0m19:56:12.601835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m19:56:12.602227 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m19:56:12.605701 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:56:12.605879 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m19:56:12.606020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:12.606701 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:56:12.607530 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:56:12.607673 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m19:56:12.607878 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:12.608008 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:56:12.608134 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m19:56:12.608571 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:12.608975 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:56:12.609105 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:56:12.609222 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:56:12.609407 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:12.609539 [debug] [ThreadPool]: On create_dev_main: Close
[0m19:56:12.610586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_dbt_test__audit)
[0m19:56:12.613252 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m19:56:12.613410 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m19:56:12.613538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:12.613765 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:12.613901 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m19:56:12.614041 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m19:56:12.623394 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m19:56:12.624425 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m19:56:12.625237 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m19:56:12.625383 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m19:56:12.625625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m19:56:12.626478 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:56:12.626610 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m19:56:12.626727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:12.626959 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:56:12.627087 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:56:12.627222 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m19:56:12.629263 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:56:12.629960 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m19:56:12.630221 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m19:56:12.630349 [debug] [ThreadPool]: On list_dev_main: Close
[0m19:56:12.631099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0f8b09e-2ad9-4ed3-9fcd-55e27d278a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e89090>]}
[0m19:56:12.631327 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:12.631463 [debug] [MainThread]: On master: BEGIN
[0m19:56:12.631584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:12.631794 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:12.631945 [debug] [MainThread]: On master: COMMIT
[0m19:56:12.632080 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:12.632202 [debug] [MainThread]: On master: COMMIT
[0m19:56:12.632376 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:12.632514 [debug] [MainThread]: On master: Close
[0m19:56:12.633827 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m19:56:12.634077 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_events .................................... [RUN]
[0m19:56:12.634284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.sbdk_project.stg_events)
[0m19:56:12.634452 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m19:56:12.638238 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m19:56:12.638801 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m19:56:12.656784 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m19:56:12.657982 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m19:56:12.658178 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m19:56:12.658336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:12.658705 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.658869 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m19:56:12.659071 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_events
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m19:56:12.660189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:12.699476 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m19:56:12.699741 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m19:56:12.700397 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.701761 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m19:56:12.701943 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m19:56:12.702248 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.708587 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m19:56:12.708776 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m19:56:12.708933 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m19:56:12.709949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:12.712855 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m19:56:12.713044 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m19:56:12.713430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.714619 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m19:56:12.715567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f8b09e-2ad9-4ed3-9fcd-55e27d278a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563ea50>]}
[0m19:56:12.715888 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.08s]
[0m19:56:12.716170 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m19:56:12.716368 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m19:56:12.716618 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_orders .................................... [RUN]
[0m19:56:12.716819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m19:56:12.716986 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m19:56:12.718255 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m19:56:12.718754 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m19:56:12.720217 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m19:56:12.720662 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m19:56:12.720824 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m19:56:12.720975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:12.721281 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.721490 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m19:56:12.721811 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_orders
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m19:56:12.723006 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:12.724950 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m19:56:12.725148 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m19:56:12.725512 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.727175 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m19:56:12.727365 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:56:12.727734 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.728556 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m19:56:12.728727 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m19:56:12.728883 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m19:56:12.729580 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:56:12.730938 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m19:56:12.731107 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m19:56:12.731461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.732090 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m19:56:12.732352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f8b09e-2ad9-4ed3-9fcd-55e27d278a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e70470>]}
[0m19:56:12.732643 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.02s]
[0m19:56:12.732910 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m19:56:12.733094 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m19:56:12.733330 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_users ..................................... [RUN]
[0m19:56:12.733522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m19:56:12.733690 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m19:56:12.734940 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m19:56:12.735590 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m19:56:12.737024 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m19:56:12.737457 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m19:56:12.737616 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m19:56:12.737764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:12.738018 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.738231 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m19:56:12.738453 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_users
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m19:56:12.740873 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:56:12.742784 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m19:56:12.742975 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m19:56:12.743301 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.744587 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m19:56:12.744761 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m19:56:12.745037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.745786 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m19:56:12.745968 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m19:56:12.746132 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m19:56:12.746545 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.747831 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m19:56:12.748009 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m19:56:12.748341 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.748983 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m19:56:12.749239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f8b09e-2ad9-4ed3-9fcd-55e27d278a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572d4f0>]}
[0m19:56:12.749534 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.02s]
[0m19:56:12.749787 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m19:56:12.750104 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m19:56:12.750353 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_user_activity ............................. [RUN]
[0m19:56:12.750572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now model.sbdk_project.int_user_activity)
[0m19:56:12.750743 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m19:56:12.752626 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m19:56:12.753435 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m19:56:12.754934 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.int_user_activity"
[0m19:56:12.755701 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m19:56:12.755894 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: BEGIN
[0m19:56:12.756054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:12.756395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.756553 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m19:56:12.756851 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

  
  create view "dev"."main"."int_user_activity__dbt_tmp" as (
    

with users as (
    select * from "dev"."main"."stg_users"
),

events as (
    select * from "dev"."main"."stg_events"
),

orders as (
    select * from "dev"."main"."stg_orders"
),

user_events as (
    select
        user_id,
        count(*) as total_events,
        count(*) filter (where event_type = 'page_view') as pageviews,
        count(*) filter (where event_type = 'click') as clicks,
        count(*) filter (where event_type = 'signup') as signups,
        count(*) filter (where event_type = 'login') as logins,
        count(*) filter (where event_type = 'purchase') as purchase_events,
        count(*) filter (where is_conversion_event = true) as conversion_events,
        count(*) filter (where is_revenue_event = true) as revenue_events,
        coalesce(sum(revenue), 0) as total_event_revenue,
        coalesce(sum(duration_seconds), 0) as total_time_on_site,
        count(distinct session_id) filter (where session_id is not null) as unique_sessions,
        count(distinct event_date) as active_days,
        min(timestamp) as first_event_at,
        max(timestamp) as last_event_at,
        count(distinct traffic_category) as traffic_sources_used
    from events
    group by user_id
),

user_orders as (
    select
        user_id,
        count(*) as total_orders,
        count(*) filter (where is_completed = true) as completed_orders,
        count(*) filter (where is_failed = true) as failed_orders,
        count(*) filter (where is_recurring = true) as recurring_orders,
        coalesce(sum(total_amount) filter (where is_completed = true), 0) as total_order_revenue,
        coalesce(avg(total_amount) filter (where is_completed = true), 0) as avg_order_value,
        coalesce(sum(discount_amount), 0) as total_discounts_used,
        count(distinct product_category) as product_categories_purchased,
        min(created_at) as first_order_at,
        max(created_at) as last_order_at,
        count(distinct payment_method) as payment_methods_used
    from orders
    group by user_id
),

combined as (
    select
        u.user_id,
        u.username,
        u.email,
        u.first_name,
        u.last_name,
        u.created_at as user_created_at,
        u.country,
        u.city,
        u.subscription_tier,
        u.referrer,
        u.is_active,
        u.age,
        u.is_paid_subscriber,
        u.days_since_signup,
        u.has_complete_profile,
        
        -- Event metrics
        coalesce(e.total_events, 0) as total_events,
        coalesce(e.pageviews, 0) as pageviews,
        coalesce(e.clicks, 0) as clicks,
        coalesce(e.signups, 0) as signups,
        coalesce(e.logins, 0) as logins,
        coalesce(e.purchase_events, 0) as purchase_events,
        coalesce(e.conversion_events, 0) as conversion_events,
        coalesce(e.revenue_events, 0) as revenue_events,
        coalesce(e.total_event_revenue, 0) as total_event_revenue,
        coalesce(e.total_time_on_site, 0) as total_time_on_site,
        coalesce(e.unique_sessions, 0) as unique_sessions,
        coalesce(e.active_days, 0) as active_days,
        e.first_event_at,
        e.last_event_at,
        coalesce(e.traffic_sources_used, 0) as traffic_sources_used,
        
        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.failed_orders, 0) as failed_orders,
        coalesce(o.recurring_orders, 0) as recurring_orders,
        coalesce(o.total_order_revenue, 0) as total_order_revenue,
        coalesce(o.avg_order_value, 0) as avg_order_value,
        coalesce(o.total_discounts_used, 0) as total_discounts_used,
        coalesce(o.product_categories_purchased, 0) as product_categories_purchased,
        o.first_order_at,
        o.last_order_at,
        coalesce(o.payment_methods_used, 0) as payment_methods_used,
        
        -- Calculated metrics
        case 
            when e.pageviews > 0 and o.completed_orders > 0 
            then round(o.completed_orders::float / e.pageviews * 100, 2)
            else 0 
        end as purchase_conversion_rate,
        
        case 
            when e.total_events > 0 
            then round(e.conversion_events::float / e.total_events * 100, 2)
            else 0 
        end as event_conversion_rate,
        
        case 
            when e.unique_sessions > 0 
            then round(e.total_events::float / e.unique_sessions, 2)
            else 0 
        end as events_per_session,
        
        case 
            when u.days_since_signup > 0 and e.active_days > 0
            then round(e.active_days::float / u.days_since_signup * 100, 2)
            else 0 
        end as activity_frequency_percentage,
        
        -- Total combined revenue
        coalesce(e.total_event_revenue, 0) + coalesce(o.total_order_revenue, 0) as total_revenue,
        
        -- User activity classification
        case 
            when o.completed_orders > 0 then 'customer'
            when e.signups > 0 then 'signed_up'
            when e.total_events > 10 then 'engaged_visitor'
            when e.total_events > 0 then 'visitor'
            else 'inactive'
        end as user_type
        
    from users u
    left join user_events e on u.user_id = e.user_id
    left join user_orders o on u.user_id = o.user_id
)

select * from combined
  );

[0m19:56:12.761165 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:56:12.763109 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m19:56:12.763302 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity" rename to "int_user_activity__dbt_backup"
[0m19:56:12.763756 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.765175 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m19:56:12.765365 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity__dbt_tmp" rename to "int_user_activity"
[0m19:56:12.765697 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.766454 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m19:56:12.766624 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m19:56:12.766778 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m19:56:12.767397 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.768438 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m19:56:12.768609 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

      drop view if exists "dev"."main"."int_user_activity__dbt_backup" cascade
    
[0m19:56:12.768965 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.769859 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: Close
[0m19:56:12.770141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f8b09e-2ad9-4ed3-9fcd-55e27d278a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057170d0>]}
[0m19:56:12.770451 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_user_activity ........................ [[32mOK[0m in 0.02s]
[0m19:56:12.770717 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m19:56:12.772264 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m19:56:12.772553 [info ] [Thread-1 (]: 5 of 5 START sql table model main.user_metrics ................................. [RUN]
[0m19:56:12.772810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m19:56:12.772989 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m19:56:12.775000 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m19:56:12.776087 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m19:56:12.786635 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.user_metrics"
[0m19:56:12.788057 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m19:56:12.788262 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: BEGIN
[0m19:56:12.788420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:12.788795 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.788976 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m19:56:12.789246 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

  
    
    

    create  table
      "dev"."main"."user_metrics__dbt_tmp"
  
    as (
      

with user_activity as (
    select * from "dev"."main"."int_user_activity"
),

final as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        user_created_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        age,
        is_paid_subscriber,
        days_since_signup,
        has_complete_profile,
        
        -- Engagement metrics
        total_events,
        pageviews,
        clicks,
        logins,
        unique_sessions,
        active_days,
        traffic_sources_used,
        events_per_session,
        activity_frequency_percentage,
        total_time_on_site,
        
        -- Conversion metrics
        signups,
        purchase_events,
        conversion_events,
        purchase_conversion_rate,
        event_conversion_rate,
        
        -- Revenue metrics
        total_orders,
        completed_orders,
        failed_orders,
        recurring_orders,
        total_order_revenue,
        total_event_revenue,
        total_revenue,
        avg_order_value,
        total_discounts_used,
        product_categories_purchased,
        payment_methods_used,
        
        -- Timing metrics
        first_event_at,
        last_event_at,
        first_order_at,
        last_order_at,
        
        -- User classification
        user_type,
        
        -- Customer lifetime value estimate
        case 
            when recurring_orders > 0 and days_since_signup > 0
            then round(total_revenue * (365.0 / days_since_signup) * 2, 2)  -- Rough 2-year CLV estimate
            else total_revenue 
        end as estimated_clv,
        
        -- Engagement score (0-100)
        least(100, 
            (case when active_days > 0 then least(25, active_days) else 0 end) +
            (case when unique_sessions > 0 then least(25, unique_sessions) else 0 end) +
            (case when total_events > 0 then least(25, least(25, total_events / 10)) else 0 end) +
            (case when completed_orders > 0 then 25 else 0 end)
        ) as engagement_score,
        
        -- Risk classification
        case 
            when last_event_at < current_date - interval '90 days' and total_orders > 0 then 'churn_risk'
            when last_event_at < current_date - interval '30 days' and user_type = 'customer' then 'at_risk'
            when activity_frequency_percentage < 10 and days_since_signup > 30 then 'low_engagement'
            when user_type = 'customer' and recurring_orders = 0 then 'one_time_buyer'
            when user_type = 'customer' and recurring_orders > 0 then 'loyal_customer'
            when user_type = 'engaged_visitor' then 'potential_customer'
            else 'standard'
        end as risk_category,
        
        -- Value tier
        case 
            when total_revenue >= 1000 then 'high_value'
            when total_revenue >= 500 then 'medium_value'
            when total_revenue >= 100 then 'low_value'
            when total_revenue > 0 then 'minimal_value'
            else 'no_value'
        end as value_tier,
        
        -- Recency, Frequency, Monetary (RFM) components
        case 
            when last_order_at >= current_date - interval '30 days' then 5
            when last_order_at >= current_date - interval '60 days' then 4
            when last_order_at >= current_date - interval '90 days' then 3
            when last_order_at >= current_date - interval '180 days' then 2
            when last_order_at is not null then 1
            else 0
        end as recency_score,
        
        case 
            when completed_orders >= 10 then 5
            when completed_orders >= 5 then 4
            when completed_orders >= 3 then 3
            when completed_orders >= 2 then 2
            when completed_orders >= 1 then 1
            else 0
        end as frequency_score,
        
        case 
            when total_revenue >= 1000 then 5
            when total_revenue >= 500 then 4
            when total_revenue >= 200 then 3
            when total_revenue >= 50 then 2
            when total_revenue > 0 then 1
            else 0
        end as monetary_score,
        
        -- Data freshness
        current_timestamp as updated_at
        
    from user_activity
)

select * from final
    );
  
  
[0m19:56:12.845312 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m19:56:12.846993 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m19:56:12.847181 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics" rename to "user_metrics__dbt_backup"
[0m19:56:12.847566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.848828 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m19:56:12.849210 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics__dbt_tmp" rename to "user_metrics"
[0m19:56:12.849515 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.852180 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m19:56:12.852369 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m19:56:12.852528 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m19:56:12.859305 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m19:56:12.860867 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m19:56:12.861115 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

      drop table if exists "dev"."main"."user_metrics__dbt_backup" cascade
    
[0m19:56:12.861714 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:56:12.862382 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: Close
[0m19:56:12.862662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f8b09e-2ad9-4ed3-9fcd-55e27d278a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f24de0>]}
[0m19:56:12.862964 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.user_metrics ............................ [[32mOK[0m in 0.09s]
[0m19:56:12.863269 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m19:56:12.864050 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:12.864193 [debug] [MainThread]: On master: BEGIN
[0m19:56:12.864314 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:12.864536 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:12.864660 [debug] [MainThread]: On master: COMMIT
[0m19:56:12.864778 [debug] [MainThread]: Using duckdb connection "master"
[0m19:56:12.864896 [debug] [MainThread]: On master: COMMIT
[0m19:56:12.865063 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:56:12.865187 [debug] [MainThread]: On master: Close
[0m19:56:12.865343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:12.865461 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m19:56:12.865620 [info ] [MainThread]: 
[0m19:56:12.865758 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m19:56:12.866277 [debug] [MainThread]: Command end result
[0m19:56:12.881369 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m19:56:12.882464 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m19:56:12.887872 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m19:56:12.888046 [info ] [MainThread]: 
[0m19:56:12.888301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:12.888508 [info ] [MainThread]: 
[0m19:56:12.888691 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m19:56:12.890560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8978961, "process_in_blocks": "0", "process_kernel_time": 0.230082, "process_mem_max_rss": "214810624", "process_out_blocks": "0", "process_user_time": 1.413208}
[0m19:56:12.890782 [debug] [MainThread]: Command `dbt run` succeeded at 19:56:12.890741 after 0.90 seconds
[0m19:56:12.890958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e637d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e63d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e63710>]}
[0m19:56:12.891129 [debug] [MainThread]: Flushing usage events
[0m19:56:13.357033 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:03:44.005099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bada90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0bd90>]}


============================== 20:03:44.008912 | 4b63fb68-1e45-45ff-a5a7-094bc774a6c6 ==============================
[0m20:03:44.008912 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:03:44.009244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug --project-dir /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:03:44.022187 [info ] [MainThread]: dbt version: 1.10.6
[0m20:03:44.022453 [info ] [MainThread]: python version: 3.13.5
[0m20:03:44.022608 [info ] [MainThread]: python path: /Users/mattstrautmann/Documents/GitHub/sbdk-dev/.venv/bin/python3
[0m20:03:44.022756 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m20:03:44.111927 [info ] [MainThread]: Using profiles dir at /Users/mattstrautmann/.dbt
[0m20:03:44.112219 [info ] [MainThread]: Using profiles.yml file at /Users/mattstrautmann/.dbt/profiles.yml
[0m20:03:44.112377 [info ] [MainThread]: Using dbt_project.yml file at /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/dbt_project.yml
[0m20:03:44.113793 [info ] [MainThread]: adapter type: duckdb
[0m20:03:44.113996 [info ] [MainThread]: adapter version: 1.9.4
[0m20:03:44.179392 [info ] [MainThread]: Configuration:
[0m20:03:44.179657 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:03:44.179811 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:03:44.179952 [info ] [MainThread]: Required dependencies:
[0m20:03:44.180160 [debug] [MainThread]: Executing "git --help"
[0m20:03:44.192258 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:03:44.193011 [debug] [MainThread]: STDERR: "b''"
[0m20:03:44.193230 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:03:44.193440 [info ] [MainThread]: Connection:
[0m20:03:44.193614 [info ] [MainThread]:   database: dev
[0m20:03:44.193763 [info ] [MainThread]:   schema: main
[0m20:03:44.193895 [info ] [MainThread]:   path: /Users/mattstrautmann/Documents/GitHub/sbdk-dev/sbdk-starter/demo_project/data/dev.duckdb
[0m20:03:44.194028 [info ] [MainThread]:   config_options: None
[0m20:03:44.194155 [info ] [MainThread]:   extensions: None
[0m20:03:44.194290 [info ] [MainThread]:   settings: {}
[0m20:03:44.194409 [info ] [MainThread]:   external_root: .
[0m20:03:44.194532 [info ] [MainThread]:   use_credential_provider: None
[0m20:03:44.194652 [info ] [MainThread]:   attach: None
[0m20:03:44.194767 [info ] [MainThread]:   filesystems: None
[0m20:03:44.194886 [info ] [MainThread]:   remote: None
[0m20:03:44.195002 [info ] [MainThread]:   plugins: None
[0m20:03:44.195122 [info ] [MainThread]:   disable_transactions: False
[0m20:03:44.195478 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:03:44.249889 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:03:44.298820 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:03:44.299097 [debug] [MainThread]: On debug: select 1 as id
[0m20:03:44.299259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:03:44.346032 [debug] [MainThread]: SQL status: OK in 0.047 seconds
[0m20:03:44.346658 [debug] [MainThread]: On debug: Close
[0m20:03:44.346874 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:03:44.347047 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:03:44.348898 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3976834, "process_in_blocks": "0", "process_kernel_time": 0.207096, "process_mem_max_rss": "138477568", "process_out_blocks": "0", "process_user_time": 0.965286}
[0m20:03:44.349167 [debug] [MainThread]: Command `dbt debug` succeeded at 20:03:44.349113 after 0.40 seconds
[0m20:03:44.349334 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:03:44.349515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107100b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e99b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d68160>]}
[0m20:03:44.349722 [debug] [MainThread]: Flushing usage events
[0m20:03:44.859510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:25.472583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105911a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10686fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10686fd90>]}


============================== 20:04:25.476310 | 0b02935a-357f-4e71-a28a-787ad131d6d1 ==============================
[0m20:04:25.476310 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:04:25.476730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug --project-dir /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:25.488083 [info ] [MainThread]: dbt version: 1.10.6
[0m20:04:25.488356 [info ] [MainThread]: python version: 3.13.5
[0m20:04:25.488513 [info ] [MainThread]: python path: /Users/mattstrautmann/Documents/GitHub/sbdk-dev/.venv/bin/python3
[0m20:04:25.488663 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m20:04:25.553660 [info ] [MainThread]: Using profiles dir at /Users/mattstrautmann/.dbt
[0m20:04:25.554150 [info ] [MainThread]: Using profiles.yml file at /Users/mattstrautmann/.dbt/profiles.yml
[0m20:04:25.554372 [info ] [MainThread]: Using dbt_project.yml file at /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/dbt_project.yml
[0m20:04:25.555437 [info ] [MainThread]: adapter type: duckdb
[0m20:04:25.555610 [info ] [MainThread]: adapter version: 1.9.4
[0m20:04:25.624054 [info ] [MainThread]: Configuration:
[0m20:04:25.624341 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:04:25.624498 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:04:25.624642 [info ] [MainThread]: Required dependencies:
[0m20:04:25.624857 [debug] [MainThread]: Executing "git --help"
[0m20:04:25.637867 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:04:25.638461 [debug] [MainThread]: STDERR: "b''"
[0m20:04:25.638683 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:04:25.638890 [info ] [MainThread]: Connection:
[0m20:04:25.639059 [info ] [MainThread]:   database: dev
[0m20:04:25.639200 [info ] [MainThread]:   schema: main
[0m20:04:25.639332 [info ] [MainThread]:   path: /Users/mattstrautmann/Documents/GitHub/sbdk-dev/sbdk-starter/demo_project/data/dev.duckdb
[0m20:04:25.639460 [info ] [MainThread]:   config_options: None
[0m20:04:25.639584 [info ] [MainThread]:   extensions: None
[0m20:04:25.639705 [info ] [MainThread]:   settings: {}
[0m20:04:25.639828 [info ] [MainThread]:   external_root: .
[0m20:04:25.639949 [info ] [MainThread]:   use_credential_provider: None
[0m20:04:25.640073 [info ] [MainThread]:   attach: None
[0m20:04:25.640196 [info ] [MainThread]:   filesystems: None
[0m20:04:25.640321 [info ] [MainThread]:   remote: None
[0m20:04:25.640444 [info ] [MainThread]:   plugins: None
[0m20:04:25.640567 [info ] [MainThread]:   disable_transactions: False
[0m20:04:25.640938 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:04:25.695070 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:04:25.740619 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:04:25.740886 [debug] [MainThread]: On debug: select 1 as id
[0m20:04:25.741047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:25.826681 [debug] [MainThread]: SQL status: OK in 0.086 seconds
[0m20:04:25.827349 [debug] [MainThread]: On debug: Close
[0m20:04:25.827589 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:04:25.827773 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:04:25.831192 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4117086, "process_in_blocks": "0", "process_kernel_time": 0.194554, "process_mem_max_rss": "130695168", "process_out_blocks": "0", "process_user_time": 1.011154}
[0m20:04:25.831538 [debug] [MainThread]: Command `dbt debug` succeeded at 20:04:25.831464 after 0.41 seconds
[0m20:04:25.831752 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:04:25.831963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e649d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad0160>]}
[0m20:04:25.832195 [debug] [MainThread]: Flushing usage events
[0m20:04:26.290598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c39a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b97b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b97d90>]}


============================== 20:04:26.293181 | 79916940-7ac1-44f3-9bc9-40c97cc4e04e ==============================
[0m20:04:26.293181 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:04:26.293506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:04:26.446780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79916940-7ac1-44f3-9bc9-40c97cc4e04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef96e0>]}
[0m20:04:26.489289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79916940-7ac1-44f3-9bc9-40c97cc4e04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055bead0>]}
[0m20:04:26.490759 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:04:26.559249 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:04:26.595954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:26.643160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:26.643545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:26.647407 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:04:26.671112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79916940-7ac1-44f3-9bc9-40c97cc4e04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca7d50>]}
[0m20:04:26.732223 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:04:26.734216 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:04:26.746790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79916940-7ac1-44f3-9bc9-40c97cc4e04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed7d40>]}
[0m20:04:26.747125 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:04:26.747309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79916940-7ac1-44f3-9bc9-40c97cc4e04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702be70>]}
[0m20:04:26.748769 [info ] [MainThread]: 
[0m20:04:26.748981 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:04:26.749128 [info ] [MainThread]: 
[0m20:04:26.749430 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:04:26.752563 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m20:04:26.783378 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:04:26.783663 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:04:26.784149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:26.794549 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:04:26.794829 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:04:26.795167 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:04:26.812524 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:04:26.813703 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:04:26.814645 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:04:26.814820 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:04:26.815131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:04:26.816864 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:04:26.817107 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:04:26.817269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:26.817588 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:26.817730 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:04:26.817879 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:04:26.820266 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:04:26.820987 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:04:26.821323 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:04:26.821474 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:04:26.821806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79916940-7ac1-44f3-9bc9-40c97cc4e04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071af450>]}
[0m20:04:26.823419 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:04:26.823955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now model.sbdk_project.stg_events)
[0m20:04:26.824201 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:04:26.828612 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:04:26.829474 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:04:26.829873 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:04:26.830082 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:04:26.830311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:04:26.830487 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:04:26.831889 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:04:26.832369 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:04:26.832679 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:04:26.832857 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:04:26.833052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:04:26.833219 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:04:26.834416 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:04:26.835027 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:04:26.835359 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:04:26.835550 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:04:26.835755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2)
[0m20:04:26.835950 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:04:26.844501 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:04:26.845069 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:04:26.845432 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:04:26.845629 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:04:26.845853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2, now test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05)
[0m20:04:26.846055 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:04:26.848038 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:04:26.848437 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:04:26.848766 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:04:26.848955 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:04:26.849155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05, now test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1)
[0m20:04:26.849329 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:04:26.889234 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:04:26.889716 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:04:26.890115 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:04:26.890385 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:04:26.890645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1, now test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f)
[0m20:04:26.890887 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:04:26.893025 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:04:26.893409 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:04:26.893746 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:04:26.893943 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:04:26.894156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f, now test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec)
[0m20:04:26.894334 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:04:26.896236 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:04:26.896599 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:04:26.896913 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:04:26.897095 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:04:26.897285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec, now test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd)
[0m20:04:26.897784 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:04:26.899613 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:04:26.899955 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:04:26.900267 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:04:26.900452 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:04:26.900645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd, now test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5)
[0m20:04:26.900818 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:04:26.902629 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:04:26.903136 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:04:26.903511 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:04:26.903709 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:04:26.903914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5, now test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5)
[0m20:04:26.904095 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:04:26.906331 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:04:26.906690 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:04:26.907003 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:04:26.907189 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:04:26.907380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5, now test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c)
[0m20:04:26.907552 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:04:26.909371 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:04:26.909715 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:04:26.910024 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:04:26.910209 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:04:26.910399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c, now test.sbdk_project.source_unique_raw_events_event_id.825f404073)
[0m20:04:26.910574 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:04:26.913931 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:04:26.914357 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:04:26.914697 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:04:26.914891 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:04:26.915093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_events_event_id.825f404073, now test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f)
[0m20:04:26.915267 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:04:26.917308 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:04:26.917696 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:04:26.918029 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:04:26.918219 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:04:26.918546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f, now test.sbdk_project.source_unique_raw_users_email.ab11a6771a)
[0m20:04:26.919130 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:04:26.921120 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:04:26.921541 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:04:26.921881 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:04:26.922074 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:04:26.922302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_users_email.ab11a6771a, now test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c)
[0m20:04:26.922527 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:04:26.924755 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:04:26.925135 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:04:26.925469 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:04:26.925664 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:04:26.925864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c, now model.sbdk_project.int_user_activity)
[0m20:04:26.926039 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m20:04:26.927927 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m20:04:26.928504 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m20:04:26.928819 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:04:26.929166 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:04:26.929379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m20:04:26.929553 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m20:04:26.931134 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m20:04:26.931740 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m20:04:26.932056 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:04:26.932482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:26.932632 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m20:04:26.933880 [debug] [MainThread]: Command end result
[0m20:04:26.946936 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:04:26.948002 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:04:26.952162 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:04:26.953645 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.7112301, "process_in_blocks": "0", "process_kernel_time": 0.212704, "process_mem_max_rss": "143343616", "process_out_blocks": "0", "process_user_time": 1.307682}
[0m20:04:26.953936 [debug] [MainThread]: Command `dbt compile` succeeded at 20:04:26.953886 after 0.71 seconds
[0m20:04:26.954145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f8520>]}
[0m20:04:26.954350 [debug] [MainThread]: Flushing usage events
[0m20:04:27.351715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:27.800978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107095a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f3d90>]}


============================== 20:04:27.804045 | f589ca12-fe80-4320-9fc5-5631e67a5111 ==============================
[0m20:04:27.804045 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:04:27.804447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_users --project-dir /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:04:27.939441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f589ca12-fe80-4320-9fc5-5631e67a5111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076556e0>]}
[0m20:04:27.979321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f589ca12-fe80-4320-9fc5-5631e67a5111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d52ad0>]}
[0m20:04:27.980542 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:04:28.033428 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:04:28.096166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:28.096403 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:28.099875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:04:28.120745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f589ca12-fe80-4320-9fc5-5631e67a5111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108803b50>]}
[0m20:04:28.167937 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:04:28.169089 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:04:28.177512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f589ca12-fe80-4320-9fc5-5631e67a5111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a33f20>]}
[0m20:04:28.177805 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:04:28.177975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f589ca12-fe80-4320-9fc5-5631e67a5111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e94830>]}
[0m20:04:28.178849 [info ] [MainThread]: 
[0m20:04:28.179024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:04:28.179166 [info ] [MainThread]: 
[0m20:04:28.179421 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:04:28.179833 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:04:28.208732 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:04:28.209030 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:04:28.209553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:28.218471 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:04:28.219285 [debug] [ThreadPool]: On list_dev: Close
[0m20:04:28.219686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:04:28.220198 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:04:28.223733 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:04:28.223935 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:04:28.224077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:28.224630 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:04:28.225329 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:04:28.225479 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:04:28.225725 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:28.225894 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:04:28.226041 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:04:28.226818 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:04:28.227293 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:04:28.227446 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:04:28.227581 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:04:28.227813 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:28.227957 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:04:28.231128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_dbt_test__audit)
[0m20:04:28.234512 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:04:28.234739 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:04:28.234884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:28.235244 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:28.235386 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:04:28.235535 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:04:28.242991 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:04:28.243795 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:04:28.244426 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:04:28.244587 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:04:28.244853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:04:28.245768 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:04:28.245916 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:04:28.246042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:28.246299 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:28.246432 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:04:28.246570 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:04:28.248584 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:04:28.249281 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:04:28.249587 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:04:28.249731 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:04:28.250506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f589ca12-fe80-4320-9fc5-5631e67a5111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092c5090>]}
[0m20:04:28.250741 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:28.250910 [debug] [MainThread]: On master: BEGIN
[0m20:04:28.251103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:28.251387 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:28.251540 [debug] [MainThread]: On master: COMMIT
[0m20:04:28.251672 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:28.251800 [debug] [MainThread]: On master: COMMIT
[0m20:04:28.251990 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:28.252124 [debug] [MainThread]: On master: Close
[0m20:04:28.253176 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:04:28.253442 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_users ..................................... [RUN]
[0m20:04:28.253655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.sbdk_project.stg_users)
[0m20:04:28.253820 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:04:28.257560 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:04:28.257954 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:04:28.276288 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:04:28.276834 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:04:28.277014 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:04:28.277173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:28.277559 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:28.277760 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:04:28.277962 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_users
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:04:28.280323 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:04:28.320403 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:04:28.320660 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m20:04:28.321851 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:04:28.323319 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:04:28.323500 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:04:28.323788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:28.330451 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:04:28.330724 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:04:28.330899 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:04:28.332381 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:04:28.335687 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:04:28.335901 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m20:04:28.336638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:04:28.337905 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:04:28.338997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f589ca12-fe80-4320-9fc5-5631e67a5111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887ea50>]}
[0m20:04:28.339358 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.08s]
[0m20:04:28.339640 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:04:28.340258 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:28.340410 [debug] [MainThread]: On master: BEGIN
[0m20:04:28.340537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:28.340804 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:28.340945 [debug] [MainThread]: On master: COMMIT
[0m20:04:28.341079 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:28.341208 [debug] [MainThread]: On master: COMMIT
[0m20:04:28.341404 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:28.341540 [debug] [MainThread]: On master: Close
[0m20:04:28.341713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:28.341840 [debug] [MainThread]: Connection 'model.sbdk_project.stg_users' was properly closed.
[0m20:04:28.341977 [info ] [MainThread]: 
[0m20:04:28.342123 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m20:04:28.342442 [debug] [MainThread]: Command end result
[0m20:04:28.354902 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:04:28.355882 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:04:28.358814 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:04:28.358991 [info ] [MainThread]: 
[0m20:04:28.359188 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:04:28.359338 [info ] [MainThread]: 
[0m20:04:28.359498 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:04:28.360838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.60759157, "process_in_blocks": "0", "process_kernel_time": 0.190987, "process_mem_max_rss": "146423808", "process_out_blocks": "0", "process_user_time": 1.29819}
[0m20:04:28.361063 [debug] [MainThread]: Command `dbt run` succeeded at 20:04:28.361022 after 0.61 seconds
[0m20:04:28.361238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109228b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109354b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109354cd0>]}
[0m20:04:28.361408 [debug] [MainThread]: Flushing usage events
[0m20:04:28.787846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:29.906559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915bd90>]}


============================== 20:04:29.908924 | 9fb81f19-7db8-4e0b-bce2-ca6c75fbd6e8 ==============================
[0m20:04:29.908924 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:04:29.909247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:30.051367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fb81f19-7db8-4e0b-bce2-ca6c75fbd6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b96e0>]}
[0m20:04:30.114997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fb81f19-7db8-4e0b-bce2-ca6c75fbd6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b82ad0>]}
[0m20:04:30.116485 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:04:30.209909 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:04:30.276587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:30.276837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:30.280433 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:04:30.303174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fb81f19-7db8-4e0b-bce2-ca6c75fbd6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10926bd50>]}
[0m20:04:30.351894 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:04:30.353238 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:04:30.430529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fb81f19-7db8-4e0b-bce2-ca6c75fbd6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e59a0>]}
[0m20:04:30.430830 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:04:30.431001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fb81f19-7db8-4e0b-bce2-ca6c75fbd6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a141630>]}
[0m20:04:30.432195 [info ] [MainThread]: 
[0m20:04:30.432391 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:04:30.432534 [info ] [MainThread]: 
[0m20:04:30.432792 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:04:30.435455 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:04:30.466449 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:04:30.466691 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:04:30.466848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:30.475370 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:04:30.476147 [debug] [ThreadPool]: On list_dev: Close
[0m20:04:30.476491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:04:30.476723 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:04:30.480034 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:04:30.480209 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:04:30.480362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:30.480734 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:30.481353 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:04:30.481494 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:04:30.481691 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:30.481826 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:04:30.481954 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:04:30.482177 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:30.482566 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:04:30.482706 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:04:30.482833 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:04:30.483276 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:30.483445 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:04:30.484492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main_dbt_test__audit)
[0m20:04:30.487276 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:04:30.487471 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:04:30.487622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:30.487953 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:30.488097 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:04:30.488248 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:04:30.495280 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:04:30.495989 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:04:30.496570 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:04:30.496723 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:04:30.496972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:04:30.533568 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:04:30.533789 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:04:30.533930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:30.534263 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:30.534401 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:04:30.534543 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:04:30.536784 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:04:30.537542 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:04:30.537885 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:04:30.538031 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:04:30.538797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fb81f19-7db8-4e0b-bce2-ca6c75fbd6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097cedd0>]}
[0m20:04:30.539048 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:30.539191 [debug] [MainThread]: On master: BEGIN
[0m20:04:30.539318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:30.539546 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:30.539679 [debug] [MainThread]: On master: COMMIT
[0m20:04:30.539806 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:30.539928 [debug] [MainThread]: On master: COMMIT
[0m20:04:30.540111 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:30.540242 [debug] [MainThread]: On master: Close
[0m20:04:30.541306 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:04:30.541507 [info ] [Thread-1 (]: 1 of 13 START test source_not_null_raw_events_event_id ......................... [RUN]
[0m20:04:30.541719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2)
[0m20:04:30.541897 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:04:30.551046 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:04:30.551657 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:04:30.561525 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
[0m20:04:30.571425 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:04:30.571699 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: BEGIN
[0m20:04:30.571875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.572239 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.572410 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:04:30.572582 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where event_id is null



  
  
    );
  
  
    
[0m20:04:30.576509 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where event_id is null



  
  
    );
  
  
    
[0m20:04:30.576718 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.576974 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: ROLLBACK
[0m20:04:30.582625 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2'
[0m20:04:30.582909 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: Close
[0m20:04:30.585054 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:04:30.585358 [error] [Thread-1 (]: 1 of 13 ERROR source_not_null_raw_events_event_id .............................. [[31mERROR[0m in 0.04s]
[0m20:04:30.585718 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:04:30.586091 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:04:30.586566 [info ] [Thread-1 (]: 2 of 13 START test source_not_null_raw_events_timestamp ........................ [RUN]
[0m20:04:30.587033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2, now test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05)
[0m20:04:30.587332 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:04:30.587609 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:04:30.590709 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:04:30.591368 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:04:30.592616 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
[0m20:04:30.593177 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:04:30.593375 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: BEGIN
[0m20:04:30.593552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.593950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.594158 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:04:30.594345 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where timestamp is null



  
  
    );
  
  
    
[0m20:04:30.594803 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where timestamp is null



  
  
    );
  
  
    
[0m20:04:30.594995 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.595222 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: ROLLBACK
[0m20:04:30.597396 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05'
[0m20:04:30.597591 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: Close
[0m20:04:30.599622 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:04:30.599889 [error] [Thread-1 (]: 2 of 13 ERROR source_not_null_raw_events_timestamp ............................. [[31mERROR[0m in 0.01s]
[0m20:04:30.600171 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:04:30.600370 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:04:30.600626 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:04:30.600845 [info ] [Thread-1 (]: 3 of 13 START test source_not_null_raw_events_user_id .......................... [RUN]
[0m20:04:30.601139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05, now test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1)
[0m20:04:30.601331 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:04:30.603971 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:04:30.604432 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:04:30.605536 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
[0m20:04:30.606066 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:04:30.606263 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: BEGIN
[0m20:04:30.606437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.606804 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.606980 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:04:30.607161 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where user_id is null



  
  
    );
  
  
    
[0m20:04:30.607609 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where user_id is null



  
  
    );
  
  
    
[0m20:04:30.607793 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.608017 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: ROLLBACK
[0m20:04:30.610171 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1'
[0m20:04:30.610363 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: Close
[0m20:04:30.612366 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:04:30.612621 [error] [Thread-1 (]: 3 of 13 ERROR source_not_null_raw_events_user_id ............................... [[31mERROR[0m in 0.01s]
[0m20:04:30.612898 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:04:30.613097 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:04:30.613343 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:04:30.613561 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_raw_orders_order_id ......................... [RUN]
[0m20:04:30.613853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1, now test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f)
[0m20:04:30.614051 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:04:30.616391 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:04:30.616783 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:04:30.617831 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
[0m20:04:30.618339 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:04:30.618524 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: BEGIN
[0m20:04:30.618691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.619017 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.619185 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:04:30.619358 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where order_id is null



  
  
    );
  
  
    
[0m20:04:30.619787 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where order_id is null



  
  
    );
  
  
    
[0m20:04:30.619966 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.620175 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: ROLLBACK
[0m20:04:30.622239 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f'
[0m20:04:30.622432 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: Close
[0m20:04:30.624396 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:04:30.624641 [error] [Thread-1 (]: 4 of 13 ERROR source_not_null_raw_orders_order_id .............................. [[31mERROR[0m in 0.01s]
[0m20:04:30.624911 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:04:30.625106 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:04:30.625334 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:04:30.625530 [info ] [Thread-1 (]: 5 of 13 START test source_not_null_raw_orders_total_amount ..................... [RUN]
[0m20:04:30.625798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f, now test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec)
[0m20:04:30.626016 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:04:30.628285 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:04:30.628664 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:04:30.629716 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
[0m20:04:30.630233 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:04:30.630425 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: BEGIN
[0m20:04:30.630601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.630927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.631117 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:04:30.631303 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:04:30.631738 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:04:30.631926 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.632144 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: ROLLBACK
[0m20:04:30.634228 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec'
[0m20:04:30.634421 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: Close
[0m20:04:30.636398 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:04:30.636650 [error] [Thread-1 (]: 5 of 13 ERROR source_not_null_raw_orders_total_amount .......................... [[31mERROR[0m in 0.01s]
[0m20:04:30.636922 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:04:30.637118 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:04:30.637345 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:04:30.637550 [info ] [Thread-1 (]: 6 of 13 START test source_not_null_raw_orders_user_id .......................... [RUN]
[0m20:04:30.637823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec, now test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd)
[0m20:04:30.638007 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:04:30.640042 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:04:30.640406 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:04:30.641767 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
[0m20:04:30.642275 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:04:30.642465 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: BEGIN
[0m20:04:30.642633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.642967 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.643150 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:04:30.643332 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where user_id is null



  
  
    );
  
  
    
[0m20:04:30.643750 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where user_id is null



  
  
    );
  
  
    
[0m20:04:30.643933 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.644148 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: ROLLBACK
[0m20:04:30.646189 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd'
[0m20:04:30.646369 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: Close
[0m20:04:30.648340 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:04:30.648579 [error] [Thread-1 (]: 6 of 13 ERROR source_not_null_raw_orders_user_id ............................... [[31mERROR[0m in 0.01s]
[0m20:04:30.648848 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:04:30.649039 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:04:30.649264 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:04:30.649457 [info ] [Thread-1 (]: 7 of 13 START test source_not_null_raw_users_created_at ........................ [RUN]
[0m20:04:30.649713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd, now test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5)
[0m20:04:30.649910 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:04:30.651870 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:04:30.652243 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:04:30.653535 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
[0m20:04:30.654053 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:04:30.654244 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: BEGIN
[0m20:04:30.654415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.654714 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.654887 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:04:30.655065 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where created_at is null



  
  
    );
  
  
    
[0m20:04:30.655480 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where created_at is null



  
  
    );
  
  
    
[0m20:04:30.655667 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.655880 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: ROLLBACK
[0m20:04:30.657960 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5'
[0m20:04:30.658156 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: Close
[0m20:04:30.660142 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:04:30.660392 [error] [Thread-1 (]: 7 of 13 ERROR source_not_null_raw_users_created_at ............................. [[31mERROR[0m in 0.01s]
[0m20:04:30.660672 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:04:30.660868 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:04:30.661093 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:04:30.661288 [info ] [Thread-1 (]: 8 of 13 START test source_not_null_raw_users_email ............................. [RUN]
[0m20:04:30.661553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5, now test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5)
[0m20:04:30.661734 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:04:30.663869 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:04:30.664255 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:04:30.665319 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
[0m20:04:30.665827 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:04:30.666012 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: BEGIN
[0m20:04:30.666180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.666522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.666715 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:04:30.666898 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where email is null



  
  
    );
  
  
    
[0m20:04:30.667331 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where email is null



  
  
    );
  
  
    
[0m20:04:30.667515 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.667734 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: ROLLBACK
[0m20:04:30.669944 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5'
[0m20:04:30.670142 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: Close
[0m20:04:30.672162 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:04:30.672412 [error] [Thread-1 (]: 8 of 13 ERROR source_not_null_raw_users_email .................................. [[31mERROR[0m in 0.01s]
[0m20:04:30.672683 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:04:30.672874 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:04:30.673101 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:04:30.673317 [info ] [Thread-1 (]: 9 of 13 START test source_not_null_raw_users_user_id ........................... [RUN]
[0m20:04:30.673612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5, now test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c)
[0m20:04:30.673798 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:04:30.676812 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:04:30.677471 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:04:30.678680 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
[0m20:04:30.679210 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:04:30.679397 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: BEGIN
[0m20:04:30.679571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.679935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.680107 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:04:30.680281 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where user_id is null



  
  
    );
  
  
    
[0m20:04:30.680726 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where user_id is null



  
  
    );
  
  
    
[0m20:04:30.680907 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.681126 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: ROLLBACK
[0m20:04:30.683366 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c'
[0m20:04:30.683583 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: Close
[0m20:04:30.685636 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:04:30.685901 [error] [Thread-1 (]: 9 of 13 ERROR source_not_null_raw_users_user_id ................................ [[31mERROR[0m in 0.01s]
[0m20:04:30.686282 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:04:30.686593 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:04:30.687246 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:04:30.687005 [info ] [Thread-1 (]: 10 of 13 START test source_unique_raw_events_event_id .......................... [RUN]
[0m20:04:30.687580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c, now test.sbdk_project.source_unique_raw_events_event_id.825f404073)
[0m20:04:30.687772 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:04:30.691433 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:04:30.691813 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:04:30.692863 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
[0m20:04:30.693364 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:04:30.693544 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: BEGIN
[0m20:04:30.693708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.694055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.694216 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:04:30.694390 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_events_event_id.825f404073"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."raw"."events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:04:30.694841 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_events_event_id.825f404073"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."raw"."events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:04:30.695019 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.695226 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: ROLLBACK
[0m20:04:30.697314 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_events_event_id.825f404073'
[0m20:04:30.697506 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: Close
[0m20:04:30.699471 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^
[0m20:04:30.699715 [error] [Thread-1 (]: 10 of 13 ERROR source_unique_raw_events_event_id ............................... [[31mERROR[0m in 0.01s]
[0m20:04:30.699982 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:04:30.700175 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:04:30.700406 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_events_event_id.825f404073' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^.
[0m20:04:30.700615 [info ] [Thread-1 (]: 11 of 13 START test source_unique_raw_orders_order_id .......................... [RUN]
[0m20:04:30.700900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_events_event_id.825f404073, now test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f)
[0m20:04:30.701075 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:04:30.703154 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:04:30.703654 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:04:30.705191 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
[0m20:04:30.705722 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:04:30.705906 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: BEGIN
[0m20:04:30.706072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.706477 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.706678 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:04:30.706870 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."raw"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:04:30.707391 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."raw"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:04:30.707584 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.707816 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: ROLLBACK
[0m20:04:30.710130 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f'
[0m20:04:30.710399 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: Close
[0m20:04:30.713449 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^
[0m20:04:30.713816 [error] [Thread-1 (]: 11 of 13 ERROR source_unique_raw_orders_order_id ............................... [[31mERROR[0m in 0.01s]
[0m20:04:30.714109 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:04:30.714323 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:04:30.714541 [info ] [Thread-1 (]: 12 of 13 START test source_unique_raw_users_email .............................. [RUN]
[0m20:04:30.714832 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^.
[0m20:04:30.715080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f, now test.sbdk_project.source_unique_raw_users_email.ab11a6771a)
[0m20:04:30.715379 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:04:30.717752 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:04:30.718195 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:04:30.720862 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
[0m20:04:30.721489 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:04:30.721847 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: BEGIN
[0m20:04:30.722028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.722462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.722639 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:04:30.722819 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:04:30.723321 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:04:30.723511 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.723750 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: ROLLBACK
[0m20:04:30.726499 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_users_email.ab11a6771a'
[0m20:04:30.726733 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: Close
[0m20:04:30.728827 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:04:30.729101 [error] [Thread-1 (]: 12 of 13 ERROR source_unique_raw_users_email ................................... [[31mERROR[0m in 0.01s]
[0m20:04:30.729382 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:04:30.729582 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:04:30.729843 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_users_email.ab11a6771a' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^.
[0m20:04:30.730064 [info ] [Thread-1 (]: 13 of 13 START test source_unique_raw_users_user_id ............................ [RUN]
[0m20:04:30.730353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_users_email.ab11a6771a, now test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c)
[0m20:04:30.730543 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:04:30.732721 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:04:30.733148 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:04:30.734302 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
[0m20:04:30.736726 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:04:30.736976 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: BEGIN
[0m20:04:30.737160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:30.737552 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:30.737745 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:04:30.737934 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:04:30.738407 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:04:30.738600 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:30.738827 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: ROLLBACK
[0m20:04:30.740951 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c'
[0m20:04:30.741140 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: Close
[0m20:04:30.743158 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:04:30.743416 [error] [Thread-1 (]: 13 of 13 ERROR source_unique_raw_users_user_id ................................. [[31mERROR[0m in 0.01s]
[0m20:04:30.743919 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:04:30.744234 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^.
[0m20:04:30.744904 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:30.745080 [debug] [MainThread]: On master: BEGIN
[0m20:04:30.745211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:30.745503 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:30.745652 [debug] [MainThread]: On master: COMMIT
[0m20:04:30.745802 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:30.746006 [debug] [MainThread]: On master: COMMIT
[0m20:04:30.746275 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:30.746455 [debug] [MainThread]: On master: Close
[0m20:04:30.746657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:30.746795 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c' was properly closed.
[0m20:04:30.746985 [info ] [MainThread]: 
[0m20:04:30.747160 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:04:30.748252 [debug] [MainThread]: Command end result
[0m20:04:30.762085 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:04:30.763257 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:04:30.767269 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:04:30.767466 [info ] [MainThread]: 
[0m20:04:30.767665 [info ] [MainThread]: [31mCompleted with 13 errors, 0 partial successes, and 0 warnings:[0m
[0m20:04:30.767827 [info ] [MainThread]: 
[0m20:04:30.768023 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_event_id (models/_sources.yml)[0m
[0m20:04:30.768207 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:04:30.768347 [info ] [MainThread]: 
[0m20:04:30.768512 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_event_id.sql
[0m20:04:30.768645 [info ] [MainThread]: 
[0m20:04:30.768808 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  --------------------------------------------------------------------------------
[0m20:04:30.768946 [info ] [MainThread]: 
[0m20:04:30.769111 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_timestamp (models/_sources.yml)[0m
[0m20:04:30.769321 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:04:30.769500 [info ] [MainThread]: 
[0m20:04:30.769684 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_timestamp.sql
[0m20:04:30.769825 [info ] [MainThread]: 
[0m20:04:30.769992 [info ] [MainThread]:   See test failures:
  ---------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  ---------------------------------------------------------------------------------
[0m20:04:30.770137 [info ] [MainThread]: 
[0m20:04:30.770309 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_user_id (models/_sources.yml)[0m
[0m20:04:30.770482 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:04:30.770615 [info ] [MainThread]: 
[0m20:04:30.770777 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_user_id.sql
[0m20:04:30.770906 [info ] [MainThread]: 
[0m20:04:30.771066 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  -------------------------------------------------------------------------------
[0m20:04:30.771208 [info ] [MainThread]: 
[0m20:04:30.771377 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_order_id (models/_sources.yml)[0m
[0m20:04:30.771551 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:04:30.771684 [info ] [MainThread]: 
[0m20:04:30.771845 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_order_id.sql
[0m20:04:30.771974 [info ] [MainThread]: 
[0m20:04:30.772130 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  --------------------------------------------------------------------------------
[0m20:04:30.772269 [info ] [MainThread]: 
[0m20:04:30.772438 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_total_amount (models/_sources.yml)[0m
[0m20:04:30.772611 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:04:30.772745 [info ] [MainThread]: 
[0m20:04:30.772905 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_total_amount.sql
[0m20:04:30.773037 [info ] [MainThread]: 
[0m20:04:30.773194 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  ------------------------------------------------------------------------------------
[0m20:04:30.773328 [info ] [MainThread]: 
[0m20:04:30.773493 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_user_id (models/_sources.yml)[0m
[0m20:04:30.773662 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:04:30.773794 [info ] [MainThread]: 
[0m20:04:30.773954 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_user_id.sql
[0m20:04:30.774081 [info ] [MainThread]: 
[0m20:04:30.774239 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  -------------------------------------------------------------------------------
[0m20:04:30.774376 [info ] [MainThread]: 
[0m20:04:30.774542 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_created_at (models/_sources.yml)[0m
[0m20:04:30.774710 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:04:30.774838 [info ] [MainThread]: 
[0m20:04:30.774997 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_created_at.sql
[0m20:04:30.775125 [info ] [MainThread]: 
[0m20:04:30.775282 [info ] [MainThread]:   See test failures:
  ---------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  ---------------------------------------------------------------------------------
[0m20:04:30.775421 [info ] [MainThread]: 
[0m20:04:30.775583 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_email (models/_sources.yml)[0m
[0m20:04:30.775751 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:04:30.775883 [info ] [MainThread]: 
[0m20:04:30.776042 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_email.sql
[0m20:04:30.776171 [info ] [MainThread]: 
[0m20:04:30.776329 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  ----------------------------------------------------------------------------
[0m20:04:30.776464 [info ] [MainThread]: 
[0m20:04:30.776630 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_user_id (models/_sources.yml)[0m
[0m20:04:30.776793 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:04:30.776922 [info ] [MainThread]: 
[0m20:04:30.777080 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_user_id.sql
[0m20:04:30.777207 [info ] [MainThread]: 
[0m20:04:30.777364 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  ------------------------------------------------------------------------------
[0m20:04:30.777500 [info ] [MainThread]: 
[0m20:04:30.777660 [error] [MainThread]: [31mFailure in test source_unique_raw_events_event_id (models/_sources.yml)[0m
[0m20:04:30.777825 [error] [MainThread]:   Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^
[0m20:04:30.777958 [info ] [MainThread]: 
[0m20:04:30.778175 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_events_event_id.sql
[0m20:04:30.778348 [info ] [MainThread]: 
[0m20:04:30.778532 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  ------------------------------------------------------------------------------
[0m20:04:30.778687 [info ] [MainThread]: 
[0m20:04:30.778861 [error] [MainThread]: [31mFailure in test source_unique_raw_orders_order_id (models/_sources.yml)[0m
[0m20:04:30.779040 [error] [MainThread]:   Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^
[0m20:04:30.779178 [info ] [MainThread]: 
[0m20:04:30.779346 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_orders_order_id.sql
[0m20:04:30.779483 [info ] [MainThread]: 
[0m20:04:30.779647 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  ------------------------------------------------------------------------------
[0m20:04:30.779786 [info ] [MainThread]: 
[0m20:04:30.779952 [error] [MainThread]: [31mFailure in test source_unique_raw_users_email (models/_sources.yml)[0m
[0m20:04:30.780124 [error] [MainThread]:   Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:04:30.780257 [info ] [MainThread]: 
[0m20:04:30.780417 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_users_email.sql
[0m20:04:30.780548 [info ] [MainThread]: 
[0m20:04:30.780707 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  --------------------------------------------------------------------------
[0m20:04:30.780847 [info ] [MainThread]: 
[0m20:04:30.781012 [error] [MainThread]: [31mFailure in test source_unique_raw_users_user_id (models/_sources.yml)[0m
[0m20:04:30.781179 [error] [MainThread]:   Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:04:30.781312 [info ] [MainThread]: 
[0m20:04:30.781473 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_users_user_id.sql
[0m20:04:30.781604 [info ] [MainThread]: 
[0m20:04:30.781765 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  ----------------------------------------------------------------------------
[0m20:04:30.781907 [info ] [MainThread]: 
[0m20:04:30.782070 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=13 SKIP=0 NO-OP=0 TOTAL=13
[0m20:04:30.784649 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.9236747, "process_in_blocks": "0", "process_kernel_time": 0.200968, "process_mem_max_rss": "172048384", "process_out_blocks": "0", "process_user_time": 1.476306}
[0m20:04:30.784918 [debug] [MainThread]: Command `dbt test` failed at 20:04:30.784870 after 0.92 seconds
[0m20:04:30.785130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ae150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097add30>]}
[0m20:04:30.785330 [debug] [MainThread]: Flushing usage events
[0m20:04:31.141187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:32.358208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bdda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f3d90>]}


============================== 20:04:32.360845 | e818f748-274a-4e98-b310-610393f804c5 ==============================
[0m20:04:32.360845 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:04:32.361195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --project-dir /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt --profiles-dir /Users/mattstrautmann/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:04:32.367700 [info ] [MainThread]: dbt version: 1.10.6
[0m20:04:32.368088 [info ] [MainThread]: python version: 3.13.5
[0m20:04:32.368367 [info ] [MainThread]: python path: /Users/mattstrautmann/Documents/GitHub/sbdk-dev/.venv/bin/python3
[0m20:04:32.368528 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m20:04:32.435097 [info ] [MainThread]: Using profiles dir at /Users/mattstrautmann/.dbt
[0m20:04:32.435419 [info ] [MainThread]: Using profiles.yml file at /Users/mattstrautmann/.dbt/profiles.yml
[0m20:04:32.435599 [info ] [MainThread]: Using dbt_project.yml file at /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/dbt_project.yml
[0m20:04:32.436668 [info ] [MainThread]: adapter type: duckdb
[0m20:04:32.436865 [info ] [MainThread]: adapter version: 1.9.4
[0m20:04:32.507304 [info ] [MainThread]: Configuration:
[0m20:04:32.507604 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:04:32.507758 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:04:32.507901 [info ] [MainThread]: Required dependencies:
[0m20:04:32.508093 [debug] [MainThread]: Executing "git --help"
[0m20:04:32.522475 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:04:32.523057 [debug] [MainThread]: STDERR: "b''"
[0m20:04:32.523262 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:04:32.523442 [info ] [MainThread]: Connection:
[0m20:04:32.523624 [info ] [MainThread]:   database: dev
[0m20:04:32.523764 [info ] [MainThread]:   schema: main
[0m20:04:32.523889 [info ] [MainThread]:   path: /Users/mattstrautmann/Documents/GitHub/sbdk-dev/sbdk-starter/demo_project/data/dev.duckdb
[0m20:04:32.524014 [info ] [MainThread]:   config_options: None
[0m20:04:32.524138 [info ] [MainThread]:   extensions: None
[0m20:04:32.524258 [info ] [MainThread]:   settings: {}
[0m20:04:32.524382 [info ] [MainThread]:   external_root: .
[0m20:04:32.524500 [info ] [MainThread]:   use_credential_provider: None
[0m20:04:32.524621 [info ] [MainThread]:   attach: None
[0m20:04:32.524742 [info ] [MainThread]:   filesystems: None
[0m20:04:32.524858 [info ] [MainThread]:   remote: None
[0m20:04:32.524981 [info ] [MainThread]:   plugins: None
[0m20:04:32.525099 [info ] [MainThread]:   disable_transactions: False
[0m20:04:32.525449 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:04:32.585984 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:04:32.610175 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:04:32.610432 [debug] [MainThread]: On debug: select 1 as id
[0m20:04:32.610587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:32.619336 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m20:04:32.620029 [debug] [MainThread]: On debug: Close
[0m20:04:32.620284 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:04:32.620540 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:04:32.622378 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.31606546, "process_in_blocks": "0", "process_kernel_time": 0.18337, "process_mem_max_rss": "138428416", "process_out_blocks": "0", "process_user_time": 1.014881}
[0m20:04:32.622699 [debug] [MainThread]: Command `dbt debug` succeeded at 20:04:32.622642 after 0.32 seconds
[0m20:04:32.622885 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:04:32.623079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107681b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107458160>]}
[0m20:04:32.623293 [debug] [MainThread]: Flushing usage events
[0m20:04:32.983924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:33.849155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702fd90>]}


============================== 20:04:33.852735 | fe29d5e6-4252-47d7-be7f-6f6183032eae ==============================
[0m20:04:33.852735 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:04:33.853103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:33.991612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe29d5e6-4252-47d7-be7f-6f6183032eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063916e0>]}
[0m20:04:34.033259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe29d5e6-4252-47d7-be7f-6f6183032eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a56ad0>]}
[0m20:04:34.034530 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:04:34.039656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fbd90>]}


============================== 20:04:34.042404 | 29d392d2-4415-4a67-bfeb-868dd02d508c ==============================
[0m20:04:34.042404 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:04:34.042755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt --profiles-dir /Users/mattstrautmann/.dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:34.091619 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:04:34.159365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:34.159618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:34.163280 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:04:34.182927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29d392d2-4415-4a67-bfeb-868dd02d508c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087496e0>]}
[0m20:04:34.185540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe29d5e6-4252-47d7-be7f-6f6183032eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713fb50>]}
[0m20:04:34.223947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29d392d2-4415-4a67-bfeb-868dd02d508c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e22ad0>]}
[0m20:04:34.227973 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:04:34.235607 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:04:34.237004 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:04:34.246406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe29d5e6-4252-47d7-be7f-6f6183032eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736ff20>]}
[0m20:04:34.246719 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:04:34.246900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe29d5e6-4252-47d7-be7f-6f6183032eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076cc830>]}
[0m20:04:34.248013 [info ] [MainThread]: 
[0m20:04:34.248210 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:04:34.248359 [info ] [MainThread]: 
[0m20:04:34.248630 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:04:34.251283 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:04:34.285574 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:04:34.285847 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:04:34.286105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:34.295290 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:04:34.296135 [debug] [ThreadPool]: On list_dev: Close
[0m20:04:34.296509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:04:34.296770 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:04:34.297594 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:04:34.300281 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:04:34.300479 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:04:34.300625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:34.301124 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:34.301803 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:04:34.301953 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:04:34.302184 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:34.302314 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:04:34.302446 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:04:34.302669 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:34.303160 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:04:34.303345 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:04:34.303492 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:04:34.303746 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:34.303898 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:04:34.305022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_dbt_test__audit)
[0m20:04:34.307845 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:04:34.308030 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:04:34.308174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:34.308442 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:34.308590 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:04:34.308731 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:04:34.315826 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:04:34.316937 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:04:34.317565 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:04:34.317728 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:04:34.317997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:04:34.318915 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:04:34.319117 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:04:34.319304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:34.319645 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:04:34.319848 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:04:34.320008 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:04:34.322306 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:04:34.323171 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:04:34.323566 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:04:34.323734 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:04:34.324635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe29d5e6-4252-47d7-be7f-6f6183032eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a05640>]}
[0m20:04:34.324900 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:34.325050 [debug] [MainThread]: On master: BEGIN
[0m20:04:34.325185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:34.325534 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:34.325697 [debug] [MainThread]: On master: COMMIT
[0m20:04:34.325846 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:34.325981 [debug] [MainThread]: On master: COMMIT
[0m20:04:34.326196 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:34.326340 [debug] [MainThread]: On master: Close
[0m20:04:34.327404 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:04:34.327675 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_events .................................... [RUN]
[0m20:04:34.327888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.sbdk_project.stg_events)
[0m20:04:34.328057 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:04:34.332286 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:04:34.332761 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:04:34.351731 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m20:04:34.352292 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:04:34.352487 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m20:04:34.352657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:34.353040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.353204 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:04:34.353553 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_events
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m20:04:34.354519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:04:34.366555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:34.366858 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:34.371006 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:04:34.394736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29d392d2-4415-4a67-bfeb-868dd02d508c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950bb50>]}
[0m20:04:34.395039 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:04:34.395290 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m20:04:34.395721 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.397192 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:04:34.397385 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:04:34.397685 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.404234 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:04:34.404449 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:04:34.404619 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:04:34.405370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:04:34.408404 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:04:34.408618 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m20:04:34.409086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.410505 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m20:04:34.411893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe29d5e6-4252-47d7-be7f-6f6183032eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071baa50>]}
[0m20:04:34.412244 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.08s]
[0m20:04:34.412524 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:04:34.412731 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:04:34.412988 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_orders .................................... [RUN]
[0m20:04:34.413204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:04:34.413378 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:04:34.414833 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:04:34.415264 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:04:34.417072 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m20:04:34.417756 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:04:34.418075 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m20:04:34.418291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:34.418732 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.418947 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:04:34.419196 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_orders
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m20:04:34.420527 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:04:34.422477 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:04:34.422678 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:04:34.423004 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.424440 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:04:34.424640 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:04:34.424957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.425768 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:04:34.425957 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:04:34.426123 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:04:34.426643 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.427966 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:04:34.428144 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m20:04:34.428507 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.429159 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m20:04:34.429447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe29d5e6-4252-47d7-be7f-6f6183032eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab0470>]}
[0m20:04:34.429760 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.02s]
[0m20:04:34.430023 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:04:34.430211 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:04:34.430462 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_users ..................................... [RUN]
[0m20:04:34.430662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:04:34.430832 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:04:34.432182 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:04:34.432592 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:04:34.434168 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:04:34.434514 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:04:34.434684 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:04:34.434847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:34.435134 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.435292 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:04:34.435484 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_users
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:04:34.436458 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:04:34.438308 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:04:34.438505 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m20:04:34.438834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.440205 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:04:34.440395 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:04:34.440674 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.441462 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:04:34.441648 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:04:34.441811 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:04:34.442223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.443451 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:04:34.443649 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m20:04:34.444038 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.444785 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:04:34.445092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe29d5e6-4252-47d7-be7f-6f6183032eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b3d90>]}
[0m20:04:34.445422 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.01s]
[0m20:04:34.445702 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:04:34.445828 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:04:34.446083 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:04:34.446343 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_user_activity ............................. [RUN]
[0m20:04:34.446556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now model.sbdk_project.int_user_activity)
[0m20:04:34.446732 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m20:04:34.447063 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:04:34.448836 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m20:04:34.449300 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m20:04:34.451030 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.int_user_activity"
[0m20:04:34.451657 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:04:34.451887 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: BEGIN
[0m20:04:34.452228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:34.452692 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.452886 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:04:34.453317 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

  
  create view "dev"."main"."int_user_activity__dbt_tmp" as (
    

with users as (
    select * from "dev"."main"."stg_users"
),

events as (
    select * from "dev"."main"."stg_events"
),

orders as (
    select * from "dev"."main"."stg_orders"
),

user_events as (
    select
        user_id,
        count(*) as total_events,
        count(*) filter (where event_type = 'page_view') as pageviews,
        count(*) filter (where event_type = 'click') as clicks,
        count(*) filter (where event_type = 'signup') as signups,
        count(*) filter (where event_type = 'login') as logins,
        count(*) filter (where event_type = 'purchase') as purchase_events,
        count(*) filter (where is_conversion_event = true) as conversion_events,
        count(*) filter (where is_revenue_event = true) as revenue_events,
        coalesce(sum(revenue), 0) as total_event_revenue,
        coalesce(sum(duration_seconds), 0) as total_time_on_site,
        count(distinct session_id) filter (where session_id is not null) as unique_sessions,
        count(distinct event_date) as active_days,
        min(timestamp) as first_event_at,
        max(timestamp) as last_event_at,
        count(distinct traffic_category) as traffic_sources_used
    from events
    group by user_id
),

user_orders as (
    select
        user_id,
        count(*) as total_orders,
        count(*) filter (where is_completed = true) as completed_orders,
        count(*) filter (where is_failed = true) as failed_orders,
        count(*) filter (where is_recurring = true) as recurring_orders,
        coalesce(sum(total_amount) filter (where is_completed = true), 0) as total_order_revenue,
        coalesce(avg(total_amount) filter (where is_completed = true), 0) as avg_order_value,
        coalesce(sum(discount_amount), 0) as total_discounts_used,
        count(distinct product_category) as product_categories_purchased,
        min(created_at) as first_order_at,
        max(created_at) as last_order_at,
        count(distinct payment_method) as payment_methods_used
    from orders
    group by user_id
),

combined as (
    select
        u.user_id,
        u.username,
        u.email,
        u.first_name,
        u.last_name,
        u.created_at as user_created_at,
        u.country,
        u.city,
        u.subscription_tier,
        u.referrer,
        u.is_active,
        u.age,
        u.is_paid_subscriber,
        u.days_since_signup,
        u.has_complete_profile,
        
        -- Event metrics
        coalesce(e.total_events, 0) as total_events,
        coalesce(e.pageviews, 0) as pageviews,
        coalesce(e.clicks, 0) as clicks,
        coalesce(e.signups, 0) as signups,
        coalesce(e.logins, 0) as logins,
        coalesce(e.purchase_events, 0) as purchase_events,
        coalesce(e.conversion_events, 0) as conversion_events,
        coalesce(e.revenue_events, 0) as revenue_events,
        coalesce(e.total_event_revenue, 0) as total_event_revenue,
        coalesce(e.total_time_on_site, 0) as total_time_on_site,
        coalesce(e.unique_sessions, 0) as unique_sessions,
        coalesce(e.active_days, 0) as active_days,
        e.first_event_at,
        e.last_event_at,
        coalesce(e.traffic_sources_used, 0) as traffic_sources_used,
        
        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.failed_orders, 0) as failed_orders,
        coalesce(o.recurring_orders, 0) as recurring_orders,
        coalesce(o.total_order_revenue, 0) as total_order_revenue,
        coalesce(o.avg_order_value, 0) as avg_order_value,
        coalesce(o.total_discounts_used, 0) as total_discounts_used,
        coalesce(o.product_categories_purchased, 0) as product_categories_purchased,
        o.first_order_at,
        o.last_order_at,
        coalesce(o.payment_methods_used, 0) as payment_methods_used,
        
        -- Calculated metrics
        case 
            when e.pageviews > 0 and o.completed_orders > 0 
            then round(o.completed_orders::float / e.pageviews * 100, 2)
            else 0 
        end as purchase_conversion_rate,
        
        case 
            when e.total_events > 0 
            then round(e.conversion_events::float / e.total_events * 100, 2)
            else 0 
        end as event_conversion_rate,
        
        case 
            when e.unique_sessions > 0 
            then round(e.total_events::float / e.unique_sessions, 2)
            else 0 
        end as events_per_session,
        
        case 
            when u.days_since_signup > 0 and e.active_days > 0
            then round(e.active_days::float / u.days_since_signup * 100, 2)
            else 0 
        end as activity_frequency_percentage,
        
        -- Total combined revenue
        coalesce(e.total_event_revenue, 0) + coalesce(o.total_order_revenue, 0) as total_revenue,
        
        -- User activity classification
        case 
            when o.completed_orders > 0 then 'customer'
            when e.signups > 0 then 'signed_up'
            when e.total_events > 10 then 'engaged_visitor'
            when e.total_events > 0 then 'visitor'
            else 'inactive'
        end as user_type
        
    from users u
    left join user_events e on u.user_id = e.user_id
    left join user_orders o on u.user_id = o.user_id
)

select * from combined
  );

[0m20:04:34.456499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29d392d2-4415-4a67-bfeb-868dd02d508c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973bf20>]}
[0m20:04:34.456809 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:04:34.457034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29d392d2-4415-4a67-bfeb-868dd02d508c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa0830>]}
[0m20:04:34.457371 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:04:34.458208 [info ] [MainThread]: 
[0m20:04:34.458408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:04:34.458557 [info ] [MainThread]: 
[0m20:04:34.458821 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:04:34.459330 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:04:34.459531 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity" rename to "int_user_activity__dbt_backup"
[0m20:04:34.459902 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.461235 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:04:34.461417 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity__dbt_tmp" rename to "int_user_activity"
[0m20:04:34.461457 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:04:34.461735 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.462506 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:04:34.462684 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:04:34.462843 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:04:34.463607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:04:34.464777 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:04:34.464967 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

      drop view if exists "dev"."main"."int_user_activity__dbt_backup" cascade
    
[0m20:04:34.465347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.466222 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: Close
[0m20:04:34.466501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe29d5e6-4252-47d7-be7f-6f6183032eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ef350>]}
[0m20:04:34.466812 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_user_activity ........................ [[32mOK[0m in 0.02s]
[0m20:04:34.467076 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:04:34.467401 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:04:34.467687 [info ] [Thread-1 (]: 5 of 5 START sql table model main.user_metrics ................................. [RUN]
[0m20:04:34.467915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m20:04:34.468089 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m20:04:34.469827 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m20:04:34.470357 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m20:04:34.481293 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.user_metrics"
[0m20:04:34.481981 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:04:34.482163 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: BEGIN
[0m20:04:34.482323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:34.482674 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.482834 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:04:34.483105 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

  
    
    

    create  table
      "dev"."main"."user_metrics__dbt_tmp"
  
    as (
      

with user_activity as (
    select * from "dev"."main"."int_user_activity"
),

final as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        user_created_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        age,
        is_paid_subscriber,
        days_since_signup,
        has_complete_profile,
        
        -- Engagement metrics
        total_events,
        pageviews,
        clicks,
        logins,
        unique_sessions,
        active_days,
        traffic_sources_used,
        events_per_session,
        activity_frequency_percentage,
        total_time_on_site,
        
        -- Conversion metrics
        signups,
        purchase_events,
        conversion_events,
        purchase_conversion_rate,
        event_conversion_rate,
        
        -- Revenue metrics
        total_orders,
        completed_orders,
        failed_orders,
        recurring_orders,
        total_order_revenue,
        total_event_revenue,
        total_revenue,
        avg_order_value,
        total_discounts_used,
        product_categories_purchased,
        payment_methods_used,
        
        -- Timing metrics
        first_event_at,
        last_event_at,
        first_order_at,
        last_order_at,
        
        -- User classification
        user_type,
        
        -- Customer lifetime value estimate
        case 
            when recurring_orders > 0 and days_since_signup > 0
            then round(total_revenue * (365.0 / days_since_signup) * 2, 2)  -- Rough 2-year CLV estimate
            else total_revenue 
        end as estimated_clv,
        
        -- Engagement score (0-100)
        least(100, 
            (case when active_days > 0 then least(25, active_days) else 0 end) +
            (case when unique_sessions > 0 then least(25, unique_sessions) else 0 end) +
            (case when total_events > 0 then least(25, least(25, total_events / 10)) else 0 end) +
            (case when completed_orders > 0 then 25 else 0 end)
        ) as engagement_score,
        
        -- Risk classification
        case 
            when last_event_at < current_date - interval '90 days' and total_orders > 0 then 'churn_risk'
            when last_event_at < current_date - interval '30 days' and user_type = 'customer' then 'at_risk'
            when activity_frequency_percentage < 10 and days_since_signup > 30 then 'low_engagement'
            when user_type = 'customer' and recurring_orders = 0 then 'one_time_buyer'
            when user_type = 'customer' and recurring_orders > 0 then 'loyal_customer'
            when user_type = 'engaged_visitor' then 'potential_customer'
            else 'standard'
        end as risk_category,
        
        -- Value tier
        case 
            when total_revenue >= 1000 then 'high_value'
            when total_revenue >= 500 then 'medium_value'
            when total_revenue >= 100 then 'low_value'
            when total_revenue > 0 then 'minimal_value'
            else 'no_value'
        end as value_tier,
        
        -- Recency, Frequency, Monetary (RFM) components
        case 
            when last_order_at >= current_date - interval '30 days' then 5
            when last_order_at >= current_date - interval '60 days' then 4
            when last_order_at >= current_date - interval '90 days' then 3
            when last_order_at >= current_date - interval '180 days' then 2
            when last_order_at is not null then 1
            else 0
        end as recency_score,
        
        case 
            when completed_orders >= 10 then 5
            when completed_orders >= 5 then 4
            when completed_orders >= 3 then 3
            when completed_orders >= 2 then 2
            when completed_orders >= 1 then 1
            else 0
        end as frequency_score,
        
        case 
            when total_revenue >= 1000 then 5
            when total_revenue >= 500 then 4
            when total_revenue >= 200 then 3
            when total_revenue >= 50 then 2
            when total_revenue > 0 then 1
            else 0
        end as monetary_score,
        
        -- Data freshness
        current_timestamp as updated_at
        
    from user_activity
)

select * from final
    );
  
  
[0m20:04:34.487537 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:04:34.487773 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:04:34.487936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:34.493881 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:04:34.494141 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:04:34.494604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:34.494781 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:04:34.494999 [info ] [MainThread]: 
[0m20:04:34.495215 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m20:04:34.495726 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/mattstrautmann/Documents/GitHub/sbdk-dev/sbdk-starter/demo_project/data/dev.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 99928) by user mattstrautmann. See also https://duckdb.org/docs/stable/connect/concurrency
[0m20:04:34.497393 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5055317, "process_in_blocks": "0", "process_kernel_time": 0.165556, "process_mem_max_rss": "136577024", "process_out_blocks": "0", "process_user_time": 1.141674}
[0m20:04:34.497723 [debug] [MainThread]: Command `dbt run` failed at 20:04:34.497663 after 0.51 seconds
[0m20:04:34.497962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd0870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a22450>]}
[0m20:04:34.498172 [debug] [MainThread]: Flushing usage events
[0m20:04:34.544073 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m20:04:34.546605 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:04:34.546871 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics" rename to "user_metrics__dbt_backup"
[0m20:04:34.548156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:04:34.549580 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:04:34.549762 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics__dbt_tmp" rename to "user_metrics"
[0m20:04:34.550083 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.552900 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:04:34.553131 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:04:34.553348 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:04:34.559308 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:04:34.560825 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:04:34.561004 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

      drop table if exists "dev"."main"."user_metrics__dbt_backup" cascade
    
[0m20:04:34.561596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:04:34.562285 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: Close
[0m20:04:34.562559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe29d5e6-4252-47d7-be7f-6f6183032eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab42f0>]}
[0m20:04:34.562866 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.user_metrics ............................ [[32mOK[0m in 0.09s]
[0m20:04:34.563134 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:04:34.563696 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:34.563847 [debug] [MainThread]: On master: BEGIN
[0m20:04:34.563976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:34.564227 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:34.564384 [debug] [MainThread]: On master: COMMIT
[0m20:04:34.564525 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:34.564655 [debug] [MainThread]: On master: COMMIT
[0m20:04:34.564848 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:34.564983 [debug] [MainThread]: On master: Close
[0m20:04:34.565157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:34.565285 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m20:04:34.565448 [info ] [MainThread]: 
[0m20:04:34.565590 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m20:04:34.566113 [debug] [MainThread]: Command end result
[0m20:04:34.583922 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:04:34.585061 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:04:34.589169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:04:34.589502 [info ] [MainThread]: 
[0m20:04:34.589825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:04:34.590034 [info ] [MainThread]: 
[0m20:04:34.590214 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:04:34.592117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.79541194, "process_in_blocks": "0", "process_kernel_time": 0.218441, "process_mem_max_rss": "222396416", "process_out_blocks": "0", "process_user_time": 1.445137}
[0m20:04:34.592379 [debug] [MainThread]: Command `dbt run` succeeded at 20:04:34.592331 after 0.80 seconds
[0m20:04:34.592585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079df8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079dfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079df7d0>]}
[0m20:04:34.592778 [debug] [MainThread]: Flushing usage events
[0m20:04:34.829227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:35.135881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:36.003798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061dda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f3d90>]}


============================== 20:04:36.006375 | 9531b5b7-33b7-455a-9600-6eb4d5cfbdb0 ==============================
[0m20:04:36.006375 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:04:36.006707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt list --resource-type model --project-dir /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:04:36.142912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9531b5b7-33b7-455a-9600-6eb4d5cfbdb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069556e0>]}
[0m20:04:36.184067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9531b5b7-33b7-455a-9600-6eb4d5cfbdb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106052ad0>]}
[0m20:04:36.185303 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:04:36.259212 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:04:36.323971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:36.324212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:36.328104 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:04:36.349730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9531b5b7-33b7-455a-9600-6eb4d5cfbdb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108403d50>]}
[0m20:04:36.398038 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:04:36.399191 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:04:36.407894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9531b5b7-33b7-455a-9600-6eb4d5cfbdb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108633e30>]}
[0m20:04:36.408494 [info ] [MainThread]: sbdk_project.intermediate.int_user_activity
[0m20:04:36.408669 [info ] [MainThread]: sbdk_project.staging.stg_events
[0m20:04:36.408803 [info ] [MainThread]: sbdk_project.staging.stg_orders
[0m20:04:36.408929 [info ] [MainThread]: sbdk_project.staging.stg_users
[0m20:04:36.409048 [info ] [MainThread]: sbdk_project.marts.user_metrics
[0m20:04:36.410409 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.4541591, "process_in_blocks": "0", "process_kernel_time": 0.1801, "process_mem_max_rss": "121159680", "process_out_blocks": "0", "process_user_time": 1.109526}
[0m20:04:36.410653 [debug] [MainThread]: Command `dbt list` succeeded at 20:04:36.410599 after 0.45 seconds
[0m20:04:36.410835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f7e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10895b790>]}
[0m20:04:36.410998 [debug] [MainThread]: Flushing usage events
[0m20:04:36.774551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:37.796115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c95a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132f3d90>]}


============================== 20:04:37.798525 | 0fb772de-8658-4b89-be5b-7d8f8729a485 ==============================
[0m20:04:37.798525 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:04:37.798842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select non_existent_model --project-dir /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:04:37.930504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fb772de-8658-4b89-be5b-7d8f8729a485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112416e0>]}
[0m20:04:37.972507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fb772de-8658-4b89-be5b-7d8f8729a485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104baad0>]}
[0m20:04:37.973722 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:04:38.025961 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:04:38.090932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:38.091191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:38.094771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:04:38.116145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fb772de-8658-4b89-be5b-7d8f8729a485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113407b50>]}
[0m20:04:38.162107 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:04:38.163783 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:04:38.173101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fb772de-8658-4b89-be5b-7d8f8729a485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113633f20>]}
[0m20:04:38.173673 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:04:38.173877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fb772de-8658-4b89-be5b-7d8f8729a485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114590830>]}
[0m20:04:38.174261 [warn ] [MainThread]: The selection criterion 'non_existent_model' does not match any enabled nodes
[0m20:04:38.174889 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:04:38.175867 [debug] [MainThread]: Command end result
[0m20:04:38.188207 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:04:38.189234 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:04:38.190894 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:04:38.192446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.44235614, "process_in_blocks": "0", "process_kernel_time": 0.146928, "process_mem_max_rss": "127500288", "process_out_blocks": "0", "process_user_time": 1.06932}
[0m20:04:38.192705 [debug] [MainThread]: Command `dbt run` succeeded at 20:04:38.192661 after 0.44 seconds
[0m20:04:38.192908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11456bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113325910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114558e90>]}
[0m20:04:38.193096 [debug] [MainThread]: Flushing usage events
[0m20:04:38.513724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:31.929867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10397da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048dbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048dbd90>]}


============================== 20:05:31.933717 | 17cf4c50-c95c-4986-ba44-a314743d0375 ==============================
[0m20:05:31.933717 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:05:31.934103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:05:32.082337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17cf4c50-c95c-4986-ba44-a314743d0375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c3d6e0>]}
[0m20:05:32.122142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17cf4c50-c95c-4986-ba44-a314743d0375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103302ad0>]}
[0m20:05:32.123352 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:05:32.179242 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:05:32.258250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:32.258495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:32.262101 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:05:32.283331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17cf4c50-c95c-4986-ba44-a314743d0375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ebd50>]}
[0m20:05:32.330092 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:05:32.331463 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:05:32.344263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17cf4c50-c95c-4986-ba44-a314743d0375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1bd40>]}
[0m20:05:32.344549 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:05:32.344728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17cf4c50-c95c-4986-ba44-a314743d0375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d6fe70>]}
[0m20:05:32.345991 [info ] [MainThread]: 
[0m20:05:32.346176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:05:32.346315 [info ] [MainThread]: 
[0m20:05:32.346573 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:05:32.351948 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m20:05:32.399797 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:05:32.400039 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:05:32.400186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:32.464303 [debug] [ThreadPool]: SQL status: OK in 0.064 seconds
[0m20:05:32.464572 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:05:32.464734 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:05:32.485399 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:05:32.486571 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:05:32.487502 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:05:32.487666 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:05:32.487952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:05:32.489466 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:05:32.489615 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:05:32.489741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:32.490031 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:05:32.490168 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:05:32.490311 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:05:32.492416 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:05:32.493051 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:05:32.493343 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:05:32.493473 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:05:32.493771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17cf4c50-c95c-4986-ba44-a314743d0375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef3450>]}
[0m20:05:32.495666 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:05:32.495888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now model.sbdk_project.stg_events)
[0m20:05:32.496075 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:05:32.500479 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:05:32.501799 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:05:32.502196 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:05:32.502393 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:05:32.502602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:05:32.502769 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:05:32.504012 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:05:32.504369 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:05:32.504661 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:05:32.504838 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:05:32.505022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:05:32.505182 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:05:32.506328 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:05:32.507032 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:05:32.507338 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:05:32.507518 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:05:32.507706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2)
[0m20:05:32.507888 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:05:32.515345 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:05:32.515963 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:05:32.516294 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:05:32.516471 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:05:32.516662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2, now test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05)
[0m20:05:32.516826 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:05:32.518587 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:05:32.519063 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:05:32.519373 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:05:32.519549 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:05:32.519728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05, now test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1)
[0m20:05:32.519891 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:05:32.558228 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:05:32.558889 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:05:32.559248 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:05:32.559441 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:05:32.559617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1, now test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f)
[0m20:05:32.559786 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:05:32.561701 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:05:32.562167 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:05:32.562517 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:05:32.562717 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:05:32.562911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f, now test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec)
[0m20:05:32.563087 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:05:32.564954 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:05:32.565432 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:05:32.565732 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:05:32.565912 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:05:32.566090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec, now test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd)
[0m20:05:32.566551 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:05:32.568328 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:05:32.568737 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:05:32.569145 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:05:32.569348 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:05:32.569552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd, now test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5)
[0m20:05:32.569752 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:05:32.571617 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:05:32.572159 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:05:32.572467 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:05:32.572653 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:05:32.572838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5, now test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5)
[0m20:05:32.573001 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:05:32.575026 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:05:32.575485 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:05:32.575787 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:05:32.575972 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:05:32.576156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5, now test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c)
[0m20:05:32.576323 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:05:32.578079 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:05:32.578637 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:05:32.578950 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:05:32.579128 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:05:32.579311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c, now test.sbdk_project.source_unique_raw_events_event_id.825f404073)
[0m20:05:32.579474 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:05:32.582591 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:05:32.583078 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:05:32.583390 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:05:32.583572 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:05:32.583759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_events_event_id.825f404073, now test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f)
[0m20:05:32.583924 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:05:32.585754 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:05:32.586222 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:05:32.586529 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:05:32.586708 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:05:32.586890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f, now test.sbdk_project.source_unique_raw_users_email.ab11a6771a)
[0m20:05:32.587058 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:05:32.588768 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:05:32.589225 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:05:32.589514 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:05:32.589687 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:05:32.589860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_users_email.ab11a6771a, now test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c)
[0m20:05:32.590023 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:05:32.591995 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:05:32.592295 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:05:32.592584 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:05:32.592760 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:05:32.592934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c, now model.sbdk_project.int_user_activity)
[0m20:05:32.593093 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m20:05:32.594851 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m20:05:32.595374 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m20:05:32.595686 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:05:32.596001 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:05:32.596232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m20:05:32.596425 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m20:05:32.598128 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m20:05:32.598582 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m20:05:32.598898 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:05:32.599319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:32.599464 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m20:05:32.600635 [debug] [MainThread]: Command end result
[0m20:05:32.613502 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:05:32.614447 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:05:32.618100 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:05:32.619821 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.73768896, "process_in_blocks": "0", "process_kernel_time": 0.180228, "process_mem_max_rss": "143441920", "process_out_blocks": "0", "process_user_time": 1.266034}
[0m20:05:32.620110 [debug] [MainThread]: Command `dbt compile` succeeded at 20:05:32.620057 after 0.74 seconds
[0m20:05:32.620315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10533c520>]}
[0m20:05:32.620498 [debug] [MainThread]: Flushing usage events
[0m20:05:32.990986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:04.774298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767bd90>]}


============================== 20:07:04.777904 | 726bebe8-5fe5-4a3b-a2d1-fe0d98b87e86 ==============================
[0m20:07:04.777904 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:07:04.778291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:07:04.927861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '726bebe8-5fe5-4a3b-a2d1-fe0d98b87e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d96e0>]}
[0m20:07:04.969832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '726bebe8-5fe5-4a3b-a2d1-fe0d98b87e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a2ad0>]}
[0m20:07:04.971401 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:07:05.030118 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:07:05.109955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:05.110202 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:05.113868 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:07:05.134991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '726bebe8-5fe5-4a3b-a2d1-fe0d98b87e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778bb50>]}
[0m20:07:05.180774 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:07:05.182161 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:07:05.195269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '726bebe8-5fe5-4a3b-a2d1-fe0d98b87e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079bbf20>]}
[0m20:07:05.195535 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:07:05.195702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '726bebe8-5fe5-4a3b-a2d1-fe0d98b87e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d18830>]}
[0m20:07:05.196727 [info ] [MainThread]: 
[0m20:07:05.196900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:07:05.197036 [info ] [MainThread]: 
[0m20:07:05.197279 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:07:05.199735 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:07:05.243785 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:07:05.244023 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:07:05.244179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:05.254726 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:07:05.255677 [debug] [ThreadPool]: On list_dev: Close
[0m20:07:05.256039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:07:05.256312 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:07:05.259712 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:07:05.259890 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:07:05.260035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:05.260425 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:05.261184 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:07:05.261333 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:07:05.261550 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:05.261687 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:07:05.261820 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:07:05.262156 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:05.262668 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:07:05.262841 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:07:05.262985 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:07:05.263213 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:05.263360 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:07:05.264464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m20:07:05.267257 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:07:05.267431 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:07:05.267573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:05.267861 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:05.268048 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:07:05.268206 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:07:05.276324 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:07:05.277460 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:07:05.278673 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:07:05.278844 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:07:05.279093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:07:05.280478 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:07:05.280629 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:07:05.280759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:05.281027 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:05.281192 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:07:05.281345 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:07:05.283347 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:07:05.283965 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:07:05.284286 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:07:05.284430 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:07:05.284698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '726bebe8-5fe5-4a3b-a2d1-fe0d98b87e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108051160>]}
[0m20:07:05.284932 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:05.285073 [debug] [MainThread]: On master: BEGIN
[0m20:07:05.285198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:05.285409 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:05.285547 [debug] [MainThread]: On master: COMMIT
[0m20:07:05.285679 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:05.285809 [debug] [MainThread]: On master: COMMIT
[0m20:07:05.285992 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:05.286126 [debug] [MainThread]: On master: Close
[0m20:07:05.287426 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:07:05.287698 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_events .................................... [RUN]
[0m20:07:05.287901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now model.sbdk_project.stg_events)
[0m20:07:05.288068 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:07:05.291770 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:07:05.292174 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:07:05.309384 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m20:07:05.309847 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:07:05.310023 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m20:07:05.310179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:05.310497 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.310661 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:07:05.310862 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_events
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m20:07:05.311646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:05.350010 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:07:05.350271 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m20:07:05.351384 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:05.353065 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:07:05.353274 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:07:05.353632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.360021 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:07:05.360234 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:07:05.360407 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:07:05.361782 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:05.364760 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:07:05.364957 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m20:07:05.365334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.366572 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m20:07:05.367620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726bebe8-5fe5-4a3b-a2d1-fe0d98b87e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107806a50>]}
[0m20:07:05.368101 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.08s]
[0m20:07:05.368401 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:07:05.368602 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:07:05.368858 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_orders .................................... [RUN]
[0m20:07:05.369072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:07:05.369480 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:07:05.370875 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:07:05.371450 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:07:05.373036 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m20:07:05.373873 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:07:05.374045 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m20:07:05.374202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:05.374519 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.374679 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:07:05.374898 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_orders
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m20:07:05.375892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:05.377552 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:07:05.377735 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:07:05.378020 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.379316 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:07:05.379485 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:07:05.379761 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.380550 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:07:05.380726 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:07:05.381162 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:07:05.381675 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.382929 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:07:05.383114 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m20:07:05.383455 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.384115 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m20:07:05.384400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726bebe8-5fe5-4a3b-a2d1-fe0d98b87e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108028680>]}
[0m20:07:05.384726 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.02s]
[0m20:07:05.384993 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:07:05.385240 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:07:05.385504 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_users ..................................... [RUN]
[0m20:07:05.385703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:07:05.385875 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:07:05.387092 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:07:05.388071 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:07:05.389539 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:07:05.390335 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:07:05.390506 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:07:05.390662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:05.390932 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.391092 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:07:05.391282 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_users
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:07:05.394061 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:07:05.395674 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:07:05.395856 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m20:07:05.396139 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.397407 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:07:05.397575 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:07:05.397835 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.398560 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:07:05.398735 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:07:05.398889 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:07:05.399250 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.400230 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:07:05.400404 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m20:07:05.400740 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.401636 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:07:05.401903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726bebe8-5fe5-4a3b-a2d1-fe0d98b87e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696b4d0>]}
[0m20:07:05.402188 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.02s]
[0m20:07:05.402437 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:07:05.402761 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:07:05.403036 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_user_activity ............................. [RUN]
[0m20:07:05.403268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now model.sbdk_project.int_user_activity)
[0m20:07:05.403444 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m20:07:05.405374 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m20:07:05.406052 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m20:07:05.407534 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.int_user_activity"
[0m20:07:05.408096 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:07:05.408274 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: BEGIN
[0m20:07:05.408438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:05.408760 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.408928 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:07:05.409224 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

  
  create view "dev"."main"."int_user_activity__dbt_tmp" as (
    

with users as (
    select * from "dev"."main"."stg_users"
),

events as (
    select * from "dev"."main"."stg_events"
),

orders as (
    select * from "dev"."main"."stg_orders"
),

user_events as (
    select
        user_id,
        count(*) as total_events,
        count(*) filter (where event_type = 'page_view') as pageviews,
        count(*) filter (where event_type = 'click') as clicks,
        count(*) filter (where event_type = 'signup') as signups,
        count(*) filter (where event_type = 'login') as logins,
        count(*) filter (where event_type = 'purchase') as purchase_events,
        count(*) filter (where is_conversion_event = true) as conversion_events,
        count(*) filter (where is_revenue_event = true) as revenue_events,
        coalesce(sum(revenue), 0) as total_event_revenue,
        coalesce(sum(duration_seconds), 0) as total_time_on_site,
        count(distinct session_id) filter (where session_id is not null) as unique_sessions,
        count(distinct event_date) as active_days,
        min(timestamp) as first_event_at,
        max(timestamp) as last_event_at,
        count(distinct traffic_category) as traffic_sources_used
    from events
    group by user_id
),

user_orders as (
    select
        user_id,
        count(*) as total_orders,
        count(*) filter (where is_completed = true) as completed_orders,
        count(*) filter (where is_failed = true) as failed_orders,
        count(*) filter (where is_recurring = true) as recurring_orders,
        coalesce(sum(total_amount) filter (where is_completed = true), 0) as total_order_revenue,
        coalesce(avg(total_amount) filter (where is_completed = true), 0) as avg_order_value,
        coalesce(sum(discount_amount), 0) as total_discounts_used,
        count(distinct product_category) as product_categories_purchased,
        min(created_at) as first_order_at,
        max(created_at) as last_order_at,
        count(distinct payment_method) as payment_methods_used
    from orders
    group by user_id
),

combined as (
    select
        u.user_id,
        u.username,
        u.email,
        u.first_name,
        u.last_name,
        u.created_at as user_created_at,
        u.country,
        u.city,
        u.subscription_tier,
        u.referrer,
        u.is_active,
        u.age,
        u.is_paid_subscriber,
        u.days_since_signup,
        u.has_complete_profile,
        
        -- Event metrics
        coalesce(e.total_events, 0) as total_events,
        coalesce(e.pageviews, 0) as pageviews,
        coalesce(e.clicks, 0) as clicks,
        coalesce(e.signups, 0) as signups,
        coalesce(e.logins, 0) as logins,
        coalesce(e.purchase_events, 0) as purchase_events,
        coalesce(e.conversion_events, 0) as conversion_events,
        coalesce(e.revenue_events, 0) as revenue_events,
        coalesce(e.total_event_revenue, 0) as total_event_revenue,
        coalesce(e.total_time_on_site, 0) as total_time_on_site,
        coalesce(e.unique_sessions, 0) as unique_sessions,
        coalesce(e.active_days, 0) as active_days,
        e.first_event_at,
        e.last_event_at,
        coalesce(e.traffic_sources_used, 0) as traffic_sources_used,
        
        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.failed_orders, 0) as failed_orders,
        coalesce(o.recurring_orders, 0) as recurring_orders,
        coalesce(o.total_order_revenue, 0) as total_order_revenue,
        coalesce(o.avg_order_value, 0) as avg_order_value,
        coalesce(o.total_discounts_used, 0) as total_discounts_used,
        coalesce(o.product_categories_purchased, 0) as product_categories_purchased,
        o.first_order_at,
        o.last_order_at,
        coalesce(o.payment_methods_used, 0) as payment_methods_used,
        
        -- Calculated metrics
        case 
            when e.pageviews > 0 and o.completed_orders > 0 
            then round(o.completed_orders::float / e.pageviews * 100, 2)
            else 0 
        end as purchase_conversion_rate,
        
        case 
            when e.total_events > 0 
            then round(e.conversion_events::float / e.total_events * 100, 2)
            else 0 
        end as event_conversion_rate,
        
        case 
            when e.unique_sessions > 0 
            then round(e.total_events::float / e.unique_sessions, 2)
            else 0 
        end as events_per_session,
        
        case 
            when u.days_since_signup > 0 and e.active_days > 0
            then round(e.active_days::float / u.days_since_signup * 100, 2)
            else 0 
        end as activity_frequency_percentage,
        
        -- Total combined revenue
        coalesce(e.total_event_revenue, 0) + coalesce(o.total_order_revenue, 0) as total_revenue,
        
        -- User activity classification
        case 
            when o.completed_orders > 0 then 'customer'
            when e.signups > 0 then 'signed_up'
            when e.total_events > 10 then 'engaged_visitor'
            when e.total_events > 0 then 'visitor'
            else 'inactive'
        end as user_type
        
    from users u
    left join user_events e on u.user_id = e.user_id
    left join user_orders o on u.user_id = o.user_id
)

select * from combined
  );

[0m20:07:05.412292 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:07:05.413949 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:07:05.414134 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity" rename to "int_user_activity__dbt_backup"
[0m20:07:05.414480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.415821 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:07:05.416002 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity__dbt_tmp" rename to "int_user_activity"
[0m20:07:05.416336 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.417098 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:07:05.417269 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:07:05.417461 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:07:05.418145 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:05.419167 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:07:05.419336 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

      drop view if exists "dev"."main"."int_user_activity__dbt_backup" cascade
    
[0m20:07:05.419666 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.420293 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: Close
[0m20:07:05.420556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726bebe8-5fe5-4a3b-a2d1-fe0d98b87e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a84d0>]}
[0m20:07:05.420847 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_user_activity ........................ [[32mOK[0m in 0.02s]
[0m20:07:05.421104 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:07:05.421393 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:07:05.421631 [info ] [Thread-1 (]: 5 of 5 START sql table model main.user_metrics ................................. [RUN]
[0m20:07:05.421856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m20:07:05.422035 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m20:07:05.423838 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m20:07:05.424355 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m20:07:05.434266 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.user_metrics"
[0m20:07:05.434702 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:07:05.434870 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: BEGIN
[0m20:07:05.435021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:05.435318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.435477 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:07:05.435746 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

  
    
    

    create  table
      "dev"."main"."user_metrics__dbt_tmp"
  
    as (
      

with user_activity as (
    select * from "dev"."main"."int_user_activity"
),

final as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        user_created_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        age,
        is_paid_subscriber,
        days_since_signup,
        has_complete_profile,
        
        -- Engagement metrics
        total_events,
        pageviews,
        clicks,
        logins,
        unique_sessions,
        active_days,
        traffic_sources_used,
        events_per_session,
        activity_frequency_percentage,
        total_time_on_site,
        
        -- Conversion metrics
        signups,
        purchase_events,
        conversion_events,
        purchase_conversion_rate,
        event_conversion_rate,
        
        -- Revenue metrics
        total_orders,
        completed_orders,
        failed_orders,
        recurring_orders,
        total_order_revenue,
        total_event_revenue,
        total_revenue,
        avg_order_value,
        total_discounts_used,
        product_categories_purchased,
        payment_methods_used,
        
        -- Timing metrics
        first_event_at,
        last_event_at,
        first_order_at,
        last_order_at,
        
        -- User classification
        user_type,
        
        -- Customer lifetime value estimate
        case 
            when recurring_orders > 0 and days_since_signup > 0
            then round(total_revenue * (365.0 / days_since_signup) * 2, 2)  -- Rough 2-year CLV estimate
            else total_revenue 
        end as estimated_clv,
        
        -- Engagement score (0-100)
        least(100, 
            (case when active_days > 0 then least(25, active_days) else 0 end) +
            (case when unique_sessions > 0 then least(25, unique_sessions) else 0 end) +
            (case when total_events > 0 then least(25, least(25, total_events / 10)) else 0 end) +
            (case when completed_orders > 0 then 25 else 0 end)
        ) as engagement_score,
        
        -- Risk classification
        case 
            when last_event_at < current_date - interval '90 days' and total_orders > 0 then 'churn_risk'
            when last_event_at < current_date - interval '30 days' and user_type = 'customer' then 'at_risk'
            when activity_frequency_percentage < 10 and days_since_signup > 30 then 'low_engagement'
            when user_type = 'customer' and recurring_orders = 0 then 'one_time_buyer'
            when user_type = 'customer' and recurring_orders > 0 then 'loyal_customer'
            when user_type = 'engaged_visitor' then 'potential_customer'
            else 'standard'
        end as risk_category,
        
        -- Value tier
        case 
            when total_revenue >= 1000 then 'high_value'
            when total_revenue >= 500 then 'medium_value'
            when total_revenue >= 100 then 'low_value'
            when total_revenue > 0 then 'minimal_value'
            else 'no_value'
        end as value_tier,
        
        -- Recency, Frequency, Monetary (RFM) components
        case 
            when last_order_at >= current_date - interval '30 days' then 5
            when last_order_at >= current_date - interval '60 days' then 4
            when last_order_at >= current_date - interval '90 days' then 3
            when last_order_at >= current_date - interval '180 days' then 2
            when last_order_at is not null then 1
            else 0
        end as recency_score,
        
        case 
            when completed_orders >= 10 then 5
            when completed_orders >= 5 then 4
            when completed_orders >= 3 then 3
            when completed_orders >= 2 then 2
            when completed_orders >= 1 then 1
            else 0
        end as frequency_score,
        
        case 
            when total_revenue >= 1000 then 5
            when total_revenue >= 500 then 4
            when total_revenue >= 200 then 3
            when total_revenue >= 50 then 2
            when total_revenue > 0 then 1
            else 0
        end as monetary_score,
        
        -- Data freshness
        current_timestamp as updated_at
        
    from user_activity
)

select * from final
    );
  
  
[0m20:07:05.484951 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m20:07:05.486919 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:07:05.487112 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics" rename to "user_metrics__dbt_backup"
[0m20:07:05.487818 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:05.489176 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:07:05.489361 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics__dbt_tmp" rename to "user_metrics"
[0m20:07:05.489673 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.492418 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:07:05.492620 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:07:05.492788 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:07:05.499419 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:07:05.501006 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:07:05.501203 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

      drop table if exists "dev"."main"."user_metrics__dbt_backup" cascade
    
[0m20:07:05.501800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:05.502516 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: Close
[0m20:07:05.502809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726bebe8-5fe5-4a3b-a2d1-fe0d98b87e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ef150>]}
[0m20:07:05.503117 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.user_metrics ............................ [[32mOK[0m in 0.08s]
[0m20:07:05.503377 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:07:05.503940 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:05.504102 [debug] [MainThread]: On master: BEGIN
[0m20:07:05.504240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:05.504489 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:05.504648 [debug] [MainThread]: On master: COMMIT
[0m20:07:05.504791 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:05.504921 [debug] [MainThread]: On master: COMMIT
[0m20:07:05.505111 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:05.505248 [debug] [MainThread]: On master: Close
[0m20:07:05.505425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:05.505556 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m20:07:05.505725 [info ] [MainThread]: 
[0m20:07:05.505874 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:07:05.506403 [debug] [MainThread]: Command end result
[0m20:07:05.520743 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:07:05.521785 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:07:05.525215 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:07:05.525389 [info ] [MainThread]: 
[0m20:07:05.525570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:07:05.525717 [info ] [MainThread]: 
[0m20:07:05.525874 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:07:05.527422 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8047853, "process_in_blocks": "0", "process_kernel_time": 0.217593, "process_mem_max_rss": "225394688", "process_out_blocks": "0", "process_user_time": 1.403987}
[0m20:07:05.527652 [debug] [MainThread]: Command `dbt run` succeeded at 20:07:05.527612 after 0.81 seconds
[0m20:07:05.527827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c47410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10803bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10803b830>]}
[0m20:07:05.528006 [debug] [MainThread]: Flushing usage events
[0m20:07:06.081399 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:07.241503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b95a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af3d90>]}


============================== 20:07:07.244759 | d6ae2b2a-4482-4be6-95d8-624a0baa0445 ==============================
[0m20:07:07.244759 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:07:07.245321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'log_path': 'dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:07:07.388264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6ae2b2a-4482-4be6-95d8-624a0baa0445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e516e0>]}
[0m20:07:07.428915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6ae2b2a-4482-4be6-95d8-624a0baa0445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551aad0>]}
[0m20:07:07.430141 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:07:07.484527 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:07:07.551502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:07.551761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:07.555464 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:07:07.577105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6ae2b2a-4482-4be6-95d8-624a0baa0445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c03d50>]}
[0m20:07:07.624147 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:07:07.625276 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:07:07.638978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6ae2b2a-4482-4be6-95d8-624a0baa0445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f97c0>]}
[0m20:07:07.639275 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:07:07.639448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6ae2b2a-4482-4be6-95d8-624a0baa0445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725cbb0>]}
[0m20:07:07.640605 [info ] [MainThread]: 
[0m20:07:07.640789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:07:07.640930 [info ] [MainThread]: 
[0m20:07:07.641180 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:07:07.643998 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:07:07.674968 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:07:07.675214 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:07:07.675368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:07.683810 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:07:07.684565 [debug] [ThreadPool]: On list_dev: Close
[0m20:07:07.684902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:07:07.685122 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:07:07.688407 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:07:07.688576 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:07:07.688713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:07.689128 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:07.689741 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:07:07.689880 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:07:07.690072 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:07.690196 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:07:07.690317 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:07:07.690528 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:07.690908 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:07:07.691044 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:07:07.691166 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:07:07.691345 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:07.691489 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:07:07.692503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main)
[0m20:07:07.695148 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:07:07.695317 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:07:07.695449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:07.695718 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:07.695850 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:07:07.695991 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:07:07.702961 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:07:07.739282 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:07:07.739921 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:07:07.740081 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:07:07.740367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:07:07.741239 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:07:07.741392 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:07:07.741523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:07.742301 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:07.742445 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:07:07.742585 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:07:07.744771 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:07:07.745396 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:07:07.745695 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:07:07.745834 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:07:07.746106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6ae2b2a-4482-4be6-95d8-624a0baa0445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d5640>]}
[0m20:07:07.746343 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:07.746485 [debug] [MainThread]: On master: BEGIN
[0m20:07:07.746615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:07.746839 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:07.746974 [debug] [MainThread]: On master: COMMIT
[0m20:07:07.747098 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:07.747219 [debug] [MainThread]: On master: COMMIT
[0m20:07:07.747392 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:07.747516 [debug] [MainThread]: On master: Close
[0m20:07:07.748495 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:07:07.748697 [info ] [Thread-1 (]: 1 of 13 START test source_not_null_raw_events_event_id ......................... [RUN]
[0m20:07:07.748896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2)
[0m20:07:07.749061 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:07:07.757533 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:07:07.758043 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:07:07.767271 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
[0m20:07:07.776943 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:07:07.777215 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: BEGIN
[0m20:07:07.777401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.777845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.778021 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:07:07.778198 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where event_id is null



  
  
    );
  
  
    
[0m20:07:07.781721 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where event_id is null



  
  
    );
  
  
    
[0m20:07:07.781995 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.782263 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: ROLLBACK
[0m20:07:07.787917 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2'
[0m20:07:07.788185 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: Close
[0m20:07:07.790523 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:07:07.790879 [error] [Thread-1 (]: 1 of 13 ERROR source_not_null_raw_events_event_id .............................. [[31mERROR[0m in 0.04s]
[0m20:07:07.791179 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:07:07.791390 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:07:07.791662 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:07:07.791891 [info ] [Thread-1 (]: 2 of 13 START test source_not_null_raw_events_timestamp ........................ [RUN]
[0m20:07:07.792499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2, now test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05)
[0m20:07:07.793218 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:07:07.795439 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:07:07.796917 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:07:07.798082 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
[0m20:07:07.798598 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:07:07.798780 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: BEGIN
[0m20:07:07.798938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.799307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.799477 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:07:07.799653 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where timestamp is null



  
  
    );
  
  
    
[0m20:07:07.800099 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where timestamp is null



  
  
    );
  
  
    
[0m20:07:07.800278 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.800494 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: ROLLBACK
[0m20:07:07.802640 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05'
[0m20:07:07.802834 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: Close
[0m20:07:07.804775 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:07:07.805319 [error] [Thread-1 (]: 2 of 13 ERROR source_not_null_raw_events_timestamp ............................. [[31mERROR[0m in 0.01s]
[0m20:07:07.805640 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:07:07.805854 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:07:07.806103 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:07:07.806310 [info ] [Thread-1 (]: 3 of 13 START test source_not_null_raw_events_user_id .......................... [RUN]
[0m20:07:07.807208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05, now test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1)
[0m20:07:07.807525 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:07:07.810319 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:07:07.811178 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:07:07.812285 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
[0m20:07:07.812783 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:07:07.812954 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: BEGIN
[0m20:07:07.813114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.813590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.813779 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:07:07.813957 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where user_id is null



  
  
    );
  
  
    
[0m20:07:07.814377 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where user_id is null



  
  
    );
  
  
    
[0m20:07:07.814547 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.814750 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: ROLLBACK
[0m20:07:07.816760 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1'
[0m20:07:07.816938 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: Close
[0m20:07:07.818887 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:07:07.819162 [error] [Thread-1 (]: 3 of 13 ERROR source_not_null_raw_events_user_id ............................... [[31mERROR[0m in 0.01s]
[0m20:07:07.819440 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:07:07.819627 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:07:07.819842 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:07:07.820027 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_raw_orders_order_id ......................... [RUN]
[0m20:07:07.820275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1, now test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f)
[0m20:07:07.820453 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:07:07.822618 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:07:07.823000 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:07:07.823953 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
[0m20:07:07.824408 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:07:07.824575 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: BEGIN
[0m20:07:07.824725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.824999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.825156 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:07:07.825316 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where order_id is null



  
  
    );
  
  
    
[0m20:07:07.825699 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where order_id is null



  
  
    );
  
  
    
[0m20:07:07.825863 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.826058 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: ROLLBACK
[0m20:07:07.827988 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f'
[0m20:07:07.828157 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: Close
[0m20:07:07.830004 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:07:07.830230 [error] [Thread-1 (]: 4 of 13 ERROR source_not_null_raw_orders_order_id .............................. [[31mERROR[0m in 0.01s]
[0m20:07:07.830482 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:07:07.830663 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:07:07.830879 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:07:07.831068 [info ] [Thread-1 (]: 5 of 13 START test source_not_null_raw_orders_total_amount ..................... [RUN]
[0m20:07:07.831316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f, now test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec)
[0m20:07:07.831491 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:07:07.833343 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:07:07.833664 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:07:07.834905 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
[0m20:07:07.835350 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:07:07.835511 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: BEGIN
[0m20:07:07.835658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.835914 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.836069 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:07:07.836223 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:07:07.836584 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:07:07.836747 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.836939 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: ROLLBACK
[0m20:07:07.838805 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec'
[0m20:07:07.838971 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: Close
[0m20:07:07.840817 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:07:07.841037 [error] [Thread-1 (]: 5 of 13 ERROR source_not_null_raw_orders_total_amount .......................... [[31mERROR[0m in 0.01s]
[0m20:07:07.841288 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:07:07.841462 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:07:07.841682 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:07:07.841865 [info ] [Thread-1 (]: 6 of 13 START test source_not_null_raw_orders_user_id .......................... [RUN]
[0m20:07:07.842101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec, now test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd)
[0m20:07:07.842279 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:07:07.844056 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:07:07.844541 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:07:07.845738 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
[0m20:07:07.846194 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:07:07.846362 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: BEGIN
[0m20:07:07.846520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.846781 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.846945 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:07:07.847107 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where user_id is null



  
  
    );
  
  
    
[0m20:07:07.847458 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where user_id is null



  
  
    );
  
  
    
[0m20:07:07.847617 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.847803 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: ROLLBACK
[0m20:07:07.849672 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd'
[0m20:07:07.849849 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: Close
[0m20:07:07.851713 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:07:07.851941 [error] [Thread-1 (]: 6 of 13 ERROR source_not_null_raw_orders_user_id ............................... [[31mERROR[0m in 0.01s]
[0m20:07:07.852192 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:07:07.852367 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:07:07.852572 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:07:07.852749 [info ] [Thread-1 (]: 7 of 13 START test source_not_null_raw_users_created_at ........................ [RUN]
[0m20:07:07.852987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd, now test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5)
[0m20:07:07.853157 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:07:07.854959 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:07:07.855298 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:07:07.856261 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
[0m20:07:07.856960 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:07:07.857134 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: BEGIN
[0m20:07:07.857292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.857575 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.857755 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:07:07.857918 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where created_at is null



  
  
    );
  
  
    
[0m20:07:07.858286 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where created_at is null



  
  
    );
  
  
    
[0m20:07:07.858453 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.858660 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: ROLLBACK
[0m20:07:07.860518 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5'
[0m20:07:07.860679 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: Close
[0m20:07:07.862471 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:07:07.862687 [error] [Thread-1 (]: 7 of 13 ERROR source_not_null_raw_users_created_at ............................. [[31mERROR[0m in 0.01s]
[0m20:07:07.862938 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:07:07.863113 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:07:07.863319 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:07:07.863500 [info ] [Thread-1 (]: 8 of 13 START test source_not_null_raw_users_email ............................. [RUN]
[0m20:07:07.863744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5, now test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5)
[0m20:07:07.863917 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:07:07.865754 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:07:07.866099 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:07:07.867082 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
[0m20:07:07.867538 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:07:07.867699 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: BEGIN
[0m20:07:07.867844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.868103 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.868256 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:07:07.868410 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where email is null



  
  
    );
  
  
    
[0m20:07:07.868788 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where email is null



  
  
    );
  
  
    
[0m20:07:07.869275 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.869468 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: ROLLBACK
[0m20:07:07.871433 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5'
[0m20:07:07.871613 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: Close
[0m20:07:07.873716 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:07:07.873944 [error] [Thread-1 (]: 8 of 13 ERROR source_not_null_raw_users_email .................................. [[31mERROR[0m in 0.01s]
[0m20:07:07.874205 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:07:07.874387 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:07:07.874597 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:07:07.874776 [info ] [Thread-1 (]: 9 of 13 START test source_not_null_raw_users_user_id ........................... [RUN]
[0m20:07:07.875017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5, now test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c)
[0m20:07:07.875194 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:07:07.877469 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:07:07.878235 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:07:07.879246 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
[0m20:07:07.879707 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:07:07.879871 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: BEGIN
[0m20:07:07.880021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.880337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.880491 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:07:07.880647 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where user_id is null



  
  
    );
  
  
    
[0m20:07:07.881057 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where user_id is null



  
  
    );
  
  
    
[0m20:07:07.881333 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.881536 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: ROLLBACK
[0m20:07:07.883503 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c'
[0m20:07:07.883704 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: Close
[0m20:07:07.886055 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:07:07.886352 [error] [Thread-1 (]: 9 of 13 ERROR source_not_null_raw_users_user_id ................................ [[31mERROR[0m in 0.01s]
[0m20:07:07.886614 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:07:07.886798 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:07:07.886972 [info ] [Thread-1 (]: 10 of 13 START test source_unique_raw_events_event_id .......................... [RUN]
[0m20:07:07.887221 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:07:07.887444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c, now test.sbdk_project.source_unique_raw_events_event_id.825f404073)
[0m20:07:07.887664 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:07:07.891083 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:07:07.891503 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:07:07.892495 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
[0m20:07:07.892954 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:07:07.893119 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: BEGIN
[0m20:07:07.893271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.893608 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.893774 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:07:07.893940 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_events_event_id.825f404073"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."raw"."events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:07.894413 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_events_event_id.825f404073"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."raw"."events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:07.894584 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.894778 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: ROLLBACK
[0m20:07:07.896716 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_events_event_id.825f404073'
[0m20:07:07.896888 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: Close
[0m20:07:07.898696 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^
[0m20:07:07.898918 [error] [Thread-1 (]: 10 of 13 ERROR source_unique_raw_events_event_id ............................... [[31mERROR[0m in 0.01s]
[0m20:07:07.899170 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:07:07.899349 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:07:07.899559 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_events_event_id.825f404073' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^.
[0m20:07:07.899750 [info ] [Thread-1 (]: 11 of 13 START test source_unique_raw_orders_order_id .......................... [RUN]
[0m20:07:07.900001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_events_event_id.825f404073, now test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f)
[0m20:07:07.900176 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:07:07.902265 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:07:07.902672 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:07:07.904033 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
[0m20:07:07.904516 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:07:07.904690 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: BEGIN
[0m20:07:07.904851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.905179 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.905344 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:07:07.905512 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."raw"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:07.905975 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."raw"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:07.906151 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.906359 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: ROLLBACK
[0m20:07:07.908409 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f'
[0m20:07:07.908588 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: Close
[0m20:07:07.910466 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^
[0m20:07:07.910704 [error] [Thread-1 (]: 11 of 13 ERROR source_unique_raw_orders_order_id ............................... [[31mERROR[0m in 0.01s]
[0m20:07:07.910977 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:07:07.911170 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:07:07.911421 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^.
[0m20:07:07.911624 [info ] [Thread-1 (]: 12 of 13 START test source_unique_raw_users_email .............................. [RUN]
[0m20:07:07.911902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f, now test.sbdk_project.source_unique_raw_users_email.ab11a6771a)
[0m20:07:07.912078 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:07:07.914127 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:07:07.914536 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:07:07.915870 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
[0m20:07:07.916383 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:07:07.916557 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: BEGIN
[0m20:07:07.916715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.917046 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.917211 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:07:07.917419 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:07.917919 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:07.918111 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.918333 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: ROLLBACK
[0m20:07:07.920423 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_users_email.ab11a6771a'
[0m20:07:07.920610 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: Close
[0m20:07:07.922533 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:07:07.922778 [error] [Thread-1 (]: 12 of 13 ERROR source_unique_raw_users_email ................................... [[31mERROR[0m in 0.01s]
[0m20:07:07.923047 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:07:07.923232 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:07:07.923446 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_users_email.ab11a6771a' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^.
[0m20:07:07.923654 [info ] [Thread-1 (]: 13 of 13 START test source_unique_raw_users_user_id ............................ [RUN]
[0m20:07:07.923939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_users_email.ab11a6771a, now test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c)
[0m20:07:07.924119 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:07:07.926051 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:07:07.926440 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:07:07.927432 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
[0m20:07:07.927888 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:07:07.928052 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: BEGIN
[0m20:07:07.928204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:07.928514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:07.928677 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:07:07.928836 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:07.929238 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:07.929406 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:07.929603 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: ROLLBACK
[0m20:07:07.931565 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c'
[0m20:07:07.931742 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: Close
[0m20:07:07.933603 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:07:07.933828 [error] [Thread-1 (]: 13 of 13 ERROR source_unique_raw_users_user_id ................................. [[31mERROR[0m in 0.01s]
[0m20:07:07.934094 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:07:07.934324 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^.
[0m20:07:07.934874 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:07.935018 [debug] [MainThread]: On master: BEGIN
[0m20:07:07.935144 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:07.935394 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:07.935534 [debug] [MainThread]: On master: COMMIT
[0m20:07:07.935669 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:07.935795 [debug] [MainThread]: On master: COMMIT
[0m20:07:07.936008 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:07.936160 [debug] [MainThread]: On master: Close
[0m20:07:07.936336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:07.936695 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c' was properly closed.
[0m20:07:07.936845 [info ] [MainThread]: 
[0m20:07:07.936993 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m20:07:07.938003 [debug] [MainThread]: Command end result
[0m20:07:07.952118 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:07:07.953102 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:07:07.956730 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:07:07.956899 [info ] [MainThread]: 
[0m20:07:07.957082 [info ] [MainThread]: [31mCompleted with 13 errors, 0 partial successes, and 0 warnings:[0m
[0m20:07:07.957227 [info ] [MainThread]: 
[0m20:07:07.957407 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_event_id (models/_sources.yml)[0m
[0m20:07:07.957581 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:07:07.957706 [info ] [MainThread]: 
[0m20:07:07.957862 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_event_id.sql
[0m20:07:07.957987 [info ] [MainThread]: 
[0m20:07:07.958140 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  --------------------------------------------------------------------------------
[0m20:07:07.958270 [info ] [MainThread]: 
[0m20:07:07.958431 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_timestamp (models/_sources.yml)[0m
[0m20:07:07.958596 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:07:07.958721 [info ] [MainThread]: 
[0m20:07:07.958872 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_timestamp.sql
[0m20:07:07.958994 [info ] [MainThread]: 
[0m20:07:07.959144 [info ] [MainThread]:   See test failures:
  ---------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  ---------------------------------------------------------------------------------
[0m20:07:07.959273 [info ] [MainThread]: 
[0m20:07:07.959426 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_user_id (models/_sources.yml)[0m
[0m20:07:07.959589 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:07:07.959714 [info ] [MainThread]: 
[0m20:07:07.959869 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_user_id.sql
[0m20:07:07.959995 [info ] [MainThread]: 
[0m20:07:07.960148 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  -------------------------------------------------------------------------------
[0m20:07:07.960277 [info ] [MainThread]: 
[0m20:07:07.960431 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_order_id (models/_sources.yml)[0m
[0m20:07:07.960597 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:07:07.960727 [info ] [MainThread]: 
[0m20:07:07.960884 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_order_id.sql
[0m20:07:07.961008 [info ] [MainThread]: 
[0m20:07:07.961162 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  --------------------------------------------------------------------------------
[0m20:07:07.961292 [info ] [MainThread]: 
[0m20:07:07.961452 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_total_amount (models/_sources.yml)[0m
[0m20:07:07.961614 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:07:07.961738 [info ] [MainThread]: 
[0m20:07:07.961891 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_total_amount.sql
[0m20:07:07.962019 [info ] [MainThread]: 
[0m20:07:07.962172 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  ------------------------------------------------------------------------------------
[0m20:07:07.962302 [info ] [MainThread]: 
[0m20:07:07.962463 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_user_id (models/_sources.yml)[0m
[0m20:07:07.962622 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:07:07.962744 [info ] [MainThread]: 
[0m20:07:07.962895 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_user_id.sql
[0m20:07:07.963016 [info ] [MainThread]: 
[0m20:07:07.963165 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  -------------------------------------------------------------------------------
[0m20:07:07.963293 [info ] [MainThread]: 
[0m20:07:07.963449 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_created_at (models/_sources.yml)[0m
[0m20:07:07.963609 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:07:07.963734 [info ] [MainThread]: 
[0m20:07:07.963889 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_created_at.sql
[0m20:07:07.964012 [info ] [MainThread]: 
[0m20:07:07.964164 [info ] [MainThread]:   See test failures:
  ---------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  ---------------------------------------------------------------------------------
[0m20:07:07.964293 [info ] [MainThread]: 
[0m20:07:07.964450 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_email (models/_sources.yml)[0m
[0m20:07:07.964613 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:07:07.964740 [info ] [MainThread]: 
[0m20:07:07.964893 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_email.sql
[0m20:07:07.965019 [info ] [MainThread]: 
[0m20:07:07.965170 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  ----------------------------------------------------------------------------
[0m20:07:07.965296 [info ] [MainThread]: 
[0m20:07:07.965448 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_user_id (models/_sources.yml)[0m
[0m20:07:07.965605 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:07:07.965728 [info ] [MainThread]: 
[0m20:07:07.965877 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_user_id.sql
[0m20:07:07.965997 [info ] [MainThread]: 
[0m20:07:07.966145 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  ------------------------------------------------------------------------------
[0m20:07:07.966277 [info ] [MainThread]: 
[0m20:07:07.966438 [error] [MainThread]: [31mFailure in test source_unique_raw_events_event_id (models/_sources.yml)[0m
[0m20:07:07.966603 [error] [MainThread]:   Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^
[0m20:07:07.966730 [info ] [MainThread]: 
[0m20:07:07.966883 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_events_event_id.sql
[0m20:07:07.967005 [info ] [MainThread]: 
[0m20:07:07.967152 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  ------------------------------------------------------------------------------
[0m20:07:07.967297 [info ] [MainThread]: 
[0m20:07:07.967515 [error] [MainThread]: [31mFailure in test source_unique_raw_orders_order_id (models/_sources.yml)[0m
[0m20:07:07.967706 [error] [MainThread]:   Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^
[0m20:07:07.967847 [info ] [MainThread]: 
[0m20:07:07.968005 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_orders_order_id.sql
[0m20:07:07.968136 [info ] [MainThread]: 
[0m20:07:07.968293 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  ------------------------------------------------------------------------------
[0m20:07:07.968427 [info ] [MainThread]: 
[0m20:07:07.968586 [error] [MainThread]: [31mFailure in test source_unique_raw_users_email (models/_sources.yml)[0m
[0m20:07:07.968751 [error] [MainThread]:   Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:07:07.968882 [info ] [MainThread]: 
[0m20:07:07.969041 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_users_email.sql
[0m20:07:07.969165 [info ] [MainThread]: 
[0m20:07:07.969315 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  --------------------------------------------------------------------------
[0m20:07:07.969447 [info ] [MainThread]: 
[0m20:07:07.969608 [error] [MainThread]: [31mFailure in test source_unique_raw_users_user_id (models/_sources.yml)[0m
[0m20:07:07.969772 [error] [MainThread]:   Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:07:07.969896 [info ] [MainThread]: 
[0m20:07:07.970047 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_users_user_id.sql
[0m20:07:07.970170 [info ] [MainThread]: 
[0m20:07:07.970322 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  ----------------------------------------------------------------------------
[0m20:07:07.970455 [info ] [MainThread]: 
[0m20:07:07.970602 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=13 SKIP=0 NO-OP=0 TOTAL=13
[0m20:07:07.971933 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.8433285, "process_in_blocks": "0", "process_kernel_time": 0.180852, "process_mem_max_rss": "151584768", "process_out_blocks": "0", "process_user_time": 1.36453}
[0m20:07:07.972148 [debug] [MainThread]: Command `dbt test` failed at 20:07:07.972108 after 0.84 seconds
[0m20:07:07.972325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b19910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722ec50>]}
[0m20:07:07.972490 [debug] [MainThread]: Flushing usage events
[0m20:07:08.423602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:53.260985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760fd90>]}


============================== 20:07:53.264366 | 1c839248-80de-4cee-9e85-4b487dab7ed1 ==============================
[0m20:07:53.264366 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:07:53.264713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:07:53.412520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c839248-80de-4cee-9e85-4b487dab7ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696d6e0>]}
[0m20:07:53.452298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c839248-80de-4cee-9e85-4b487dab7ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106036ad0>]}
[0m20:07:53.453785 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:07:53.510455 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:07:53.588532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:53.588778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:53.592401 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:07:53.614138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c839248-80de-4cee-9e85-4b487dab7ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771fb50>]}
[0m20:07:53.661136 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:07:53.662579 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:07:53.676676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c839248-80de-4cee-9e85-4b487dab7ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794ff20>]}
[0m20:07:53.676957 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:07:53.677130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c839248-80de-4cee-9e85-4b487dab7ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb0830>]}
[0m20:07:53.678167 [info ] [MainThread]: 
[0m20:07:53.678347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:07:53.678491 [info ] [MainThread]: 
[0m20:07:53.678750 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:07:53.681133 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:07:53.725231 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:07:53.725474 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:07:53.725626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:53.736541 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:07:53.737703 [debug] [ThreadPool]: On list_dev: Close
[0m20:07:53.738123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:07:53.738398 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:07:53.744218 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:07:53.744515 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:07:53.744674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:53.745414 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:53.746466 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:07:53.746650 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:07:53.746903 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:53.747049 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:07:53.747184 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:07:53.747454 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:53.748104 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:07:53.748296 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:07:53.748449 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:07:53.748915 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:53.749135 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:07:53.750509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m20:07:53.753629 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:07:53.753970 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:07:53.754137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:53.754502 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:53.754649 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:07:53.754794 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:07:53.763668 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:07:53.764910 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:07:53.765797 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:07:53.765958 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:07:53.766219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:07:53.767701 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:07:53.767851 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:07:53.767974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:53.768249 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:53.768386 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:07:53.768529 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:07:53.770604 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:07:53.771208 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:07:53.771491 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:07:53.771635 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:07:53.771904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c839248-80de-4cee-9e85-4b487dab7ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe5160>]}
[0m20:07:53.772141 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:53.772280 [debug] [MainThread]: On master: BEGIN
[0m20:07:53.772404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:53.772609 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:53.772743 [debug] [MainThread]: On master: COMMIT
[0m20:07:53.772876 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:53.772999 [debug] [MainThread]: On master: COMMIT
[0m20:07:53.773175 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:53.773309 [debug] [MainThread]: On master: Close
[0m20:07:53.774613 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:07:53.774876 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_events .................................... [RUN]
[0m20:07:53.775076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now model.sbdk_project.stg_events)
[0m20:07:53.775240 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:07:53.779011 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:07:53.779405 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:07:53.796529 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m20:07:53.797021 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:07:53.797201 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m20:07:53.797357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.797681 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.797834 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:07:53.798023 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_events
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m20:07:53.798808 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:53.837146 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:07:53.837402 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m20:07:53.838184 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:53.839588 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:07:53.839765 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:07:53.840077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.846419 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:07:53.846659 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:07:53.846833 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:07:53.847587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:53.850672 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:07:53.850891 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m20:07:53.851503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.852853 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m20:07:53.853849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c839248-80de-4cee-9e85-4b487dab7ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10779aa50>]}
[0m20:07:53.854170 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.08s]
[0m20:07:53.854439 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:07:53.854635 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:07:53.854883 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_orders .................................... [RUN]
[0m20:07:53.855087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:07:53.855254 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:07:53.856705 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:07:53.857149 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:07:53.858719 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m20:07:53.859072 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:07:53.859249 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m20:07:53.859414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.859737 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.859903 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:07:53.860123 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_orders
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m20:07:53.861152 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:53.862846 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:07:53.863028 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:07:53.863318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.864607 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:07:53.864783 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:07:53.865067 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.865838 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:07:53.866015 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:07:53.866177 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:07:53.866797 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.868195 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:07:53.868383 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m20:07:53.868767 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.869411 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m20:07:53.869690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c839248-80de-4cee-9e85-4b487dab7ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc8680>]}
[0m20:07:53.869993 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.01s]
[0m20:07:53.870245 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:07:53.870426 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:07:53.870661 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_users ..................................... [RUN]
[0m20:07:53.870851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:07:53.871013 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:07:53.872284 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:07:53.872765 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:07:53.874242 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:07:53.874658 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:07:53.874823 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:07:53.874970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.875251 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.875412 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:07:53.875593 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_users
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:07:53.877974 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:53.879581 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:07:53.879761 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m20:07:53.880051 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.881324 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:07:53.881501 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:07:53.881773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.882511 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:07:53.882686 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:07:53.882841 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:07:53.883298 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.884294 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:07:53.884467 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m20:07:53.884785 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.885627 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:07:53.885885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c839248-80de-4cee-9e85-4b487dab7ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ff4d0>]}
[0m20:07:53.886185 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.02s]
[0m20:07:53.886440 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:07:53.886771 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:07:53.887073 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_user_activity ............................. [RUN]
[0m20:07:53.887316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now model.sbdk_project.int_user_activity)
[0m20:07:53.887499 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m20:07:53.889461 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m20:07:53.890058 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m20:07:53.891547 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.int_user_activity"
[0m20:07:53.892024 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:07:53.892191 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: BEGIN
[0m20:07:53.892339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.892612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.892771 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:07:53.893065 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

  
  create view "dev"."main"."int_user_activity__dbt_tmp" as (
    

with users as (
    select * from "dev"."main"."stg_users"
),

events as (
    select * from "dev"."main"."stg_events"
),

orders as (
    select * from "dev"."main"."stg_orders"
),

user_events as (
    select
        user_id,
        count(*) as total_events,
        count(*) filter (where event_type = 'page_view') as pageviews,
        count(*) filter (where event_type = 'click') as clicks,
        count(*) filter (where event_type = 'signup') as signups,
        count(*) filter (where event_type = 'login') as logins,
        count(*) filter (where event_type = 'purchase') as purchase_events,
        count(*) filter (where is_conversion_event = true) as conversion_events,
        count(*) filter (where is_revenue_event = true) as revenue_events,
        coalesce(sum(revenue), 0) as total_event_revenue,
        coalesce(sum(duration_seconds), 0) as total_time_on_site,
        count(distinct session_id) filter (where session_id is not null) as unique_sessions,
        count(distinct event_date) as active_days,
        min(timestamp) as first_event_at,
        max(timestamp) as last_event_at,
        count(distinct traffic_category) as traffic_sources_used
    from events
    group by user_id
),

user_orders as (
    select
        user_id,
        count(*) as total_orders,
        count(*) filter (where is_completed = true) as completed_orders,
        count(*) filter (where is_failed = true) as failed_orders,
        count(*) filter (where is_recurring = true) as recurring_orders,
        coalesce(sum(total_amount) filter (where is_completed = true), 0) as total_order_revenue,
        coalesce(avg(total_amount) filter (where is_completed = true), 0) as avg_order_value,
        coalesce(sum(discount_amount), 0) as total_discounts_used,
        count(distinct product_category) as product_categories_purchased,
        min(created_at) as first_order_at,
        max(created_at) as last_order_at,
        count(distinct payment_method) as payment_methods_used
    from orders
    group by user_id
),

combined as (
    select
        u.user_id,
        u.username,
        u.email,
        u.first_name,
        u.last_name,
        u.created_at as user_created_at,
        u.country,
        u.city,
        u.subscription_tier,
        u.referrer,
        u.is_active,
        u.age,
        u.is_paid_subscriber,
        u.days_since_signup,
        u.has_complete_profile,
        
        -- Event metrics
        coalesce(e.total_events, 0) as total_events,
        coalesce(e.pageviews, 0) as pageviews,
        coalesce(e.clicks, 0) as clicks,
        coalesce(e.signups, 0) as signups,
        coalesce(e.logins, 0) as logins,
        coalesce(e.purchase_events, 0) as purchase_events,
        coalesce(e.conversion_events, 0) as conversion_events,
        coalesce(e.revenue_events, 0) as revenue_events,
        coalesce(e.total_event_revenue, 0) as total_event_revenue,
        coalesce(e.total_time_on_site, 0) as total_time_on_site,
        coalesce(e.unique_sessions, 0) as unique_sessions,
        coalesce(e.active_days, 0) as active_days,
        e.first_event_at,
        e.last_event_at,
        coalesce(e.traffic_sources_used, 0) as traffic_sources_used,
        
        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.failed_orders, 0) as failed_orders,
        coalesce(o.recurring_orders, 0) as recurring_orders,
        coalesce(o.total_order_revenue, 0) as total_order_revenue,
        coalesce(o.avg_order_value, 0) as avg_order_value,
        coalesce(o.total_discounts_used, 0) as total_discounts_used,
        coalesce(o.product_categories_purchased, 0) as product_categories_purchased,
        o.first_order_at,
        o.last_order_at,
        coalesce(o.payment_methods_used, 0) as payment_methods_used,
        
        -- Calculated metrics
        case 
            when e.pageviews > 0 and o.completed_orders > 0 
            then round(o.completed_orders::float / e.pageviews * 100, 2)
            else 0 
        end as purchase_conversion_rate,
        
        case 
            when e.total_events > 0 
            then round(e.conversion_events::float / e.total_events * 100, 2)
            else 0 
        end as event_conversion_rate,
        
        case 
            when e.unique_sessions > 0 
            then round(e.total_events::float / e.unique_sessions, 2)
            else 0 
        end as events_per_session,
        
        case 
            when u.days_since_signup > 0 and e.active_days > 0
            then round(e.active_days::float / u.days_since_signup * 100, 2)
            else 0 
        end as activity_frequency_percentage,
        
        -- Total combined revenue
        coalesce(e.total_event_revenue, 0) + coalesce(o.total_order_revenue, 0) as total_revenue,
        
        -- User activity classification
        case 
            when o.completed_orders > 0 then 'customer'
            when e.signups > 0 then 'signed_up'
            when e.total_events > 10 then 'engaged_visitor'
            when e.total_events > 0 then 'visitor'
            else 'inactive'
        end as user_type
        
    from users u
    left join user_events e on u.user_id = e.user_id
    left join user_orders o on u.user_id = o.user_id
)

select * from combined
  );

[0m20:07:53.896213 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:07:53.897883 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:07:53.898076 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity" rename to "int_user_activity__dbt_backup"
[0m20:07:53.898412 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.899709 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:07:53.899888 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity__dbt_tmp" rename to "int_user_activity"
[0m20:07:53.900257 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.900991 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:07:53.901165 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:07:53.901326 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:07:53.901937 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.903038 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:07:53.903229 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

      drop view if exists "dev"."main"."int_user_activity__dbt_backup" cascade
    
[0m20:07:53.903603 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.904257 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: Close
[0m20:07:53.904530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c839248-80de-4cee-9e85-4b487dab7ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782c4d0>]}
[0m20:07:53.904833 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_user_activity ........................ [[32mOK[0m in 0.02s]
[0m20:07:53.905090 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:07:53.905410 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:07:53.905637 [info ] [Thread-1 (]: 5 of 5 START sql table model main.user_metrics ................................. [RUN]
[0m20:07:53.905825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m20:07:53.905989 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m20:07:53.907890 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m20:07:53.908462 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m20:07:53.919010 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.user_metrics"
[0m20:07:53.919618 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:07:53.919804 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: BEGIN
[0m20:07:53.919965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.920328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.920492 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:07:53.920765 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

  
    
    

    create  table
      "dev"."main"."user_metrics__dbt_tmp"
  
    as (
      

with user_activity as (
    select * from "dev"."main"."int_user_activity"
),

final as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        user_created_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        age,
        is_paid_subscriber,
        days_since_signup,
        has_complete_profile,
        
        -- Engagement metrics
        total_events,
        pageviews,
        clicks,
        logins,
        unique_sessions,
        active_days,
        traffic_sources_used,
        events_per_session,
        activity_frequency_percentage,
        total_time_on_site,
        
        -- Conversion metrics
        signups,
        purchase_events,
        conversion_events,
        purchase_conversion_rate,
        event_conversion_rate,
        
        -- Revenue metrics
        total_orders,
        completed_orders,
        failed_orders,
        recurring_orders,
        total_order_revenue,
        total_event_revenue,
        total_revenue,
        avg_order_value,
        total_discounts_used,
        product_categories_purchased,
        payment_methods_used,
        
        -- Timing metrics
        first_event_at,
        last_event_at,
        first_order_at,
        last_order_at,
        
        -- User classification
        user_type,
        
        -- Customer lifetime value estimate
        case 
            when recurring_orders > 0 and days_since_signup > 0
            then round(total_revenue * (365.0 / days_since_signup) * 2, 2)  -- Rough 2-year CLV estimate
            else total_revenue 
        end as estimated_clv,
        
        -- Engagement score (0-100)
        least(100, 
            (case when active_days > 0 then least(25, active_days) else 0 end) +
            (case when unique_sessions > 0 then least(25, unique_sessions) else 0 end) +
            (case when total_events > 0 then least(25, least(25, total_events / 10)) else 0 end) +
            (case when completed_orders > 0 then 25 else 0 end)
        ) as engagement_score,
        
        -- Risk classification
        case 
            when last_event_at < current_date - interval '90 days' and total_orders > 0 then 'churn_risk'
            when last_event_at < current_date - interval '30 days' and user_type = 'customer' then 'at_risk'
            when activity_frequency_percentage < 10 and days_since_signup > 30 then 'low_engagement'
            when user_type = 'customer' and recurring_orders = 0 then 'one_time_buyer'
            when user_type = 'customer' and recurring_orders > 0 then 'loyal_customer'
            when user_type = 'engaged_visitor' then 'potential_customer'
            else 'standard'
        end as risk_category,
        
        -- Value tier
        case 
            when total_revenue >= 1000 then 'high_value'
            when total_revenue >= 500 then 'medium_value'
            when total_revenue >= 100 then 'low_value'
            when total_revenue > 0 then 'minimal_value'
            else 'no_value'
        end as value_tier,
        
        -- Recency, Frequency, Monetary (RFM) components
        case 
            when last_order_at >= current_date - interval '30 days' then 5
            when last_order_at >= current_date - interval '60 days' then 4
            when last_order_at >= current_date - interval '90 days' then 3
            when last_order_at >= current_date - interval '180 days' then 2
            when last_order_at is not null then 1
            else 0
        end as recency_score,
        
        case 
            when completed_orders >= 10 then 5
            when completed_orders >= 5 then 4
            when completed_orders >= 3 then 3
            when completed_orders >= 2 then 2
            when completed_orders >= 1 then 1
            else 0
        end as frequency_score,
        
        case 
            when total_revenue >= 1000 then 5
            when total_revenue >= 500 then 4
            when total_revenue >= 200 then 3
            when total_revenue >= 50 then 2
            when total_revenue > 0 then 1
            else 0
        end as monetary_score,
        
        -- Data freshness
        current_timestamp as updated_at
        
    from user_activity
)

select * from final
    );
  
  
[0m20:07:53.970053 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m20:07:53.971994 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:07:53.972191 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics" rename to "user_metrics__dbt_backup"
[0m20:07:53.972862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.974802 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:07:53.975021 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics__dbt_tmp" rename to "user_metrics"
[0m20:07:53.975426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.978201 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:07:53.978403 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:07:53.978566 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:07:53.984596 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:07:53.986105 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:07:53.986295 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

      drop table if exists "dev"."main"."user_metrics__dbt_backup" cascade
    
[0m20:07:53.986907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:53.987654 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: Close
[0m20:07:53.987955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c839248-80de-4cee-9e85-4b487dab7ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080940c0>]}
[0m20:07:53.988275 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.user_metrics ............................ [[32mOK[0m in 0.08s]
[0m20:07:53.988532 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:07:53.989228 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:53.989382 [debug] [MainThread]: On master: BEGIN
[0m20:07:53.989513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:53.989739 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:53.989869 [debug] [MainThread]: On master: COMMIT
[0m20:07:53.989992 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:53.990110 [debug] [MainThread]: On master: COMMIT
[0m20:07:53.990281 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:53.990405 [debug] [MainThread]: On master: Close
[0m20:07:53.990567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:53.990687 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m20:07:53.990847 [info ] [MainThread]: 
[0m20:07:53.991010 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:07:53.991524 [debug] [MainThread]: Command end result
[0m20:07:54.006024 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:07:54.007133 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:07:54.010532 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:07:54.010702 [info ] [MainThread]: 
[0m20:07:54.010882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:07:54.011029 [info ] [MainThread]: 
[0m20:07:54.011185 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:07:54.012789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.80201894, "process_in_blocks": "0", "process_kernel_time": 0.214916, "process_mem_max_rss": "213778432", "process_out_blocks": "0", "process_user_time": 1.415463}
[0m20:07:54.013004 [debug] [MainThread]: Command `dbt run` succeeded at 20:07:54.012964 after 0.80 seconds
[0m20:07:54.013178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c67dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107515e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107515850>]}
[0m20:07:54.013353 [debug] [MainThread]: Flushing usage events
[0m20:07:54.407344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:55.513437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c91a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108befb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108befd90>]}


============================== 20:07:55.516392 | 2a8b797e-c58a-4bd1-8eb4-545eb0b04594 ==============================
[0m20:07:55.516392 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:07:55.516912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:07:55.671117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a8b797e-c58a-4bd1-8eb4-545eb0b04594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4d6e0>]}
[0m20:07:55.716968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a8b797e-c58a-4bd1-8eb4-545eb0b04594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107616ad0>]}
[0m20:07:55.719667 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:07:55.776832 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:07:55.843423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:55.843659 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:55.847182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:07:55.868542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a8b797e-c58a-4bd1-8eb4-545eb0b04594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d03d50>]}
[0m20:07:55.916146 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:07:55.917435 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:07:55.931407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a8b797e-c58a-4bd1-8eb4-545eb0b04594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f57c0>]}
[0m20:07:55.931683 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:07:55.931846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a8b797e-c58a-4bd1-8eb4-545eb0b04594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935cbb0>]}
[0m20:07:55.933735 [info ] [MainThread]: 
[0m20:07:55.933947 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:07:55.934088 [info ] [MainThread]: 
[0m20:07:55.934493 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:07:55.937173 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:07:55.970931 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:07:55.971179 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:07:55.971335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:55.980374 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:07:55.981364 [debug] [ThreadPool]: On list_dev: Close
[0m20:07:55.981724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:07:55.981948 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:07:55.985613 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:07:55.985819 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:07:55.985970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:55.986572 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:55.987231 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:07:55.987375 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:07:55.987581 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:55.987710 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:07:55.987837 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:07:55.988045 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:55.988455 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:07:55.988600 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:07:55.988728 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:07:55.988915 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:55.989053 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:07:55.990186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main)
[0m20:07:55.993167 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:07:55.993364 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:07:55.993507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:55.993823 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:55.993965 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:07:55.994110 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:07:56.001513 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:07:56.041061 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:07:56.041709 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:07:56.041865 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:07:56.042130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:07:56.042994 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:07:56.043144 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:07:56.043273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:56.044086 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:56.044240 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:07:56.044388 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:07:56.046486 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:07:56.047116 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:07:56.047406 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:07:56.047545 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:07:56.047827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a8b797e-c58a-4bd1-8eb4-545eb0b04594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d13d0>]}
[0m20:07:56.048083 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:56.048232 [debug] [MainThread]: On master: BEGIN
[0m20:07:56.048364 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:56.048581 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:56.048719 [debug] [MainThread]: On master: COMMIT
[0m20:07:56.048847 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:56.048971 [debug] [MainThread]: On master: COMMIT
[0m20:07:56.049151 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:56.049284 [debug] [MainThread]: On master: Close
[0m20:07:56.050330 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:07:56.050526 [info ] [Thread-1 (]: 1 of 13 START test source_not_null_raw_events_event_id ......................... [RUN]
[0m20:07:56.050727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2)
[0m20:07:56.050896 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:07:56.059194 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:07:56.059672 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:07:56.067599 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
[0m20:07:56.077194 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:07:56.077477 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: BEGIN
[0m20:07:56.077653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.078009 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.078182 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:07:56.078361 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where event_id is null



  
  
    );
  
  
    
[0m20:07:56.081666 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where event_id is null



  
  
    );
  
  
    
[0m20:07:56.081894 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.082142 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: ROLLBACK
[0m20:07:56.087650 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2'
[0m20:07:56.087874 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: Close
[0m20:07:56.089806 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:07:56.090065 [error] [Thread-1 (]: 1 of 13 ERROR source_not_null_raw_events_event_id .............................. [[31mERROR[0m in 0.04s]
[0m20:07:56.090339 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:07:56.090534 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:07:56.090770 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:07:56.090963 [info ] [Thread-1 (]: 2 of 13 START test source_not_null_raw_events_timestamp ........................ [RUN]
[0m20:07:56.091500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2, now test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05)
[0m20:07:56.091669 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:07:56.093660 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:07:56.094332 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:07:56.095642 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
[0m20:07:56.096239 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:07:56.096431 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: BEGIN
[0m20:07:56.096589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.096927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.097097 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:07:56.097268 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where timestamp is null



  
  
    );
  
  
    
[0m20:07:56.097688 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where timestamp is null



  
  
    );
  
  
    
[0m20:07:56.097854 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.098057 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: ROLLBACK
[0m20:07:56.100276 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05'
[0m20:07:56.100487 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: Close
[0m20:07:56.102421 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:07:56.102673 [error] [Thread-1 (]: 2 of 13 ERROR source_not_null_raw_events_timestamp ............................. [[31mERROR[0m in 0.01s]
[0m20:07:56.102934 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:07:56.103123 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:07:56.103362 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:07:56.103551 [info ] [Thread-1 (]: 3 of 13 START test source_not_null_raw_events_user_id .......................... [RUN]
[0m20:07:56.103802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05, now test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1)
[0m20:07:56.103973 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:07:56.106273 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:07:56.106904 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:07:56.107916 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
[0m20:07:56.108379 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:07:56.108552 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: BEGIN
[0m20:07:56.108707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.109031 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.109200 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:07:56.109374 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where user_id is null



  
  
    );
  
  
    
[0m20:07:56.109803 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where user_id is null



  
  
    );
  
  
    
[0m20:07:56.109973 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.110181 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: ROLLBACK
[0m20:07:56.112166 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1'
[0m20:07:56.112342 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: Close
[0m20:07:56.114179 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:07:56.114409 [error] [Thread-1 (]: 3 of 13 ERROR source_not_null_raw_events_user_id ............................... [[31mERROR[0m in 0.01s]
[0m20:07:56.114677 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:07:56.114862 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:07:56.115087 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:07:56.115289 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_raw_orders_order_id ......................... [RUN]
[0m20:07:56.115541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1, now test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f)
[0m20:07:56.115722 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:07:56.117857 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:07:56.118207 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:07:56.119158 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
[0m20:07:56.119604 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:07:56.119768 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: BEGIN
[0m20:07:56.119915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.120187 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.120340 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:07:56.120496 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where order_id is null



  
  
    );
  
  
    
[0m20:07:56.120860 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where order_id is null



  
  
    );
  
  
    
[0m20:07:56.121023 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.121214 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: ROLLBACK
[0m20:07:56.123272 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f'
[0m20:07:56.123460 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: Close
[0m20:07:56.125388 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:07:56.125637 [error] [Thread-1 (]: 4 of 13 ERROR source_not_null_raw_orders_order_id .............................. [[31mERROR[0m in 0.01s]
[0m20:07:56.125903 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:07:56.126090 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:07:56.126311 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:07:56.126510 [info ] [Thread-1 (]: 5 of 13 START test source_not_null_raw_orders_total_amount ..................... [RUN]
[0m20:07:56.126768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f, now test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec)
[0m20:07:56.126945 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:07:56.128851 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:07:56.129250 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:07:56.130532 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
[0m20:07:56.131017 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:07:56.131191 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: BEGIN
[0m20:07:56.131353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.131683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.131860 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:07:56.132025 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:07:56.132420 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:07:56.132590 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.132785 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: ROLLBACK
[0m20:07:56.134696 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec'
[0m20:07:56.134870 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: Close
[0m20:07:56.136676 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:07:56.136901 [error] [Thread-1 (]: 5 of 13 ERROR source_not_null_raw_orders_total_amount .......................... [[31mERROR[0m in 0.01s]
[0m20:07:56.137161 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:07:56.137353 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:07:56.137576 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:07:56.137766 [info ] [Thread-1 (]: 6 of 13 START test source_not_null_raw_orders_user_id .......................... [RUN]
[0m20:07:56.138016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec, now test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd)
[0m20:07:56.138195 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:07:56.140356 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:07:56.141028 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:07:56.142401 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
[0m20:07:56.142879 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:07:56.143048 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: BEGIN
[0m20:07:56.143197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.143514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.143676 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:07:56.143839 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where user_id is null



  
  
    );
  
  
    
[0m20:07:56.144249 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where user_id is null



  
  
    );
  
  
    
[0m20:07:56.144411 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.144603 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: ROLLBACK
[0m20:07:56.146776 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd'
[0m20:07:56.147004 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: Close
[0m20:07:56.148872 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:07:56.149109 [error] [Thread-1 (]: 6 of 13 ERROR source_not_null_raw_orders_user_id ............................... [[31mERROR[0m in 0.01s]
[0m20:07:56.149368 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:07:56.149551 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:07:56.149720 [info ] [Thread-1 (]: 7 of 13 START test source_not_null_raw_users_created_at ........................ [RUN]
[0m20:07:56.149974 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:07:56.150175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd, now test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5)
[0m20:07:56.150443 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:07:56.152585 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:07:56.153024 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:07:56.154017 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
[0m20:07:56.154739 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:07:56.154912 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: BEGIN
[0m20:07:56.155070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.155394 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.155551 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:07:56.155709 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where created_at is null



  
  
    );
  
  
    
[0m20:07:56.156114 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where created_at is null



  
  
    );
  
  
    
[0m20:07:56.156280 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.156478 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: ROLLBACK
[0m20:07:56.158441 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5'
[0m20:07:56.158614 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: Close
[0m20:07:56.160450 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:07:56.160676 [error] [Thread-1 (]: 7 of 13 ERROR source_not_null_raw_users_created_at ............................. [[31mERROR[0m in 0.01s]
[0m20:07:56.160933 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:07:56.161117 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:07:56.161336 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:07:56.161514 [info ] [Thread-1 (]: 8 of 13 START test source_not_null_raw_users_email ............................. [RUN]
[0m20:07:56.161752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5, now test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5)
[0m20:07:56.161924 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:07:56.163795 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:07:56.164148 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:07:56.165124 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
[0m20:07:56.165582 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:07:56.165749 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: BEGIN
[0m20:07:56.165901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.166175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.166342 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:07:56.166509 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where email is null



  
  
    );
  
  
    
[0m20:07:56.166959 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where email is null



  
  
    );
  
  
    
[0m20:07:56.167180 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.167441 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: ROLLBACK
[0m20:07:56.169474 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5'
[0m20:07:56.169653 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: Close
[0m20:07:56.171577 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:07:56.171823 [error] [Thread-1 (]: 8 of 13 ERROR source_not_null_raw_users_email .................................. [[31mERROR[0m in 0.01s]
[0m20:07:56.172087 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:07:56.172277 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:07:56.172499 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:07:56.172677 [info ] [Thread-1 (]: 9 of 13 START test source_not_null_raw_users_user_id ........................... [RUN]
[0m20:07:56.172912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5, now test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c)
[0m20:07:56.173083 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:07:56.175380 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:07:56.176148 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:07:56.177159 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
[0m20:07:56.177617 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:07:56.177785 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: BEGIN
[0m20:07:56.177942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.178283 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.178467 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:07:56.178640 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where user_id is null



  
  
    );
  
  
    
[0m20:07:56.179052 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where user_id is null



  
  
    );
  
  
    
[0m20:07:56.179225 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.179429 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: ROLLBACK
[0m20:07:56.181440 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c'
[0m20:07:56.181623 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: Close
[0m20:07:56.183630 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:07:56.183881 [error] [Thread-1 (]: 9 of 13 ERROR source_not_null_raw_users_user_id ................................ [[31mERROR[0m in 0.01s]
[0m20:07:56.184145 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:07:56.184335 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:07:56.184578 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:07:56.184798 [info ] [Thread-1 (]: 10 of 13 START test source_unique_raw_events_event_id .......................... [RUN]
[0m20:07:56.185084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c, now test.sbdk_project.source_unique_raw_events_event_id.825f404073)
[0m20:07:56.185268 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:07:56.188809 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:07:56.189236 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:07:56.190264 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
[0m20:07:56.190758 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:07:56.190948 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: BEGIN
[0m20:07:56.191114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.191457 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.191613 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:07:56.191773 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_events_event_id.825f404073"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."raw"."events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:56.192207 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_events_event_id.825f404073"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."raw"."events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:56.192380 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.192716 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: ROLLBACK
[0m20:07:56.194767 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_events_event_id.825f404073'
[0m20:07:56.194955 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: Close
[0m20:07:56.196798 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^
[0m20:07:56.197030 [error] [Thread-1 (]: 10 of 13 ERROR source_unique_raw_events_event_id ............................... [[31mERROR[0m in 0.01s]
[0m20:07:56.197290 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:07:56.197474 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:07:56.197680 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_events_event_id.825f404073' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^.
[0m20:07:56.197856 [info ] [Thread-1 (]: 11 of 13 START test source_unique_raw_orders_order_id .......................... [RUN]
[0m20:07:56.198096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_events_event_id.825f404073, now test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f)
[0m20:07:56.198270 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:07:56.200336 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:07:56.200740 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:07:56.202054 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
[0m20:07:56.202735 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:07:56.202922 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: BEGIN
[0m20:07:56.203084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.203414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.203569 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:07:56.203734 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."raw"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:56.204163 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."raw"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:56.204338 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.204539 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: ROLLBACK
[0m20:07:56.206671 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f'
[0m20:07:56.206857 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: Close
[0m20:07:56.208739 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^
[0m20:07:56.208973 [error] [Thread-1 (]: 11 of 13 ERROR source_unique_raw_orders_order_id ............................... [[31mERROR[0m in 0.01s]
[0m20:07:56.209231 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:07:56.209416 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:07:56.209629 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^.
[0m20:07:56.209807 [info ] [Thread-1 (]: 12 of 13 START test source_unique_raw_users_email .............................. [RUN]
[0m20:07:56.211050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f, now test.sbdk_project.source_unique_raw_users_email.ab11a6771a)
[0m20:07:56.211232 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:07:56.213182 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:07:56.213843 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:07:56.215099 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
[0m20:07:56.215564 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:07:56.215744 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: BEGIN
[0m20:07:56.215902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.216211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.216374 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:07:56.216542 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:56.216977 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:56.217147 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.217347 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: ROLLBACK
[0m20:07:56.219336 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_users_email.ab11a6771a'
[0m20:07:56.219503 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: Close
[0m20:07:56.221333 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:07:56.221570 [error] [Thread-1 (]: 12 of 13 ERROR source_unique_raw_users_email ................................... [[31mERROR[0m in 0.01s]
[0m20:07:56.221836 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:07:56.222024 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:07:56.222241 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_users_email.ab11a6771a' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^.
[0m20:07:56.222428 [info ] [Thread-1 (]: 13 of 13 START test source_unique_raw_users_user_id ............................ [RUN]
[0m20:07:56.222677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_users_email.ab11a6771a, now test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c)
[0m20:07:56.222945 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:07:56.224882 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:07:56.225293 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:07:56.226301 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
[0m20:07:56.226765 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:07:56.226932 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: BEGIN
[0m20:07:56.227080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:56.227374 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:56.227533 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:07:56.227695 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:56.228091 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:07:56.228256 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:56.228447 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: ROLLBACK
[0m20:07:56.230407 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c'
[0m20:07:56.230577 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: Close
[0m20:07:56.232400 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:07:56.232621 [error] [Thread-1 (]: 13 of 13 ERROR source_unique_raw_users_user_id ................................. [[31mERROR[0m in 0.01s]
[0m20:07:56.232869 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:07:56.233086 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^.
[0m20:07:56.233667 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:56.233816 [debug] [MainThread]: On master: BEGIN
[0m20:07:56.234396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:56.234638 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:56.234779 [debug] [MainThread]: On master: COMMIT
[0m20:07:56.234916 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:56.235044 [debug] [MainThread]: On master: COMMIT
[0m20:07:56.235241 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:56.235378 [debug] [MainThread]: On master: Close
[0m20:07:56.235544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:56.235666 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c' was properly closed.
[0m20:07:56.235809 [info ] [MainThread]: 
[0m20:07:56.236083 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m20:07:56.237115 [debug] [MainThread]: Command end result
[0m20:07:56.250721 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:07:56.251650 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:07:56.255206 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:07:56.255368 [info ] [MainThread]: 
[0m20:07:56.255548 [info ] [MainThread]: [31mCompleted with 13 errors, 0 partial successes, and 0 warnings:[0m
[0m20:07:56.255692 [info ] [MainThread]: 
[0m20:07:56.255875 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_event_id (models/_sources.yml)[0m
[0m20:07:56.256047 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:07:56.256178 [info ] [MainThread]: 
[0m20:07:56.256336 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_event_id.sql
[0m20:07:56.256462 [info ] [MainThread]: 
[0m20:07:56.256614 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  --------------------------------------------------------------------------------
[0m20:07:56.256746 [info ] [MainThread]: 
[0m20:07:56.256911 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_timestamp (models/_sources.yml)[0m
[0m20:07:56.257078 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:07:56.257203 [info ] [MainThread]: 
[0m20:07:56.257356 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_timestamp.sql
[0m20:07:56.257481 [info ] [MainThread]: 
[0m20:07:56.257635 [info ] [MainThread]:   See test failures:
  ---------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  ---------------------------------------------------------------------------------
[0m20:07:56.257773 [info ] [MainThread]: 
[0m20:07:56.257928 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_user_id (models/_sources.yml)[0m
[0m20:07:56.258087 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:07:56.258210 [info ] [MainThread]: 
[0m20:07:56.258361 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_user_id.sql
[0m20:07:56.258486 [info ] [MainThread]: 
[0m20:07:56.258641 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  -------------------------------------------------------------------------------
[0m20:07:56.258773 [info ] [MainThread]: 
[0m20:07:56.258934 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_order_id (models/_sources.yml)[0m
[0m20:07:56.259102 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:07:56.259230 [info ] [MainThread]: 
[0m20:07:56.259385 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_order_id.sql
[0m20:07:56.259510 [info ] [MainThread]: 
[0m20:07:56.259667 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  --------------------------------------------------------------------------------
[0m20:07:56.259799 [info ] [MainThread]: 
[0m20:07:56.259963 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_total_amount (models/_sources.yml)[0m
[0m20:07:56.260127 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:07:56.260257 [info ] [MainThread]: 
[0m20:07:56.260448 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_total_amount.sql
[0m20:07:56.260590 [info ] [MainThread]: 
[0m20:07:56.260757 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  ------------------------------------------------------------------------------------
[0m20:07:56.260899 [info ] [MainThread]: 
[0m20:07:56.261062 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_user_id (models/_sources.yml)[0m
[0m20:07:56.261226 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:07:56.261352 [info ] [MainThread]: 
[0m20:07:56.261508 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_user_id.sql
[0m20:07:56.261634 [info ] [MainThread]: 
[0m20:07:56.261793 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  -------------------------------------------------------------------------------
[0m20:07:56.261928 [info ] [MainThread]: 
[0m20:07:56.262087 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_created_at (models/_sources.yml)[0m
[0m20:07:56.262248 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:07:56.262372 [info ] [MainThread]: 
[0m20:07:56.262523 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_created_at.sql
[0m20:07:56.262644 [info ] [MainThread]: 
[0m20:07:56.262793 [info ] [MainThread]:   See test failures:
  ---------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  ---------------------------------------------------------------------------------
[0m20:07:56.262922 [info ] [MainThread]: 
[0m20:07:56.263078 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_email (models/_sources.yml)[0m
[0m20:07:56.263237 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:07:56.263362 [info ] [MainThread]: 
[0m20:07:56.263512 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_email.sql
[0m20:07:56.263633 [info ] [MainThread]: 
[0m20:07:56.263784 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  ----------------------------------------------------------------------------
[0m20:07:56.263913 [info ] [MainThread]: 
[0m20:07:56.264068 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_user_id (models/_sources.yml)[0m
[0m20:07:56.264226 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:07:56.264350 [info ] [MainThread]: 
[0m20:07:56.264499 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_user_id.sql
[0m20:07:56.264620 [info ] [MainThread]: 
[0m20:07:56.264771 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  ------------------------------------------------------------------------------
[0m20:07:56.264899 [info ] [MainThread]: 
[0m20:07:56.265056 [error] [MainThread]: [31mFailure in test source_unique_raw_events_event_id (models/_sources.yml)[0m
[0m20:07:56.265217 [error] [MainThread]:   Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^
[0m20:07:56.265341 [info ] [MainThread]: 
[0m20:07:56.265492 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_events_event_id.sql
[0m20:07:56.265613 [info ] [MainThread]: 
[0m20:07:56.265765 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  ------------------------------------------------------------------------------
[0m20:07:56.265893 [info ] [MainThread]: 
[0m20:07:56.266048 [error] [MainThread]: [31mFailure in test source_unique_raw_orders_order_id (models/_sources.yml)[0m
[0m20:07:56.266206 [error] [MainThread]:   Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^
[0m20:07:56.266334 [info ] [MainThread]: 
[0m20:07:56.266486 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_orders_order_id.sql
[0m20:07:56.266674 [info ] [MainThread]: 
[0m20:07:56.266924 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  ------------------------------------------------------------------------------
[0m20:07:56.267105 [info ] [MainThread]: 
[0m20:07:56.267308 [error] [MainThread]: [31mFailure in test source_unique_raw_users_email (models/_sources.yml)[0m
[0m20:07:56.267496 [error] [MainThread]:   Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:07:56.267636 [info ] [MainThread]: 
[0m20:07:56.267802 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_users_email.sql
[0m20:07:56.267970 [info ] [MainThread]: 
[0m20:07:56.268168 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  --------------------------------------------------------------------------
[0m20:07:56.268330 [info ] [MainThread]: 
[0m20:07:56.268507 [error] [MainThread]: [31mFailure in test source_unique_raw_users_user_id (models/_sources.yml)[0m
[0m20:07:56.268684 [error] [MainThread]:   Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:07:56.268819 [info ] [MainThread]: 
[0m20:07:56.268978 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_users_user_id.sql
[0m20:07:56.269103 [info ] [MainThread]: 
[0m20:07:56.269256 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  ----------------------------------------------------------------------------
[0m20:07:56.269389 [info ] [MainThread]: 
[0m20:07:56.269543 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=13 SKIP=0 NO-OP=0 TOTAL=13
[0m20:07:56.271143 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.80769527, "process_in_blocks": "0", "process_kernel_time": 0.189464, "process_mem_max_rss": "144621568", "process_out_blocks": "0", "process_user_time": 1.374887}
[0m20:07:56.271364 [debug] [MainThread]: Command `dbt test` failed at 20:07:56.271325 after 0.81 seconds
[0m20:07:56.271550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c21910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932ac50>]}
[0m20:07:56.271731 [debug] [MainThread]: Flushing usage events
[0m20:07:56.666818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:34.806874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112df3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112df3d90>]}


============================== 20:08:34.810952 | 0bf2ad3e-5f60-410a-8033-a3279ab7e7d3 ==============================
[0m20:08:34.810952 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:08:34.811381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:08:34.961857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bf2ad3e-5f60-410a-8033-a3279ab7e7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078516e0>]}
[0m20:08:35.002861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bf2ad3e-5f60-410a-8033-a3279ab7e7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5ead0>]}
[0m20:08:35.004529 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:08:35.066731 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:08:35.144292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:08:35.144519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:08:35.148105 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:08:35.169506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bf2ad3e-5f60-410a-8033-a3279ab7e7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f03b50>]}
[0m20:08:35.216166 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:08:35.217465 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:08:35.230945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bf2ad3e-5f60-410a-8033-a3279ab7e7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113133f20>]}
[0m20:08:35.231216 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:08:35.231392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bf2ad3e-5f60-410a-8033-a3279ab7e7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113490830>]}
[0m20:08:35.232421 [info ] [MainThread]: 
[0m20:08:35.232642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:08:35.232828 [info ] [MainThread]: 
[0m20:08:35.233101 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:08:35.235592 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:08:35.279180 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:08:35.279409 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:08:35.279561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:35.289722 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:08:35.290616 [debug] [ThreadPool]: On list_dev: Close
[0m20:08:35.290972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:08:35.291393 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:08:35.294697 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:08:35.294865 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:08:35.294999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:35.295357 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:08:35.296141 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:08:35.296290 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:08:35.296494 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:08:35.296628 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:08:35.296758 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:08:35.296978 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:08:35.297377 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:08:35.297522 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:08:35.297651 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:08:35.297849 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:08:35.297989 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:08:35.299140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_dbt_test__audit)
[0m20:08:35.302140 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:08:35.302339 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:08:35.302477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:35.302826 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:08:35.303001 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:08:35.303158 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:08:35.312512 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:08:35.313789 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:08:35.314732 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:08:35.314910 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:08:35.315204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:08:35.316726 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:08:35.318420 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:08:35.318616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:35.318946 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:08:35.319093 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:08:35.319237 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:08:35.321458 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:08:35.322235 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:08:35.322574 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:08:35.322717 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:08:35.323497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bf2ad3e-5f60-410a-8033-a3279ab7e7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138c9090>]}
[0m20:08:35.323765 [debug] [MainThread]: Using duckdb connection "master"
[0m20:08:35.323919 [debug] [MainThread]: On master: BEGIN
[0m20:08:35.324050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:08:35.324298 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:08:35.324437 [debug] [MainThread]: On master: COMMIT
[0m20:08:35.324569 [debug] [MainThread]: Using duckdb connection "master"
[0m20:08:35.324700 [debug] [MainThread]: On master: COMMIT
[0m20:08:35.324896 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:08:35.325100 [debug] [MainThread]: On master: Close
[0m20:08:35.326848 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:08:35.327129 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_events .................................... [RUN]
[0m20:08:35.327351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.sbdk_project.stg_events)
[0m20:08:35.327534 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:08:35.331462 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:08:35.332034 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:08:35.349914 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m20:08:35.350397 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:08:35.350565 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m20:08:35.350714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:35.351033 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.351185 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:08:35.351375 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_events
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m20:08:35.352149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:08:35.391327 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:08:35.391580 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m20:08:35.392465 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:08:35.393872 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:08:35.394050 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:08:35.394329 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.400432 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:08:35.400624 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:08:35.400784 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:08:35.401765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:08:35.404579 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:08:35.404764 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m20:08:35.405116 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.406336 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m20:08:35.407358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bf2ad3e-5f60-410a-8033-a3279ab7e7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f7ea50>]}
[0m20:08:35.407691 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.08s]
[0m20:08:35.407957 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:08:35.408142 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:08:35.408385 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_orders .................................... [RUN]
[0m20:08:35.408581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:08:35.408743 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:08:35.410025 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:08:35.410415 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:08:35.411897 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m20:08:35.412292 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:08:35.412478 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m20:08:35.412640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:35.413003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.413239 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:08:35.413512 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_orders
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m20:08:35.414621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:08:35.416532 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:08:35.416753 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:08:35.417095 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.418456 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:08:35.418637 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:08:35.419014 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.419887 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:08:35.420085 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:08:35.420252 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:08:35.420769 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.422093 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:08:35.422270 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m20:08:35.422616 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.423241 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m20:08:35.423508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bf2ad3e-5f60-410a-8033-a3279ab7e7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138b0470>]}
[0m20:08:35.423800 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.01s]
[0m20:08:35.424057 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:08:35.424237 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:08:35.424474 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_users ..................................... [RUN]
[0m20:08:35.424667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:08:35.424835 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:08:35.426088 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:08:35.426502 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:08:35.427947 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:08:35.428283 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:08:35.428454 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:08:35.428606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:35.428897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.429066 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:08:35.429259 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_users
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:08:35.431653 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:08:35.433331 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:08:35.433505 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m20:08:35.433783 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.435033 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:08:35.435196 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:08:35.435444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.436160 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:08:35.436326 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:08:35.436476 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:08:35.436867 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.438062 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:08:35.438236 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m20:08:35.438580 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.439210 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:08:35.439468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bf2ad3e-5f60-410a-8033-a3279ab7e7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11306d4f0>]}
[0m20:08:35.439757 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.01s]
[0m20:08:35.440009 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:08:35.440337 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:08:35.440610 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_user_activity ............................. [RUN]
[0m20:08:35.440834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now model.sbdk_project.int_user_activity)
[0m20:08:35.441006 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m20:08:35.442889 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m20:08:35.443353 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m20:08:35.444879 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.int_user_activity"
[0m20:08:35.445262 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:08:35.445428 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: BEGIN
[0m20:08:35.445578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:35.445863 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.446028 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:08:35.446327 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

  
  create view "dev"."main"."int_user_activity__dbt_tmp" as (
    

with users as (
    select * from "dev"."main"."stg_users"
),

events as (
    select * from "dev"."main"."stg_events"
),

orders as (
    select * from "dev"."main"."stg_orders"
),

user_events as (
    select
        user_id,
        count(*) as total_events,
        count(*) filter (where event_type = 'page_view') as pageviews,
        count(*) filter (where event_type = 'click') as clicks,
        count(*) filter (where event_type = 'signup') as signups,
        count(*) filter (where event_type = 'login') as logins,
        count(*) filter (where event_type = 'purchase') as purchase_events,
        count(*) filter (where is_conversion_event = true) as conversion_events,
        count(*) filter (where is_revenue_event = true) as revenue_events,
        coalesce(sum(revenue), 0) as total_event_revenue,
        coalesce(sum(duration_seconds), 0) as total_time_on_site,
        count(distinct session_id) filter (where session_id is not null) as unique_sessions,
        count(distinct event_date) as active_days,
        min(timestamp) as first_event_at,
        max(timestamp) as last_event_at,
        count(distinct traffic_category) as traffic_sources_used
    from events
    group by user_id
),

user_orders as (
    select
        user_id,
        count(*) as total_orders,
        count(*) filter (where is_completed = true) as completed_orders,
        count(*) filter (where is_failed = true) as failed_orders,
        count(*) filter (where is_recurring = true) as recurring_orders,
        coalesce(sum(total_amount) filter (where is_completed = true), 0) as total_order_revenue,
        coalesce(avg(total_amount) filter (where is_completed = true), 0) as avg_order_value,
        coalesce(sum(discount_amount), 0) as total_discounts_used,
        count(distinct product_category) as product_categories_purchased,
        min(created_at) as first_order_at,
        max(created_at) as last_order_at,
        count(distinct payment_method) as payment_methods_used
    from orders
    group by user_id
),

combined as (
    select
        u.user_id,
        u.username,
        u.email,
        u.first_name,
        u.last_name,
        u.created_at as user_created_at,
        u.country,
        u.city,
        u.subscription_tier,
        u.referrer,
        u.is_active,
        u.age,
        u.is_paid_subscriber,
        u.days_since_signup,
        u.has_complete_profile,
        
        -- Event metrics
        coalesce(e.total_events, 0) as total_events,
        coalesce(e.pageviews, 0) as pageviews,
        coalesce(e.clicks, 0) as clicks,
        coalesce(e.signups, 0) as signups,
        coalesce(e.logins, 0) as logins,
        coalesce(e.purchase_events, 0) as purchase_events,
        coalesce(e.conversion_events, 0) as conversion_events,
        coalesce(e.revenue_events, 0) as revenue_events,
        coalesce(e.total_event_revenue, 0) as total_event_revenue,
        coalesce(e.total_time_on_site, 0) as total_time_on_site,
        coalesce(e.unique_sessions, 0) as unique_sessions,
        coalesce(e.active_days, 0) as active_days,
        e.first_event_at,
        e.last_event_at,
        coalesce(e.traffic_sources_used, 0) as traffic_sources_used,
        
        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.failed_orders, 0) as failed_orders,
        coalesce(o.recurring_orders, 0) as recurring_orders,
        coalesce(o.total_order_revenue, 0) as total_order_revenue,
        coalesce(o.avg_order_value, 0) as avg_order_value,
        coalesce(o.total_discounts_used, 0) as total_discounts_used,
        coalesce(o.product_categories_purchased, 0) as product_categories_purchased,
        o.first_order_at,
        o.last_order_at,
        coalesce(o.payment_methods_used, 0) as payment_methods_used,
        
        -- Calculated metrics
        case 
            when e.pageviews > 0 and o.completed_orders > 0 
            then round(o.completed_orders::float / e.pageviews * 100, 2)
            else 0 
        end as purchase_conversion_rate,
        
        case 
            when e.total_events > 0 
            then round(e.conversion_events::float / e.total_events * 100, 2)
            else 0 
        end as event_conversion_rate,
        
        case 
            when e.unique_sessions > 0 
            then round(e.total_events::float / e.unique_sessions, 2)
            else 0 
        end as events_per_session,
        
        case 
            when u.days_since_signup > 0 and e.active_days > 0
            then round(e.active_days::float / u.days_since_signup * 100, 2)
            else 0 
        end as activity_frequency_percentage,
        
        -- Total combined revenue
        coalesce(e.total_event_revenue, 0) + coalesce(o.total_order_revenue, 0) as total_revenue,
        
        -- User activity classification
        case 
            when o.completed_orders > 0 then 'customer'
            when e.signups > 0 then 'signed_up'
            when e.total_events > 10 then 'engaged_visitor'
            when e.total_events > 0 then 'visitor'
            else 'inactive'
        end as user_type
        
    from users u
    left join user_events e on u.user_id = e.user_id
    left join user_orders o on u.user_id = o.user_id
)

select * from combined
  );

[0m20:08:35.449517 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:08:35.451163 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:08:35.451343 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity" rename to "int_user_activity__dbt_backup"
[0m20:08:35.451654 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.452887 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:08:35.453053 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity__dbt_tmp" rename to "int_user_activity"
[0m20:08:35.453337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.454057 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:08:35.454220 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:08:35.454370 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:08:35.454954 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.455971 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:08:35.456145 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

      drop view if exists "dev"."main"."int_user_activity__dbt_backup" cascade
    
[0m20:08:35.456465 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.457267 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: Close
[0m20:08:35.457528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bf2ad3e-5f60-410a-8033-a3279ab7e7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137a9650>]}
[0m20:08:35.457817 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_user_activity ........................ [[32mOK[0m in 0.02s]
[0m20:08:35.458070 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:08:35.458356 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:08:35.458603 [info ] [Thread-1 (]: 5 of 5 START sql table model main.user_metrics ................................. [RUN]
[0m20:08:35.458811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m20:08:35.458975 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m20:08:35.460584 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m20:08:35.461039 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m20:08:35.471967 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.user_metrics"
[0m20:08:35.472562 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:08:35.472746 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: BEGIN
[0m20:08:35.472908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:35.473244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.473409 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:08:35.473685 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

  
    
    

    create  table
      "dev"."main"."user_metrics__dbt_tmp"
  
    as (
      

with user_activity as (
    select * from "dev"."main"."int_user_activity"
),

final as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        user_created_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        age,
        is_paid_subscriber,
        days_since_signup,
        has_complete_profile,
        
        -- Engagement metrics
        total_events,
        pageviews,
        clicks,
        logins,
        unique_sessions,
        active_days,
        traffic_sources_used,
        events_per_session,
        activity_frequency_percentage,
        total_time_on_site,
        
        -- Conversion metrics
        signups,
        purchase_events,
        conversion_events,
        purchase_conversion_rate,
        event_conversion_rate,
        
        -- Revenue metrics
        total_orders,
        completed_orders,
        failed_orders,
        recurring_orders,
        total_order_revenue,
        total_event_revenue,
        total_revenue,
        avg_order_value,
        total_discounts_used,
        product_categories_purchased,
        payment_methods_used,
        
        -- Timing metrics
        first_event_at,
        last_event_at,
        first_order_at,
        last_order_at,
        
        -- User classification
        user_type,
        
        -- Customer lifetime value estimate
        case 
            when recurring_orders > 0 and days_since_signup > 0
            then round(total_revenue * (365.0 / days_since_signup) * 2, 2)  -- Rough 2-year CLV estimate
            else total_revenue 
        end as estimated_clv,
        
        -- Engagement score (0-100)
        least(100, 
            (case when active_days > 0 then least(25, active_days) else 0 end) +
            (case when unique_sessions > 0 then least(25, unique_sessions) else 0 end) +
            (case when total_events > 0 then least(25, least(25, total_events / 10)) else 0 end) +
            (case when completed_orders > 0 then 25 else 0 end)
        ) as engagement_score,
        
        -- Risk classification
        case 
            when last_event_at < current_date - interval '90 days' and total_orders > 0 then 'churn_risk'
            when last_event_at < current_date - interval '30 days' and user_type = 'customer' then 'at_risk'
            when activity_frequency_percentage < 10 and days_since_signup > 30 then 'low_engagement'
            when user_type = 'customer' and recurring_orders = 0 then 'one_time_buyer'
            when user_type = 'customer' and recurring_orders > 0 then 'loyal_customer'
            when user_type = 'engaged_visitor' then 'potential_customer'
            else 'standard'
        end as risk_category,
        
        -- Value tier
        case 
            when total_revenue >= 1000 then 'high_value'
            when total_revenue >= 500 then 'medium_value'
            when total_revenue >= 100 then 'low_value'
            when total_revenue > 0 then 'minimal_value'
            else 'no_value'
        end as value_tier,
        
        -- Recency, Frequency, Monetary (RFM) components
        case 
            when last_order_at >= current_date - interval '30 days' then 5
            when last_order_at >= current_date - interval '60 days' then 4
            when last_order_at >= current_date - interval '90 days' then 3
            when last_order_at >= current_date - interval '180 days' then 2
            when last_order_at is not null then 1
            else 0
        end as recency_score,
        
        case 
            when completed_orders >= 10 then 5
            when completed_orders >= 5 then 4
            when completed_orders >= 3 then 3
            when completed_orders >= 2 then 2
            when completed_orders >= 1 then 1
            else 0
        end as frequency_score,
        
        case 
            when total_revenue >= 1000 then 5
            when total_revenue >= 500 then 4
            when total_revenue >= 200 then 3
            when total_revenue >= 50 then 2
            when total_revenue > 0 then 1
            else 0
        end as monetary_score,
        
        -- Data freshness
        current_timestamp as updated_at
        
    from user_activity
)

select * from final
    );
  
  
[0m20:08:35.530490 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m20:08:35.532171 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:08:35.532356 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics" rename to "user_metrics__dbt_backup"
[0m20:08:35.533106 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:08:35.534371 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:08:35.534542 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics__dbt_tmp" rename to "user_metrics"
[0m20:08:35.534807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.537502 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:08:35.537693 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:08:35.537858 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:08:35.546689 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:08:35.548310 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:08:35.548502 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

      drop table if exists "dev"."main"."user_metrics__dbt_backup" cascade
    
[0m20:08:35.549107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:08:35.549937 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: Close
[0m20:08:35.550259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bf2ad3e-5f60-410a-8033-a3279ab7e7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c5160>]}
[0m20:08:35.550609 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.user_metrics ............................ [[32mOK[0m in 0.09s]
[0m20:08:35.550894 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:08:35.551491 [debug] [MainThread]: Using duckdb connection "master"
[0m20:08:35.551642 [debug] [MainThread]: On master: BEGIN
[0m20:08:35.551776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:08:35.552055 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:08:35.552188 [debug] [MainThread]: On master: COMMIT
[0m20:08:35.552318 [debug] [MainThread]: Using duckdb connection "master"
[0m20:08:35.552446 [debug] [MainThread]: On master: COMMIT
[0m20:08:35.552667 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:08:35.552857 [debug] [MainThread]: On master: Close
[0m20:08:35.553067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:35.553214 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m20:08:35.553433 [info ] [MainThread]: 
[0m20:08:35.553685 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m20:08:35.554427 [debug] [MainThread]: Command end result
[0m20:08:35.569059 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:08:35.570074 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:08:35.573177 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:08:35.573350 [info ] [MainThread]: 
[0m20:08:35.573542 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:08:35.573684 [info ] [MainThread]: 
[0m20:08:35.573835 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:08:35.575594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8215458, "process_in_blocks": "0", "process_kernel_time": 0.23605, "process_mem_max_rss": "225099776", "process_out_blocks": "0", "process_user_time": 1.424862}
[0m20:08:35.575831 [debug] [MainThread]: Command `dbt run` succeeded at 20:08:35.575790 after 0.82 seconds
[0m20:08:35.576015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138a3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138a3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138a3770>]}
[0m20:08:35.576183 [debug] [MainThread]: Flushing usage events
[0m20:08:36.093291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:40.110928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105723b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105723d90>]}


============================== 20:10:40.116490 | 49d3e8f9-3299-448e-99a2-204ee47e153d ==============================
[0m20:10:40.116490 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:10:40.116867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'log_path': 'dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:10:40.265062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49d3e8f9-3299-448e-99a2-204ee47e153d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a816e0>]}
[0m20:10:40.305138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49d3e8f9-3299-448e-99a2-204ee47e153d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414aad0>]}
[0m20:10:40.306683 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:10:40.362340 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:10:40.441607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:40.441857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:40.445515 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:10:40.466810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49d3e8f9-3299-448e-99a2-204ee47e153d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105833b50>]}
[0m20:10:40.512627 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:10:40.514055 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:10:40.528150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49d3e8f9-3299-448e-99a2-204ee47e153d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a63f20>]}
[0m20:10:40.528426 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:10:40.528595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49d3e8f9-3299-448e-99a2-204ee47e153d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc0830>]}
[0m20:10:40.529602 [info ] [MainThread]: 
[0m20:10:40.529766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:40.529896 [info ] [MainThread]: 
[0m20:10:40.530134 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:10:40.532606 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:10:40.575685 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:10:40.575911 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:10:40.576061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:40.586790 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:10:40.587713 [debug] [ThreadPool]: On list_dev: Close
[0m20:10:40.588076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:10:40.588336 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:10:40.591679 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:10:40.591857 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:10:40.592000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:40.592384 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:40.593174 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:10:40.593324 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:10:40.593541 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:40.593670 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:10:40.593798 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:10:40.594023 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:40.594422 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:10:40.594565 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:10:40.594691 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:10:40.594904 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:40.595060 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:10:40.596211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m20:10:40.599551 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:10:40.599722 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:10:40.599852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:40.600150 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:40.600284 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:10:40.600423 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:10:40.609118 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:10:40.610248 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:10:40.611074 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:10:40.611243 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:10:40.611501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:10:40.612848 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:10:40.612989 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:10:40.613110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:40.613341 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:40.613471 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:10:40.613606 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:10:40.615752 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:10:40.616361 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:10:40.616636 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:10:40.616769 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:10:40.617034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49d3e8f9-3299-448e-99a2-204ee47e153d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f9160>]}
[0m20:10:40.617255 [debug] [MainThread]: Using duckdb connection "master"
[0m20:10:40.617389 [debug] [MainThread]: On master: BEGIN
[0m20:10:40.617516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:10:40.617726 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:10:40.617952 [debug] [MainThread]: On master: COMMIT
[0m20:10:40.618101 [debug] [MainThread]: Using duckdb connection "master"
[0m20:10:40.618235 [debug] [MainThread]: On master: COMMIT
[0m20:10:40.618430 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:10:40.618567 [debug] [MainThread]: On master: Close
[0m20:10:40.620299 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:10:40.620564 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_events .................................... [RUN]
[0m20:10:40.620765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now model.sbdk_project.stg_events)
[0m20:10:40.621064 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:10:40.624867 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:10:40.625266 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:10:40.643060 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m20:10:40.643596 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:10:40.643773 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m20:10:40.643930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:40.644311 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.644516 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:10:40.644735 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_events
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m20:10:40.645558 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:10:40.682976 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:10:40.683225 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m20:10:40.684078 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:10:40.685514 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:10:40.685694 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:10:40.685982 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.692177 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:10:40.692377 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:10:40.692540 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:10:40.693520 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:10:40.696382 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:10:40.696570 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m20:10:40.696944 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.698181 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m20:10:40.699226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d3e8f9-3299-448e-99a2-204ee47e153d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058aea50>]}
[0m20:10:40.699548 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.08s]
[0m20:10:40.699821 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:10:40.700014 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:10:40.700260 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_orders .................................... [RUN]
[0m20:10:40.700476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:10:40.700642 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:10:40.701987 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:10:40.702385 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:10:40.703876 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m20:10:40.704201 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:10:40.704362 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m20:10:40.704507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:40.704804 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.704959 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:10:40.705171 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_orders
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m20:10:40.706140 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:10:40.707765 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:10:40.707947 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:10:40.708231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.709496 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:10:40.709664 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:10:40.709936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.710682 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:10:40.710848 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:10:40.710995 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:10:40.711474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.712691 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:10:40.712864 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m20:10:40.713209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.713808 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m20:10:40.714063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d3e8f9-3299-448e-99a2-204ee47e153d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a0680>]}
[0m20:10:40.714380 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.01s]
[0m20:10:40.714638 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:10:40.714824 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:10:40.715075 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_users ..................................... [RUN]
[0m20:10:40.715275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:10:40.715436 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:10:40.716617 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:10:40.717165 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:10:40.718615 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:10:40.719096 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:10:40.719263 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:10:40.719411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:40.719677 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.719835 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:10:40.720019 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from main.raw_users
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:10:40.722403 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:10:40.723971 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:10:40.724142 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m20:10:40.724427 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.725677 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:10:40.725843 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:10:40.726109 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.726841 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:10:40.727008 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:10:40.727160 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:10:40.727537 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.728496 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:10:40.728655 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m20:10:40.728954 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.729765 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:10:40.730004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d3e8f9-3299-448e-99a2-204ee47e153d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a134d0>]}
[0m20:10:40.730283 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.01s]
[0m20:10:40.730526 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:10:40.730882 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:10:40.731142 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_user_activity ............................. [RUN]
[0m20:10:40.731333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now model.sbdk_project.int_user_activity)
[0m20:10:40.731493 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m20:10:40.733350 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m20:10:40.733977 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m20:10:40.735422 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.int_user_activity"
[0m20:10:40.735945 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:10:40.736110 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: BEGIN
[0m20:10:40.736255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:40.736539 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.736697 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:10:40.736988 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

  
  create view "dev"."main"."int_user_activity__dbt_tmp" as (
    

with users as (
    select * from "dev"."main"."stg_users"
),

events as (
    select * from "dev"."main"."stg_events"
),

orders as (
    select * from "dev"."main"."stg_orders"
),

user_events as (
    select
        user_id,
        count(*) as total_events,
        count(*) filter (where event_type = 'page_view') as pageviews,
        count(*) filter (where event_type = 'click') as clicks,
        count(*) filter (where event_type = 'signup') as signups,
        count(*) filter (where event_type = 'login') as logins,
        count(*) filter (where event_type = 'purchase') as purchase_events,
        count(*) filter (where is_conversion_event = true) as conversion_events,
        count(*) filter (where is_revenue_event = true) as revenue_events,
        coalesce(sum(revenue), 0) as total_event_revenue,
        coalesce(sum(duration_seconds), 0) as total_time_on_site,
        count(distinct session_id) filter (where session_id is not null) as unique_sessions,
        count(distinct event_date) as active_days,
        min(timestamp) as first_event_at,
        max(timestamp) as last_event_at,
        count(distinct traffic_category) as traffic_sources_used
    from events
    group by user_id
),

user_orders as (
    select
        user_id,
        count(*) as total_orders,
        count(*) filter (where is_completed = true) as completed_orders,
        count(*) filter (where is_failed = true) as failed_orders,
        count(*) filter (where is_recurring = true) as recurring_orders,
        coalesce(sum(total_amount) filter (where is_completed = true), 0) as total_order_revenue,
        coalesce(avg(total_amount) filter (where is_completed = true), 0) as avg_order_value,
        coalesce(sum(discount_amount), 0) as total_discounts_used,
        count(distinct product_category) as product_categories_purchased,
        min(created_at) as first_order_at,
        max(created_at) as last_order_at,
        count(distinct payment_method) as payment_methods_used
    from orders
    group by user_id
),

combined as (
    select
        u.user_id,
        u.username,
        u.email,
        u.first_name,
        u.last_name,
        u.created_at as user_created_at,
        u.country,
        u.city,
        u.subscription_tier,
        u.referrer,
        u.is_active,
        u.age,
        u.is_paid_subscriber,
        u.days_since_signup,
        u.has_complete_profile,
        
        -- Event metrics
        coalesce(e.total_events, 0) as total_events,
        coalesce(e.pageviews, 0) as pageviews,
        coalesce(e.clicks, 0) as clicks,
        coalesce(e.signups, 0) as signups,
        coalesce(e.logins, 0) as logins,
        coalesce(e.purchase_events, 0) as purchase_events,
        coalesce(e.conversion_events, 0) as conversion_events,
        coalesce(e.revenue_events, 0) as revenue_events,
        coalesce(e.total_event_revenue, 0) as total_event_revenue,
        coalesce(e.total_time_on_site, 0) as total_time_on_site,
        coalesce(e.unique_sessions, 0) as unique_sessions,
        coalesce(e.active_days, 0) as active_days,
        e.first_event_at,
        e.last_event_at,
        coalesce(e.traffic_sources_used, 0) as traffic_sources_used,
        
        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.failed_orders, 0) as failed_orders,
        coalesce(o.recurring_orders, 0) as recurring_orders,
        coalesce(o.total_order_revenue, 0) as total_order_revenue,
        coalesce(o.avg_order_value, 0) as avg_order_value,
        coalesce(o.total_discounts_used, 0) as total_discounts_used,
        coalesce(o.product_categories_purchased, 0) as product_categories_purchased,
        o.first_order_at,
        o.last_order_at,
        coalesce(o.payment_methods_used, 0) as payment_methods_used,
        
        -- Calculated metrics
        case 
            when e.pageviews > 0 and o.completed_orders > 0 
            then round(o.completed_orders::float / e.pageviews * 100, 2)
            else 0 
        end as purchase_conversion_rate,
        
        case 
            when e.total_events > 0 
            then round(e.conversion_events::float / e.total_events * 100, 2)
            else 0 
        end as event_conversion_rate,
        
        case 
            when e.unique_sessions > 0 
            then round(e.total_events::float / e.unique_sessions, 2)
            else 0 
        end as events_per_session,
        
        case 
            when u.days_since_signup > 0 and e.active_days > 0
            then round(e.active_days::float / u.days_since_signup * 100, 2)
            else 0 
        end as activity_frequency_percentage,
        
        -- Total combined revenue
        coalesce(e.total_event_revenue, 0) + coalesce(o.total_order_revenue, 0) as total_revenue,
        
        -- User activity classification
        case 
            when o.completed_orders > 0 then 'customer'
            when e.signups > 0 then 'signed_up'
            when e.total_events > 10 then 'engaged_visitor'
            when e.total_events > 0 then 'visitor'
            else 'inactive'
        end as user_type
        
    from users u
    left join user_events e on u.user_id = e.user_id
    left join user_orders o on u.user_id = o.user_id
)

select * from combined
  );

[0m20:10:40.739962 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:10:40.741607 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:10:40.741781 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity" rename to "int_user_activity__dbt_backup"
[0m20:10:40.742088 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.743322 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:10:40.743494 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity__dbt_tmp" rename to "int_user_activity"
[0m20:10:40.743849 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.744652 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:10:40.744831 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:10:40.744995 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:10:40.745541 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.746569 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:10:40.746730 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

      drop view if exists "dev"."main"."int_user_activity__dbt_backup" cascade
    
[0m20:10:40.747079 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.747748 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: Close
[0m20:10:40.748033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d3e8f9-3299-448e-99a2-204ee47e153d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105930050>]}
[0m20:10:40.748349 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_user_activity ........................ [[32mOK[0m in 0.02s]
[0m20:10:40.748687 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:10:40.749092 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:10:40.749354 [info ] [Thread-1 (]: 5 of 5 START sql table model main.user_metrics ................................. [RUN]
[0m20:10:40.749573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m20:10:40.749741 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m20:10:40.751724 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m20:10:40.752317 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m20:10:40.762313 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.user_metrics"
[0m20:10:40.762763 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:10:40.762931 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: BEGIN
[0m20:10:40.763079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:40.763427 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.763603 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:10:40.763862 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

  
    
    

    create  table
      "dev"."main"."user_metrics__dbt_tmp"
  
    as (
      

with user_activity as (
    select * from "dev"."main"."int_user_activity"
),

final as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        user_created_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        age,
        is_paid_subscriber,
        days_since_signup,
        has_complete_profile,
        
        -- Engagement metrics
        total_events,
        pageviews,
        clicks,
        logins,
        unique_sessions,
        active_days,
        traffic_sources_used,
        events_per_session,
        activity_frequency_percentage,
        total_time_on_site,
        
        -- Conversion metrics
        signups,
        purchase_events,
        conversion_events,
        purchase_conversion_rate,
        event_conversion_rate,
        
        -- Revenue metrics
        total_orders,
        completed_orders,
        failed_orders,
        recurring_orders,
        total_order_revenue,
        total_event_revenue,
        total_revenue,
        avg_order_value,
        total_discounts_used,
        product_categories_purchased,
        payment_methods_used,
        
        -- Timing metrics
        first_event_at,
        last_event_at,
        first_order_at,
        last_order_at,
        
        -- User classification
        user_type,
        
        -- Customer lifetime value estimate
        case 
            when recurring_orders > 0 and days_since_signup > 0
            then round(total_revenue * (365.0 / days_since_signup) * 2, 2)  -- Rough 2-year CLV estimate
            else total_revenue 
        end as estimated_clv,
        
        -- Engagement score (0-100)
        least(100, 
            (case when active_days > 0 then least(25, active_days) else 0 end) +
            (case when unique_sessions > 0 then least(25, unique_sessions) else 0 end) +
            (case when total_events > 0 then least(25, least(25, total_events / 10)) else 0 end) +
            (case when completed_orders > 0 then 25 else 0 end)
        ) as engagement_score,
        
        -- Risk classification
        case 
            when last_event_at < current_date - interval '90 days' and total_orders > 0 then 'churn_risk'
            when last_event_at < current_date - interval '30 days' and user_type = 'customer' then 'at_risk'
            when activity_frequency_percentage < 10 and days_since_signup > 30 then 'low_engagement'
            when user_type = 'customer' and recurring_orders = 0 then 'one_time_buyer'
            when user_type = 'customer' and recurring_orders > 0 then 'loyal_customer'
            when user_type = 'engaged_visitor' then 'potential_customer'
            else 'standard'
        end as risk_category,
        
        -- Value tier
        case 
            when total_revenue >= 1000 then 'high_value'
            when total_revenue >= 500 then 'medium_value'
            when total_revenue >= 100 then 'low_value'
            when total_revenue > 0 then 'minimal_value'
            else 'no_value'
        end as value_tier,
        
        -- Recency, Frequency, Monetary (RFM) components
        case 
            when last_order_at >= current_date - interval '30 days' then 5
            when last_order_at >= current_date - interval '60 days' then 4
            when last_order_at >= current_date - interval '90 days' then 3
            when last_order_at >= current_date - interval '180 days' then 2
            when last_order_at is not null then 1
            else 0
        end as recency_score,
        
        case 
            when completed_orders >= 10 then 5
            when completed_orders >= 5 then 4
            when completed_orders >= 3 then 3
            when completed_orders >= 2 then 2
            when completed_orders >= 1 then 1
            else 0
        end as frequency_score,
        
        case 
            when total_revenue >= 1000 then 5
            when total_revenue >= 500 then 4
            when total_revenue >= 200 then 3
            when total_revenue >= 50 then 2
            when total_revenue > 0 then 1
            else 0
        end as monetary_score,
        
        -- Data freshness
        current_timestamp as updated_at
        
    from user_activity
)

select * from final
    );
  
  
[0m20:10:40.813744 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m20:10:40.815663 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:10:40.815855 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics" rename to "user_metrics__dbt_backup"
[0m20:10:40.816549 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:10:40.817843 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:10:40.818015 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics__dbt_tmp" rename to "user_metrics"
[0m20:10:40.818284 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.820876 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:10:40.821055 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:10:40.821212 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:10:40.826756 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:10:40.828201 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:10:40.828388 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

      drop table if exists "dev"."main"."user_metrics__dbt_backup" cascade
    
[0m20:10:40.828961 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:40.829637 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: Close
[0m20:10:40.829926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d3e8f9-3299-448e-99a2-204ee47e153d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b0e50>]}
[0m20:10:40.830242 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.user_metrics ............................ [[32mOK[0m in 0.08s]
[0m20:10:40.830502 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:10:40.831076 [debug] [MainThread]: Using duckdb connection "master"
[0m20:10:40.831234 [debug] [MainThread]: On master: BEGIN
[0m20:10:40.831368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:10:40.831600 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:10:40.831733 [debug] [MainThread]: On master: COMMIT
[0m20:10:40.831860 [debug] [MainThread]: Using duckdb connection "master"
[0m20:10:40.831986 [debug] [MainThread]: On master: COMMIT
[0m20:10:40.832166 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:10:40.832295 [debug] [MainThread]: On master: Close
[0m20:10:40.832467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:40.832599 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m20:10:40.832764 [info ] [MainThread]: 
[0m20:10:40.832902 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m20:10:40.833423 [debug] [MainThread]: Command end result
[0m20:10:40.848386 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:10:40.849449 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:10:40.852756 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:10:40.852932 [info ] [MainThread]: 
[0m20:10:40.853111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:40.853251 [info ] [MainThread]: 
[0m20:10:40.853402 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:10:40.855131 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7955246, "process_in_blocks": "0", "process_kernel_time": 0.212983, "process_mem_max_rss": "215400448", "process_out_blocks": "0", "process_user_time": 1.407784}
[0m20:10:40.855379 [debug] [MainThread]: Command `dbt run` succeeded at 20:10:40.855334 after 0.80 seconds
[0m20:10:40.855565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e37d0>]}
[0m20:10:40.855748 [debug] [MainThread]: Flushing usage events
[0m20:10:41.419450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:42.579051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068abb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068abd90>]}


============================== 20:10:42.581789 | c2091f7b-d365-40c1-90d4-1842adbb86a6 ==============================
[0m20:10:42.581789 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:10:42.582110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:10:42.716674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2091f7b-d365-40c1-90d4-1842adbb86a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c096e0>]}
[0m20:10:42.757703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2091f7b-d365-40c1-90d4-1842adbb86a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d2ad0>]}
[0m20:10:42.758982 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:10:42.812445 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:10:42.877609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:42.877881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:42.881664 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:10:42.902930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2091f7b-d365-40c1-90d4-1842adbb86a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bbd50>]}
[0m20:10:42.949234 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:10:42.950398 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:10:42.964012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2091f7b-d365-40c1-90d4-1842adbb86a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fad7c0>]}
[0m20:10:42.964342 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:10:42.964580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2091f7b-d365-40c1-90d4-1842adbb86a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107014bb0>]}
[0m20:10:42.966002 [info ] [MainThread]: 
[0m20:10:42.966228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:42.966373 [info ] [MainThread]: 
[0m20:10:42.966640 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:10:42.969335 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:10:42.999290 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:10:42.999531 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:10:42.999682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:43.008130 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:10:43.008859 [debug] [ThreadPool]: On list_dev: Close
[0m20:10:43.009189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:10:43.009405 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:10:43.012794 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:10:43.012974 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:10:43.013110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:43.013568 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:43.014261 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:10:43.014443 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:10:43.014692 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:43.014829 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:10:43.014953 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:10:43.015175 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:43.015609 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:10:43.015751 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:10:43.015875 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:10:43.016058 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:43.016189 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:10:43.017281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main_dbt_test__audit)
[0m20:10:43.020003 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:10:43.020160 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:10:43.020289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:43.020565 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:43.020731 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:10:43.020947 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:10:43.028079 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:10:43.064745 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:10:43.065619 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:10:43.065836 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:10:43.066140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:10:43.067050 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:10:43.067197 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:10:43.067326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:43.067633 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:43.067765 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:10:43.067890 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:10:43.070055 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:10:43.070787 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:10:43.071089 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:10:43.071220 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:10:43.071962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2091f7b-d365-40c1-90d4-1842adbb86a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107389710>]}
[0m20:10:43.072197 [debug] [MainThread]: Using duckdb connection "master"
[0m20:10:43.072335 [debug] [MainThread]: On master: BEGIN
[0m20:10:43.072461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:10:43.072708 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:10:43.072872 [debug] [MainThread]: On master: COMMIT
[0m20:10:43.073008 [debug] [MainThread]: Using duckdb connection "master"
[0m20:10:43.073133 [debug] [MainThread]: On master: COMMIT
[0m20:10:43.073326 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:10:43.073457 [debug] [MainThread]: On master: Close
[0m20:10:43.074452 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:10:43.074642 [info ] [Thread-1 (]: 1 of 13 START test source_not_null_raw_events_event_id ......................... [RUN]
[0m20:10:43.074868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2)
[0m20:10:43.075030 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:10:43.083991 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:10:43.084528 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:10:43.092332 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
[0m20:10:43.100745 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:10:43.100990 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: BEGIN
[0m20:10:43.101154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.101495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.101649 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:10:43.101807 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where event_id is null



  
  
    );
  
  
    
[0m20:10:43.105841 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where event_id is null



  
  
    );
  
  
    
[0m20:10:43.106023 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.106236 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: ROLLBACK
[0m20:10:43.111593 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2'
[0m20:10:43.111824 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: Close
[0m20:10:43.113775 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:10:43.114035 [error] [Thread-1 (]: 1 of 13 ERROR source_not_null_raw_events_event_id .............................. [[31mERROR[0m in 0.04s]
[0m20:10:43.114387 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:10:43.114595 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:10:43.114841 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:10:43.115044 [info ] [Thread-1 (]: 2 of 13 START test source_not_null_raw_events_timestamp ........................ [RUN]
[0m20:10:43.115580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2, now test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05)
[0m20:10:43.115757 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:10:43.117731 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:10:43.118281 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:10:43.119302 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
[0m20:10:43.119756 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:10:43.119922 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: BEGIN
[0m20:10:43.120069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.120384 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.120542 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:10:43.120706 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where timestamp is null



  
  
    );
  
  
    
[0m20:10:43.121137 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where timestamp is null



  
  
    );
  
  
    
[0m20:10:43.121303 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.121499 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: ROLLBACK
[0m20:10:43.123438 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05'
[0m20:10:43.123601 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: Close
[0m20:10:43.125456 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:10:43.125684 [error] [Thread-1 (]: 2 of 13 ERROR source_not_null_raw_events_timestamp ............................. [[31mERROR[0m in 0.01s]
[0m20:10:43.125940 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:10:43.126124 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:10:43.126339 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:10:43.126517 [info ] [Thread-1 (]: 3 of 13 START test source_not_null_raw_events_user_id .......................... [RUN]
[0m20:10:43.126755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05, now test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1)
[0m20:10:43.126922 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:10:43.129126 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:10:43.129730 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:10:43.130771 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
[0m20:10:43.131255 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:10:43.131424 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: BEGIN
[0m20:10:43.131577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.131874 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.132032 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:10:43.132194 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where user_id is null



  
  
    );
  
  
    
[0m20:10:43.132584 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where user_id is null



  
  
    );
  
  
    
[0m20:10:43.132746 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.132937 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: ROLLBACK
[0m20:10:43.134892 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1'
[0m20:10:43.135066 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: Close
[0m20:10:43.136930 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:10:43.137160 [error] [Thread-1 (]: 3 of 13 ERROR source_not_null_raw_events_user_id ............................... [[31mERROR[0m in 0.01s]
[0m20:10:43.137414 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:10:43.137597 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:10:43.137816 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:10:43.137998 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_raw_orders_order_id ......................... [RUN]
[0m20:10:43.138238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1, now test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f)
[0m20:10:43.138404 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:10:43.140556 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:10:43.140920 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:10:43.141876 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
[0m20:10:43.142330 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:10:43.142505 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: BEGIN
[0m20:10:43.142654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.142902 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.143063 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:10:43.143226 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where order_id is null



  
  
    );
  
  
    
[0m20:10:43.143584 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where order_id is null



  
  
    );
  
  
    
[0m20:10:43.143744 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.143934 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: ROLLBACK
[0m20:10:43.145907 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f'
[0m20:10:43.146071 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: Close
[0m20:10:43.148008 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:10:43.148244 [error] [Thread-1 (]: 4 of 13 ERROR source_not_null_raw_orders_order_id .............................. [[31mERROR[0m in 0.01s]
[0m20:10:43.148498 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:10:43.148676 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:10:43.148887 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:10:43.149068 [info ] [Thread-1 (]: 5 of 13 START test source_not_null_raw_orders_total_amount ..................... [RUN]
[0m20:10:43.149302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f, now test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec)
[0m20:10:43.149468 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:10:43.151541 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:10:43.151916 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:10:43.152885 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
[0m20:10:43.153343 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:10:43.153507 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: BEGIN
[0m20:10:43.153660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.153947 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.154110 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:10:43.154275 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:10:43.154651 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:10:43.154813 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.155006 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: ROLLBACK
[0m20:10:43.156973 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec'
[0m20:10:43.157137 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: Close
[0m20:10:43.158972 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:10:43.159193 [error] [Thread-1 (]: 5 of 13 ERROR source_not_null_raw_orders_total_amount .......................... [[31mERROR[0m in 0.01s]
[0m20:10:43.159442 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:10:43.159618 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:10:43.159832 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:10:43.160013 [info ] [Thread-1 (]: 6 of 13 START test source_not_null_raw_orders_user_id .......................... [RUN]
[0m20:10:43.160244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec, now test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd)
[0m20:10:43.160411 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:10:43.162413 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:10:43.162934 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:10:43.164288 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
[0m20:10:43.164823 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:10:43.165002 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: BEGIN
[0m20:10:43.165165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.165609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.165779 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:10:43.165946 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where user_id is null



  
  
    );
  
  
    
[0m20:10:43.166382 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where user_id is null



  
  
    );
  
  
    
[0m20:10:43.166546 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.166750 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: ROLLBACK
[0m20:10:43.168844 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd'
[0m20:10:43.169014 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: Close
[0m20:10:43.170858 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:10:43.171088 [error] [Thread-1 (]: 6 of 13 ERROR source_not_null_raw_orders_user_id ............................... [[31mERROR[0m in 0.01s]
[0m20:10:43.171347 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:10:43.171526 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:10:43.171744 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:10:43.171922 [info ] [Thread-1 (]: 7 of 13 START test source_not_null_raw_users_created_at ........................ [RUN]
[0m20:10:43.172157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd, now test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5)
[0m20:10:43.172321 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:10:43.174260 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:10:43.174706 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:10:43.175953 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
[0m20:10:43.176413 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:10:43.176583 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: BEGIN
[0m20:10:43.176735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.177033 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.177197 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:10:43.177362 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where created_at is null



  
  
    );
  
  
    
[0m20:10:43.177775 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where created_at is null



  
  
    );
  
  
    
[0m20:10:43.177951 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.178150 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: ROLLBACK
[0m20:10:43.180089 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5'
[0m20:10:43.180258 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: Close
[0m20:10:43.182406 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:10:43.182657 [error] [Thread-1 (]: 7 of 13 ERROR source_not_null_raw_users_created_at ............................. [[31mERROR[0m in 0.01s]
[0m20:10:43.182910 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:10:43.183090 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:10:43.183302 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:10:43.183490 [info ] [Thread-1 (]: 8 of 13 START test source_not_null_raw_users_email ............................. [RUN]
[0m20:10:43.183745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5, now test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5)
[0m20:10:43.183916 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:10:43.185883 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:10:43.186263 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:10:43.187245 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
[0m20:10:43.187705 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:10:43.187873 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: BEGIN
[0m20:10:43.188025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.188358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.188525 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:10:43.188691 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where email is null



  
  
    );
  
  
    
[0m20:10:43.189100 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where email is null



  
  
    );
  
  
    
[0m20:10:43.189265 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.189455 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: ROLLBACK
[0m20:10:43.191401 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5'
[0m20:10:43.191568 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: Close
[0m20:10:43.193403 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:10:43.193620 [error] [Thread-1 (]: 8 of 13 ERROR source_not_null_raw_users_email .................................. [[31mERROR[0m in 0.01s]
[0m20:10:43.193876 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:10:43.194058 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:10:43.194271 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:10:43.194469 [info ] [Thread-1 (]: 9 of 13 START test source_not_null_raw_users_user_id ........................... [RUN]
[0m20:10:43.194711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5, now test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c)
[0m20:10:43.194882 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:10:43.197038 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:10:43.197446 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:10:43.198516 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
[0m20:10:43.198962 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:10:43.199121 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: BEGIN
[0m20:10:43.199268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.199564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.199714 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:10:43.199867 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where user_id is null



  
  
    );
  
  
    
[0m20:10:43.200255 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where user_id is null



  
  
    );
  
  
    
[0m20:10:43.200417 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.200607 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: ROLLBACK
[0m20:10:43.202534 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c'
[0m20:10:43.202694 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: Close
[0m20:10:43.204513 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:10:43.204737 [error] [Thread-1 (]: 9 of 13 ERROR source_not_null_raw_users_user_id ................................ [[31mERROR[0m in 0.01s]
[0m20:10:43.204993 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:10:43.205175 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:10:43.205397 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:10:43.205589 [info ] [Thread-1 (]: 10 of 13 START test source_unique_raw_events_event_id .......................... [RUN]
[0m20:10:43.205839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c, now test.sbdk_project.source_unique_raw_events_event_id.825f404073)
[0m20:10:43.206007 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:10:43.209237 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:10:43.209764 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:10:43.210717 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
[0m20:10:43.211178 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:10:43.211382 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: BEGIN
[0m20:10:43.211545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.211864 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.212045 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:10:43.212211 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_events_event_id.825f404073"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."raw"."events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:10:43.212641 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_events_event_id.825f404073"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."raw"."events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:10:43.212822 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.213021 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: ROLLBACK
[0m20:10:43.215077 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_events_event_id.825f404073'
[0m20:10:43.215764 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: Close
[0m20:10:43.217688 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^
[0m20:10:43.217922 [error] [Thread-1 (]: 10 of 13 ERROR source_unique_raw_events_event_id ............................... [[31mERROR[0m in 0.01s]
[0m20:10:43.218334 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:10:43.218528 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:10:43.218881 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_events_event_id.825f404073' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^.
[0m20:10:43.218702 [info ] [Thread-1 (]: 11 of 13 START test source_unique_raw_orders_order_id .......................... [RUN]
[0m20:10:43.219153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_events_event_id.825f404073, now test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f)
[0m20:10:43.219312 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:10:43.221366 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:10:43.221783 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:10:43.223120 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
[0m20:10:43.223596 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:10:43.223771 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: BEGIN
[0m20:10:43.223922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.224232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.224391 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:10:43.224549 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."raw"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:10:43.224973 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."raw"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:10:43.225145 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.225339 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: ROLLBACK
[0m20:10:43.227282 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f'
[0m20:10:43.227455 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: Close
[0m20:10:43.229361 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^
[0m20:10:43.229587 [error] [Thread-1 (]: 11 of 13 ERROR source_unique_raw_orders_order_id ............................... [[31mERROR[0m in 0.01s]
[0m20:10:43.229845 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:10:43.230026 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:10:43.230244 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^.
[0m20:10:43.230432 [info ] [Thread-1 (]: 12 of 13 START test source_unique_raw_users_email .............................. [RUN]
[0m20:10:43.230703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f, now test.sbdk_project.source_unique_raw_users_email.ab11a6771a)
[0m20:10:43.230899 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:10:43.232841 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:10:43.233303 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:10:43.234554 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
[0m20:10:43.235005 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:10:43.235171 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: BEGIN
[0m20:10:43.235321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.235641 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.235800 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:10:43.235962 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:10:43.236384 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:10:43.236546 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.236735 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: ROLLBACK
[0m20:10:43.238794 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_users_email.ab11a6771a'
[0m20:10:43.238965 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: Close
[0m20:10:43.240903 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:10:43.241140 [error] [Thread-1 (]: 12 of 13 ERROR source_unique_raw_users_email ................................... [[31mERROR[0m in 0.01s]
[0m20:10:43.241399 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:10:43.241581 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:10:43.241805 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_users_email.ab11a6771a' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^.
[0m20:10:43.241986 [info ] [Thread-1 (]: 13 of 13 START test source_unique_raw_users_user_id ............................ [RUN]
[0m20:10:43.242235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_users_email.ab11a6771a, now test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c)
[0m20:10:43.242405 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:10:43.244363 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:10:43.244782 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:10:43.245778 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
[0m20:10:43.247949 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:10:43.248140 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: BEGIN
[0m20:10:43.248288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:43.248600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:43.248757 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:10:43.248922 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:10:43.249351 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:10:43.249514 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:10:43.249710 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: ROLLBACK
[0m20:10:43.251731 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c'
[0m20:10:43.251903 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: Close
[0m20:10:43.253792 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:10:43.254019 [error] [Thread-1 (]: 13 of 13 ERROR source_unique_raw_users_user_id ................................. [[31mERROR[0m in 0.01s]
[0m20:10:43.254272 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:10:43.254510 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^.
[0m20:10:43.255238 [debug] [MainThread]: Using duckdb connection "master"
[0m20:10:43.255379 [debug] [MainThread]: On master: BEGIN
[0m20:10:43.255499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:10:43.255744 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:10:43.255875 [debug] [MainThread]: On master: COMMIT
[0m20:10:43.255997 [debug] [MainThread]: Using duckdb connection "master"
[0m20:10:43.256117 [debug] [MainThread]: On master: COMMIT
[0m20:10:43.256302 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:10:43.256431 [debug] [MainThread]: On master: Close
[0m20:10:43.256591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:43.256952 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c' was properly closed.
[0m20:10:43.257097 [info ] [MainThread]: 
[0m20:10:43.257243 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m20:10:43.258249 [debug] [MainThread]: Command end result
[0m20:10:43.271412 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:10:43.272424 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:10:43.276065 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:10:43.276232 [info ] [MainThread]: 
[0m20:10:43.276415 [info ] [MainThread]: [31mCompleted with 13 errors, 0 partial successes, and 0 warnings:[0m
[0m20:10:43.276565 [info ] [MainThread]: 
[0m20:10:43.276892 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_event_id (models/_sources.yml)[0m
[0m20:10:43.277065 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:10:43.277192 [info ] [MainThread]: 
[0m20:10:43.277347 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_event_id.sql
[0m20:10:43.277472 [info ] [MainThread]: 
[0m20:10:43.277629 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  --------------------------------------------------------------------------------
[0m20:10:43.277766 [info ] [MainThread]: 
[0m20:10:43.277933 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_timestamp (models/_sources.yml)[0m
[0m20:10:43.279077 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:10:43.279498 [info ] [MainThread]: 
[0m20:10:43.279655 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_timestamp.sql
[0m20:10:43.279786 [info ] [MainThread]: 
[0m20:10:43.279942 [info ] [MainThread]:   See test failures:
  ---------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  ---------------------------------------------------------------------------------
[0m20:10:43.280076 [info ] [MainThread]: 
[0m20:10:43.280234 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_user_id (models/_sources.yml)[0m
[0m20:10:43.280395 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:10:43.280522 [info ] [MainThread]: 
[0m20:10:43.280677 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_user_id.sql
[0m20:10:43.280901 [info ] [MainThread]: 
[0m20:10:43.281109 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  -------------------------------------------------------------------------------
[0m20:10:43.281276 [info ] [MainThread]: 
[0m20:10:43.281511 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_order_id (models/_sources.yml)[0m
[0m20:10:43.281697 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:10:43.281832 [info ] [MainThread]: 
[0m20:10:43.282047 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_order_id.sql
[0m20:10:43.282226 [info ] [MainThread]: 
[0m20:10:43.282411 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  --------------------------------------------------------------------------------
[0m20:10:43.282558 [info ] [MainThread]: 
[0m20:10:43.282731 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_total_amount (models/_sources.yml)[0m
[0m20:10:43.282998 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:10:43.283133 [info ] [MainThread]: 
[0m20:10:43.283290 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_total_amount.sql
[0m20:10:43.283416 [info ] [MainThread]: 
[0m20:10:43.283575 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  ------------------------------------------------------------------------------------
[0m20:10:43.283710 [info ] [MainThread]: 
[0m20:10:43.283870 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_user_id (models/_sources.yml)[0m
[0m20:10:43.284036 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:10:43.284174 [info ] [MainThread]: 
[0m20:10:43.284321 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_user_id.sql
[0m20:10:43.284497 [info ] [MainThread]: 
[0m20:10:43.284645 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  -------------------------------------------------------------------------------
[0m20:10:43.284775 [info ] [MainThread]: 
[0m20:10:43.285160 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_created_at (models/_sources.yml)[0m
[0m20:10:43.285322 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:10:43.285446 [info ] [MainThread]: 
[0m20:10:43.285596 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_created_at.sql
[0m20:10:43.285717 [info ] [MainThread]: 
[0m20:10:43.285865 [info ] [MainThread]:   See test failures:
  ---------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  ---------------------------------------------------------------------------------
[0m20:10:43.285992 [info ] [MainThread]: 
[0m20:10:43.286144 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_email (models/_sources.yml)[0m
[0m20:10:43.286297 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:10:43.286417 [info ] [MainThread]: 
[0m20:10:43.286564 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_email.sql
[0m20:10:43.286682 [info ] [MainThread]: 
[0m20:10:43.286825 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  ----------------------------------------------------------------------------
[0m20:10:43.286950 [info ] [MainThread]: 
[0m20:10:43.287103 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_user_id (models/_sources.yml)[0m
[0m20:10:43.287258 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:10:43.287378 [info ] [MainThread]: 
[0m20:10:43.287524 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_user_id.sql
[0m20:10:43.287641 [info ] [MainThread]: 
[0m20:10:43.287792 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  ------------------------------------------------------------------------------
[0m20:10:43.287923 [info ] [MainThread]: 
[0m20:10:43.288083 [error] [MainThread]: [31mFailure in test source_unique_raw_events_event_id (models/_sources.yml)[0m
[0m20:10:43.288248 [error] [MainThread]:   Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^
[0m20:10:43.288377 [info ] [MainThread]: 
[0m20:10:43.288531 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_events_event_id.sql
[0m20:10:43.288654 [info ] [MainThread]: 
[0m20:10:43.288807 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  ------------------------------------------------------------------------------
[0m20:10:43.288938 [info ] [MainThread]: 
[0m20:10:43.289099 [error] [MainThread]: [31mFailure in test source_unique_raw_orders_order_id (models/_sources.yml)[0m
[0m20:10:43.289265 [error] [MainThread]:   Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^
[0m20:10:43.289390 [info ] [MainThread]: 
[0m20:10:43.289545 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_orders_order_id.sql
[0m20:10:43.289671 [info ] [MainThread]: 
[0m20:10:43.289830 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  ------------------------------------------------------------------------------
[0m20:10:43.289967 [info ] [MainThread]: 
[0m20:10:43.290131 [error] [MainThread]: [31mFailure in test source_unique_raw_users_email (models/_sources.yml)[0m
[0m20:10:43.290303 [error] [MainThread]:   Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:10:43.290438 [info ] [MainThread]: 
[0m20:10:43.290605 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_users_email.sql
[0m20:10:43.290734 [info ] [MainThread]: 
[0m20:10:43.290892 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  --------------------------------------------------------------------------
[0m20:10:43.291027 [info ] [MainThread]: 
[0m20:10:43.291188 [error] [MainThread]: [31mFailure in test source_unique_raw_users_user_id (models/_sources.yml)[0m
[0m20:10:43.291347 [error] [MainThread]:   Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:10:43.291469 [info ] [MainThread]: 
[0m20:10:43.291620 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_users_user_id.sql
[0m20:10:43.291741 [info ] [MainThread]: 
[0m20:10:43.291889 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  ----------------------------------------------------------------------------
[0m20:10:43.292020 [info ] [MainThread]: 
[0m20:10:43.292169 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=13 SKIP=0 NO-OP=0 TOTAL=13
[0m20:10:43.293639 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.7624457, "process_in_blocks": "0", "process_kernel_time": 0.184455, "process_mem_max_rss": "146145280", "process_out_blocks": "0", "process_user_time": 1.38416}
[0m20:10:43.293906 [debug] [MainThread]: Command `dbt test` failed at 20:10:43.293862 after 0.76 seconds
[0m20:10:43.294097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068dd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106feaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fead00>]}
[0m20:10:43.294277 [debug] [MainThread]: Flushing usage events
[0m20:10:43.825057 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:31.520147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104859a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b7d90>]}


============================== 20:12:31.527226 | 247b091d-221b-4c07-a26d-0806106e5045 ==============================
[0m20:12:31.527226 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:12:31.527575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:12:31.537736 [info ] [MainThread]: dbt version: 1.10.6
[0m20:12:31.537998 [info ] [MainThread]: python version: 3.13.5
[0m20:12:31.538152 [info ] [MainThread]: python path: /Users/mattstrautmann/Documents/GitHub/sbdk-dev/.venv/bin/python3
[0m20:12:31.538299 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m20:12:31.603700 [info ] [MainThread]: Using profiles dir at /Users/mattstrautmann/.dbt
[0m20:12:31.603977 [info ] [MainThread]: Using profiles.yml file at /Users/mattstrautmann/.dbt/profiles.yml
[0m20:12:31.604127 [info ] [MainThread]: Using dbt_project.yml file at /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/dbt_project.yml
[0m20:12:31.605389 [info ] [MainThread]: adapter type: duckdb
[0m20:12:31.605579 [info ] [MainThread]: adapter version: 1.9.4
[0m20:12:31.668958 [info ] [MainThread]: Configuration:
[0m20:12:31.669258 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:12:31.669414 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:12:31.669554 [info ] [MainThread]: Required dependencies:
[0m20:12:31.669789 [debug] [MainThread]: Executing "git --help"
[0m20:12:31.687394 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:12:31.687982 [debug] [MainThread]: STDERR: "b''"
[0m20:12:31.688174 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:12:31.688349 [info ] [MainThread]: Connection:
[0m20:12:31.688520 [info ] [MainThread]:   database: dev
[0m20:12:31.688669 [info ] [MainThread]:   schema: main
[0m20:12:31.688795 [info ] [MainThread]:   path: /Users/mattstrautmann/Documents/GitHub/sbdk-dev/sbdk-starter/demo_project/data/dev.duckdb
[0m20:12:31.688919 [info ] [MainThread]:   config_options: None
[0m20:12:31.689042 [info ] [MainThread]:   extensions: None
[0m20:12:31.689163 [info ] [MainThread]:   settings: {}
[0m20:12:31.689283 [info ] [MainThread]:   external_root: .
[0m20:12:31.689402 [info ] [MainThread]:   use_credential_provider: None
[0m20:12:31.689521 [info ] [MainThread]:   attach: None
[0m20:12:31.689636 [info ] [MainThread]:   filesystems: None
[0m20:12:31.689751 [info ] [MainThread]:   remote: None
[0m20:12:31.689878 [info ] [MainThread]:   plugins: None
[0m20:12:31.689997 [info ] [MainThread]:   disable_transactions: False
[0m20:12:31.690353 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:12:31.745765 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:12:31.783709 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:12:31.784093 [debug] [MainThread]: On debug: select 1 as id
[0m20:12:31.784251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:12:31.797579 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m20:12:31.798241 [debug] [MainThread]: On debug: Close
[0m20:12:31.798453 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:12:31.798620 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:12:31.800240 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.33322114, "process_in_blocks": "0", "process_kernel_time": 0.195975, "process_mem_max_rss": "134643712", "process_out_blocks": "0", "process_user_time": 0.956724}
[0m20:12:31.800514 [debug] [MainThread]: Command `dbt debug` succeeded at 20:12:31.800456 after 0.33 seconds
[0m20:12:31.800688 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:12:31.800870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dac9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b49b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a18160>]}
[0m20:12:31.801085 [debug] [MainThread]: Flushing usage events
[0m20:12:32.264718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:44.714659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108695a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf3d90>]}


============================== 20:12:44.718041 | 888e4ef7-e436-4767-97a2-2af70d42a7f5 ==============================
[0m20:12:44.718041 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:12:44.718358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select source:raw', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:12:44.862808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '888e4ef7-e436-4767-97a2-2af70d42a7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b556e0>]}
[0m20:12:44.904049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '888e4ef7-e436-4767-97a2-2af70d42a7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec6ad0>]}
[0m20:12:44.905594 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:12:44.963113 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:12:45.043869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:12:45.044214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:12:45.047966 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:12:45.071049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '888e4ef7-e436-4767-97a2-2af70d42a7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d03d50>]}
[0m20:12:45.119013 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:12:45.120673 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:12:45.139482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '888e4ef7-e436-4767-97a2-2af70d42a7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4f97c0>]}
[0m20:12:45.139776 [info ] [MainThread]: Found 5 models, 13 data tests, 3 sources, 429 macros
[0m20:12:45.139949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888e4ef7-e436-4767-97a2-2af70d42a7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a55cbb0>]}
[0m20:12:45.141005 [info ] [MainThread]: 
[0m20:12:45.141189 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:12:45.141324 [info ] [MainThread]: 
[0m20:12:45.141575 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:12:45.144260 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:12:45.177403 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:12:45.177639 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:12:45.177788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:45.193005 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:12:45.193862 [debug] [ThreadPool]: On list_dev: Close
[0m20:12:45.194246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:12:45.194970 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:12:45.198693 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:12:45.198916 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:12:45.199070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:45.199785 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:12:45.200438 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:12:45.200581 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:12:45.200790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:45.200925 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:12:45.201059 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:12:45.201470 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:45.201862 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:12:45.201995 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:12:45.202116 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:12:45.202298 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:45.202432 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:12:45.203477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main_dbt_test__audit)
[0m20:12:45.206314 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:12:45.206489 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:12:45.206631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:45.206878 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:45.207016 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:12:45.207160 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:12:45.215253 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:12:45.255152 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:12:45.256429 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:12:45.256705 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:12:45.257016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:12:45.258040 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:12:45.258198 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:12:45.258330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:45.258639 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:45.258777 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:12:45.258923 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:12:45.261134 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:12:45.261887 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:12:45.262194 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:12:45.262405 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:12:45.263479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888e4ef7-e436-4767-97a2-2af70d42a7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a1300>]}
[0m20:12:45.264601 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:45.264773 [debug] [MainThread]: On master: BEGIN
[0m20:12:45.264910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:12:45.265231 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:12:45.265408 [debug] [MainThread]: On master: COMMIT
[0m20:12:45.265558 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:45.265691 [debug] [MainThread]: On master: COMMIT
[0m20:12:45.265887 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:12:45.266027 [debug] [MainThread]: On master: Close
[0m20:12:45.267808 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:12:45.268010 [info ] [Thread-1 (]: 1 of 13 START test source_not_null_raw_events_event_id ......................... [RUN]
[0m20:12:45.268224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2)
[0m20:12:45.268393 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:12:45.277398 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:12:45.278143 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:12:45.286265 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
[0m20:12:45.294757 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:12:45.295025 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: BEGIN
[0m20:12:45.295197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.295559 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:45.295732 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"
[0m20:12:45.295914 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where event_id is null



  
  
    );
  
  
    
[0m20:12:45.296706 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where event_id is null



  
  
    );
  
  
    
[0m20:12:45.296926 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.297171 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: ROLLBACK
[0m20:12:45.304318 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2'
[0m20:12:45.304530 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2: Close
[0m20:12:45.306494 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:12:45.306756 [error] [Thread-1 (]: 1 of 13 ERROR source_not_null_raw_events_event_id .............................. [[31mERROR[0m in 0.04s]
[0m20:12:45.307041 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2
[0m20:12:45.307233 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:12:45.307476 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:12:45.307675 [info ] [Thread-1 (]: 2 of 13 START test source_not_null_raw_events_timestamp ........................ [RUN]
[0m20:12:45.308225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_event_id.1893a9eae2, now test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05)
[0m20:12:45.308411 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:12:45.310418 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:12:45.311021 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:12:45.312010 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
[0m20:12:45.312497 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:12:45.312675 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: BEGIN
[0m20:12:45.312825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.313126 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:45.313293 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"
[0m20:12:45.313466 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where timestamp is null



  
  
    );
  
  
    
[0m20:12:45.313883 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where timestamp is null



  
  
    );
  
  
    
[0m20:12:45.314060 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.314265 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: ROLLBACK
[0m20:12:45.316208 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05'
[0m20:12:45.316382 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05: Close
[0m20:12:45.318220 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:12:45.318453 [error] [Thread-1 (]: 2 of 13 ERROR source_not_null_raw_events_timestamp ............................. [[31mERROR[0m in 0.01s]
[0m20:12:45.318712 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05
[0m20:12:45.318904 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:12:45.319115 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:12:45.319292 [info ] [Thread-1 (]: 3 of 13 START test source_not_null_raw_events_user_id .......................... [RUN]
[0m20:12:45.319527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_timestamp.0a96d78a05, now test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1)
[0m20:12:45.319690 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:12:45.321818 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:12:45.322261 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:12:45.323250 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
[0m20:12:45.323703 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:12:45.323872 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: BEGIN
[0m20:12:45.324024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.324331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:45.324514 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"
[0m20:12:45.324685 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where user_id is null



  
  
    );
  
  
    
[0m20:12:45.325078 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."events"
where user_id is null



  
  
    );
  
  
    
[0m20:12:45.325248 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.325444 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: ROLLBACK
[0m20:12:45.327364 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1'
[0m20:12:45.327545 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1: Close
[0m20:12:45.329536 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:12:45.329786 [error] [Thread-1 (]: 3 of 13 ERROR source_not_null_raw_events_user_id ............................... [[31mERROR[0m in 0.01s]
[0m20:12:45.330051 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1
[0m20:12:45.330242 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:12:45.330480 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^.
[0m20:12:45.330684 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_raw_orders_order_id ......................... [RUN]
[0m20:12:45.330959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_events_user_id.7468b6e0b1, now test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f)
[0m20:12:45.331141 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:12:45.333623 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:12:45.334165 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:12:45.335189 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
[0m20:12:45.335653 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:12:45.335820 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: BEGIN
[0m20:12:45.335970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.336293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:45.336457 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"
[0m20:12:45.336622 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where order_id is null



  
  
    );
  
  
    
[0m20:12:45.337071 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where order_id is null



  
  
    );
  
  
    
[0m20:12:45.337245 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.337451 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: ROLLBACK
[0m20:12:45.339627 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f'
[0m20:12:45.339826 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f: Close
[0m20:12:45.342063 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:12:45.342356 [error] [Thread-1 (]: 4 of 13 ERROR source_not_null_raw_orders_order_id .............................. [[31mERROR[0m in 0.01s]
[0m20:12:45.342632 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f
[0m20:12:45.342823 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:12:45.343045 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:12:45.343235 [info ] [Thread-1 (]: 5 of 13 START test source_not_null_raw_orders_total_amount ..................... [RUN]
[0m20:12:45.343503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_order_id.03a065a98f, now test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec)
[0m20:12:45.343678 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:12:45.346054 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:12:45.346895 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:12:45.348052 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
[0m20:12:45.348535 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:12:45.348709 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: BEGIN
[0m20:12:45.348861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.349191 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:45.349357 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"
[0m20:12:45.349524 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:12:45.349953 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:12:45.350125 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.350328 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: ROLLBACK
[0m20:12:45.352307 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec'
[0m20:12:45.352477 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec: Close
[0m20:12:45.354345 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:12:45.354567 [error] [Thread-1 (]: 5 of 13 ERROR source_not_null_raw_orders_total_amount .......................... [[31mERROR[0m in 0.01s]
[0m20:12:45.354826 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec
[0m20:12:45.355008 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:12:45.355234 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:12:45.355433 [info ] [Thread-1 (]: 6 of 13 START test source_not_null_raw_orders_user_id .......................... [RUN]
[0m20:12:45.355693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_total_amount.36d4c28fec, now test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd)
[0m20:12:45.355873 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:12:45.357817 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:12:45.358426 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:12:45.359736 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
[0m20:12:45.360218 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:12:45.360385 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: BEGIN
[0m20:12:45.360533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.360836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:45.360999 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"
[0m20:12:45.361165 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where user_id is null



  
  
    );
  
  
    
[0m20:12:45.361591 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."orders"
where user_id is null



  
  
    );
  
  
    
[0m20:12:45.361758 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.361957 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: ROLLBACK
[0m20:12:45.364082 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd'
[0m20:12:45.364300 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd: Close
[0m20:12:45.366270 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:12:45.366517 [error] [Thread-1 (]: 6 of 13 ERROR source_not_null_raw_orders_user_id ............................... [[31mERROR[0m in 0.01s]
[0m20:12:45.366790 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd
[0m20:12:45.366976 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:12:45.367190 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^.
[0m20:12:45.367384 [info ] [Thread-1 (]: 7 of 13 START test source_not_null_raw_users_created_at ........................ [RUN]
[0m20:12:45.367640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_orders_user_id.1c0db495dd, now test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5)
[0m20:12:45.367814 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:12:45.369820 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:12:45.370359 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:12:45.371626 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
[0m20:12:45.372119 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:12:45.372294 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: BEGIN
[0m20:12:45.372446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.372755 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:45.372922 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"
[0m20:12:45.373089 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where created_at is null



  
  
    );
  
  
    
[0m20:12:45.373508 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where created_at is null



  
  
    );
  
  
    
[0m20:12:45.373677 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.373876 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: ROLLBACK
[0m20:12:45.375802 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5'
[0m20:12:45.375975 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5: Close
[0m20:12:45.377858 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:12:45.378108 [error] [Thread-1 (]: 7 of 13 ERROR source_not_null_raw_users_created_at ............................. [[31mERROR[0m in 0.01s]
[0m20:12:45.378372 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5
[0m20:12:45.378561 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:12:45.378786 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:12:45.378998 [info ] [Thread-1 (]: 8 of 13 START test source_not_null_raw_users_email ............................. [RUN]
[0m20:12:45.379323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_created_at.9a9fce61f5, now test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5)
[0m20:12:45.379501 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:12:45.381663 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:12:45.382217 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:12:45.383228 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
[0m20:12:45.383697 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:12:45.383869 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: BEGIN
[0m20:12:45.384023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.384348 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:45.384513 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"
[0m20:12:45.384677 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where email is null



  
  
    );
  
  
    
[0m20:12:45.385091 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where email is null



  
  
    );
  
  
    
[0m20:12:45.385260 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.385469 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: ROLLBACK
[0m20:12:45.387783 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5'
[0m20:12:45.388510 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5: Close
[0m20:12:45.390906 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:12:45.391219 [error] [Thread-1 (]: 8 of 13 ERROR source_not_null_raw_users_email .................................. [[31mERROR[0m in 0.01s]
[0m20:12:45.391497 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5
[0m20:12:45.391687 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:12:45.391911 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:12:45.392107 [info ] [Thread-1 (]: 9 of 13 START test source_not_null_raw_users_user_id ........................... [RUN]
[0m20:12:45.392390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_email.a636a2f7e5, now test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c)
[0m20:12:45.392566 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:12:45.394942 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:12:45.395644 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:12:45.397075 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
[0m20:12:45.397638 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:12:45.397815 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: BEGIN
[0m20:12:45.397969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.398300 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:45.398465 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"
[0m20:12:45.398630 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where user_id is null



  
  
    );
  
  
    
[0m20:12:45.399060 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."users"
where user_id is null



  
  
    );
  
  
    
[0m20:12:45.399227 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.399429 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: ROLLBACK
[0m20:12:45.401459 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c'
[0m20:12:45.401645 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c: Close
[0m20:12:45.403666 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:12:45.403938 [error] [Thread-1 (]: 9 of 13 ERROR source_not_null_raw_users_user_id ................................ [[31mERROR[0m in 0.01s]
[0m20:12:45.404223 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c
[0m20:12:45.404417 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:12:45.404659 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^.
[0m20:12:45.404859 [info ] [Thread-1 (]: 10 of 13 START test source_unique_raw_events_event_id .......................... [RUN]
[0m20:12:45.405140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_users_user_id.7b2e734e5c, now test.sbdk_project.source_unique_raw_events_event_id.825f404073)
[0m20:12:45.405329 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:12:45.409174 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:12:45.410500 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:12:45.411637 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
[0m20:12:45.412117 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:12:45.412298 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: BEGIN
[0m20:12:45.412488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.413234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:12:45.413421 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_events_event_id.825f404073"
[0m20:12:45.413599 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_events_event_id.825f404073"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."raw"."events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:12:45.414067 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_events_event_id.825f404073"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."raw"."events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:12:45.414239 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.414445 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: ROLLBACK
[0m20:12:45.416450 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_events_event_id.825f404073'
[0m20:12:45.416627 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_events_event_id.825f404073: Close
[0m20:12:45.418527 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^
[0m20:12:45.418762 [error] [Thread-1 (]: 10 of 13 ERROR source_unique_raw_events_event_id ............................... [[31mERROR[0m in 0.01s]
[0m20:12:45.419501 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_events_event_id.825f404073
[0m20:12:45.419690 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:12:45.419862 [info ] [Thread-1 (]: 11 of 13 START test source_unique_raw_orders_order_id .......................... [RUN]
[0m20:12:45.420099 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_events_event_id.825f404073' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^.
[0m20:12:45.420300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_events_event_id.825f404073, now test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f)
[0m20:12:45.420518 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:12:45.422458 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:12:45.423047 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:12:45.424345 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
[0m20:12:45.424816 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:12:45.424990 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: BEGIN
[0m20:12:45.425145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.425447 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:45.425603 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"
[0m20:12:45.425765 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."raw"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:12:45.426170 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."raw"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:12:45.426347 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.426544 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: ROLLBACK
[0m20:12:45.428524 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f'
[0m20:12:45.428702 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f: Close
[0m20:12:45.430592 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^
[0m20:12:45.430823 [error] [Thread-1 (]: 11 of 13 ERROR source_unique_raw_orders_order_id ............................... [[31mERROR[0m in 0.01s]
[0m20:12:45.431086 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f
[0m20:12:45.431271 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:12:45.431491 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^.
[0m20:12:45.431672 [info ] [Thread-1 (]: 12 of 13 START test source_unique_raw_users_email .............................. [RUN]
[0m20:12:45.431919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_orders_order_id.2e0765462f, now test.sbdk_project.source_unique_raw_users_email.ab11a6771a)
[0m20:12:45.432093 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:12:45.434012 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:12:45.434595 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:12:45.435842 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
[0m20:12:45.436313 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:12:45.436483 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: BEGIN
[0m20:12:45.436632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.436931 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:45.437084 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"
[0m20:12:45.437248 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:12:45.437686 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_email.ab11a6771a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:12:45.437852 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.438048 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: ROLLBACK
[0m20:12:45.439993 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_users_email.ab11a6771a'
[0m20:12:45.440161 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_email.ab11a6771a: Close
[0m20:12:45.442047 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:12:45.442293 [error] [Thread-1 (]: 12 of 13 ERROR source_unique_raw_users_email ................................... [[31mERROR[0m in 0.01s]
[0m20:12:45.442558 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_email.ab11a6771a
[0m20:12:45.442744 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:12:45.442966 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_users_email.ab11a6771a' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^.
[0m20:12:45.443153 [info ] [Thread-1 (]: 13 of 13 START test source_unique_raw_users_user_id ............................ [RUN]
[0m20:12:45.443403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_users_email.ab11a6771a, now test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c)
[0m20:12:45.443571 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:12:45.445497 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:12:45.445924 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:12:45.446962 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
[0m20:12:45.449026 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:12:45.449213 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: BEGIN
[0m20:12:45.449372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.449702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:45.449867 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"
[0m20:12:45.450040 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:12:45.450470 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."raw"."users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:12:45.450638 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:45.450839 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: ROLLBACK
[0m20:12:45.452856 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c'
[0m20:12:45.453030 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c: Close
[0m20:12:45.454848 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:12:45.455067 [error] [Thread-1 (]: 13 of 13 ERROR source_unique_raw_users_user_id ................................. [[31mERROR[0m in 0.01s]
[0m20:12:45.455319 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c
[0m20:12:45.455552 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^.
[0m20:12:45.456163 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:45.456308 [debug] [MainThread]: On master: BEGIN
[0m20:12:45.456427 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:12:45.456647 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:12:45.456779 [debug] [MainThread]: On master: COMMIT
[0m20:12:45.456906 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:45.457021 [debug] [MainThread]: On master: COMMIT
[0m20:12:45.457196 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:12:45.457326 [debug] [MainThread]: On master: Close
[0m20:12:45.457492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:45.457609 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_raw_users_user_id.1efe4afa3c' was properly closed.
[0m20:12:45.457745 [info ] [MainThread]: 
[0m20:12:45.457883 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m20:12:45.458901 [debug] [MainThread]: Command end result
[0m20:12:45.471375 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:12:45.472418 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:12:45.476691 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:12:45.476860 [info ] [MainThread]: 
[0m20:12:45.477043 [info ] [MainThread]: [31mCompleted with 13 errors, 0 partial successes, and 0 warnings:[0m
[0m20:12:45.477192 [info ] [MainThread]: 
[0m20:12:45.477375 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_event_id (models/_sources.yml)[0m
[0m20:12:45.477555 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:12:45.477915 [info ] [MainThread]: 
[0m20:12:45.478128 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_event_id.sql
[0m20:12:45.478274 [info ] [MainThread]: 
[0m20:12:45.478448 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_event_id"
  --------------------------------------------------------------------------------
[0m20:12:45.478593 [info ] [MainThread]: 
[0m20:12:45.478845 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_timestamp (models/_sources.yml)[0m
[0m20:12:45.479111 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:12:45.479249 [info ] [MainThread]: 
[0m20:12:45.479412 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_timestamp.sql
[0m20:12:45.479542 [info ] [MainThread]: 
[0m20:12:45.479697 [info ] [MainThread]:   See test failures:
  ---------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_timestamp"
  ---------------------------------------------------------------------------------
[0m20:12:45.479831 [info ] [MainThread]: 
[0m20:12:45.479994 [error] [MainThread]: [31mFailure in test source_not_null_raw_events_user_id (models/_sources.yml)[0m
[0m20:12:45.480157 [error] [MainThread]:   Runtime Error in test source_not_null_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."events"
                ^
[0m20:12:45.480286 [info ] [MainThread]: 
[0m20:12:45.480442 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_events_user_id.sql
[0m20:12:45.480566 [info ] [MainThread]: 
[0m20:12:45.480715 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_events_user_id"
  -------------------------------------------------------------------------------
[0m20:12:45.480846 [info ] [MainThread]: 
[0m20:12:45.481001 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_order_id (models/_sources.yml)[0m
[0m20:12:45.481165 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:12:45.481291 [info ] [MainThread]: 
[0m20:12:45.481446 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_order_id.sql
[0m20:12:45.481569 [info ] [MainThread]: 
[0m20:12:45.481724 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_order_id"
  --------------------------------------------------------------------------------
[0m20:12:45.481857 [info ] [MainThread]: 
[0m20:12:45.482020 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_total_amount (models/_sources.yml)[0m
[0m20:12:45.482185 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:12:45.482313 [info ] [MainThread]: 
[0m20:12:45.482469 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_total_amount.sql
[0m20:12:45.482593 [info ] [MainThread]: 
[0m20:12:45.482750 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_total_amount"
  ------------------------------------------------------------------------------------
[0m20:12:45.482883 [info ] [MainThread]: 
[0m20:12:45.483046 [error] [MainThread]: [31mFailure in test source_not_null_raw_orders_user_id (models/_sources.yml)[0m
[0m20:12:45.483209 [error] [MainThread]:   Runtime Error in test source_not_null_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 21: from "dev"."raw"."orders"
                ^
[0m20:12:45.483337 [info ] [MainThread]: 
[0m20:12:45.483487 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_orders_user_id.sql
[0m20:12:45.483609 [info ] [MainThread]: 
[0m20:12:45.483765 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_orders_user_id"
  -------------------------------------------------------------------------------
[0m20:12:45.483898 [info ] [MainThread]: 
[0m20:12:45.484060 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_created_at (models/_sources.yml)[0m
[0m20:12:45.484225 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:12:45.484351 [info ] [MainThread]: 
[0m20:12:45.484502 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_created_at.sql
[0m20:12:45.484625 [info ] [MainThread]: 
[0m20:12:45.484773 [info ] [MainThread]:   See test failures:
  ---------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_created_at"
  ---------------------------------------------------------------------------------
[0m20:12:45.484903 [info ] [MainThread]: 
[0m20:12:45.485058 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_email (models/_sources.yml)[0m
[0m20:12:45.485217 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:12:45.485339 [info ] [MainThread]: 
[0m20:12:45.485488 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_email.sql
[0m20:12:45.485607 [info ] [MainThread]: 
[0m20:12:45.485756 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_email"
  ----------------------------------------------------------------------------
[0m20:12:45.485884 [info ] [MainThread]: 
[0m20:12:45.486038 [error] [MainThread]: [31mFailure in test source_not_null_raw_users_user_id (models/_sources.yml)[0m
[0m20:12:45.486195 [error] [MainThread]:   Runtime Error in test source_not_null_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 21: from "dev"."raw"."users"
                ^
[0m20:12:45.486317 [info ] [MainThread]: 
[0m20:12:45.486464 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_users_user_id.sql
[0m20:12:45.486581 [info ] [MainThread]: 
[0m20:12:45.486729 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_users_user_id"
  ------------------------------------------------------------------------------
[0m20:12:45.486856 [info ] [MainThread]: 
[0m20:12:45.487007 [error] [MainThread]: [31mFailure in test source_unique_raw_events_event_id (models/_sources.yml)[0m
[0m20:12:45.487163 [error] [MainThread]:   Runtime Error in test source_unique_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."events"
                ^
[0m20:12:45.487287 [info ] [MainThread]: 
[0m20:12:45.487439 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_events_event_id.sql
[0m20:12:45.487564 [info ] [MainThread]: 
[0m20:12:45.487715 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_events_event_id"
  ------------------------------------------------------------------------------
[0m20:12:45.487845 [info ] [MainThread]: 
[0m20:12:45.487997 [error] [MainThread]: [31mFailure in test source_unique_raw_orders_order_id (models/_sources.yml)[0m
[0m20:12:45.488154 [error] [MainThread]:   Runtime Error in test source_unique_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name orders does not exist!
  Did you mean "dev.stg_orders"?
  
  LINE 22: from "dev"."raw"."orders"
                ^
[0m20:12:45.488277 [info ] [MainThread]: 
[0m20:12:45.488425 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_orders_order_id.sql
[0m20:12:45.488545 [info ] [MainThread]: 
[0m20:12:45.488695 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_orders_order_id"
  ------------------------------------------------------------------------------
[0m20:12:45.488821 [info ] [MainThread]: 
[0m20:12:45.488978 [error] [MainThread]: [31mFailure in test source_unique_raw_users_email (models/_sources.yml)[0m
[0m20:12:45.489142 [error] [MainThread]:   Runtime Error in test source_unique_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:12:45.489270 [info ] [MainThread]: 
[0m20:12:45.489424 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_users_email.sql
[0m20:12:45.489549 [info ] [MainThread]: 
[0m20:12:45.489706 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_users_email"
  --------------------------------------------------------------------------
[0m20:12:45.489840 [info ] [MainThread]: 
[0m20:12:45.490002 [error] [MainThread]: [31mFailure in test source_unique_raw_users_user_id (models/_sources.yml)[0m
[0m20:12:45.490167 [error] [MainThread]:   Runtime Error in test source_unique_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name users does not exist!
  Did you mean "dev.user_metrics"?
  
  LINE 22: from "dev"."raw"."users"
                ^
[0m20:12:45.490295 [info ] [MainThread]: 
[0m20:12:45.490451 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_users_user_id.sql
[0m20:12:45.490577 [info ] [MainThread]: 
[0m20:12:45.490732 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_users_user_id"
  ----------------------------------------------------------------------------
[0m20:12:45.490868 [info ] [MainThread]: 
[0m20:12:45.491025 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=13 SKIP=0 NO-OP=0 TOTAL=13
[0m20:12:45.493518 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.8304098, "process_in_blocks": "0", "process_kernel_time": 0.221367, "process_mem_max_rss": "148062208", "process_out_blocks": "0", "process_user_time": 1.452351}
[0m20:12:45.493803 [debug] [MainThread]: Command `dbt test` failed at 20:12:45.493756 after 0.83 seconds
[0m20:12:45.494013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c25910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a52eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a52ed00>]}
[0m20:12:45.494222 [debug] [MainThread]: Flushing usage events
[0m20:12:46.038995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:29.134809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c15a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b73b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b73d90>]}


============================== 20:13:29.143377 | fc7b9dac-c4b4-4f30-befd-f3d1359712f3 ==============================
[0m20:13:29.143377 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:13:29.143755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt parse', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:13:29.314770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc7b9dac-c4b4-4f30-befd-f3d1359712f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed16e0>]}
[0m20:13:29.354247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc7b9dac-c4b4-4f30-befd-f3d1359712f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10359aad0>]}
[0m20:13:29.356529 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:13:29.414392 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:13:29.495769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m20:13:29.496360 [debug] [MainThread]: Partial parsing: updated file: sbdk_project://models/_sources.yml
[0m20:13:29.496581 [debug] [MainThread]: Partial parsing: updated file: sbdk_project://models/staging/stg_events.sql
[0m20:13:29.496772 [debug] [MainThread]: Partial parsing: updated file: sbdk_project://models/staging/stg_users.sql
[0m20:13:29.496957 [debug] [MainThread]: Partial parsing: updated file: sbdk_project://models/staging/stg_orders.sql
[0m20:13:29.869129 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:13:29.876716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc7b9dac-c4b4-4f30-befd-f3d1359712f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c7f450>]}
[0m20:13:29.879063 [info ] [MainThread]: Performance info: /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/perf_info.json
[0m20:13:29.927783 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:13:29.929234 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:13:29.931153 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.8539934, "process_in_blocks": "0", "process_kernel_time": 0.208623, "process_mem_max_rss": "128253952", "process_out_blocks": "0", "process_user_time": 1.468014}
[0m20:13:29.931691 [debug] [MainThread]: Command `dbt parse` succeeded at 20:13:29.931398 after 0.85 seconds
[0m20:13:29.931911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb0aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a77e70>]}
[0m20:13:29.932100 [debug] [MainThread]: Flushing usage events
[0m20:13:30.558427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:36.660256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114035a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ef3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ef3d90>]}


============================== 20:13:36.663550 | 4fcd8256-aae6-41d9-b516-a49f11578a5a ==============================
[0m20:13:36.663550 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:13:36.663887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:13:36.813501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fcd8256-aae6-41d9-b516-a49f11578a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147516e0>]}
[0m20:13:36.856287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fcd8256-aae6-41d9-b516-a49f11578a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eaaad0>]}
[0m20:13:36.858108 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:13:36.916987 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:13:36.997767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:36.998024 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:37.001701 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:13:37.025843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fcd8256-aae6-41d9-b516-a49f11578a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116103c50>]}
[0m20:13:37.074992 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:13:37.076343 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:13:37.091606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fcd8256-aae6-41d9-b516-a49f11578a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116333890>]}
[0m20:13:37.091950 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:13:37.092129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fcd8256-aae6-41d9-b516-a49f11578a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167584b0>]}
[0m20:13:37.093492 [info ] [MainThread]: 
[0m20:13:37.093687 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:13:37.093826 [info ] [MainThread]: 
[0m20:13:37.094092 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:13:37.097025 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_dbt_test__audit'
[0m20:13:37.142230 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:13:37.142473 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:13:37.142624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:37.220032 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m20:13:37.220309 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:13:37.220481 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:13:37.245553 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m20:13:37.246655 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:13:37.247573 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:13:37.247742 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:13:37.248030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:13:37.249013 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:13:37.249157 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:13:37.249283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:37.249576 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:13:37.249763 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:13:37.249918 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:13:37.252081 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:13:37.252827 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:13:37.253131 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:13:37.253279 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:13:37.254103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fcd8256-aae6-41d9-b516-a49f11578a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116961640>]}
[0m20:13:37.255577 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:13:37.255793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.sbdk_project.stg_events)
[0m20:13:37.255967 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:13:37.301026 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:13:37.301976 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:13:37.302406 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:13:37.302614 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:13:37.302854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:13:37.303033 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:13:37.304918 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:13:37.305640 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:13:37.306015 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:13:37.306212 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:13:37.306423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:13:37.306595 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:13:37.308056 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:13:37.308886 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:13:37.309187 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:13:37.309367 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4
[0m20:13:37.309561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4)
[0m20:13:37.309746 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4
[0m20:13:37.315799 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4"
[0m20:13:37.316484 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4
[0m20:13:37.317133 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4
[0m20:13:37.320368 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d
[0m20:13:37.320627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4, now test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d)
[0m20:13:37.320823 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d
[0m20:13:37.323120 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d"
[0m20:13:37.323687 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d
[0m20:13:37.324102 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d
[0m20:13:37.324318 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3
[0m20:13:37.324538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d, now test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3)
[0m20:13:37.324720 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3
[0m20:13:37.328783 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3"
[0m20:13:37.329289 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3
[0m20:13:37.329631 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3
[0m20:13:37.329826 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6
[0m20:13:37.330037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3, now test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6)
[0m20:13:37.330216 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6
[0m20:13:37.332271 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6"
[0m20:13:37.332686 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6
[0m20:13:37.332986 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6
[0m20:13:37.333165 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15
[0m20:13:37.333378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6, now test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15)
[0m20:13:37.333588 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15
[0m20:13:37.335748 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15"
[0m20:13:37.336097 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15
[0m20:13:37.336407 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15
[0m20:13:37.336585 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf
[0m20:13:37.336766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15, now test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf)
[0m20:13:37.336929 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf
[0m20:13:37.338692 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf"
[0m20:13:37.339019 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf
[0m20:13:37.339306 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf
[0m20:13:37.339480 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97
[0m20:13:37.339664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf, now test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97)
[0m20:13:37.339828 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97
[0m20:13:37.341631 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97"
[0m20:13:37.341974 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97
[0m20:13:37.342267 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97
[0m20:13:37.342441 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58
[0m20:13:37.342619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97, now test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58)
[0m20:13:37.342782 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58
[0m20:13:37.344849 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58"
[0m20:13:37.345174 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58
[0m20:13:37.345477 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58
[0m20:13:37.345664 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14
[0m20:13:37.345856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58, now test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14)
[0m20:13:37.346026 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14
[0m20:13:37.347831 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14"
[0m20:13:37.348162 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14
[0m20:13:37.348463 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14
[0m20:13:37.348645 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473
[0m20:13:37.348833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14, now test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473)
[0m20:13:37.349004 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473
[0m20:13:37.351123 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473"
[0m20:13:37.351479 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473
[0m20:13:37.351795 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473
[0m20:13:37.351982 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e
[0m20:13:37.352173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473, now test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e)
[0m20:13:37.352356 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e
[0m20:13:37.354334 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e"
[0m20:13:37.354750 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e
[0m20:13:37.355078 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e
[0m20:13:37.355671 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9
[0m20:13:37.355918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e, now test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9)
[0m20:13:37.356125 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9
[0m20:13:37.359710 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9"
[0m20:13:37.360196 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9
[0m20:13:37.360540 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9
[0m20:13:37.360728 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945
[0m20:13:37.361071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9, now test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945)
[0m20:13:37.361244 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945
[0m20:13:37.363517 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945"
[0m20:13:37.364220 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945
[0m20:13:37.364540 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945
[0m20:13:37.364840 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044
[0m20:13:37.365049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945, now test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044)
[0m20:13:37.365252 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044
[0m20:13:37.367227 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044"
[0m20:13:37.367688 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044
[0m20:13:37.368035 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044
[0m20:13:37.368233 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85
[0m20:13:37.368444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044, now test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85)
[0m20:13:37.368626 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85
[0m20:13:37.371768 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85"
[0m20:13:37.372318 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85
[0m20:13:37.372709 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85
[0m20:13:37.372962 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:13:37.373223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85, now model.sbdk_project.int_user_activity)
[0m20:13:37.373413 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m20:13:37.375642 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m20:13:37.376487 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m20:13:37.376860 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:13:37.377229 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:13:37.377507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m20:13:37.377709 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m20:13:37.379487 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m20:13:37.380098 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m20:13:37.380420 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:13:37.380849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:37.380992 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m20:13:37.382267 [debug] [MainThread]: Command end result
[0m20:13:37.397529 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:13:37.398686 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:13:37.402948 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:13:37.404974 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.7928657, "process_in_blocks": "0", "process_kernel_time": 0.219791, "process_mem_max_rss": "144408576", "process_out_blocks": "0", "process_user_time": 1.317868}
[0m20:13:37.405279 [debug] [MainThread]: Command `dbt compile` succeeded at 20:13:37.405231 after 0.79 seconds
[0m20:13:37.405491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f25910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1166afee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1166afe30>]}
[0m20:13:37.405696 [debug] [MainThread]: Flushing usage events
[0m20:13:37.779968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:42.654829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a95a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ff3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ff3d90>]}


============================== 20:13:42.658983 | 05293ea0-5366-4050-a68c-089402317148 ==============================
[0m20:13:42.658983 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:13:42.659424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select source:raw', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:13:42.798935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05293ea0-5366-4050-a68c-089402317148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e516e0>]}
[0m20:13:42.840263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05293ea0-5366-4050-a68c-089402317148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113262ad0>]}
[0m20:13:42.841955 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:13:42.898384 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:13:42.979718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:42.979982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:42.983722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:13:43.005311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05293ea0-5366-4050-a68c-089402317148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115103c50>]}
[0m20:13:43.054507 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:13:43.055647 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:13:43.073944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05293ea0-5366-4050-a68c-089402317148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115841b80>]}
[0m20:13:43.074263 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:13:43.074446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05293ea0-5366-4050-a68c-089402317148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158d51d0>]}
[0m20:13:43.075726 [info ] [MainThread]: 
[0m20:13:43.075927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:13:43.076073 [info ] [MainThread]: 
[0m20:13:43.076347 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:13:43.079105 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:13:43.155226 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:13:43.155498 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:13:43.155716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:43.168354 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:13:43.169280 [debug] [ThreadPool]: On list_dev: Close
[0m20:13:43.169660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:13:43.170058 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:13:43.173661 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:13:43.173865 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:13:43.174020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:43.174535 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:13:43.175381 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:13:43.175538 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:13:43.175753 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:13:43.175887 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:13:43.176021 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:13:43.176519 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:13:43.176934 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:13:43.177077 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:13:43.177205 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:13:43.177387 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:13:43.177524 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:13:43.178702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main)
[0m20:13:43.181952 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:13:43.182133 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:13:43.182273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:43.182551 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:13:43.182687 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:13:43.182830 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:13:43.190390 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:13:43.191371 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:13:43.192248 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:13:43.192433 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:13:43.192735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:13:43.194314 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:13:43.194477 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:13:43.194615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:43.194962 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:13:43.195106 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:13:43.195248 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:13:43.197550 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:13:43.198226 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:13:43.198559 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:13:43.198704 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:13:43.199010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05293ea0-5366-4050-a68c-089402317148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115aea9c0>]}
[0m20:13:43.199278 [debug] [MainThread]: Using duckdb connection "master"
[0m20:13:43.199446 [debug] [MainThread]: On master: BEGIN
[0m20:13:43.199586 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:13:43.199837 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:13:43.199978 [debug] [MainThread]: On master: COMMIT
[0m20:13:43.200115 [debug] [MainThread]: Using duckdb connection "master"
[0m20:13:43.200248 [debug] [MainThread]: On master: COMMIT
[0m20:13:43.200459 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:13:43.200627 [debug] [MainThread]: On master: Close
[0m20:13:43.202144 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4
[0m20:13:43.202355 [info ] [Thread-1 (]: 1 of 15 START test source_not_null_raw_raw_events_event_id ..................... [RUN]
[0m20:13:43.202569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4)
[0m20:13:43.202746 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4
[0m20:13:43.211871 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4"
[0m20:13:43.212378 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4
[0m20:13:43.220271 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_event_id"
[0m20:13:43.228282 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4"
[0m20:13:43.228509 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4: BEGIN
[0m20:13:43.228684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.229047 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.229217 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4"
[0m20:13:43.229390 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:13:43.238058 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:13:43.238372 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.238698 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4: ROLLBACK
[0m20:13:43.244583 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4'
[0m20:13:43.244839 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4: Close
[0m20:13:43.246992 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."raw_events"
                ^
[0m20:13:43.247302 [error] [Thread-1 (]: 1 of 15 ERROR source_not_null_raw_raw_events_event_id .......................... [[31mERROR[0m in 0.04s]
[0m20:13:43.247602 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4
[0m20:13:43.247802 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d
[0m20:13:43.248063 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."raw_events"
                ^.
[0m20:13:43.248300 [info ] [Thread-1 (]: 2 of 15 START test source_not_null_raw_raw_events_event_type ................... [RUN]
[0m20:13:43.248920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_events_event_id.b5e74ac7e4, now test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d)
[0m20:13:43.249127 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d
[0m20:13:43.251243 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d"
[0m20:13:43.251652 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d
[0m20:13:43.252692 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_event_type"
[0m20:13:43.253186 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d"
[0m20:13:43.253364 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d: BEGIN
[0m20:13:43.253528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.253943 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.254137 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d"
[0m20:13:43.254319 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:13:43.254798 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:13:43.254986 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.255210 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d: ROLLBACK
[0m20:13:43.257340 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d'
[0m20:13:43.257532 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d: Close
[0m20:13:43.259627 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_events_event_type (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."raw_events"
                ^
[0m20:13:43.259899 [error] [Thread-1 (]: 2 of 15 ERROR source_not_null_raw_raw_events_event_type ........................ [[31mERROR[0m in 0.01s]
[0m20:13:43.260179 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d
[0m20:13:43.260511 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3
[0m20:13:43.260884 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_events_event_type (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."raw_events"
                ^.
[0m20:13:43.260685 [info ] [Thread-1 (]: 3 of 15 START test source_not_null_raw_raw_events_timestamp .................... [RUN]
[0m20:13:43.261331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_events_event_type.4659b87d1d, now test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3)
[0m20:13:43.261515 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3
[0m20:13:43.263923 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3"
[0m20:13:43.264335 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3
[0m20:13:43.265335 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_timestamp"
[0m20:13:43.265811 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3"
[0m20:13:43.265986 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3: BEGIN
[0m20:13:43.266139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.266489 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.266678 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3"
[0m20:13:43.266853 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:13:43.267287 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:13:43.267467 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.267680 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3: ROLLBACK
[0m20:13:43.269697 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3'
[0m20:13:43.269897 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3: Close
[0m20:13:43.272017 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."raw_events"
                ^
[0m20:13:43.272507 [error] [Thread-1 (]: 3 of 15 ERROR source_not_null_raw_raw_events_timestamp ......................... [[31mERROR[0m in 0.01s]
[0m20:13:43.272795 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3
[0m20:13:43.273054 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6
[0m20:13:43.273287 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."raw_events"
                ^.
[0m20:13:43.273499 [info ] [Thread-1 (]: 4 of 15 START test source_not_null_raw_raw_events_user_id ...................... [RUN]
[0m20:13:43.273813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_events_timestamp.9ef40da8d3, now test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6)
[0m20:13:43.274004 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6
[0m20:13:43.276453 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6"
[0m20:13:43.276925 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6
[0m20:13:43.277955 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_user_id"
[0m20:13:43.278432 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6"
[0m20:13:43.278606 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6: BEGIN
[0m20:13:43.278765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.279110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.279281 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6"
[0m20:13:43.279455 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:13:43.280018 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:13:43.280210 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.280467 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6: ROLLBACK
[0m20:13:43.282538 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6'
[0m20:13:43.282711 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6: Close
[0m20:13:43.284594 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."raw_events"
                ^
[0m20:13:43.284879 [error] [Thread-1 (]: 4 of 15 ERROR source_not_null_raw_raw_events_user_id ........................... [[31mERROR[0m in 0.01s]
[0m20:13:43.285153 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6
[0m20:13:43.285344 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15
[0m20:13:43.285567 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."raw_events"
                ^.
[0m20:13:43.285761 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_raw_raw_orders_created_at ................... [RUN]
[0m20:13:43.286014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_events_user_id.4d7ae76ec6, now test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15)
[0m20:13:43.286221 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15
[0m20:13:43.288364 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15"
[0m20:13:43.288904 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15
[0m20:13:43.290262 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_created_at"
[0m20:13:43.290745 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15"
[0m20:13:43.290920 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15: BEGIN
[0m20:13:43.291082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.291407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.291577 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15"
[0m20:13:43.291752 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:13:43.292294 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:13:43.292494 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.292710 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15: ROLLBACK
[0m20:13:43.294734 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15'
[0m20:13:43.295020 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15: Close
[0m20:13:43.297055 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_orders_created_at (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 21: from "dev"."raw"."raw_orders"
                ^
[0m20:13:43.297320 [error] [Thread-1 (]: 5 of 15 ERROR source_not_null_raw_raw_orders_created_at ........................ [[31mERROR[0m in 0.01s]
[0m20:13:43.297593 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15
[0m20:13:43.297792 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf
[0m20:13:43.298015 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_orders_created_at (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 21: from "dev"."raw"."raw_orders"
                ^.
[0m20:13:43.298208 [info ] [Thread-1 (]: 6 of 15 START test source_not_null_raw_raw_orders_order_id ..................... [RUN]
[0m20:13:43.298475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_orders_created_at.500679de15, now test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf)
[0m20:13:43.298655 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf
[0m20:13:43.300819 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf"
[0m20:13:43.301340 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf
[0m20:13:43.302788 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_order_id"
[0m20:13:43.303288 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf"
[0m20:13:43.303463 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf: BEGIN
[0m20:13:43.303623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.303964 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.304131 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf"
[0m20:13:43.304298 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:13:43.304731 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:13:43.304906 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.305106 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf: ROLLBACK
[0m20:13:43.307142 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf'
[0m20:13:43.307323 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf: Close
[0m20:13:43.309438 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 21: from "dev"."raw"."raw_orders"
                ^
[0m20:13:43.309715 [error] [Thread-1 (]: 6 of 15 ERROR source_not_null_raw_raw_orders_order_id .......................... [[31mERROR[0m in 0.01s]
[0m20:13:43.309994 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf
[0m20:13:43.310189 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97
[0m20:13:43.310366 [info ] [Thread-1 (]: 7 of 15 START test source_not_null_raw_raw_orders_total_amount ................. [RUN]
[0m20:13:43.310618 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 21: from "dev"."raw"."raw_orders"
                ^.
[0m20:13:43.310983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_orders_order_id.c81aad1dcf, now test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97)
[0m20:13:43.311257 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97
[0m20:13:43.313318 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97"
[0m20:13:43.313759 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97
[0m20:13:43.314754 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_total_amount"
[0m20:13:43.315473 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97"
[0m20:13:43.315649 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97: BEGIN
[0m20:13:43.315810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.316157 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.316323 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97"
[0m20:13:43.316496 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:13:43.316914 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:13:43.317081 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.317285 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97: ROLLBACK
[0m20:13:43.319269 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97'
[0m20:13:43.319444 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97: Close
[0m20:13:43.321282 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 21: from "dev"."raw"."raw_orders"
                ^
[0m20:13:43.321515 [error] [Thread-1 (]: 7 of 15 ERROR source_not_null_raw_raw_orders_total_amount ...................... [[31mERROR[0m in 0.01s]
[0m20:13:43.321780 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97
[0m20:13:43.321971 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58
[0m20:13:43.322142 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_raw_raw_orders_user_id ...................... [RUN]
[0m20:13:43.322393 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 21: from "dev"."raw"."raw_orders"
                ^.
[0m20:13:43.322599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_orders_total_amount.f570071c97, now test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58)
[0m20:13:43.322838 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58
[0m20:13:43.324777 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58"
[0m20:13:43.325194 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58
[0m20:13:43.326413 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_user_id"
[0m20:13:43.326925 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58"
[0m20:13:43.327108 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58: BEGIN
[0m20:13:43.327270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.327599 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.327765 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58"
[0m20:13:43.327939 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:13:43.328369 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:13:43.328548 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.328750 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58: ROLLBACK
[0m20:13:43.330761 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58'
[0m20:13:43.330938 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58: Close
[0m20:13:43.332796 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 21: from "dev"."raw"."raw_orders"
                ^
[0m20:13:43.333030 [error] [Thread-1 (]: 8 of 15 ERROR source_not_null_raw_raw_orders_user_id ........................... [[31mERROR[0m in 0.01s]
[0m20:13:43.333294 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58
[0m20:13:43.333485 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14
[0m20:13:43.333648 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_raw_raw_users_created_at .................... [RUN]
[0m20:13:43.333877 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 21: from "dev"."raw"."raw_orders"
                ^.
[0m20:13:43.334071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_orders_user_id.94f29f5c58, now test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14)
[0m20:13:43.334295 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14
[0m20:13:43.336501 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14"
[0m20:13:43.336913 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14
[0m20:13:43.337899 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_created_at"
[0m20:13:43.338375 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14"
[0m20:13:43.338546 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14: BEGIN
[0m20:13:43.338707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.339004 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.339183 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14"
[0m20:13:43.339353 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:13:43.339755 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:13:43.339931 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.340136 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14: ROLLBACK
[0m20:13:43.342144 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14'
[0m20:13:43.342316 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14: Close
[0m20:13:43.344193 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 21: from "dev"."raw"."raw_users"
                ^
[0m20:13:43.344429 [error] [Thread-1 (]: 9 of 15 ERROR source_not_null_raw_raw_users_created_at ......................... [[31mERROR[0m in 0.01s]
[0m20:13:43.344687 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14
[0m20:13:43.344869 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473
[0m20:13:43.345083 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 21: from "dev"."raw"."raw_users"
                ^.
[0m20:13:43.345266 [info ] [Thread-1 (]: 10 of 15 START test source_not_null_raw_raw_users_email ........................ [RUN]
[0m20:13:43.345491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14, now test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473)
[0m20:13:43.345657 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473
[0m20:13:43.347741 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473"
[0m20:13:43.348211 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473
[0m20:13:43.349151 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_email"
[0m20:13:43.349617 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473"
[0m20:13:43.349790 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473: BEGIN
[0m20:13:43.349949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.350229 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.350392 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473"
[0m20:13:43.350557 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:13:43.350948 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:13:43.351118 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.351325 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473: ROLLBACK
[0m20:13:43.353334 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473'
[0m20:13:43.353518 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473: Close
[0m20:13:43.355461 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 21: from "dev"."raw"."raw_users"
                ^
[0m20:13:43.355694 [error] [Thread-1 (]: 10 of 15 ERROR source_not_null_raw_raw_users_email ............................. [[31mERROR[0m in 0.01s]
[0m20:13:43.355957 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473
[0m20:13:43.356148 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e
[0m20:13:43.356362 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 21: from "dev"."raw"."raw_users"
                ^.
[0m20:13:43.356552 [info ] [Thread-1 (]: 11 of 15 START test source_not_null_raw_raw_users_user_id ...................... [RUN]
[0m20:13:43.356788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473, now test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e)
[0m20:13:43.356963 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e
[0m20:13:43.358873 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e"
[0m20:13:43.359231 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e
[0m20:13:43.361971 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_user_id"
[0m20:13:43.362490 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e"
[0m20:13:43.362676 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e: BEGIN
[0m20:13:43.362831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.363151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.363329 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e"
[0m20:13:43.363505 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:13:43.363930 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."raw"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:13:43.364103 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.364304 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e: ROLLBACK
[0m20:13:43.366335 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e'
[0m20:13:43.366509 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e: Close
[0m20:13:43.368379 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 21: from "dev"."raw"."raw_users"
                ^
[0m20:13:43.368611 [error] [Thread-1 (]: 11 of 15 ERROR source_not_null_raw_raw_users_user_id ........................... [[31mERROR[0m in 0.01s]
[0m20:13:43.368870 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e
[0m20:13:43.369055 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9
[0m20:13:43.369220 [info ] [Thread-1 (]: 12 of 15 START test source_unique_raw_raw_events_event_id ...................... [RUN]
[0m20:13:43.369412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e, now test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9)
[0m20:13:43.369578 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9
[0m20:13:43.372653 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9"
[0m20:13:43.372891 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 21: from "dev"."raw"."raw_users"
                ^.
[0m20:13:43.373245 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9
[0m20:13:43.374442 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_raw_events_event_id"
[0m20:13:43.374894 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9"
[0m20:13:43.375065 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9: BEGIN
[0m20:13:43.375244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.375529 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.375695 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9"
[0m20:13:43.375872 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."raw"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:13:43.376295 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."raw"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:13:43.376473 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.376683 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9: ROLLBACK
[0m20:13:43.378723 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9'
[0m20:13:43.378914 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9: Close
[0m20:13:43.380894 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."raw_events"
                ^
[0m20:13:43.381164 [error] [Thread-1 (]: 12 of 15 ERROR source_unique_raw_raw_events_event_id ........................... [[31mERROR[0m in 0.01s]
[0m20:13:43.381442 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9
[0m20:13:43.381651 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945
[0m20:13:43.381882 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."raw_events"
                ^.
[0m20:13:43.382078 [info ] [Thread-1 (]: 13 of 15 START test source_unique_raw_raw_orders_order_id ...................... [RUN]
[0m20:13:43.382356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_raw_events_event_id.3f7a6549b9, now test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945)
[0m20:13:43.382537 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945
[0m20:13:43.384534 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945"
[0m20:13:43.384925 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945
[0m20:13:43.385924 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_raw_orders_order_id"
[0m20:13:43.386411 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945"
[0m20:13:43.386588 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945: BEGIN
[0m20:13:43.386751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.387098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.387261 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945"
[0m20:13:43.387433 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."raw"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:13:43.388151 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."raw"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:13:43.388433 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.388662 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945: ROLLBACK
[0m20:13:43.391397 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945'
[0m20:13:43.391652 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945: Close
[0m20:13:43.393890 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 22: from "dev"."raw"."raw_orders"
                ^
[0m20:13:43.394162 [error] [Thread-1 (]: 13 of 15 ERROR source_unique_raw_raw_orders_order_id ........................... [[31mERROR[0m in 0.01s]
[0m20:13:43.394434 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945
[0m20:13:43.394617 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044
[0m20:13:43.394854 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 22: from "dev"."raw"."raw_orders"
                ^.
[0m20:13:43.395076 [info ] [Thread-1 (]: 14 of 15 START test source_unique_raw_raw_users_email .......................... [RUN]
[0m20:13:43.395393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_raw_orders_order_id.2b32ac9945, now test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044)
[0m20:13:43.395586 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044
[0m20:13:43.397617 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044"
[0m20:13:43.398015 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044
[0m20:13:43.399019 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_email"
[0m20:13:43.399489 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044"
[0m20:13:43.399662 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044: BEGIN
[0m20:13:43.399819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.400180 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.400362 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044"
[0m20:13:43.400533 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."raw"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:13:43.401001 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."raw"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:13:43.401181 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.401386 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044: ROLLBACK
[0m20:13:43.403402 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044'
[0m20:13:43.403572 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044: Close
[0m20:13:43.405407 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 22: from "dev"."raw"."raw_users"
                ^
[0m20:13:43.405646 [error] [Thread-1 (]: 14 of 15 ERROR source_unique_raw_raw_users_email ............................... [[31mERROR[0m in 0.01s]
[0m20:13:43.405914 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044
[0m20:13:43.406103 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85
[0m20:13:43.406320 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 22: from "dev"."raw"."raw_users"
                ^.
[0m20:13:43.406519 [info ] [Thread-1 (]: 15 of 15 START test source_unique_raw_raw_users_user_id ........................ [RUN]
[0m20:13:43.406758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044, now test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85)
[0m20:13:43.406933 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85
[0m20:13:43.409180 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85"
[0m20:13:43.409552 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85
[0m20:13:43.410555 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_user_id"
[0m20:13:43.411029 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85"
[0m20:13:43.411202 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85: BEGIN
[0m20:13:43.411359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:43.411661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:43.411822 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85"
[0m20:13:43.411989 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."raw"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:13:43.412408 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."raw"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:13:43.412583 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:13:43.412779 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85: ROLLBACK
[0m20:13:43.414763 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85'
[0m20:13:43.414941 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85: Close
[0m20:13:43.416906 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 22: from "dev"."raw"."raw_users"
                ^
[0m20:13:43.417152 [error] [Thread-1 (]: 15 of 15 ERROR source_unique_raw_raw_users_user_id ............................. [[31mERROR[0m in 0.01s]
[0m20:13:43.417422 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85
[0m20:13:43.417669 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 22: from "dev"."raw"."raw_users"
                ^.
[0m20:13:43.418294 [debug] [MainThread]: Using duckdb connection "master"
[0m20:13:43.418454 [debug] [MainThread]: On master: BEGIN
[0m20:13:43.418593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:13:43.418882 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:13:43.419023 [debug] [MainThread]: On master: COMMIT
[0m20:13:43.419155 [debug] [MainThread]: Using duckdb connection "master"
[0m20:13:43.419278 [debug] [MainThread]: On master: COMMIT
[0m20:13:43.419490 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:13:43.419658 [debug] [MainThread]: On master: Close
[0m20:13:43.419859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:43.419995 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85' was properly closed.
[0m20:13:43.420157 [info ] [MainThread]: 
[0m20:13:43.420316 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m20:13:43.421507 [debug] [MainThread]: Command end result
[0m20:13:43.436141 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:13:43.437210 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:13:43.440851 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:13:43.441021 [info ] [MainThread]: 
[0m20:13:43.441211 [info ] [MainThread]: [31mCompleted with 15 errors, 0 partial successes, and 0 warnings:[0m
[0m20:13:43.441363 [info ] [MainThread]: 
[0m20:13:43.441546 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_events_event_id (models/_sources.yml)[0m
[0m20:13:43.441721 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."raw_events"
                ^
[0m20:13:43.441913 [info ] [MainThread]: 
[0m20:13:43.442118 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_events_event_id.sql
[0m20:13:43.442268 [info ] [MainThread]: 
[0m20:13:43.442443 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_event_id"
  ------------------------------------------------------------------------------------
[0m20:13:43.442606 [info ] [MainThread]: 
[0m20:13:43.442880 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_events_event_type (models/_sources.yml)[0m
[0m20:13:43.443066 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_events_event_type (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."raw_events"
                ^
[0m20:13:43.443204 [info ] [MainThread]: 
[0m20:13:43.443370 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_events_event_type.sql
[0m20:13:43.443501 [info ] [MainThread]: 
[0m20:13:43.443666 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_event_type"
  --------------------------------------------------------------------------------------
[0m20:13:43.443807 [info ] [MainThread]: 
[0m20:13:43.443975 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_events_timestamp (models/_sources.yml)[0m
[0m20:13:43.444144 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_events_timestamp (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."raw_events"
                ^
[0m20:13:43.444273 [info ] [MainThread]: 
[0m20:13:43.444434 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_events_timestamp.sql
[0m20:13:43.444567 [info ] [MainThread]: 
[0m20:13:43.444725 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_timestamp"
  -------------------------------------------------------------------------------------
[0m20:13:43.444859 [info ] [MainThread]: 
[0m20:13:43.445023 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_events_user_id (models/_sources.yml)[0m
[0m20:13:43.445187 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_events_user_id (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 21: from "dev"."raw"."raw_events"
                ^
[0m20:13:43.445313 [info ] [MainThread]: 
[0m20:13:43.445466 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_events_user_id.sql
[0m20:13:43.445589 [info ] [MainThread]: 
[0m20:13:43.445746 [info ] [MainThread]:   See test failures:
  -----------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_events_user_id"
  -----------------------------------------------------------------------------------
[0m20:13:43.445881 [info ] [MainThread]: 
[0m20:13:43.446043 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_orders_created_at (models/_sources.yml)[0m
[0m20:13:43.446204 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_orders_created_at (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 21: from "dev"."raw"."raw_orders"
                ^
[0m20:13:43.446330 [info ] [MainThread]: 
[0m20:13:43.446482 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_orders_created_at.sql
[0m20:13:43.446605 [info ] [MainThread]: 
[0m20:13:43.446763 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_created_at"
  --------------------------------------------------------------------------------------
[0m20:13:43.446898 [info ] [MainThread]: 
[0m20:13:43.447061 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_orders_order_id (models/_sources.yml)[0m
[0m20:13:43.447229 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 21: from "dev"."raw"."raw_orders"
                ^
[0m20:13:43.447355 [info ] [MainThread]: 
[0m20:13:43.447507 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_orders_order_id.sql
[0m20:13:43.447631 [info ] [MainThread]: 
[0m20:13:43.447789 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_order_id"
  ------------------------------------------------------------------------------------
[0m20:13:43.447924 [info ] [MainThread]: 
[0m20:13:43.448087 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_orders_total_amount (models/_sources.yml)[0m
[0m20:13:43.448251 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_orders_total_amount (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 21: from "dev"."raw"."raw_orders"
                ^
[0m20:13:43.448376 [info ] [MainThread]: 
[0m20:13:43.448532 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_orders_total_amount.sql
[0m20:13:43.448658 [info ] [MainThread]: 
[0m20:13:43.448816 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_total_amount"
  ----------------------------------------------------------------------------------------
[0m20:13:43.448946 [info ] [MainThread]: 
[0m20:13:43.449107 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_orders_user_id (models/_sources.yml)[0m
[0m20:13:43.449273 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_orders_user_id (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 21: from "dev"."raw"."raw_orders"
                ^
[0m20:13:43.449402 [info ] [MainThread]: 
[0m20:13:43.449555 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_orders_user_id.sql
[0m20:13:43.449678 [info ] [MainThread]: 
[0m20:13:43.449833 [info ] [MainThread]:   See test failures:
  -----------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_orders_user_id"
  -----------------------------------------------------------------------------------
[0m20:13:43.449968 [info ] [MainThread]: 
[0m20:13:43.450127 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_users_created_at (models/_sources.yml)[0m
[0m20:13:43.450287 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_users_created_at (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 21: from "dev"."raw"."raw_users"
                ^
[0m20:13:43.450412 [info ] [MainThread]: 
[0m20:13:43.450564 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_users_created_at.sql
[0m20:13:43.450686 [info ] [MainThread]: 
[0m20:13:43.450839 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_created_at"
  -------------------------------------------------------------------------------------
[0m20:13:43.450969 [info ] [MainThread]: 
[0m20:13:43.451127 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_users_email (models/_sources.yml)[0m
[0m20:13:43.451287 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 21: from "dev"."raw"."raw_users"
                ^
[0m20:13:43.451412 [info ] [MainThread]: 
[0m20:13:43.451564 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_users_email.sql
[0m20:13:43.451688 [info ] [MainThread]: 
[0m20:13:43.451845 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_email"
  --------------------------------------------------------------------------------
[0m20:13:43.451986 [info ] [MainThread]: 
[0m20:13:43.452146 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_users_user_id (models/_sources.yml)[0m
[0m20:13:43.452308 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 21: from "dev"."raw"."raw_users"
                ^
[0m20:13:43.452432 [info ] [MainThread]: 
[0m20:13:43.452585 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_users_user_id.sql
[0m20:13:43.452706 [info ] [MainThread]: 
[0m20:13:43.452859 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_user_id"
  ----------------------------------------------------------------------------------
[0m20:13:43.452990 [info ] [MainThread]: 
[0m20:13:43.453154 [error] [MainThread]: [31mFailure in test source_unique_raw_raw_events_event_id (models/_sources.yml)[0m
[0m20:13:43.453320 [error] [MainThread]:   Runtime Error in test source_unique_raw_raw_events_event_id (models/_sources.yml)
  Catalog Error: Table with name raw_events does not exist!
  Did you mean "dev.raw_events"?
  
  LINE 22: from "dev"."raw"."raw_events"
                ^
[0m20:13:43.453448 [info ] [MainThread]: 
[0m20:13:43.453600 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_raw_events_event_id.sql
[0m20:13:43.453723 [info ] [MainThread]: 
[0m20:13:43.453875 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_raw_events_event_id"
  ----------------------------------------------------------------------------------
[0m20:13:43.454003 [info ] [MainThread]: 
[0m20:13:43.454168 [error] [MainThread]: [31mFailure in test source_unique_raw_raw_orders_order_id (models/_sources.yml)[0m
[0m20:13:43.454332 [error] [MainThread]:   Runtime Error in test source_unique_raw_raw_orders_order_id (models/_sources.yml)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "dev.raw_orders"?
  
  LINE 22: from "dev"."raw"."raw_orders"
                ^
[0m20:13:43.454457 [info ] [MainThread]: 
[0m20:13:43.454609 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_raw_orders_order_id.sql
[0m20:13:43.454730 [info ] [MainThread]: 
[0m20:13:43.454882 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_raw_orders_order_id"
  ----------------------------------------------------------------------------------
[0m20:13:43.455010 [info ] [MainThread]: 
[0m20:13:43.455165 [error] [MainThread]: [31mFailure in test source_unique_raw_raw_users_email (models/_sources.yml)[0m
[0m20:13:43.455325 [error] [MainThread]:   Runtime Error in test source_unique_raw_raw_users_email (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 22: from "dev"."raw"."raw_users"
                ^
[0m20:13:43.455450 [info ] [MainThread]: 
[0m20:13:43.455600 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_raw_users_email.sql
[0m20:13:43.455726 [info ] [MainThread]: 
[0m20:13:43.455877 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_email"
  ------------------------------------------------------------------------------
[0m20:13:43.456004 [info ] [MainThread]: 
[0m20:13:43.456162 [error] [MainThread]: [31mFailure in test source_unique_raw_raw_users_user_id (models/_sources.yml)[0m
[0m20:13:43.456321 [error] [MainThread]:   Runtime Error in test source_unique_raw_raw_users_user_id (models/_sources.yml)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "dev.raw_users"?
  
  LINE 22: from "dev"."raw"."raw_users"
                ^
[0m20:13:43.456445 [info ] [MainThread]: 
[0m20:13:43.456598 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_raw_users_user_id.sql
[0m20:13:43.456719 [info ] [MainThread]: 
[0m20:13:43.456871 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_user_id"
  --------------------------------------------------------------------------------
[0m20:13:43.457002 [info ] [MainThread]: 
[0m20:13:43.457150 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=15 SKIP=0 NO-OP=0 TOTAL=15
[0m20:13:43.459526 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.9176555, "process_in_blocks": "0", "process_kernel_time": 0.237188, "process_mem_max_rss": "147914752", "process_out_blocks": "0", "process_user_time": 1.510422}
[0m20:13:43.459767 [debug] [MainThread]: Command `dbt test` failed at 20:13:43.459727 after 0.92 seconds
[0m20:13:43.459959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115025910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b17b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b17ac0>]}
[0m20:13:43.460136 [debug] [MainThread]: Flushing usage events
[0m20:13:43.769997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:01.052817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f13b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f13d90>]}


============================== 20:14:01.059805 | 49207c85-4731-477a-b267-b40e5e215a8b ==============================
[0m20:14:01.059805 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:14:01.060291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select source:raw.raw_users', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:14:01.222605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49207c85-4731-477a-b267-b40e5e215a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062716e0>]}
[0m20:14:01.264331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49207c85-4731-477a-b267-b40e5e215a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593aad0>]}
[0m20:14:01.265897 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:14:01.321148 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:14:01.404593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:14:01.405414 [debug] [MainThread]: Partial parsing: updated file: sbdk_project://models/_sources.yml
[0m20:14:01.768983 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:14:01.775375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49207c85-4731-477a-b267-b40e5e215a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e5350>]}
[0m20:14:01.822043 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:14:01.823664 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:14:01.842017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49207c85-4731-477a-b267-b40e5e215a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107902a80>]}
[0m20:14:01.842315 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:14:01.842489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49207c85-4731-477a-b267-b40e5e215a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077eab30>]}
[0m20:14:01.843641 [info ] [MainThread]: 
[0m20:14:01.843881 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:14:01.844028 [info ] [MainThread]: 
[0m20:14:01.844277 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:14:01.846734 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:14:01.882551 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:14:01.882792 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:14:01.882940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:01.956355 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m20:14:01.957190 [debug] [ThreadPool]: On list_dev: Close
[0m20:14:01.957558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:14:01.957950 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:14:01.961516 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:14:01.961739 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:14:01.961893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:01.962410 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:14:01.963092 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:14:01.963236 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:14:01.963436 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:01.963572 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:14:01.963706 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:14:01.964130 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:01.964612 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:14:01.964773 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:14:01.964907 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:14:01.965105 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:01.965250 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:14:01.966394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main_dbt_test__audit)
[0m20:14:01.969445 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:14:01.969613 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:14:01.969746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:01.969980 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:01.970118 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:14:01.970264 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:14:01.978439 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:14:01.979088 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:14:01.979949 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:14:01.980118 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:14:01.980374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:14:01.981282 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:14:01.981428 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:14:01.981549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:01.981783 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:01.981917 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:14:01.982053 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:14:01.984008 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:14:01.984700 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:14:01.984960 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:14:01.985091 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:14:01.985831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49207c85-4731-477a-b267-b40e5e215a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b23ba0>]}
[0m20:14:01.986110 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:01.986263 [debug] [MainThread]: On master: BEGIN
[0m20:14:01.986396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:01.986625 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:01.986769 [debug] [MainThread]: On master: COMMIT
[0m20:14:01.986906 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:01.987035 [debug] [MainThread]: On master: COMMIT
[0m20:14:01.987217 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:01.987351 [debug] [MainThread]: On master: Close
[0m20:14:01.988588 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14
[0m20:14:01.988786 [info ] [Thread-1 (]: 1 of 5 START test source_not_null_raw_raw_users_created_at ..................... [RUN]
[0m20:14:01.988990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14)
[0m20:14:01.989161 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14
[0m20:14:01.997596 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14"
[0m20:14:01.998041 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14
[0m20:14:02.005727 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_created_at"
[0m20:14:02.017452 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14"
[0m20:14:02.017671 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14: BEGIN
[0m20:14:02.017841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:02.018223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:14:02.018388 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14"
[0m20:14:02.018557 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "main"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:14:02.022129 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "main"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:14:02.022306 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:14:02.022522 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14: ROLLBACK
[0m20:14:02.027655 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14'
[0m20:14:02.027862 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14: Close
[0m20:14:02.029788 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_users_created_at (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!
[0m20:14:02.030051 [error] [Thread-1 (]: 1 of 5 ERROR source_not_null_raw_raw_users_created_at .......................... [[31mERROR[0m in 0.04s]
[0m20:14:02.030341 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14
[0m20:14:02.030546 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473
[0m20:14:02.030792 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_users_created_at (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!.
[0m20:14:02.031009 [info ] [Thread-1 (]: 2 of 5 START test source_not_null_raw_raw_users_email .......................... [RUN]
[0m20:14:02.031607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_users_created_at.e225773e14, now test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473)
[0m20:14:02.031816 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473
[0m20:14:02.036203 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473"
[0m20:14:02.036694 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473
[0m20:14:02.037700 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_email"
[0m20:14:02.038180 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473"
[0m20:14:02.038356 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473: BEGIN
[0m20:14:02.038513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:02.038841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:14:02.039011 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473"
[0m20:14:02.039179 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "main"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:14:02.039565 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "main"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:14:02.039736 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:14:02.039937 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473: ROLLBACK
[0m20:14:02.041946 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473'
[0m20:14:02.042118 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473: Close
[0m20:14:02.044026 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_users_email (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!
[0m20:14:02.044280 [error] [Thread-1 (]: 2 of 5 ERROR source_not_null_raw_raw_users_email ............................... [[31mERROR[0m in 0.01s]
[0m20:14:02.044554 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473
[0m20:14:02.044745 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e
[0m20:14:02.044970 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_users_email (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!.
[0m20:14:02.045166 [info ] [Thread-1 (]: 3 of 5 START test source_not_null_raw_raw_users_user_id ........................ [RUN]
[0m20:14:02.045424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_users_email.44146ab473, now test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e)
[0m20:14:02.045607 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e
[0m20:14:02.047727 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e"
[0m20:14:02.048120 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e
[0m20:14:02.049068 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_user_id"
[0m20:14:02.049522 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e"
[0m20:14:02.049691 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e: BEGIN
[0m20:14:02.049846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:02.050121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:14:02.050280 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e"
[0m20:14:02.050444 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "main"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:14:02.050801 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "main"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:14:02.050972 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:14:02.051178 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e: ROLLBACK
[0m20:14:02.053076 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e'
[0m20:14:02.053248 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e: Close
[0m20:14:02.055065 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_raw_users_user_id (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!
[0m20:14:02.055285 [error] [Thread-1 (]: 3 of 5 ERROR source_not_null_raw_raw_users_user_id ............................. [[31mERROR[0m in 0.01s]
[0m20:14:02.055547 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e
[0m20:14:02.055730 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044
[0m20:14:02.055938 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_raw_users_user_id (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!.
[0m20:14:02.056120 [info ] [Thread-1 (]: 4 of 5 START test source_unique_raw_raw_users_email ............................ [RUN]
[0m20:14:02.056368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_raw_raw_users_user_id.68e4126c7e, now test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044)
[0m20:14:02.056544 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044
[0m20:14:02.059592 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044"
[0m20:14:02.060036 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044
[0m20:14:02.061556 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_email"
[0m20:14:02.062045 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044"
[0m20:14:02.062215 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044: BEGIN
[0m20:14:02.062366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:02.062696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:14:02.062856 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044"
[0m20:14:02.063012 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "main"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:14:02.063414 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "main"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:14:02.063579 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:14:02.063770 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044: ROLLBACK
[0m20:14:02.065709 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044'
[0m20:14:02.065883 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044: Close
[0m20:14:02.067726 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_raw_users_email (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!
[0m20:14:02.068043 [error] [Thread-1 (]: 4 of 5 ERROR source_unique_raw_raw_users_email ................................. [[31mERROR[0m in 0.01s]
[0m20:14:02.068363 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044
[0m20:14:02.068565 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85
[0m20:14:02.068790 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_raw_users_email (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!.
[0m20:14:02.068986 [info ] [Thread-1 (]: 5 of 5 START test source_unique_raw_raw_users_user_id .......................... [RUN]
[0m20:14:02.069263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_raw_raw_users_email.ed9ec19044, now test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85)
[0m20:14:02.069460 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85
[0m20:14:02.071720 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85"
[0m20:14:02.072204 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85
[0m20:14:02.073490 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_user_id"
[0m20:14:02.073964 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85"
[0m20:14:02.074136 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85: BEGIN
[0m20:14:02.074289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:02.074635 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:14:02.074804 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85"
[0m20:14:02.074979 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "main"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:14:02.075396 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "main"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:14:02.075577 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:14:02.075788 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85: ROLLBACK
[0m20:14:02.078044 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85'
[0m20:14:02.078248 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85: Close
[0m20:14:02.080133 [debug] [Thread-1 (]: Runtime Error in test source_unique_raw_raw_users_user_id (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!
[0m20:14:02.080371 [error] [Thread-1 (]: 5 of 5 ERROR source_unique_raw_raw_users_user_id ............................... [[31mERROR[0m in 0.01s]
[0m20:14:02.080638 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85
[0m20:14:02.080883 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_raw_raw_users_user_id (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!.
[0m20:14:02.081448 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:02.081598 [debug] [MainThread]: On master: BEGIN
[0m20:14:02.081725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:02.081999 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:02.082139 [debug] [MainThread]: On master: COMMIT
[0m20:14:02.082264 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:02.082386 [debug] [MainThread]: On master: COMMIT
[0m20:14:02.082565 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:02.082698 [debug] [MainThread]: On master: Close
[0m20:14:02.082864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:02.082989 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_raw_raw_users_user_id.3f3c452d85' was properly closed.
[0m20:14:02.083131 [info ] [MainThread]: 
[0m20:14:02.083271 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m20:14:02.083811 [debug] [MainThread]: Command end result
[0m20:14:02.097428 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:14:02.098424 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:14:02.101817 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:14:02.101986 [info ] [MainThread]: 
[0m20:14:02.102172 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m20:14:02.102323 [info ] [MainThread]: 
[0m20:14:02.102519 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_users_created_at (models/_sources.yml)[0m
[0m20:14:02.102692 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_users_created_at (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!
[0m20:14:02.102820 [info ] [MainThread]: 
[0m20:14:02.102977 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_users_created_at.sql
[0m20:14:02.103102 [info ] [MainThread]: 
[0m20:14:02.103261 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_created_at"
  -------------------------------------------------------------------------------------
[0m20:14:02.103396 [info ] [MainThread]: 
[0m20:14:02.103558 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_users_email (models/_sources.yml)[0m
[0m20:14:02.103718 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_users_email (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!
[0m20:14:02.103842 [info ] [MainThread]: 
[0m20:14:02.103993 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_users_email.sql
[0m20:14:02.104117 [info ] [MainThread]: 
[0m20:14:02.104268 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_email"
  --------------------------------------------------------------------------------
[0m20:14:02.104396 [info ] [MainThread]: 
[0m20:14:02.104552 [error] [MainThread]: [31mFailure in test source_not_null_raw_raw_users_user_id (models/_sources.yml)[0m
[0m20:14:02.104711 [error] [MainThread]:   Runtime Error in test source_not_null_raw_raw_users_user_id (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!
[0m20:14:02.104833 [info ] [MainThread]: 
[0m20:14:02.104985 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_not_null_raw_raw_users_user_id.sql
[0m20:14:02.105106 [info ] [MainThread]: 
[0m20:14:02.105258 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_not_null_raw_raw_users_user_id"
  ----------------------------------------------------------------------------------
[0m20:14:02.105388 [info ] [MainThread]: 
[0m20:14:02.105544 [error] [MainThread]: [31mFailure in test source_unique_raw_raw_users_email (models/_sources.yml)[0m
[0m20:14:02.105700 [error] [MainThread]:   Runtime Error in test source_unique_raw_raw_users_email (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!
[0m20:14:02.105821 [info ] [MainThread]: 
[0m20:14:02.105971 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_raw_users_email.sql
[0m20:14:02.106091 [info ] [MainThread]: 
[0m20:14:02.106248 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_email"
  ------------------------------------------------------------------------------
[0m20:14:02.106376 [info ] [MainThread]: 
[0m20:14:02.106531 [error] [MainThread]: [31mFailure in test source_unique_raw_raw_users_user_id (models/_sources.yml)[0m
[0m20:14:02.106686 [error] [MainThread]:   Runtime Error in test source_unique_raw_raw_users_user_id (models/_sources.yml)
  Binder Error: Catalog "main" does not exist!
[0m20:14:02.106807 [info ] [MainThread]: 
[0m20:14:02.106958 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_raw_raw_users_user_id.sql
[0m20:14:02.107077 [info ] [MainThread]: 
[0m20:14:02.107228 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_raw_raw_users_user_id"
  --------------------------------------------------------------------------------
[0m20:14:02.107361 [info ] [MainThread]: 
[0m20:14:02.107512 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=5
[0m20:14:02.109698 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.106586, "process_in_blocks": "0", "process_kernel_time": 0.230275, "process_mem_max_rss": "153141248", "process_out_blocks": "0", "process_user_time": 1.615853}
[0m20:14:02.109993 [debug] [MainThread]: Command `dbt test` failed at 20:14:02.109943 after 1.11 seconds
[0m20:14:02.110240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f45910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783bb70>]}
[0m20:14:02.110501 [debug] [MainThread]: Flushing usage events
[0m20:14:02.717558 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:40.264257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107035a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f3d90>]}


============================== 20:14:40.271056 | 883611bd-fc5e-404b-8321-fb34aae0c8dd ==============================
[0m20:14:40.271056 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:14:40.271469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_users', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:14:40.429909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '883611bd-fc5e-404b-8321-fb34aae0c8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074516e0>]}
[0m20:14:40.479542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '883611bd-fc5e-404b-8321-fb34aae0c8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069baad0>]}
[0m20:14:40.481087 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:14:40.541403 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:14:40.598570 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:14:40.598865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '883611bd-fc5e-404b-8321-fb34aae0c8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115e4d50>]}
[0m20:14:41.304195 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:14:41.310686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '883611bd-fc5e-404b-8321-fb34aae0c8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115737a0>]}
[0m20:14:41.356031 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:14:41.358019 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:14:41.371480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '883611bd-fc5e-404b-8321-fb34aae0c8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115b2b30>]}
[0m20:14:41.371966 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:14:41.372177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '883611bd-fc5e-404b-8321-fb34aae0c8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111954870>]}
[0m20:14:41.373073 [info ] [MainThread]: 
[0m20:14:41.373627 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:14:41.373810 [info ] [MainThread]: 
[0m20:14:41.374099 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:14:41.374529 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:14:41.418650 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:14:41.419057 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:14:41.419301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:41.497326 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m20:14:41.498340 [debug] [ThreadPool]: On list_dev: Close
[0m20:14:41.498706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:14:41.498980 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:14:41.502310 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:14:41.502490 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:14:41.502637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:41.503243 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:14:41.503883 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:14:41.504024 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:14:41.504234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:41.504370 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:14:41.504503 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:14:41.505055 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:41.505460 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:14:41.505599 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:14:41.505726 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:14:41.505929 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:41.506066 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:14:41.509088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_dbt_test__audit)
[0m20:14:41.512119 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:14:41.512288 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:14:41.512418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:41.512663 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:41.512803 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:14:41.512947 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:14:41.524984 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:14:41.525787 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:14:41.526648 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:14:41.526800 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:14:41.527057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:14:41.528042 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:14:41.528209 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:14:41.528347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:41.528622 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:41.528759 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:14:41.528900 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:14:41.530648 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:14:41.531352 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:14:41.531654 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:14:41.531793 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:14:41.532337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '883611bd-fc5e-404b-8321-fb34aae0c8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f7590>]}
[0m20:14:41.532566 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:41.532699 [debug] [MainThread]: On master: BEGIN
[0m20:14:41.532828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:41.533070 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:41.533207 [debug] [MainThread]: On master: COMMIT
[0m20:14:41.533339 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:41.533469 [debug] [MainThread]: On master: COMMIT
[0m20:14:41.533695 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:41.533892 [debug] [MainThread]: On master: Close
[0m20:14:41.535497 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:14:41.535983 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_users ..................................... [RUN]
[0m20:14:41.536253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.sbdk_project.stg_users)
[0m20:14:41.536442 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:14:41.540503 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:14:41.541134 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:14:41.559367 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:14:41.560133 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:14:41.560331 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:14:41.560521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:41.560966 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:14:41.561169 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:14:41.561395 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."raw"."raw_users"
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:14:41.564769 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."raw"."raw_users"
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:14:41.564989 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:14:41.565227 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: ROLLBACK
[0m20:14:41.570611 [debug] [Thread-1 (]: Failed to rollback 'model.sbdk_project.stg_users'
[0m20:14:41.570800 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:14:41.572790 [debug] [Thread-1 (]: Runtime Error in model stg_users (models/staging/stg_users.sql)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "main.raw_users"?
  
  LINE 8:     select * from "dev"."raw"."raw_users"
                            ^
[0m20:14:41.573821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '883611bd-fc5e-404b-8321-fb34aae0c8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c9ccb0>]}
[0m20:14:41.574168 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_users ............................ [[31mERROR[0m in 0.04s]
[0m20:14:41.574463 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:14:41.574726 [debug] [Thread-4 (]: Marking all children of 'model.sbdk_project.stg_users' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_users (models/staging/stg_users.sql)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "main.raw_users"?
  
  LINE 8:     select * from "dev"."raw"."raw_users"
                            ^.
[0m20:14:41.575571 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:41.575727 [debug] [MainThread]: On master: BEGIN
[0m20:14:41.575857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:41.576145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:41.576282 [debug] [MainThread]: On master: COMMIT
[0m20:14:41.576417 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:41.576543 [debug] [MainThread]: On master: COMMIT
[0m20:14:41.576729 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:41.576863 [debug] [MainThread]: On master: Close
[0m20:14:41.577039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:41.577200 [debug] [MainThread]: Connection 'model.sbdk_project.stg_users' was properly closed.
[0m20:14:41.577404 [info ] [MainThread]: 
[0m20:14:41.577581 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m20:14:41.577909 [debug] [MainThread]: Command end result
[0m20:14:41.591383 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:14:41.592320 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:14:41.595635 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:14:41.595782 [info ] [MainThread]: 
[0m20:14:41.595955 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:14:41.596099 [info ] [MainThread]: 
[0m20:14:41.596276 [error] [MainThread]: [31mFailure in model stg_users (models/staging/stg_users.sql)[0m
[0m20:14:41.596444 [error] [MainThread]:   Runtime Error in model stg_users (models/staging/stg_users.sql)
  Catalog Error: Table with name raw_users does not exist!
  Did you mean "main.raw_users"?
  
  LINE 8:     select * from "dev"."raw"."raw_users"
                            ^
[0m20:14:41.596581 [info ] [MainThread]: 
[0m20:14:41.596741 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/staging/stg_users.sql
[0m20:14:41.596870 [info ] [MainThread]: 
[0m20:14:41.597074 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:14:41.598862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3862836, "process_in_blocks": "0", "process_kernel_time": 0.244129, "process_mem_max_rss": "153452544", "process_out_blocks": "0", "process_user_time": 1.894462}
[0m20:14:41.599073 [debug] [MainThread]: Command `dbt run` failed at 20:14:41.599035 after 1.39 seconds
[0m20:14:41.599250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d3c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dbcb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073800d0>]}
[0m20:14:41.599428 [debug] [MainThread]: Flushing usage events
[0m20:14:41.982018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:15:03.716231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b95a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120f3d90>]}


============================== 20:15:03.719993 | 256af05f-0e4e-4114-8437-e11d2a9d10d9 ==============================
[0m20:15:03.719993 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:15:03.720361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_users', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:15:03.876535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '256af05f-0e4e-4114-8437-e11d2a9d10d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f556e0>]}
[0m20:15:03.917529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '256af05f-0e4e-4114-8437-e11d2a9d10d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073baad0>]}
[0m20:15:03.919057 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:15:03.975956 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:15:04.052358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m20:15:04.053068 [debug] [MainThread]: Partial parsing: updated file: sbdk_project://models/_sources.yml
[0m20:15:04.053265 [debug] [MainThread]: Partial parsing: updated file: sbdk_project://models/staging/stg_users.sql
[0m20:15:04.053415 [debug] [MainThread]: Partial parsing: updated file: sbdk_project://models/staging/stg_events.sql
[0m20:15:04.053556 [debug] [MainThread]: Partial parsing: updated file: sbdk_project://models/staging/stg_orders.sql
[0m20:15:04.501910 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:15:04.508511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '256af05f-0e4e-4114-8437-e11d2a9d10d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e5250>]}
[0m20:15:04.553277 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:15:04.554574 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:15:04.566971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '256af05f-0e4e-4114-8437-e11d2a9d10d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112433a70>]}
[0m20:15:04.567406 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:15:04.567629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '256af05f-0e4e-4114-8437-e11d2a9d10d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112419a90>]}
[0m20:15:04.568537 [info ] [MainThread]: 
[0m20:15:04.568723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:15:04.568864 [info ] [MainThread]: 
[0m20:15:04.569103 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:15:04.569528 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:15:04.601618 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:15:04.601854 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:15:04.602005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:04.684983 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m20:15:04.685979 [debug] [ThreadPool]: On list_dev: Close
[0m20:15:04.686353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:15:04.686604 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:15:04.690705 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:15:04.691690 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:15:04.691866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:04.692854 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:15:04.694104 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:15:04.694440 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:15:04.694694 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:04.694831 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:15:04.694964 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:15:04.695804 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:15:04.696240 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:15:04.696378 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:15:04.696503 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:15:04.696693 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:04.696830 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:15:04.699982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m20:15:04.703113 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:15:04.703293 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:15:04.703435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:04.703694 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:04.703830 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:15:04.703965 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:15:04.715686 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:15:04.716524 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:15:04.717353 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:15:04.717507 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:15:04.717758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:15:04.718928 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:15:04.719074 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:15:04.719202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:04.719468 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:04.719628 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:15:04.719779 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:15:04.721452 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:15:04.722104 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:15:04.722398 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:15:04.722542 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:15:04.722812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '256af05f-0e4e-4114-8437-e11d2a9d10d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e33a00>]}
[0m20:15:04.723052 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:04.723194 [debug] [MainThread]: On master: BEGIN
[0m20:15:04.723320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:15:04.723534 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:04.723670 [debug] [MainThread]: On master: COMMIT
[0m20:15:04.723802 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:04.723924 [debug] [MainThread]: On master: COMMIT
[0m20:15:04.724093 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:04.724227 [debug] [MainThread]: On master: Close
[0m20:15:04.725387 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:15:04.725661 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_users ..................................... [RUN]
[0m20:15:04.725887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now model.sbdk_project.stg_users)
[0m20:15:04.726065 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:15:04.730103 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:15:04.730555 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:15:04.749171 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:15:04.749779 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:15:04.749956 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:15:04.750109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:04.750441 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:04.750603 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:15:04.750794 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_users"
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:15:04.753213 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:15:04.756506 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:15:04.756700 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:15:04.757930 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:04.763320 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:15:04.763554 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:15:04.763724 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:15:04.765497 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:15:04.768173 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:15:04.768367 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m20:15:04.768949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:04.770140 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:15:04.771308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '256af05f-0e4e-4114-8437-e11d2a9d10d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fa0650>]}
[0m20:15:04.771657 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.04s]
[0m20:15:04.771945 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:15:04.772496 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:04.772658 [debug] [MainThread]: On master: BEGIN
[0m20:15:04.772781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:15:04.773001 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:04.773135 [debug] [MainThread]: On master: COMMIT
[0m20:15:04.773264 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:04.773388 [debug] [MainThread]: On master: COMMIT
[0m20:15:04.773563 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:04.773692 [debug] [MainThread]: On master: Close
[0m20:15:04.773857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:04.773981 [debug] [MainThread]: Connection 'model.sbdk_project.stg_users' was properly closed.
[0m20:15:04.774115 [info ] [MainThread]: 
[0m20:15:04.774256 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m20:15:04.774564 [debug] [MainThread]: Command end result
[0m20:15:04.790196 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:15:04.791563 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:15:04.794530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:15:04.794695 [info ] [MainThread]: 
[0m20:15:04.794887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:15:04.795029 [info ] [MainThread]: 
[0m20:15:04.795184 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:15:04.797029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1314486, "process_in_blocks": "0", "process_kernel_time": 0.228039, "process_mem_max_rss": "152485888", "process_out_blocks": "0", "process_user_time": 1.559559}
[0m20:15:04.797295 [debug] [MainThread]: Command `dbt run` succeeded at 20:15:04.797248 after 1.13 seconds
[0m20:15:04.797489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11384fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be4b90>]}
[0m20:15:04.797685 [debug] [MainThread]: Flushing usage events
[0m20:15:05.338473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:15:11.423238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d95a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222f3d90>]}


============================== 20:15:11.426986 | 38497302-7078-46a9-9149-22305dc3835e ==============================
[0m20:15:11.426986 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:15:11.427334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m20:15:11.575145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38497302-7078-46a9-9149-22305dc3835e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212016e0>]}
[0m20:15:11.618949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38497302-7078-46a9-9149-22305dc3835e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c0aad0>]}
[0m20:15:11.620467 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:15:11.676764 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:15:11.793945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:15:11.794529 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:15:11.799434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:15:11.831161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38497302-7078-46a9-9149-22305dc3835e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122603d50>]}
[0m20:15:11.903836 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:15:11.905795 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:15:11.923695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38497302-7078-46a9-9149-22305dc3835e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123031040>]}
[0m20:15:11.924684 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:15:11.925363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38497302-7078-46a9-9149-22305dc3835e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220f7bd0>]}
[0m20:15:11.928463 [info ] [MainThread]: 
[0m20:15:11.928800 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:15:11.928956 [info ] [MainThread]: 
[0m20:15:11.929273 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:15:11.932410 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:15:11.971691 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:15:11.971945 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:15:11.972105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:12.052237 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m20:15:12.053321 [debug] [ThreadPool]: On list_dev: Close
[0m20:15:12.053745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:15:12.054191 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:15:12.057596 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:15:12.057777 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:15:12.057919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:12.058875 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:15:12.059763 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:15:12.059926 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:15:12.060151 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:12.060373 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:15:12.060523 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:15:12.061044 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:12.061525 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:15:12.061682 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:15:12.061816 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:15:12.062026 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:12.062168 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:15:12.063352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m20:15:12.066322 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:15:12.066495 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:15:12.066631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:12.066929 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:12.067094 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:15:12.067246 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:15:12.075856 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:15:12.116182 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:15:12.117089 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:15:12.117260 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:15:12.117536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:15:12.118761 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:15:12.118905 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:15:12.119031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:12.119335 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:12.119470 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:15:12.119611 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:15:12.121398 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:15:12.122036 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:15:12.122319 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:15:12.122458 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:15:12.122730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38497302-7078-46a9-9149-22305dc3835e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12373a680>]}
[0m20:15:12.122969 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:12.123110 [debug] [MainThread]: On master: BEGIN
[0m20:15:12.123243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:15:12.123472 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:12.123613 [debug] [MainThread]: On master: COMMIT
[0m20:15:12.123743 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:12.123880 [debug] [MainThread]: On master: COMMIT
[0m20:15:12.124059 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:12.124198 [debug] [MainThread]: On master: Close
[0m20:15:12.125600 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:15:12.125848 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_events .................................... [RUN]
[0m20:15:12.126058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now model.sbdk_project.stg_events)
[0m20:15:12.126237 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:15:12.130480 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:15:12.130953 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:15:12.147423 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m20:15:12.148059 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:15:12.148248 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m20:15:12.148412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:12.148778 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:12.148941 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:15:12.149147 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_events"
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m20:15:12.150014 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:12.154091 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:15:12.154322 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:15:12.155333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:12.161127 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:15:12.161415 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:15:12.161596 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:15:12.164132 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:15:12.167166 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:15:12.167416 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m20:15:12.167833 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:12.169188 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m20:15:12.170484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38497302-7078-46a9-9149-22305dc3835e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12267e5d0>]}
[0m20:15:12.171505 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.04s]
[0m20:15:12.171908 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:15:12.172151 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:15:12.172507 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_orders .................................... [RUN]
[0m20:15:12.173087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:15:12.173917 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:15:12.177848 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:15:12.179342 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:15:12.181777 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m20:15:12.182421 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:15:12.182617 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m20:15:12.182790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:12.183190 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:12.183358 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:15:12.183586 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_orders"
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m20:15:12.184697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:12.186564 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:15:12.186769 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:15:12.187151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:12.187886 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:15:12.188056 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:15:12.188204 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:15:12.188785 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:12.189877 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:15:12.190060 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m20:15:12.190338 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:12.190968 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m20:15:12.191246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38497302-7078-46a9-9149-22305dc3835e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234b6ba0>]}
[0m20:15:12.191552 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.02s]
[0m20:15:12.191813 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:15:12.191999 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:15:12.192246 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_users ..................................... [RUN]
[0m20:15:12.192442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:15:12.192610 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:15:12.194154 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:15:12.194665 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:15:12.196579 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:15:12.196959 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:15:12.197132 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:15:12.197291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:12.197650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:12.197829 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:15:12.198016 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_users"
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:15:12.200597 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:15:12.202040 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:15:12.202214 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m20:15:12.202504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:12.203752 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:15:12.203921 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:15:12.204189 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:12.206386 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:15:12.206597 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:15:12.206770 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:15:12.207282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:12.208407 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:15:12.208596 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m20:15:12.208968 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:12.209672 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:15:12.209959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38497302-7078-46a9-9149-22305dc3835e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223c6df0>]}
[0m20:15:12.210322 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.02s]
[0m20:15:12.210663 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:15:12.211419 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:12.211576 [debug] [MainThread]: On master: BEGIN
[0m20:15:12.211711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:15:12.212048 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:12.212188 [debug] [MainThread]: On master: COMMIT
[0m20:15:12.212326 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:12.212454 [debug] [MainThread]: On master: COMMIT
[0m20:15:12.212686 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:12.212876 [debug] [MainThread]: On master: Close
[0m20:15:12.213076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:12.213213 [debug] [MainThread]: Connection 'model.sbdk_project.stg_users' was properly closed.
[0m20:15:12.213385 [info ] [MainThread]: 
[0m20:15:12.213547 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m20:15:12.213987 [debug] [MainThread]: Command end result
[0m20:15:12.227977 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:15:12.228994 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:15:12.232105 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:15:12.232273 [info ] [MainThread]: 
[0m20:15:12.232456 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:15:12.232599 [info ] [MainThread]: 
[0m20:15:12.232763 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m20:15:12.234540 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8646596, "process_in_blocks": "0", "process_kernel_time": 0.30931, "process_mem_max_rss": "143638528", "process_out_blocks": "0", "process_user_time": 1.51821}
[0m20:15:12.234760 [debug] [MainThread]: Command `dbt run` succeeded at 20:15:12.234720 after 0.86 seconds
[0m20:15:12.234935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12277ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12345f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122381a20>]}
[0m20:15:12.235116 [debug] [MainThread]: Flushing usage events
[0m20:15:12.619290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:15:18.473440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106691a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075efb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075efd90>]}


============================== 20:15:18.477189 | 6ec77925-2dfe-4ab7-a2c5-fe0463f09852 ==============================
[0m20:15:18.477189 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:15:18.477553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:15:18.684838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ec77925-2dfe-4ab7-a2c5-fe0463f09852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693d6e0>]}
[0m20:15:18.726643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ec77925-2dfe-4ab7-a2c5-fe0463f09852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106016ad0>]}
[0m20:15:18.728311 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:15:18.794267 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:15:18.879777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:15:18.880020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:15:18.883582 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:15:18.904818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ec77925-2dfe-4ab7-a2c5-fe0463f09852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ffd50>]}
[0m20:15:18.958477 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:15:18.959791 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:15:18.984453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ec77925-2dfe-4ab7-a2c5-fe0463f09852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d385f0>]}
[0m20:15:18.984784 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:15:18.986560 [info ] [MainThread]: 
[0m20:15:18.986787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:15:18.986937 [info ] [MainThread]: 
[0m20:15:18.987212 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:15:18.990316 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:15:19.068986 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:15:19.069253 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:15:19.069417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:19.141267 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m20:15:19.142298 [debug] [ThreadPool]: On list_dev: Close
[0m20:15:19.143484 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:15:19.143734 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:15:19.143899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:19.144392 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:19.145038 [debug] [ThreadPool]: On list_dev: Close
[0m20:15:19.145404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:15:19.145855 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:15:19.149908 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:15:19.150140 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:15:19.150294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:19.150872 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:15:19.151773 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:15:19.151947 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:15:19.152184 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:19.152328 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:15:19.152467 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:15:19.152951 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:19.153439 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:15:19.153605 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:15:19.153745 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:15:19.154222 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:19.154486 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:15:19.155322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now create_dev_main)
[0m20:15:19.156200 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:15:19.157605 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:15:19.157898 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:15:19.158211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:19.159556 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:15:19.160484 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:15:19.160901 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:15:19.161282 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:19.161457 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:15:19.161669 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:15:19.161949 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:19.162488 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:15:19.162678 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:15:19.162844 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:15:19.163094 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:19.163242 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:15:19.164725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_dbt_test__audit)
[0m20:15:19.167963 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:15:19.168280 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:15:19.168457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:19.168849 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:19.169013 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:15:19.169170 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:15:19.178637 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:15:19.179415 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:15:19.180237 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:15:19.180408 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:15:19.180685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:15:19.182022 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:15:19.182178 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:15:19.182313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:19.182598 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:19.182731 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:15:19.182869 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:15:19.184803 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:15:19.185579 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:15:19.185913 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:15:19.186066 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:15:19.186800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ec77925-2dfe-4ab7-a2c5-fe0463f09852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d8baf0>]}
[0m20:15:19.187051 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:19.187198 [debug] [MainThread]: On master: BEGIN
[0m20:15:19.187332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:15:19.187585 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:19.187753 [debug] [MainThread]: On master: COMMIT
[0m20:15:19.187901 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:19.188034 [debug] [MainThread]: On master: COMMIT
[0m20:15:19.188254 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:19.188389 [debug] [MainThread]: On master: Close
[0m20:15:19.189687 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:15:19.190070 [info ] [Thread-1 (]: 1 of 20 START test source_not_null_main_raw_events_event_id .................... [RUN]
[0m20:15:19.190321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a)
[0m20:15:19.190581 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:15:19.200462 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:15:19.201032 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:15:19.209989 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
[0m20:15:19.218513 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:15:19.218770 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:15:19.218949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.219333 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.219539 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:15:19.219728 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:15:19.220803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.221347 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:15:19.221536 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:15:19.221706 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:15:19.222030 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.224073 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:15:19.224606 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:15:19.224790 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:15:19.225048 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.225215 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:15:19.225385 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:15:19.226886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.229104 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: ROLLBACK
[0m20:15:19.229460 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a'
[0m20:15:19.229645 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: Close
[0m20:15:19.229967 [info ] [Thread-1 (]: 1 of 20 PASS source_not_null_main_raw_events_event_id .......................... [[32mPASS[0m in 0.04s]
[0m20:15:19.230249 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:15:19.230449 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:15:19.230689 [info ] [Thread-1 (]: 2 of 20 START test source_not_null_main_raw_events_event_type .................. [RUN]
[0m20:15:19.230926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a, now test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b)
[0m20:15:19.231113 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:15:19.233529 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:15:19.233967 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:15:19.235089 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
[0m20:15:19.235592 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:15:19.235771 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:15:19.235932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.236282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.236448 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:15:19.236620 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:15:19.237333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.237886 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:15:19.238080 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:15:19.238248 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:15:19.238585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.238925 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:15:19.239311 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:15:19.239480 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:15:19.239755 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.239971 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:15:19.240164 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
    
      
    ) dbt_internal_test
[0m20:15:19.240765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.241614 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: ROLLBACK
[0m20:15:19.241973 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b'
[0m20:15:19.242158 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: Close
[0m20:15:19.242474 [info ] [Thread-1 (]: 2 of 20 PASS source_not_null_main_raw_events_event_type ........................ [[32mPASS[0m in 0.01s]
[0m20:15:19.242756 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:15:19.242952 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:15:19.243188 [info ] [Thread-1 (]: 3 of 20 START test source_not_null_main_raw_events_timestamp ................... [RUN]
[0m20:15:19.243407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b, now test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d)
[0m20:15:19.243585 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:15:19.246028 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:15:19.246430 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:15:19.247483 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
[0m20:15:19.247976 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:15:19.248155 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:15:19.248316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.248640 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.248827 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:15:19.249006 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:15:19.249601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.250111 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:15:19.250294 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:15:19.250458 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:15:19.250783 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.251133 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:15:19.251493 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:15:19.251665 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:15:19.251902 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.252066 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:15:19.252238 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
    
      
    ) dbt_internal_test
[0m20:15:19.252814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.253632 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: ROLLBACK
[0m20:15:19.253995 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d'
[0m20:15:19.254187 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: Close
[0m20:15:19.254487 [info ] [Thread-1 (]: 3 of 20 PASS source_not_null_main_raw_events_timestamp ......................... [[32mPASS[0m in 0.01s]
[0m20:15:19.254764 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:15:19.254962 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:15:19.255183 [info ] [Thread-1 (]: 4 of 20 START test source_not_null_main_raw_events_user_id ..................... [RUN]
[0m20:15:19.255409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d, now test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d)
[0m20:15:19.255590 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:15:19.257815 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:15:19.258874 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:15:19.260567 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
[0m20:15:19.261115 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:15:19.261312 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:15:19.261487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.261936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.262114 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:15:19.262343 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:15:19.263156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.263721 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:15:19.263917 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:15:19.264085 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:15:19.264444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.264809 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:15:19.265238 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:15:19.265409 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:15:19.265684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.265855 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:15:19.266026 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
    
      
    ) dbt_internal_test
[0m20:15:19.266689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.267614 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: ROLLBACK
[0m20:15:19.268031 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d'
[0m20:15:19.268234 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: Close
[0m20:15:19.268629 [info ] [Thread-1 (]: 4 of 20 PASS source_not_null_main_raw_events_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:15:19.269041 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:15:19.269435 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:15:19.269765 [info ] [Thread-1 (]: 5 of 20 START test source_not_null_main_raw_orders_created_at .................. [RUN]
[0m20:15:19.270122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d, now test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273)
[0m20:15:19.270334 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:15:19.272659 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:15:19.273177 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:15:19.275181 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
[0m20:15:19.276349 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:15:19.276610 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:15:19.276819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.277512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.277730 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:15:19.278647 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:15:19.279644 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.280272 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:15:19.280491 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:15:19.280681 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:15:19.281103 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.281508 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:15:19.281957 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:15:19.282140 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:15:19.282411 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.282579 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:15:19.282756 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
    
      
    ) dbt_internal_test
[0m20:15:19.283531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.284468 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: ROLLBACK
[0m20:15:19.284873 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273'
[0m20:15:19.285068 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: Close
[0m20:15:19.285405 [info ] [Thread-1 (]: 5 of 20 PASS source_not_null_main_raw_orders_created_at ........................ [[32mPASS[0m in 0.02s]
[0m20:15:19.285694 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:15:19.285892 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:15:19.286075 [info ] [Thread-1 (]: 6 of 20 START test source_not_null_main_raw_orders_order_id .................... [RUN]
[0m20:15:19.286342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273, now test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68)
[0m20:15:19.286542 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:15:19.288844 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:15:19.289266 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:15:19.290350 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
[0m20:15:19.290852 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:15:19.291034 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:15:19.291200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.291558 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.291758 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:15:19.291944 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:15:19.292898 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.293498 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:15:19.293764 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:15:19.293964 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:15:19.294463 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.294839 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:15:19.295239 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:15:19.295411 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:15:19.295672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.295864 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:15:19.296047 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:15:19.296728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.297852 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: ROLLBACK
[0m20:15:19.298211 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68'
[0m20:15:19.298388 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: Close
[0m20:15:19.298689 [info ] [Thread-1 (]: 6 of 20 PASS source_not_null_main_raw_orders_order_id .......................... [[32mPASS[0m in 0.01s]
[0m20:15:19.298960 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:15:19.299151 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:15:19.299355 [info ] [Thread-1 (]: 7 of 20 START test source_not_null_main_raw_orders_total_amount ................ [RUN]
[0m20:15:19.299670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68, now test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681)
[0m20:15:19.299894 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:15:19.302155 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:15:19.302721 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:15:19.304050 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
[0m20:15:19.304647 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:15:19.304869 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:15:19.305070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.305520 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.305724 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:15:19.305914 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:15:19.306804 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.307538 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:15:19.307813 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:15:19.308020 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:15:19.308425 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.308845 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:15:19.309243 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:15:19.309419 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:15:19.309671 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.309845 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:15:19.310023 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
    
      
    ) dbt_internal_test
[0m20:15:19.310724 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.311613 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: ROLLBACK
[0m20:15:19.311984 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681'
[0m20:15:19.312161 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: Close
[0m20:15:19.312458 [info ] [Thread-1 (]: 7 of 20 PASS source_not_null_main_raw_orders_total_amount ...................... [[32mPASS[0m in 0.01s]
[0m20:15:19.312730 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:15:19.312920 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:15:19.313125 [info ] [Thread-1 (]: 8 of 20 START test source_not_null_main_raw_orders_user_id ..................... [RUN]
[0m20:15:19.313322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681, now test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d)
[0m20:15:19.313492 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:15:19.316006 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:15:19.316422 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:15:19.317485 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
[0m20:15:19.317993 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:15:19.318172 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:15:19.318339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.318709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.318912 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:15:19.319098 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:15:19.319827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.320348 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:15:19.320529 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:15:19.320695 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:15:19.321065 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.321404 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:15:19.321802 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:15:19.322001 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:15:19.322269 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.322457 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:15:19.322641 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
    
      
    ) dbt_internal_test
[0m20:15:19.323282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.324141 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: ROLLBACK
[0m20:15:19.324499 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d'
[0m20:15:19.324686 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: Close
[0m20:15:19.324988 [info ] [Thread-1 (]: 8 of 20 PASS source_not_null_main_raw_orders_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:15:19.325262 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:15:19.325457 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:15:19.325672 [info ] [Thread-1 (]: 9 of 20 START test source_not_null_main_raw_users_created_at ................... [RUN]
[0m20:15:19.325909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d, now test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f)
[0m20:15:19.326097 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:15:19.328610 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:15:19.329856 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:15:19.331108 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
[0m20:15:19.331690 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:15:19.331894 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:15:19.332141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.332545 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.332733 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:15:19.332933 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:15:19.333769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.334394 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:15:19.334618 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:15:19.334801 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:15:19.335172 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.335537 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:15:19.335953 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:15:19.336126 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:15:19.336369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.336556 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:15:19.337016 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
    
      
    ) dbt_internal_test
[0m20:15:19.337814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.338732 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: ROLLBACK
[0m20:15:19.339225 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f'
[0m20:15:19.339594 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: Close
[0m20:15:19.340472 [info ] [Thread-1 (]: 9 of 20 PASS source_not_null_main_raw_users_created_at ......................... [[32mPASS[0m in 0.01s]
[0m20:15:19.340806 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:15:19.341014 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:15:19.341235 [info ] [Thread-1 (]: 10 of 20 START test source_not_null_main_raw_users_email ....................... [RUN]
[0m20:15:19.341458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f, now test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2)
[0m20:15:19.341645 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:15:19.343881 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:15:19.344397 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:15:19.348000 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
[0m20:15:19.348581 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:15:19.348776 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:15:19.348950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.349377 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.349620 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:15:19.349816 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:15:19.350456 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.351051 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:15:19.351259 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:15:19.351444 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:15:19.351862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.352234 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:15:19.352669 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:15:19.352843 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:15:19.353095 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.353262 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:15:19.353435 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:15:19.354099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.354965 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: ROLLBACK
[0m20:15:19.355349 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2'
[0m20:15:19.355528 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: Close
[0m20:15:19.356072 [info ] [Thread-1 (]: 10 of 20 PASS source_not_null_main_raw_users_email ............................. [[32mPASS[0m in 0.01s]
[0m20:15:19.356493 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:15:19.356714 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:15:19.356898 [info ] [Thread-1 (]: 11 of 20 START test source_not_null_main_raw_users_user_id ..................... [RUN]
[0m20:15:19.357162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2, now test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2)
[0m20:15:19.357348 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:15:19.360905 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:15:19.361507 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:15:19.363075 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
[0m20:15:19.363630 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:15:19.363822 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:15:19.363992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.364376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.364563 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:15:19.364745 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:15:19.365374 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.365911 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:15:19.366098 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:15:19.366265 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:15:19.366612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.366980 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:15:19.367395 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:15:19.367573 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:15:19.367817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.367980 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:15:19.368151 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:15:19.368711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.369533 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: ROLLBACK
[0m20:15:19.369880 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2'
[0m20:15:19.370056 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: Close
[0m20:15:19.370361 [info ] [Thread-1 (]: 11 of 20 PASS source_not_null_main_raw_users_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:15:19.370638 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:15:19.370830 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:15:19.371027 [info ] [Thread-1 (]: 12 of 20 START test source_unique_main_raw_events_event_id ..................... [RUN]
[0m20:15:19.371224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2, now test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc)
[0m20:15:19.371400 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:15:19.374745 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:15:19.375270 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:15:19.376510 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
[0m20:15:19.377175 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:15:19.377391 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:15:19.377781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.378219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.378425 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:15:19.378620 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:15:19.391469 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m20:15:19.392415 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:15:19.392787 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:15:19.393006 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:15:19.393482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.393993 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:15:19.394918 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:15:19.395127 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:15:19.395462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.395659 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:15:19.395872 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:15:19.396402 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.397708 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: ROLLBACK
[0m20:15:19.398085 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc'
[0m20:15:19.398272 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: Close
[0m20:15:19.398592 [info ] [Thread-1 (]: 12 of 20 PASS source_unique_main_raw_events_event_id ........................... [[32mPASS[0m in 0.03s]
[0m20:15:19.398867 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:15:19.399061 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:15:19.399298 [info ] [Thread-1 (]: 13 of 20 START test source_unique_main_raw_orders_order_id ..................... [RUN]
[0m20:15:19.399616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc, now test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d)
[0m20:15:19.399813 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:15:19.401965 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:15:19.402407 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:15:19.403499 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
[0m20:15:19.404010 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:15:19.404194 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:15:19.404363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.404718 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.404885 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:15:19.405058 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:15:19.408880 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:15:19.409722 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:15:19.409939 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:15:19.410112 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:15:19.410566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.410964 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:15:19.411430 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:15:19.411807 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:15:19.412060 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.412233 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:15:19.412408 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:15:19.412893 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.413694 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: ROLLBACK
[0m20:15:19.414076 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d'
[0m20:15:19.414284 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: Close
[0m20:15:19.414615 [info ] [Thread-1 (]: 13 of 20 PASS source_unique_main_raw_orders_order_id ........................... [[32mPASS[0m in 0.01s]
[0m20:15:19.414920 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:15:19.415121 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:15:19.415350 [info ] [Thread-1 (]: 14 of 20 START test source_unique_main_raw_users_email ......................... [RUN]
[0m20:15:19.415645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d, now test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc)
[0m20:15:19.415832 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:15:19.418286 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:15:19.418778 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:15:19.419890 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
[0m20:15:19.420423 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:15:19.420607 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:15:19.420772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.421155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.421321 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:15:19.421497 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:15:19.424317 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:15:19.424901 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:15:19.425083 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:15:19.425243 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:15:19.425690 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.426090 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:15:19.426574 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:15:19.426963 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:15:19.427693 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.427956 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:15:19.428158 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:15:19.428963 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.430130 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: ROLLBACK
[0m20:15:19.430624 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc'
[0m20:15:19.430893 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: Close
[0m20:15:19.431543 [error] [Thread-1 (]: 14 of 20 FAIL 189 source_unique_main_raw_users_email ........................... [[31mFAIL 189[0m in 0.02s]
[0m20:15:19.432024 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:15:19.432322 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:15:19.432578 [debug] [Thread-4 (]: Marking all children of 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc' to be skipped because of status 'fail'.  Reason: Got 189 results, configured to fail if != 0.
[0m20:15:19.432785 [info ] [Thread-1 (]: 15 of 20 START test source_unique_main_raw_users_user_id ....................... [RUN]
[0m20:15:19.433285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc, now test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd)
[0m20:15:19.433479 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:15:19.436060 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:15:19.436579 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:15:19.437725 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
[0m20:15:19.438231 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:15:19.438411 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:15:19.438569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.438910 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.439074 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:15:19.439242 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:15:19.443262 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:15:19.444071 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:15:19.444290 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:15:19.444470 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:15:19.444885 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.445255 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:15:19.445688 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:15:19.445858 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:15:19.446093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.446255 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:15:19.446422 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:15:19.446922 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.447759 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: ROLLBACK
[0m20:15:19.448129 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd'
[0m20:15:19.448318 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: Close
[0m20:15:19.448649 [info ] [Thread-1 (]: 15 of 20 PASS source_unique_main_raw_users_user_id ............................. [[32mPASS[0m in 0.02s]
[0m20:15:19.448928 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:15:19.449128 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:15:19.449404 [info ] [Thread-1 (]: 16 of 20 START sql view model main.stg_events .................................. [RUN]
[0m20:15:19.449679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd, now model.sbdk_project.stg_events)
[0m20:15:19.449873 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:15:19.451729 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:15:19.452546 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:15:19.469654 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m20:15:19.470298 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:15:19.470535 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m20:15:19.470901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.471354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.471556 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:15:19.471780 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_events"
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m20:15:19.472778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.476609 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:15:19.476958 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m20:15:19.477923 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.479894 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:15:19.480100 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:15:19.480497 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.487556 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:15:19.487834 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:15:19.488012 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:15:19.488983 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.491906 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:15:19.492118 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m20:15:19.492581 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.493351 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m20:15:19.494689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ec77925-2dfe-4ab7-a2c5-fe0463f09852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f7ba0>]}
[0m20:15:19.495058 [info ] [Thread-1 (]: 16 of 20 OK created sql view model main.stg_events ............................. [[32mOK[0m in 0.04s]
[0m20:15:19.495356 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:15:19.495561 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:15:19.495806 [info ] [Thread-1 (]: 17 of 20 START sql view model main.stg_orders .................................. [RUN]
[0m20:15:19.496024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:15:19.496199 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:15:19.498155 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:15:19.498547 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:15:19.500136 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m20:15:19.500517 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:15:19.500692 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m20:15:19.500852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:19.501195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.501357 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:15:19.501585 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_orders"
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m20:15:19.502649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:19.504350 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:15:19.504632 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:15:19.505025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.506517 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:15:19.506710 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:15:19.507077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.508241 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:15:19.508459 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:15:19.508638 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:15:19.509284 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.510614 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:15:19.510819 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m20:15:19.511309 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:19.512194 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m20:15:19.512525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ec77925-2dfe-4ab7-a2c5-fe0463f09852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107779cd0>]}
[0m20:15:19.512863 [info ] [Thread-1 (]: 17 of 20 OK created sql view model main.stg_orders ............................. [[32mOK[0m in 0.02s]
[0m20:15:19.513140 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:15:19.513334 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:15:19.513557 [info ] [Thread-1 (]: 18 of 20 SKIP relation main.stg_users .......................................... [[33mSKIP[0m]
[0m20:15:19.513754 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:15:19.513928 [debug] [Thread-4 (]: Marking all children of 'model.sbdk_project.stg_users' to be skipped because of status 'skipped'. 
[0m20:15:19.514334 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:15:19.514522 [info ] [Thread-1 (]: 19 of 20 SKIP relation main.int_user_activity .................................. [[33mSKIP[0m]
[0m20:15:19.514860 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:15:19.515129 [debug] [Thread-4 (]: Marking all children of 'model.sbdk_project.int_user_activity' to be skipped because of status 'skipped'. 
[0m20:15:19.515563 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:15:19.515766 [info ] [Thread-1 (]: 20 of 20 SKIP relation main.user_metrics ....................................... [[33mSKIP[0m]
[0m20:15:19.515971 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:15:19.516155 [debug] [Thread-4 (]: Marking all children of 'model.sbdk_project.user_metrics' to be skipped because of status 'skipped'. 
[0m20:15:19.516828 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:19.516983 [debug] [MainThread]: On master: BEGIN
[0m20:15:19.517121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:15:19.517506 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:19.517649 [debug] [MainThread]: On master: COMMIT
[0m20:15:19.517784 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:19.517917 [debug] [MainThread]: On master: COMMIT
[0m20:15:19.518252 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:19.518516 [debug] [MainThread]: On master: Close
[0m20:15:19.518765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:19.518912 [debug] [MainThread]: Connection 'model.sbdk_project.stg_orders' was properly closed.
[0m20:15:19.519112 [info ] [MainThread]: 
[0m20:15:19.519283 [info ] [MainThread]: Finished running 1 table model, 15 data tests, 4 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m20:15:19.520594 [debug] [MainThread]: Command end result
[0m20:15:19.537516 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:15:19.538947 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:15:19.542713 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:15:19.542908 [info ] [MainThread]: 
[0m20:15:19.543103 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:15:19.543271 [info ] [MainThread]: 
[0m20:15:19.543502 [error] [MainThread]: [31mFailure in test source_unique_main_raw_users_email (models/_sources.yml)[0m
[0m20:15:19.543773 [error] [MainThread]:   Got 189 results, configured to fail if != 0
[0m20:15:19.543969 [info ] [MainThread]: 
[0m20:15:19.544168 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_main_raw_users_email.sql
[0m20:15:19.544318 [info ] [MainThread]: 
[0m20:15:19.544504 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  -------------------------------------------------------------------------------
[0m20:15:19.544665 [info ] [MainThread]: 
[0m20:15:19.544829 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=20
[0m20:15:19.546862 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.1241307, "process_in_blocks": "0", "process_kernel_time": 0.254684, "process_mem_max_rss": "159956992", "process_out_blocks": "0", "process_user_time": 1.596682}
[0m20:15:19.547210 [debug] [MainThread]: Command `dbt build` failed at 20:15:19.547156 after 1.12 seconds
[0m20:15:19.547458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107802850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107802710>]}
[0m20:15:19.547687 [debug] [MainThread]: Flushing usage events
[0m20:15:20.090683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:25.706078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a35a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f3d90>]}


============================== 20:16:25.709932 | 616f9fb6-c9a8-499d-92eb-9e70d2af8cab ==============================
[0m20:16:25.709932 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:16:25.710354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:26.095315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '616f9fb6-c9a8-499d-92eb-9e70d2af8cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f556e0>]}
[0m20:16:26.145659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '616f9fb6-c9a8-499d-92eb-9e70d2af8cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083baad0>]}
[0m20:16:26.147562 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:16:26.213049 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:16:26.300998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:26.301291 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:26.305211 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:16:26.328336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '616f9fb6-c9a8-499d-92eb-9e70d2af8cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa03d50>]}
[0m20:16:26.379250 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:16:26.381709 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:16:26.399229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '616f9fb6-c9a8-499d-92eb-9e70d2af8cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac31040>]}
[0m20:16:26.399629 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:16:26.399810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616f9fb6-c9a8-499d-92eb-9e70d2af8cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7f7bd0>]}
[0m20:16:26.401116 [info ] [MainThread]: 
[0m20:16:26.401369 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:26.401512 [info ] [MainThread]: 
[0m20:16:26.401836 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:16:26.404375 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:16:26.452928 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:16:26.453228 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:16:26.453395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:26.466712 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:16:26.467969 [debug] [ThreadPool]: On list_dev: Close
[0m20:16:26.468457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:16:26.468732 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:16:26.472477 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:16:26.472714 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:16:26.472866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:26.473425 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:16:26.474344 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:16:26.474523 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:16:26.474768 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:26.474914 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:16:26.475054 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:16:26.475300 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:26.475745 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:16:26.475899 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:16:26.476033 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:16:26.476263 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:26.476429 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:16:26.477682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_dbt_test__audit)
[0m20:16:26.480794 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:16:26.481005 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:16:26.481149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:26.481489 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:26.481628 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:16:26.481775 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:16:26.490208 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:16:26.541927 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:16:26.543023 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:16:26.543441 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:16:26.543823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:16:26.545904 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:16:26.546072 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:16:26.546211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:26.546537 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:26.546675 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:16:26.546815 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:16:26.548979 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:16:26.549692 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:16:26.550011 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:16:26.550147 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:16:26.550782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616f9fb6-c9a8-499d-92eb-9e70d2af8cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b23a5b0>]}
[0m20:16:26.551030 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:26.551177 [debug] [MainThread]: On master: BEGIN
[0m20:16:26.551305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:26.551521 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:16:26.551661 [debug] [MainThread]: On master: COMMIT
[0m20:16:26.551789 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:26.551914 [debug] [MainThread]: On master: COMMIT
[0m20:16:26.552100 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:16:26.552233 [debug] [MainThread]: On master: Close
[0m20:16:26.553700 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:16:26.553964 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_events .................................... [RUN]
[0m20:16:26.554185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.sbdk_project.stg_events)
[0m20:16:26.554361 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:16:26.559317 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:16:26.560222 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:16:26.577014 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m20:16:26.577556 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:16:26.577741 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m20:16:26.577900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:26.578245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.578412 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:16:26.578611 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_events"
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m20:16:26.579454 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:26.582599 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:16:26.582794 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m20:16:26.583401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.584687 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:16:26.584864 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:16:26.585146 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.591507 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:16:26.591718 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:16:26.591885 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:16:26.592694 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:26.595342 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:16:26.595543 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m20:16:26.595920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.597128 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m20:16:26.598243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616f9fb6-c9a8-499d-92eb-9e70d2af8cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa7de50>]}
[0m20:16:26.598594 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.04s]
[0m20:16:26.598888 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:16:26.599095 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:16:26.599324 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_orders .................................... [RUN]
[0m20:16:26.599597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:16:26.599778 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:16:26.601505 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:16:26.602002 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:16:26.604180 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m20:16:26.604666 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:16:26.604847 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m20:16:26.605008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:26.605400 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.605584 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:16:26.605827 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_orders"
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m20:16:26.606958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:26.608527 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:16:26.608703 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:16:26.609014 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.610304 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:16:26.610473 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:16:26.610737 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.611501 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:16:26.611668 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:16:26.611818 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:16:26.612328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.613677 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:16:26.613858 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m20:16:26.614295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.615021 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m20:16:26.615350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616f9fb6-c9a8-499d-92eb-9e70d2af8cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afaea40>]}
[0m20:16:26.615690 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.02s]
[0m20:16:26.615972 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:16:26.616176 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:16:26.616439 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_users ..................................... [RUN]
[0m20:16:26.616651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:16:26.616831 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:16:26.618404 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:16:26.618798 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:16:26.620584 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:16:26.620936 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:16:26.621106 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:16:26.621262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:26.621635 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.621897 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:16:26.622172 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_users"
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:16:26.624749 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:16:26.626689 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:16:26.626903 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m20:16:26.627316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.628665 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:16:26.628850 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:16:26.629153 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.629903 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:16:26.630072 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:16:26.630229 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:16:26.630694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.632045 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:16:26.632222 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m20:16:26.632568 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.633210 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:16:26.633484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616f9fb6-c9a8-499d-92eb-9e70d2af8cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab4c910>]}
[0m20:16:26.633791 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.02s]
[0m20:16:26.634052 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:16:26.634373 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:16:26.634628 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_user_activity ............................. [RUN]
[0m20:16:26.634844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now model.sbdk_project.int_user_activity)
[0m20:16:26.635013 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m20:16:26.636920 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m20:16:26.637620 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m20:16:26.639355 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.int_user_activity"
[0m20:16:26.639990 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:16:26.640160 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: BEGIN
[0m20:16:26.640313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:26.640595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.640756 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:16:26.641053 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

  
  create view "dev"."main"."int_user_activity__dbt_tmp" as (
    

with users as (
    select * from "dev"."main"."stg_users"
),

events as (
    select * from "dev"."main"."stg_events"
),

orders as (
    select * from "dev"."main"."stg_orders"
),

user_events as (
    select
        user_id,
        count(*) as total_events,
        count(*) filter (where event_type = 'page_view') as pageviews,
        count(*) filter (where event_type = 'click') as clicks,
        count(*) filter (where event_type = 'signup') as signups,
        count(*) filter (where event_type = 'login') as logins,
        count(*) filter (where event_type = 'purchase') as purchase_events,
        count(*) filter (where is_conversion_event = true) as conversion_events,
        count(*) filter (where is_revenue_event = true) as revenue_events,
        coalesce(sum(revenue), 0) as total_event_revenue,
        coalesce(sum(duration_seconds), 0) as total_time_on_site,
        count(distinct session_id) filter (where session_id is not null) as unique_sessions,
        count(distinct event_date) as active_days,
        min(timestamp) as first_event_at,
        max(timestamp) as last_event_at,
        count(distinct traffic_category) as traffic_sources_used
    from events
    group by user_id
),

user_orders as (
    select
        user_id,
        count(*) as total_orders,
        count(*) filter (where is_completed = true) as completed_orders,
        count(*) filter (where is_failed = true) as failed_orders,
        count(*) filter (where is_recurring = true) as recurring_orders,
        coalesce(sum(total_amount) filter (where is_completed = true), 0) as total_order_revenue,
        coalesce(avg(total_amount) filter (where is_completed = true), 0) as avg_order_value,
        coalesce(sum(discount_amount), 0) as total_discounts_used,
        count(distinct product_category) as product_categories_purchased,
        min(created_at) as first_order_at,
        max(created_at) as last_order_at,
        count(distinct payment_method) as payment_methods_used
    from orders
    group by user_id
),

combined as (
    select
        u.user_id,
        u.username,
        u.email,
        u.first_name,
        u.last_name,
        u.created_at as user_created_at,
        u.country,
        u.city,
        u.subscription_tier,
        u.referrer,
        u.is_active,
        u.age,
        u.is_paid_subscriber,
        u.days_since_signup,
        u.has_complete_profile,
        
        -- Event metrics
        coalesce(e.total_events, 0) as total_events,
        coalesce(e.pageviews, 0) as pageviews,
        coalesce(e.clicks, 0) as clicks,
        coalesce(e.signups, 0) as signups,
        coalesce(e.logins, 0) as logins,
        coalesce(e.purchase_events, 0) as purchase_events,
        coalesce(e.conversion_events, 0) as conversion_events,
        coalesce(e.revenue_events, 0) as revenue_events,
        coalesce(e.total_event_revenue, 0) as total_event_revenue,
        coalesce(e.total_time_on_site, 0) as total_time_on_site,
        coalesce(e.unique_sessions, 0) as unique_sessions,
        coalesce(e.active_days, 0) as active_days,
        e.first_event_at,
        e.last_event_at,
        coalesce(e.traffic_sources_used, 0) as traffic_sources_used,
        
        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.failed_orders, 0) as failed_orders,
        coalesce(o.recurring_orders, 0) as recurring_orders,
        coalesce(o.total_order_revenue, 0) as total_order_revenue,
        coalesce(o.avg_order_value, 0) as avg_order_value,
        coalesce(o.total_discounts_used, 0) as total_discounts_used,
        coalesce(o.product_categories_purchased, 0) as product_categories_purchased,
        o.first_order_at,
        o.last_order_at,
        coalesce(o.payment_methods_used, 0) as payment_methods_used,
        
        -- Calculated metrics
        case 
            when e.pageviews > 0 and o.completed_orders > 0 
            then round(o.completed_orders::float / e.pageviews * 100, 2)
            else 0 
        end as purchase_conversion_rate,
        
        case 
            when e.total_events > 0 
            then round(e.conversion_events::float / e.total_events * 100, 2)
            else 0 
        end as event_conversion_rate,
        
        case 
            when e.unique_sessions > 0 
            then round(e.total_events::float / e.unique_sessions, 2)
            else 0 
        end as events_per_session,
        
        case 
            when u.days_since_signup > 0 and e.active_days > 0
            then round(e.active_days::float / u.days_since_signup * 100, 2)
            else 0 
        end as activity_frequency_percentage,
        
        -- Total combined revenue
        coalesce(e.total_event_revenue, 0) + coalesce(o.total_order_revenue, 0) as total_revenue,
        
        -- User activity classification
        case 
            when o.completed_orders > 0 then 'customer'
            when e.signups > 0 then 'signed_up'
            when e.total_events > 10 then 'engaged_visitor'
            when e.total_events > 0 then 'visitor'
            else 'inactive'
        end as user_type
        
    from users u
    left join user_events e on u.user_id = e.user_id
    left join user_orders o on u.user_id = o.user_id
)

select * from combined
  );

[0m20:16:26.644255 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:16:26.645720 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:16:26.646727 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity__dbt_tmp" rename to "int_user_activity"
[0m20:16:26.647089 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.647803 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:16:26.647988 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:16:26.648151 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:16:26.648678 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.649735 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:16:26.649912 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

      drop view if exists "dev"."main"."int_user_activity__dbt_backup" cascade
    
[0m20:16:26.650186 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.650827 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: Close
[0m20:16:26.651103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616f9fb6-c9a8-499d-92eb-9e70d2af8cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab20350>]}
[0m20:16:26.651409 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_user_activity ........................ [[32mOK[0m in 0.02s]
[0m20:16:26.651772 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:16:26.652077 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:16:26.652422 [info ] [Thread-1 (]: 5 of 5 START sql table model main.user_metrics ................................. [RUN]
[0m20:16:26.653241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m20:16:26.653411 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m20:16:26.655319 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m20:16:26.655900 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m20:16:26.667170 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.user_metrics"
[0m20:16:26.667885 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:16:26.668094 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: BEGIN
[0m20:16:26.668267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:26.668724 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.668929 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:16:26.669220 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

  
    
    

    create  table
      "dev"."main"."user_metrics__dbt_tmp"
  
    as (
      

with user_activity as (
    select * from "dev"."main"."int_user_activity"
),

final as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        user_created_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        age,
        is_paid_subscriber,
        days_since_signup,
        has_complete_profile,
        
        -- Engagement metrics
        total_events,
        pageviews,
        clicks,
        logins,
        unique_sessions,
        active_days,
        traffic_sources_used,
        events_per_session,
        activity_frequency_percentage,
        total_time_on_site,
        
        -- Conversion metrics
        signups,
        purchase_events,
        conversion_events,
        purchase_conversion_rate,
        event_conversion_rate,
        
        -- Revenue metrics
        total_orders,
        completed_orders,
        failed_orders,
        recurring_orders,
        total_order_revenue,
        total_event_revenue,
        total_revenue,
        avg_order_value,
        total_discounts_used,
        product_categories_purchased,
        payment_methods_used,
        
        -- Timing metrics
        first_event_at,
        last_event_at,
        first_order_at,
        last_order_at,
        
        -- User classification
        user_type,
        
        -- Customer lifetime value estimate
        case 
            when recurring_orders > 0 and days_since_signup > 0
            then round(total_revenue * (365.0 / days_since_signup) * 2, 2)  -- Rough 2-year CLV estimate
            else total_revenue 
        end as estimated_clv,
        
        -- Engagement score (0-100)
        least(100, 
            (case when active_days > 0 then least(25, active_days) else 0 end) +
            (case when unique_sessions > 0 then least(25, unique_sessions) else 0 end) +
            (case when total_events > 0 then least(25, least(25, total_events / 10)) else 0 end) +
            (case when completed_orders > 0 then 25 else 0 end)
        ) as engagement_score,
        
        -- Risk classification
        case 
            when last_event_at < current_date - interval '90 days' and total_orders > 0 then 'churn_risk'
            when last_event_at < current_date - interval '30 days' and user_type = 'customer' then 'at_risk'
            when activity_frequency_percentage < 10 and days_since_signup > 30 then 'low_engagement'
            when user_type = 'customer' and recurring_orders = 0 then 'one_time_buyer'
            when user_type = 'customer' and recurring_orders > 0 then 'loyal_customer'
            when user_type = 'engaged_visitor' then 'potential_customer'
            else 'standard'
        end as risk_category,
        
        -- Value tier
        case 
            when total_revenue >= 1000 then 'high_value'
            when total_revenue >= 500 then 'medium_value'
            when total_revenue >= 100 then 'low_value'
            when total_revenue > 0 then 'minimal_value'
            else 'no_value'
        end as value_tier,
        
        -- Recency, Frequency, Monetary (RFM) components
        case 
            when last_order_at >= current_date - interval '30 days' then 5
            when last_order_at >= current_date - interval '60 days' then 4
            when last_order_at >= current_date - interval '90 days' then 3
            when last_order_at >= current_date - interval '180 days' then 2
            when last_order_at is not null then 1
            else 0
        end as recency_score,
        
        case 
            when completed_orders >= 10 then 5
            when completed_orders >= 5 then 4
            when completed_orders >= 3 then 3
            when completed_orders >= 2 then 2
            when completed_orders >= 1 then 1
            else 0
        end as frequency_score,
        
        case 
            when total_revenue >= 1000 then 5
            when total_revenue >= 500 then 4
            when total_revenue >= 200 then 3
            when total_revenue >= 50 then 2
            when total_revenue > 0 then 1
            else 0
        end as monetary_score,
        
        -- Data freshness
        current_timestamp as updated_at
        
    from user_activity
)

select * from final
    );
  
  
[0m20:16:26.753476 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m20:16:26.757386 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:16:26.757696 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics__dbt_tmp" rename to "user_metrics"
[0m20:16:26.758407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.762335 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:16:26.762639 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:16:26.762824 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:16:26.769197 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:16:26.770583 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:16:26.770776 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

      drop table if exists "dev"."main"."user_metrics__dbt_backup" cascade
    
[0m20:16:26.771109 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:26.771815 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: Close
[0m20:16:26.772099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616f9fb6-c9a8-499d-92eb-9e70d2af8cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b35f070>]}
[0m20:16:26.772402 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.user_metrics ............................ [[32mOK[0m in 0.12s]
[0m20:16:26.772664 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:16:26.773313 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:26.773468 [debug] [MainThread]: On master: BEGIN
[0m20:16:26.773599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:16:26.773843 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:16:26.773976 [debug] [MainThread]: On master: COMMIT
[0m20:16:26.774110 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:26.774239 [debug] [MainThread]: On master: COMMIT
[0m20:16:26.774427 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:16:26.774558 [debug] [MainThread]: On master: Close
[0m20:16:26.774730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:26.774859 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m20:16:26.775024 [info ] [MainThread]: 
[0m20:16:26.775177 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m20:16:26.775731 [debug] [MainThread]: Command end result
[0m20:16:26.790867 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:16:26.792029 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:16:26.797046 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:16:26.797279 [info ] [MainThread]: 
[0m20:16:26.797637 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:16:26.797824 [info ] [MainThread]: 
[0m20:16:26.798088 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:16:26.800309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1517508, "process_in_blocks": "0", "process_kernel_time": 0.291856, "process_mem_max_rss": "216809472", "process_out_blocks": "0", "process_user_time": 1.590423}
[0m20:16:26.800598 [debug] [MainThread]: Command `dbt run` succeeded at 20:16:26.800551 after 1.15 seconds
[0m20:16:26.800808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4fb470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7fdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b083b90>]}
[0m20:16:26.801005 [debug] [MainThread]: Flushing usage events
[0m20:16:27.153531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:28.390516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107685a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193f3d90>]}


============================== 20:16:28.394329 | 06c46882-4242-451d-8579-40961b25ddaa ==============================
[0m20:16:28.394329 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:16:28.394736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:16:28.534091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06c46882-4242-451d-8579-40961b25ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a556e0>]}
[0m20:16:28.575777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06c46882-4242-451d-8579-40961b25ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074faad0>]}
[0m20:16:28.577213 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:16:28.630386 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:16:28.698790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:28.699066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:28.702617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:16:28.726260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06c46882-4242-451d-8579-40961b25ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119603c50>]}
[0m20:16:28.791941 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:16:28.793243 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:16:28.810034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06c46882-4242-451d-8579-40961b25ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f35b80>]}
[0m20:16:28.810426 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:16:28.810606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c46882-4242-451d-8579-40961b25ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119fd90f0>]}
[0m20:16:28.811947 [info ] [MainThread]: 
[0m20:16:28.812138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:28.812278 [info ] [MainThread]: 
[0m20:16:28.812528 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:16:28.815273 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:16:28.900553 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:16:28.900799 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:16:28.900949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:28.911614 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:16:28.912387 [debug] [ThreadPool]: On list_dev: Close
[0m20:16:28.912723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:16:28.912945 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:16:28.916512 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:16:28.916795 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:16:28.916981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:28.917640 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:16:28.918410 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:16:28.918572 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:16:28.918806 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:28.918947 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:16:28.919086 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:16:28.919319 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:28.919738 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:16:28.919880 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:16:28.920011 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:16:28.920196 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:28.920333 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:16:28.921461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main_dbt_test__audit)
[0m20:16:28.924924 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:16:28.925182 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:16:28.925339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:28.925649 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:28.925793 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:16:28.925939 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:16:28.933681 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:16:28.934664 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:16:28.935291 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:16:28.935453 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:16:28.935734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:16:28.936716 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:16:28.936863 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:16:28.936993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:28.938255 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:16:28.938414 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:16:28.938672 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:16:28.943649 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m20:16:28.945901 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:16:28.946421 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:16:28.946614 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:16:28.948393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c46882-4242-451d-8579-40961b25ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b9ea750>]}
[0m20:16:28.948700 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:28.948859 [debug] [MainThread]: On master: BEGIN
[0m20:16:28.949031 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:28.949383 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:16:28.949552 [debug] [MainThread]: On master: COMMIT
[0m20:16:28.949695 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:28.949828 [debug] [MainThread]: On master: COMMIT
[0m20:16:28.950131 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:16:28.950292 [debug] [MainThread]: On master: Close
[0m20:16:28.951665 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:16:28.951936 [info ] [Thread-1 (]: 1 of 15 START test source_not_null_main_raw_events_event_id .................... [RUN]
[0m20:16:28.952422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a)
[0m20:16:28.953060 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:16:28.966911 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:16:28.968616 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:16:28.982050 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:16:28.982417 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id" cascade
    
[0m20:16:28.982668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:28.984007 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:28.986001 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
[0m20:16:28.999828 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:16:29.000552 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:16:29.001463 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.001733 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:16:29.001930 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:16:29.002742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.003394 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:16:29.003610 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:16:29.003858 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:16:29.004311 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.006608 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:16:29.007403 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:16:29.007628 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:16:29.008021 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.008205 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:16:29.008388 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:16:29.009186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.011750 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: ROLLBACK
[0m20:16:29.012176 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a'
[0m20:16:29.012363 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: Close
[0m20:16:29.012702 [info ] [Thread-1 (]: 1 of 15 PASS source_not_null_main_raw_events_event_id .......................... [[32mPASS[0m in 0.06s]
[0m20:16:29.012990 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:16:29.013196 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:16:29.013452 [info ] [Thread-1 (]: 2 of 15 START test source_not_null_main_raw_events_event_type .................. [RUN]
[0m20:16:29.013778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a, now test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b)
[0m20:16:29.013983 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:16:29.016416 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:16:29.017255 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:16:29.020071 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:16:29.020279 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type" cascade
    
[0m20:16:29.020445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.020951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.021534 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
[0m20:16:29.022033 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:16:29.022210 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:16:29.022480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.022643 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:16:29.022813 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:16:29.023462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.023983 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:16:29.024175 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:16:29.024347 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:16:29.024663 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.024998 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:16:29.025440 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:16:29.025603 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:16:29.025846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.026017 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:16:29.026212 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
    
      
    ) dbt_internal_test
[0m20:16:29.026796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.027587 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: ROLLBACK
[0m20:16:29.027950 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b'
[0m20:16:29.028125 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: Close
[0m20:16:29.028433 [info ] [Thread-1 (]: 2 of 15 PASS source_not_null_main_raw_events_event_type ........................ [[32mPASS[0m in 0.01s]
[0m20:16:29.028707 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:16:29.028902 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:16:29.029125 [info ] [Thread-1 (]: 3 of 15 START test source_not_null_main_raw_events_timestamp ................... [RUN]
[0m20:16:29.029359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b, now test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d)
[0m20:16:29.029545 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:16:29.031886 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:16:29.032347 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:16:29.034353 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:16:29.034543 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp" cascade
    
[0m20:16:29.034710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.035210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.035808 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
[0m20:16:29.036311 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:16:29.036483 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:16:29.036743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.036905 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:16:29.037072 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:16:29.038074 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.038956 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:16:29.039244 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:16:29.039452 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:16:29.039910 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.040848 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:16:29.041610 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:16:29.041815 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:16:29.042235 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.042415 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:16:29.042592 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
    
      
    ) dbt_internal_test
[0m20:16:29.043456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.044398 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: ROLLBACK
[0m20:16:29.044811 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d'
[0m20:16:29.044997 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: Close
[0m20:16:29.045336 [info ] [Thread-1 (]: 3 of 15 PASS source_not_null_main_raw_events_timestamp ......................... [[32mPASS[0m in 0.02s]
[0m20:16:29.045610 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:16:29.045805 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:16:29.046024 [info ] [Thread-1 (]: 4 of 15 START test source_not_null_main_raw_events_user_id ..................... [RUN]
[0m20:16:29.046829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d, now test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d)
[0m20:16:29.047245 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:16:29.053250 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:16:29.055167 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:16:29.062409 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:16:29.063033 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id" cascade
    
[0m20:16:29.063520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.065042 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:16:29.068568 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
[0m20:16:29.069663 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:16:29.069894 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:16:29.071079 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.071426 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:16:29.075714 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:16:29.078506 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:16:29.080496 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:16:29.080884 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:16:29.081517 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:16:29.086794 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:16:29.090693 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:16:29.115715 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:16:29.116141 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:16:29.145029 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.148788 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:16:29.150582 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
    
      
    ) dbt_internal_test
[0m20:16:29.151978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.154678 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: ROLLBACK
[0m20:16:29.155966 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d'
[0m20:16:29.156402 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: Close
[0m20:16:29.157633 [info ] [Thread-1 (]: 4 of 15 PASS source_not_null_main_raw_events_user_id ........................... [[32mPASS[0m in 0.11s]
[0m20:16:29.159246 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:16:29.160343 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:16:29.160979 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_main_raw_orders_created_at .................. [RUN]
[0m20:16:29.161601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d, now test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273)
[0m20:16:29.162030 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:16:29.173235 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:16:29.196343 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:16:29.211599 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:16:29.212657 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at" cascade
    
[0m20:16:29.213193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.214092 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.217387 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
[0m20:16:29.229282 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:16:29.231074 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:16:29.233024 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.233711 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:16:29.234038 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:16:29.255702 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m20:16:29.256900 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:16:29.257914 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:16:29.258211 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:16:29.264161 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:16:29.270204 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:16:29.281032 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:16:29.281919 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:16:29.282377 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.283638 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:16:29.286546 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
    
      
    ) dbt_internal_test
[0m20:16:29.302574 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:16:29.304481 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: ROLLBACK
[0m20:16:29.305124 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273'
[0m20:16:29.305334 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: Close
[0m20:16:29.305796 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_main_raw_orders_created_at ........................ [[32mPASS[0m in 0.14s]
[0m20:16:29.306110 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:16:29.306332 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:16:29.306520 [info ] [Thread-1 (]: 6 of 15 START test source_not_null_main_raw_orders_order_id .................... [RUN]
[0m20:16:29.306743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273, now test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68)
[0m20:16:29.306926 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:16:29.328581 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:16:29.329429 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:16:29.332784 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:16:29.333068 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id" cascade
    
[0m20:16:29.333753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.334997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.340771 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
[0m20:16:29.342309 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:16:29.342653 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:16:29.343076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.343283 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:16:29.343475 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:16:29.346615 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:16:29.347311 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:16:29.347524 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:16:29.347705 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:16:29.348189 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.348622 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:16:29.350834 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:16:29.351110 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:16:29.351481 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.351655 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:16:29.351831 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:16:29.352591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.353504 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: ROLLBACK
[0m20:16:29.353919 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68'
[0m20:16:29.354106 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: Close
[0m20:16:29.354420 [info ] [Thread-1 (]: 6 of 15 PASS source_not_null_main_raw_orders_order_id .......................... [[32mPASS[0m in 0.05s]
[0m20:16:29.354682 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:16:29.354871 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:16:29.355078 [info ] [Thread-1 (]: 7 of 15 START test source_not_null_main_raw_orders_total_amount ................ [RUN]
[0m20:16:29.355305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68, now test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681)
[0m20:16:29.355484 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:16:29.358207 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:16:29.358716 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:16:29.361352 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:16:29.361632 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount" cascade
    
[0m20:16:29.361823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.362351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.363494 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
[0m20:16:29.364113 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:16:29.364306 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:16:29.364700 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.364882 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:16:29.365065 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:16:29.365802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.366361 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:16:29.366560 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:16:29.366734 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:16:29.367119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.367514 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:16:29.368012 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:16:29.368195 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:16:29.368533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.368734 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:16:29.368921 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
    
      
    ) dbt_internal_test
[0m20:16:29.369658 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.370508 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: ROLLBACK
[0m20:16:29.370891 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681'
[0m20:16:29.371068 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: Close
[0m20:16:29.371405 [info ] [Thread-1 (]: 7 of 15 PASS source_not_null_main_raw_orders_total_amount ...................... [[32mPASS[0m in 0.02s]
[0m20:16:29.371704 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:16:29.371908 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:16:29.372119 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_main_raw_orders_user_id ..................... [RUN]
[0m20:16:29.372327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681, now test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d)
[0m20:16:29.372507 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:16:29.375025 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:16:29.375715 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:16:29.384111 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:16:29.384360 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id" cascade
    
[0m20:16:29.384545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.385139 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.385809 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
[0m20:16:29.386341 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:16:29.386518 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:16:29.386784 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.386951 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:16:29.387123 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:16:29.387867 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.388339 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:16:29.388508 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:16:29.388661 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:16:29.388975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.389309 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:16:29.389715 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:16:29.389884 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:16:29.390150 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.390341 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:16:29.390521 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
    
      
    ) dbt_internal_test
[0m20:16:29.391170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.392109 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: ROLLBACK
[0m20:16:29.392492 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d'
[0m20:16:29.392668 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: Close
[0m20:16:29.393076 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_main_raw_orders_user_id ........................... [[32mPASS[0m in 0.02s]
[0m20:16:29.393483 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:16:29.394234 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:16:29.394452 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_main_raw_users_created_at ................... [RUN]
[0m20:16:29.394789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d, now test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f)
[0m20:16:29.395170 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:16:29.397877 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:16:29.398458 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:16:29.401113 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:16:29.401334 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at" cascade
    
[0m20:16:29.401510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.402069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.402649 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
[0m20:16:29.403155 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:16:29.403324 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:16:29.403562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.403730 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:16:29.403902 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:16:29.404494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.404952 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:16:29.405118 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:16:29.405270 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:16:29.405605 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.405938 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:16:29.406322 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:16:29.406483 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:16:29.406703 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.406864 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:16:29.407030 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
    
      
    ) dbt_internal_test
[0m20:16:29.407546 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.408306 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: ROLLBACK
[0m20:16:29.408667 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f'
[0m20:16:29.408840 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: Close
[0m20:16:29.409112 [info ] [Thread-1 (]: 9 of 15 PASS source_not_null_main_raw_users_created_at ......................... [[32mPASS[0m in 0.01s]
[0m20:16:29.409367 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:16:29.409629 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:16:29.409915 [info ] [Thread-1 (]: 10 of 15 START test source_not_null_main_raw_users_email ....................... [RUN]
[0m20:16:29.410207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f, now test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2)
[0m20:16:29.410402 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:16:29.412711 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:16:29.413119 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:16:29.414912 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:16:29.415085 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email" cascade
    
[0m20:16:29.415243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.415695 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.416216 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
[0m20:16:29.416675 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:16:29.416846 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:16:29.417082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.417242 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:16:29.417411 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:16:29.417972 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.418486 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:16:29.418686 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:16:29.418858 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:16:29.419208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.419552 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:16:29.419955 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:16:29.420118 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:16:29.420340 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.420501 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:16:29.420670 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:16:29.421180 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.421921 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: ROLLBACK
[0m20:16:29.422254 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2'
[0m20:16:29.422415 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: Close
[0m20:16:29.422686 [info ] [Thread-1 (]: 10 of 15 PASS source_not_null_main_raw_users_email ............................. [[32mPASS[0m in 0.01s]
[0m20:16:29.422942 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:16:29.423124 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:16:29.423328 [info ] [Thread-1 (]: 11 of 15 START test source_not_null_main_raw_users_user_id ..................... [RUN]
[0m20:16:29.423548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2, now test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2)
[0m20:16:29.423726 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:16:29.426151 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:16:29.426547 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:16:29.428417 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:16:29.428595 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id" cascade
    
[0m20:16:29.428753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.429206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.429718 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
[0m20:16:29.430439 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:16:29.430613 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:16:29.430860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.431020 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:16:29.431187 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:16:29.431728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.432250 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:16:29.432440 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:16:29.432596 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:16:29.432905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.433237 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:16:29.433624 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:16:29.433789 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:16:29.434012 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.434171 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:16:29.434336 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:16:29.434860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.435618 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: ROLLBACK
[0m20:16:29.435963 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2'
[0m20:16:29.436125 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: Close
[0m20:16:29.436402 [info ] [Thread-1 (]: 11 of 15 PASS source_not_null_main_raw_users_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:16:29.436656 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:16:29.436837 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:16:29.437048 [info ] [Thread-1 (]: 12 of 15 START test source_unique_main_raw_events_event_id ..................... [RUN]
[0m20:16:29.437292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2, now test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc)
[0m20:16:29.437479 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:16:29.440705 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:16:29.441115 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:16:29.443605 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:16:29.443923 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id" cascade
    
[0m20:16:29.444135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.444715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.445469 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
[0m20:16:29.446381 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:16:29.446590 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:16:29.446955 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.447124 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:16:29.447299 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:16:29.455752 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:16:29.456850 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:16:29.457091 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:16:29.457349 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:16:29.457828 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.458227 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:16:29.458811 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:16:29.459002 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:16:29.459309 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.459509 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:16:29.459690 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:16:29.460476 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.461588 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: ROLLBACK
[0m20:16:29.462008 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc'
[0m20:16:29.462185 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: Close
[0m20:16:29.462515 [info ] [Thread-1 (]: 12 of 15 PASS source_unique_main_raw_events_event_id ........................... [[32mPASS[0m in 0.03s]
[0m20:16:29.462793 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:16:29.462994 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:16:29.463210 [info ] [Thread-1 (]: 13 of 15 START test source_unique_main_raw_orders_order_id ..................... [RUN]
[0m20:16:29.463440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc, now test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d)
[0m20:16:29.463621 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:16:29.465962 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:16:29.466478 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:16:29.468837 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:16:29.469081 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id" cascade
    
[0m20:16:29.469298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.469828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.470396 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
[0m20:16:29.470872 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:16:29.471041 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:16:29.471284 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.471451 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:16:29.471627 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:16:29.473910 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:16:29.474431 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:16:29.474610 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:16:29.474771 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:16:29.475106 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.475454 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:16:29.475848 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:16:29.476009 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:16:29.476266 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.476426 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:16:29.476617 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:16:29.477259 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.478066 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: ROLLBACK
[0m20:16:29.478425 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d'
[0m20:16:29.478599 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: Close
[0m20:16:29.478885 [info ] [Thread-1 (]: 13 of 15 PASS source_unique_main_raw_orders_order_id ........................... [[32mPASS[0m in 0.02s]
[0m20:16:29.479145 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:16:29.479327 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:16:29.479516 [info ] [Thread-1 (]: 14 of 15 START test source_unique_main_raw_users_email ......................... [RUN]
[0m20:16:29.479699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d, now test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc)
[0m20:16:29.479866 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:16:29.481865 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:16:29.482266 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:16:29.484345 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:16:29.484537 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email" cascade
    
[0m20:16:29.484711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.485260 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.485823 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
[0m20:16:29.486290 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:16:29.486453 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:16:29.486689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.486854 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:16:29.487024 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:16:29.488568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.489063 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:16:29.489237 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:16:29.489394 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:16:29.489884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.490217 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:16:29.490612 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:16:29.490776 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:16:29.491003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.491157 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:16:29.491323 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:16:29.491785 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.492629 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: ROLLBACK
[0m20:16:29.493080 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc'
[0m20:16:29.493272 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: Close
[0m20:16:29.493595 [error] [Thread-1 (]: 14 of 15 FAIL 191 source_unique_main_raw_users_email ........................... [[31mFAIL 191[0m in 0.01s]
[0m20:16:29.493867 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:16:29.494052 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:16:29.494244 [info ] [Thread-1 (]: 15 of 15 START test source_unique_main_raw_users_user_id ....................... [RUN]
[0m20:16:29.494430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc, now test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd)
[0m20:16:29.494599 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:16:29.496623 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:16:29.496971 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:16:29.499218 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:16:29.499427 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id" cascade
    
[0m20:16:29.499603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.500109 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.500715 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
[0m20:16:29.501350 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:16:29.501538 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:16:29.501965 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.502161 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:16:29.502369 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:16:29.503487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:29.504016 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:16:29.504195 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:16:29.504353 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:16:29.504693 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.505043 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:16:29.505459 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:16:29.505623 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:16:29.505855 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.506015 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:16:29.506182 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:16:29.506588 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:29.507378 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: ROLLBACK
[0m20:16:29.507730 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd'
[0m20:16:29.507900 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: Close
[0m20:16:29.508177 [info ] [Thread-1 (]: 15 of 15 PASS source_unique_main_raw_users_user_id ............................. [[32mPASS[0m in 0.01s]
[0m20:16:29.508430 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:16:29.509202 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:29.509349 [debug] [MainThread]: On master: BEGIN
[0m20:16:29.509502 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:16:29.509794 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:16:29.509973 [debug] [MainThread]: On master: COMMIT
[0m20:16:29.510230 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:29.510427 [debug] [MainThread]: On master: COMMIT
[0m20:16:29.510741 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:16:29.510890 [debug] [MainThread]: On master: Close
[0m20:16:29.511177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:29.511315 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd' was properly closed.
[0m20:16:29.511803 [info ] [MainThread]: 
[0m20:16:29.512124 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m20:16:29.513423 [debug] [MainThread]: Command end result
[0m20:16:29.531399 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:16:29.533238 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:16:29.537641 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:16:29.537814 [info ] [MainThread]: 
[0m20:16:29.538006 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:16:29.538149 [info ] [MainThread]: 
[0m20:16:29.538341 [error] [MainThread]: [31mFailure in test source_unique_main_raw_users_email (models/_sources.yml)[0m
[0m20:16:29.538506 [error] [MainThread]:   Got 191 results, configured to fail if != 0
[0m20:16:29.538630 [info ] [MainThread]: 
[0m20:16:29.538790 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_main_raw_users_email.sql
[0m20:16:29.538919 [info ] [MainThread]: 
[0m20:16:29.539081 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  -------------------------------------------------------------------------------
[0m20:16:29.539217 [info ] [MainThread]: 
[0m20:16:29.539366 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=15
[0m20:16:29.540968 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.2016635, "process_in_blocks": "0", "process_kernel_time": 0.224763, "process_mem_max_rss": "147439616", "process_out_blocks": "0", "process_user_time": 1.530721}
[0m20:16:29.541275 [debug] [MainThread]: Command `dbt test` failed at 20:16:29.541235 after 1.20 seconds
[0m20:16:29.541541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119425910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba13cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba13c20>]}
[0m20:16:29.541758 [debug] [MainThread]: Flushing usage events
[0m20:16:30.021924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:17:25.760367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af3d90>]}


============================== 20:17:25.766385 | 99f74b96-b24b-4fa2-adf3-6a945b690ee7 ==============================
[0m20:17:25.766385 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:17:25.766744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'log_path': 'dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:17:25.912101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99f74b96-b24b-4fa2-adf3-6a945b690ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073516e0>]}
[0m20:17:25.952036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99f74b96-b24b-4fa2-adf3-6a945b690ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106662ad0>]}
[0m20:17:25.953772 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:17:26.009754 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:17:26.088719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:17:26.088953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:17:26.092603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:17:26.114808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99f74b96-b24b-4fa2-adf3-6a945b690ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c03d50>]}
[0m20:17:26.162455 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:17:26.163884 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:17:26.177708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99f74b96-b24b-4fa2-adf3-6a945b690ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e31040>]}
[0m20:17:26.177970 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:17:26.178135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99f74b96-b24b-4fa2-adf3-6a945b690ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f7bd0>]}
[0m20:17:26.179189 [info ] [MainThread]: 
[0m20:17:26.179366 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:17:26.179499 [info ] [MainThread]: 
[0m20:17:26.179738 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:17:26.182148 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:17:26.229124 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:17:26.229366 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:17:26.229533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:26.241269 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:17:26.242213 [debug] [ThreadPool]: On list_dev: Close
[0m20:17:26.242579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:17:26.242976 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:17:26.246482 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:17:26.246663 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:17:26.246798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:26.247305 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:26.248136 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:17:26.248269 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:17:26.248469 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:26.248597 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:17:26.248727 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:17:26.248955 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:26.249368 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:17:26.249501 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:17:26.249618 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:17:26.249864 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:26.250057 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:17:26.251324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m20:17:26.254068 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:17:26.254228 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:17:26.254356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:26.254590 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:26.254722 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:17:26.254861 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:17:26.263867 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:17:26.298654 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:17:26.299723 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:17:26.299886 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:17:26.300154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:17:26.301017 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:17:26.301658 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:17:26.301783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:26.302065 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:26.302191 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:17:26.302323 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:17:26.304737 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:17:26.305470 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:17:26.305740 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:17:26.305873 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:17:26.306941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99f74b96-b24b-4fa2-adf3-6a945b690ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10963a680>]}
[0m20:17:26.307165 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:26.307298 [debug] [MainThread]: On master: BEGIN
[0m20:17:26.307422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:17:26.307632 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:17:26.307758 [debug] [MainThread]: On master: COMMIT
[0m20:17:26.307875 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:26.307988 [debug] [MainThread]: On master: COMMIT
[0m20:17:26.308161 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:17:26.308281 [debug] [MainThread]: On master: Close
[0m20:17:26.309680 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:17:26.309929 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_events .................................... [RUN]
[0m20:17:26.310154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now model.sbdk_project.stg_events)
[0m20:17:26.310357 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:17:26.314464 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:17:26.314884 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:17:26.331529 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m20:17:26.332045 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:17:26.332218 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m20:17:26.332366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:26.332685 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.332848 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:17:26.333043 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_events"
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m20:17:26.333811 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:17:26.336840 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:17:26.337022 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m20:17:26.337649 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.338961 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:17:26.339134 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:17:26.339407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.345884 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:17:26.346087 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:17:26.346251 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:17:26.347813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:17:26.350395 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:17:26.350572 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m20:17:26.350922 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.352122 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m20:17:26.353105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f74b96-b24b-4fa2-adf3-6a945b690ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7dcd0>]}
[0m20:17:26.353417 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.04s]
[0m20:17:26.353679 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:17:26.353864 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:17:26.354105 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_orders .................................... [RUN]
[0m20:17:26.354298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:17:26.354459 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:17:26.355887 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:17:26.356219 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:17:26.357941 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m20:17:26.358263 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:17:26.358425 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m20:17:26.358576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:26.358878 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.359056 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:17:26.359280 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_orders"
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m20:17:26.360305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:17:26.361703 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:17:26.361890 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:17:26.362194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.363450 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:17:26.363610 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:17:26.363865 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.364566 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:17:26.364721 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:17:26.364861 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:17:26.365319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.366556 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:17:26.366713 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m20:17:26.367040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.367634 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m20:17:26.367884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f74b96-b24b-4fa2-adf3-6a945b690ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093aaa40>]}
[0m20:17:26.368159 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.01s]
[0m20:17:26.368418 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:17:26.368600 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:17:26.368836 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_users ..................................... [RUN]
[0m20:17:26.369019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:17:26.369174 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:17:26.370528 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:17:26.371096 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:17:26.372739 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:17:26.373179 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:17:26.373340 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:17:26.373481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:26.373750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.373911 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:17:26.374095 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_users"
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:17:26.376585 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:17:26.377993 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:17:26.378163 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m20:17:26.378454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.379678 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:17:26.379834 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:17:26.380115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.380869 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:17:26.381042 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:17:26.381194 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:17:26.381599 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.382792 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:17:26.382949 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m20:17:26.383251 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.383855 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:17:26.384104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f74b96-b24b-4fa2-adf3-6a945b690ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d4c910>]}
[0m20:17:26.384381 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.02s]
[0m20:17:26.384625 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:17:26.384931 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:17:26.385182 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_user_activity ............................. [RUN]
[0m20:17:26.385391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now model.sbdk_project.int_user_activity)
[0m20:17:26.385554 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m20:17:26.387399 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m20:17:26.388043 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m20:17:26.389737 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.int_user_activity"
[0m20:17:26.390349 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:17:26.390513 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: BEGIN
[0m20:17:26.390663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:26.390923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.391082 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:17:26.391376 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

  
  create view "dev"."main"."int_user_activity__dbt_tmp" as (
    

with users as (
    select * from "dev"."main"."stg_users"
),

events as (
    select * from "dev"."main"."stg_events"
),

orders as (
    select * from "dev"."main"."stg_orders"
),

user_events as (
    select
        user_id,
        count(*) as total_events,
        count(*) filter (where event_type = 'page_view') as pageviews,
        count(*) filter (where event_type = 'click') as clicks,
        count(*) filter (where event_type = 'signup') as signups,
        count(*) filter (where event_type = 'login') as logins,
        count(*) filter (where event_type = 'purchase') as purchase_events,
        count(*) filter (where is_conversion_event = true) as conversion_events,
        count(*) filter (where is_revenue_event = true) as revenue_events,
        coalesce(sum(revenue), 0) as total_event_revenue,
        coalesce(sum(duration_seconds), 0) as total_time_on_site,
        count(distinct session_id) filter (where session_id is not null) as unique_sessions,
        count(distinct event_date) as active_days,
        min(timestamp) as first_event_at,
        max(timestamp) as last_event_at,
        count(distinct traffic_category) as traffic_sources_used
    from events
    group by user_id
),

user_orders as (
    select
        user_id,
        count(*) as total_orders,
        count(*) filter (where is_completed = true) as completed_orders,
        count(*) filter (where is_failed = true) as failed_orders,
        count(*) filter (where is_recurring = true) as recurring_orders,
        coalesce(sum(total_amount) filter (where is_completed = true), 0) as total_order_revenue,
        coalesce(avg(total_amount) filter (where is_completed = true), 0) as avg_order_value,
        coalesce(sum(discount_amount), 0) as total_discounts_used,
        count(distinct product_category) as product_categories_purchased,
        min(created_at) as first_order_at,
        max(created_at) as last_order_at,
        count(distinct payment_method) as payment_methods_used
    from orders
    group by user_id
),

combined as (
    select
        u.user_id,
        u.username,
        u.email,
        u.first_name,
        u.last_name,
        u.created_at as user_created_at,
        u.country,
        u.city,
        u.subscription_tier,
        u.referrer,
        u.is_active,
        u.age,
        u.is_paid_subscriber,
        u.days_since_signup,
        u.has_complete_profile,
        
        -- Event metrics
        coalesce(e.total_events, 0) as total_events,
        coalesce(e.pageviews, 0) as pageviews,
        coalesce(e.clicks, 0) as clicks,
        coalesce(e.signups, 0) as signups,
        coalesce(e.logins, 0) as logins,
        coalesce(e.purchase_events, 0) as purchase_events,
        coalesce(e.conversion_events, 0) as conversion_events,
        coalesce(e.revenue_events, 0) as revenue_events,
        coalesce(e.total_event_revenue, 0) as total_event_revenue,
        coalesce(e.total_time_on_site, 0) as total_time_on_site,
        coalesce(e.unique_sessions, 0) as unique_sessions,
        coalesce(e.active_days, 0) as active_days,
        e.first_event_at,
        e.last_event_at,
        coalesce(e.traffic_sources_used, 0) as traffic_sources_used,
        
        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.failed_orders, 0) as failed_orders,
        coalesce(o.recurring_orders, 0) as recurring_orders,
        coalesce(o.total_order_revenue, 0) as total_order_revenue,
        coalesce(o.avg_order_value, 0) as avg_order_value,
        coalesce(o.total_discounts_used, 0) as total_discounts_used,
        coalesce(o.product_categories_purchased, 0) as product_categories_purchased,
        o.first_order_at,
        o.last_order_at,
        coalesce(o.payment_methods_used, 0) as payment_methods_used,
        
        -- Calculated metrics
        case 
            when e.pageviews > 0 and o.completed_orders > 0 
            then round(o.completed_orders::float / e.pageviews * 100, 2)
            else 0 
        end as purchase_conversion_rate,
        
        case 
            when e.total_events > 0 
            then round(e.conversion_events::float / e.total_events * 100, 2)
            else 0 
        end as event_conversion_rate,
        
        case 
            when e.unique_sessions > 0 
            then round(e.total_events::float / e.unique_sessions, 2)
            else 0 
        end as events_per_session,
        
        case 
            when u.days_since_signup > 0 and e.active_days > 0
            then round(e.active_days::float / u.days_since_signup * 100, 2)
            else 0 
        end as activity_frequency_percentage,
        
        -- Total combined revenue
        coalesce(e.total_event_revenue, 0) + coalesce(o.total_order_revenue, 0) as total_revenue,
        
        -- User activity classification
        case 
            when o.completed_orders > 0 then 'customer'
            when e.signups > 0 then 'signed_up'
            when e.total_events > 10 then 'engaged_visitor'
            when e.total_events > 0 then 'visitor'
            else 'inactive'
        end as user_type
        
    from users u
    left join user_events e on u.user_id = e.user_id
    left join user_orders o on u.user_id = o.user_id
)

select * from combined
  );

[0m20:17:26.394521 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:17:26.395900 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:17:26.396071 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity" rename to "int_user_activity__dbt_backup"
[0m20:17:26.396370 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.397606 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:17:26.397771 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity__dbt_tmp" rename to "int_user_activity"
[0m20:17:26.398053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.398751 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:17:26.398915 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:17:26.399064 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:17:26.399591 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.400866 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:17:26.401036 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

      drop view if exists "dev"."main"."int_user_activity__dbt_backup" cascade
    
[0m20:17:26.401399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.401994 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: Close
[0m20:17:26.402245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f74b96-b24b-4fa2-adf3-6a945b690ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d10850>]}
[0m20:17:26.402525 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_user_activity ........................ [[32mOK[0m in 0.02s]
[0m20:17:26.402771 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:17:26.403086 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:17:26.403324 [info ] [Thread-1 (]: 5 of 5 START sql table model main.user_metrics ................................. [RUN]
[0m20:17:26.403515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m20:17:26.403675 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m20:17:26.405230 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m20:17:26.405831 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m20:17:26.416265 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.user_metrics"
[0m20:17:26.416811 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:17:26.416991 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: BEGIN
[0m20:17:26.417153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:26.417493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.417654 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:17:26.417916 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

  
    
    

    create  table
      "dev"."main"."user_metrics__dbt_tmp"
  
    as (
      

with user_activity as (
    select * from "dev"."main"."int_user_activity"
),

final as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        user_created_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        age,
        is_paid_subscriber,
        days_since_signup,
        has_complete_profile,
        
        -- Engagement metrics
        total_events,
        pageviews,
        clicks,
        logins,
        unique_sessions,
        active_days,
        traffic_sources_used,
        events_per_session,
        activity_frequency_percentage,
        total_time_on_site,
        
        -- Conversion metrics
        signups,
        purchase_events,
        conversion_events,
        purchase_conversion_rate,
        event_conversion_rate,
        
        -- Revenue metrics
        total_orders,
        completed_orders,
        failed_orders,
        recurring_orders,
        total_order_revenue,
        total_event_revenue,
        total_revenue,
        avg_order_value,
        total_discounts_used,
        product_categories_purchased,
        payment_methods_used,
        
        -- Timing metrics
        first_event_at,
        last_event_at,
        first_order_at,
        last_order_at,
        
        -- User classification
        user_type,
        
        -- Customer lifetime value estimate
        case 
            when recurring_orders > 0 and days_since_signup > 0
            then round(total_revenue * (365.0 / days_since_signup) * 2, 2)  -- Rough 2-year CLV estimate
            else total_revenue 
        end as estimated_clv,
        
        -- Engagement score (0-100)
        least(100, 
            (case when active_days > 0 then least(25, active_days) else 0 end) +
            (case when unique_sessions > 0 then least(25, unique_sessions) else 0 end) +
            (case when total_events > 0 then least(25, least(25, total_events / 10)) else 0 end) +
            (case when completed_orders > 0 then 25 else 0 end)
        ) as engagement_score,
        
        -- Risk classification
        case 
            when last_event_at < current_date - interval '90 days' and total_orders > 0 then 'churn_risk'
            when last_event_at < current_date - interval '30 days' and user_type = 'customer' then 'at_risk'
            when activity_frequency_percentage < 10 and days_since_signup > 30 then 'low_engagement'
            when user_type = 'customer' and recurring_orders = 0 then 'one_time_buyer'
            when user_type = 'customer' and recurring_orders > 0 then 'loyal_customer'
            when user_type = 'engaged_visitor' then 'potential_customer'
            else 'standard'
        end as risk_category,
        
        -- Value tier
        case 
            when total_revenue >= 1000 then 'high_value'
            when total_revenue >= 500 then 'medium_value'
            when total_revenue >= 100 then 'low_value'
            when total_revenue > 0 then 'minimal_value'
            else 'no_value'
        end as value_tier,
        
        -- Recency, Frequency, Monetary (RFM) components
        case 
            when last_order_at >= current_date - interval '30 days' then 5
            when last_order_at >= current_date - interval '60 days' then 4
            when last_order_at >= current_date - interval '90 days' then 3
            when last_order_at >= current_date - interval '180 days' then 2
            when last_order_at is not null then 1
            else 0
        end as recency_score,
        
        case 
            when completed_orders >= 10 then 5
            when completed_orders >= 5 then 4
            when completed_orders >= 3 then 3
            when completed_orders >= 2 then 2
            when completed_orders >= 1 then 1
            else 0
        end as frequency_score,
        
        case 
            when total_revenue >= 1000 then 5
            when total_revenue >= 500 then 4
            when total_revenue >= 200 then 3
            when total_revenue >= 50 then 2
            when total_revenue > 0 then 1
            else 0
        end as monetary_score,
        
        -- Data freshness
        current_timestamp as updated_at
        
    from user_activity
)

select * from final
    );
  
  
[0m20:17:26.477517 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m20:17:26.479096 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:17:26.479273 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics" rename to "user_metrics__dbt_backup"
[0m20:17:26.480223 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:17:26.481452 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:17:26.481616 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics__dbt_tmp" rename to "user_metrics"
[0m20:17:26.481873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.484486 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:17:26.484673 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:17:26.484827 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:17:26.491368 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:17:26.492987 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:17:26.493154 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

      drop table if exists "dev"."main"."user_metrics__dbt_backup" cascade
    
[0m20:17:26.493741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:26.494451 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: Close
[0m20:17:26.494742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f74b96-b24b-4fa2-adf3-6a945b690ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109768e50>]}
[0m20:17:26.495063 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.user_metrics ............................ [[32mOK[0m in 0.09s]
[0m20:17:26.495327 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:17:26.495875 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:26.496022 [debug] [MainThread]: On master: BEGIN
[0m20:17:26.496151 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:17:26.496405 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:17:26.496538 [debug] [MainThread]: On master: COMMIT
[0m20:17:26.496668 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:26.496792 [debug] [MainThread]: On master: COMMIT
[0m20:17:26.496996 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:17:26.497128 [debug] [MainThread]: On master: Close
[0m20:17:26.497296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:26.497417 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m20:17:26.497584 [info ] [MainThread]: 
[0m20:17:26.497726 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m20:17:26.498264 [debug] [MainThread]: Command end result
[0m20:17:26.515760 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:17:26.516929 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:17:26.521454 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:17:26.521668 [info ] [MainThread]: 
[0m20:17:26.521852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:17:26.521995 [info ] [MainThread]: 
[0m20:17:26.522149 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:17:26.523878 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8153498, "process_in_blocks": "0", "process_kernel_time": 0.236706, "process_mem_max_rss": "229212160", "process_out_blocks": "0", "process_user_time": 1.43644}
[0m20:17:26.524119 [debug] [MainThread]: Command `dbt run` succeeded at 20:17:26.524075 after 0.82 seconds
[0m20:17:26.524305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d90d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9c4d0>]}
[0m20:17:26.524496 [debug] [MainThread]: Flushing usage events
[0m20:17:26.968403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:17:28.078596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111895a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136f3d90>]}


============================== 20:17:28.081480 | 1411b887-0733-4819-ae23-fbf1476a97d5 ==============================
[0m20:17:28.081480 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:17:28.081793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:17:28.213256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1411b887-0733-4819-ae23-fbf1476a97d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f516e0>]}
[0m20:17:28.253218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1411b887-0733-4819-ae23-fbf1476a97d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110daaad0>]}
[0m20:17:28.254346 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:17:28.306649 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:17:28.373412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:17:28.373633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:17:28.377160 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:17:28.398163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1411b887-0733-4819-ae23-fbf1476a97d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a03c50>]}
[0m20:17:28.445718 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:17:28.446859 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:17:28.461594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1411b887-0733-4819-ae23-fbf1476a97d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114135b80>]}
[0m20:17:28.461880 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:17:28.462043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1411b887-0733-4819-ae23-fbf1476a97d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141d90f0>]}
[0m20:17:28.463229 [info ] [MainThread]: 
[0m20:17:28.463404 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:17:28.463541 [info ] [MainThread]: 
[0m20:17:28.463775 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:17:28.466486 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:17:28.533656 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:17:28.533915 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:17:28.534073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:28.546349 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:17:28.547108 [debug] [ThreadPool]: On list_dev: Close
[0m20:17:28.547439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:17:28.547652 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:17:28.550927 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:17:28.551090 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:17:28.551220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:28.551587 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:28.552188 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:17:28.552323 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:17:28.552518 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:28.552640 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:17:28.552757 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:17:28.552957 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:28.553334 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:17:28.553464 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:17:28.553582 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:17:28.553759 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:28.553885 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:17:28.554941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main)
[0m20:17:28.557853 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:17:28.558026 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:17:28.558154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:28.558417 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:28.558547 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:17:28.558679 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:17:28.565584 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:17:28.566310 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:17:28.566862 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:17:28.567008 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:17:28.567241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:17:28.568053 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:17:28.568186 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:17:28.568306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:28.568986 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:17:28.569115 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:17:28.569244 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:17:28.571410 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:17:28.572111 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:17:28.572375 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:17:28.572504 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:17:28.573594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1411b887-0733-4819-ae23-fbf1476a97d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143e25b0>]}
[0m20:17:28.573806 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:28.573932 [debug] [MainThread]: On master: BEGIN
[0m20:17:28.574048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:17:28.574262 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:17:28.574391 [debug] [MainThread]: On master: COMMIT
[0m20:17:28.574512 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:28.574633 [debug] [MainThread]: On master: COMMIT
[0m20:17:28.574883 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:17:28.575030 [debug] [MainThread]: On master: Close
[0m20:17:28.576060 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:17:28.576244 [info ] [Thread-1 (]: 1 of 15 START test source_not_null_main_raw_events_event_id .................... [RUN]
[0m20:17:28.576452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a)
[0m20:17:28.576624 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:17:28.584906 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:17:28.585726 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:17:28.595168 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:17:28.595362 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id" cascade
    
[0m20:17:28.595531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.596143 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:17:28.597339 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
[0m20:17:28.604902 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:17:28.605093 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:17:28.605352 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.605516 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:17:28.605687 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:17:28.606332 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.606827 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:17:28.607008 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:17:28.607162 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:17:28.607507 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.609454 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:17:28.609981 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:17:28.610151 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:17:28.610380 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.610540 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:17:28.610704 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:17:28.611455 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:17:28.613562 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: ROLLBACK
[0m20:17:28.613926 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a'
[0m20:17:28.614113 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: Close
[0m20:17:28.614417 [info ] [Thread-1 (]: 1 of 15 PASS source_not_null_main_raw_events_event_id .......................... [[32mPASS[0m in 0.04s]
[0m20:17:28.614757 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:17:28.614957 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:17:28.615172 [info ] [Thread-1 (]: 2 of 15 START test source_not_null_main_raw_events_event_type .................. [RUN]
[0m20:17:28.615381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a, now test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b)
[0m20:17:28.615552 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:17:28.617582 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:17:28.618299 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:17:28.620526 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:17:28.620715 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type" cascade
    
[0m20:17:28.620885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.621384 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.621947 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
[0m20:17:28.622420 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:17:28.622585 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:17:28.622821 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.622980 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:17:28.623141 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:17:28.623766 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.624230 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:17:28.624396 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:17:28.624583 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:17:28.624965 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.625316 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:17:28.625704 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:17:28.625871 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:17:28.626104 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.626262 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:17:28.626445 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
    
      
    ) dbt_internal_test
[0m20:17:28.627152 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:17:28.628547 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: ROLLBACK
[0m20:17:28.628956 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b'
[0m20:17:28.629131 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: Close
[0m20:17:28.629454 [info ] [Thread-1 (]: 2 of 15 PASS source_not_null_main_raw_events_event_type ........................ [[32mPASS[0m in 0.01s]
[0m20:17:28.629725 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:17:28.629923 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:17:28.630145 [info ] [Thread-1 (]: 3 of 15 START test source_not_null_main_raw_events_timestamp ................... [RUN]
[0m20:17:28.630837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b, now test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d)
[0m20:17:28.631056 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:17:28.633577 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:17:28.634294 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:17:28.636128 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:17:28.636303 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp" cascade
    
[0m20:17:28.636465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.636925 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.637430 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
[0m20:17:28.637870 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:17:28.638031 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:17:28.638301 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.639028 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:17:28.639199 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:17:28.639816 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.640271 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:17:28.640436 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:17:28.640587 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:17:28.640879 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.641180 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:17:28.641759 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:17:28.641913 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:17:28.642148 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.642348 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:17:28.642529 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
    
      
    ) dbt_internal_test
[0m20:17:28.643209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.644250 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: ROLLBACK
[0m20:17:28.645197 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d'
[0m20:17:28.645367 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: Close
[0m20:17:28.645651 [info ] [Thread-1 (]: 3 of 15 PASS source_not_null_main_raw_events_timestamp ......................... [[32mPASS[0m in 0.01s]
[0m20:17:28.645903 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:17:28.646085 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:17:28.646269 [info ] [Thread-1 (]: 4 of 15 START test source_not_null_main_raw_events_user_id ..................... [RUN]
[0m20:17:28.646452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d, now test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d)
[0m20:17:28.646611 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:17:28.648778 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:17:28.649362 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:17:28.651131 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:17:28.651299 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id" cascade
    
[0m20:17:28.651452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.651860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.652359 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
[0m20:17:28.652798 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:17:28.652956 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:17:28.653176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.653333 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:17:28.653496 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:17:28.654037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.654469 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:17:28.654630 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:17:28.654774 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:17:28.655048 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.655341 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:17:28.655831 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:17:28.655988 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:17:28.656190 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.656347 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:17:28.656505 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
    
      
    ) dbt_internal_test
[0m20:17:28.657019 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.657955 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: ROLLBACK
[0m20:17:28.658260 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d'
[0m20:17:28.658417 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: Close
[0m20:17:28.658668 [info ] [Thread-1 (]: 4 of 15 PASS source_not_null_main_raw_events_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:17:28.658928 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:17:28.659112 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:17:28.659297 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_main_raw_orders_created_at .................. [RUN]
[0m20:17:28.659476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d, now test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273)
[0m20:17:28.659637 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:17:28.661457 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:17:28.661801 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:17:28.663726 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:17:28.663899 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at" cascade
    
[0m20:17:28.664054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.664445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.664932 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
[0m20:17:28.665360 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:17:28.665520 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:17:28.665746 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.665904 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:17:28.666065 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:17:28.666654 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.667086 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:17:28.667243 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:17:28.667388 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:17:28.667682 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.667978 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:17:28.668285 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:17:28.668436 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:17:28.668634 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.668787 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:17:28.668943 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
    
      
    ) dbt_internal_test
[0m20:17:28.669480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.670197 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: ROLLBACK
[0m20:17:28.670507 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273'
[0m20:17:28.670674 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: Close
[0m20:17:28.670928 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_main_raw_orders_created_at ........................ [[32mPASS[0m in 0.01s]
[0m20:17:28.671177 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:17:28.671351 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:17:28.671542 [info ] [Thread-1 (]: 6 of 15 START test source_not_null_main_raw_orders_order_id .................... [RUN]
[0m20:17:28.671744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273, now test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68)
[0m20:17:28.671909 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:17:28.673695 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:17:28.674048 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:17:28.676095 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:17:28.676277 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id" cascade
    
[0m20:17:28.676434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.676819 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.677315 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
[0m20:17:28.677754 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:17:28.677916 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:17:28.678153 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.678316 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:17:28.678479 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:17:28.679163 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:17:28.679611 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:17:28.679771 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:17:28.679918 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:17:28.680214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.680508 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:17:28.680847 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:17:28.681005 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:17:28.681210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.681365 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:17:28.681525 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:17:28.682089 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.682809 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: ROLLBACK
[0m20:17:28.683128 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68'
[0m20:17:28.683291 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: Close
[0m20:17:28.683546 [info ] [Thread-1 (]: 6 of 15 PASS source_not_null_main_raw_orders_order_id .......................... [[32mPASS[0m in 0.01s]
[0m20:17:28.683794 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:17:28.685182 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:17:28.685374 [info ] [Thread-1 (]: 7 of 15 START test source_not_null_main_raw_orders_total_amount ................ [RUN]
[0m20:17:28.685561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68, now test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681)
[0m20:17:28.685730 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:17:28.687662 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:17:28.688497 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:17:28.690523 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:17:28.690699 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount" cascade
    
[0m20:17:28.690859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.691264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.691789 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
[0m20:17:28.692233 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:17:28.692399 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:17:28.692661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.692822 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:17:28.693497 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:17:28.694150 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.694611 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:17:28.694778 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:17:28.694929 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:17:28.695213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.695510 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:17:28.695854 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:17:28.696006 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:17:28.696206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.696361 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:17:28.696522 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
    
      
    ) dbt_internal_test
[0m20:17:28.697052 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.697754 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: ROLLBACK
[0m20:17:28.698062 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681'
[0m20:17:28.698219 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: Close
[0m20:17:28.698472 [info ] [Thread-1 (]: 7 of 15 PASS source_not_null_main_raw_orders_total_amount ...................... [[32mPASS[0m in 0.01s]
[0m20:17:28.698720 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:17:28.698896 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:17:28.699079 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_main_raw_orders_user_id ..................... [RUN]
[0m20:17:28.699258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681, now test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d)
[0m20:17:28.699418 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:17:28.701271 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:17:28.701624 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:17:28.705280 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:17:28.705455 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id" cascade
    
[0m20:17:28.705608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.706030 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.706531 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
[0m20:17:28.707113 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:17:28.707311 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:17:28.707543 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.707696 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:17:28.707908 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:17:28.708523 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.708964 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:17:28.709203 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:17:28.709389 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:17:28.709718 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.710017 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:17:28.710571 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:17:28.710729 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:17:28.710936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.711089 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:17:28.711249 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
    
      
    ) dbt_internal_test
[0m20:17:28.711794 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.712474 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: ROLLBACK
[0m20:17:28.712787 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d'
[0m20:17:28.712944 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: Close
[0m20:17:28.713196 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_main_raw_orders_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:17:28.713441 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:17:28.713614 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:17:28.713792 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_main_raw_users_created_at ................... [RUN]
[0m20:17:28.713969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d, now test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f)
[0m20:17:28.714128 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:17:28.716069 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:17:28.716400 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:17:28.718469 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:17:28.718642 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at" cascade
    
[0m20:17:28.718796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.719188 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.719690 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
[0m20:17:28.720131 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:17:28.720291 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:17:28.720507 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.720661 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:17:28.720828 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:17:28.721328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.721800 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:17:28.721971 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:17:28.722128 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:17:28.722445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.722755 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:17:28.723217 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:17:28.723381 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:17:28.723608 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.723767 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:17:28.723932 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
    
      
    ) dbt_internal_test
[0m20:17:28.724413 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.725123 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: ROLLBACK
[0m20:17:28.725441 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f'
[0m20:17:28.725610 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: Close
[0m20:17:28.725876 [info ] [Thread-1 (]: 9 of 15 PASS source_not_null_main_raw_users_created_at ......................... [[32mPASS[0m in 0.01s]
[0m20:17:28.726129 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:17:28.726314 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:17:28.726499 [info ] [Thread-1 (]: 10 of 15 START test source_not_null_main_raw_users_email ....................... [RUN]
[0m20:17:28.726677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f, now test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2)
[0m20:17:28.726834 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:17:28.728965 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:17:28.729318 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:17:28.731105 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:17:28.731281 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email" cascade
    
[0m20:17:28.731441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.731865 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.732402 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
[0m20:17:28.732904 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:17:28.733116 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:17:28.733411 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.733580 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:17:28.733754 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:17:28.734508 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:17:28.735072 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:17:28.735250 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:17:28.735401 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:17:28.735753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.736095 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:17:28.736474 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:17:28.736630 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:17:28.736852 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.737010 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:17:28.737166 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:17:28.737696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.738426 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: ROLLBACK
[0m20:17:28.738767 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2'
[0m20:17:28.738934 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: Close
[0m20:17:28.739208 [info ] [Thread-1 (]: 10 of 15 PASS source_not_null_main_raw_users_email ............................. [[32mPASS[0m in 0.01s]
[0m20:17:28.739473 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:17:28.739655 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:17:28.739837 [info ] [Thread-1 (]: 11 of 15 START test source_not_null_main_raw_users_user_id ..................... [RUN]
[0m20:17:28.740021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2, now test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2)
[0m20:17:28.740180 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:17:28.742453 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:17:28.743082 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:17:28.744936 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:17:28.745107 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id" cascade
    
[0m20:17:28.745263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.745723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.746244 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
[0m20:17:28.746906 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:17:28.747065 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:17:28.747288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.747445 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:17:28.747603 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:17:28.748096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.748534 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:17:28.748692 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:17:28.748837 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:17:28.749109 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.749404 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:17:28.749751 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:17:28.749905 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:17:28.750107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.750261 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:17:28.750416 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:17:28.750897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.751608 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: ROLLBACK
[0m20:17:28.751936 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2'
[0m20:17:28.752091 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: Close
[0m20:17:28.752354 [info ] [Thread-1 (]: 11 of 15 PASS source_not_null_main_raw_users_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:17:28.752605 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:17:28.752783 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:17:28.752968 [info ] [Thread-1 (]: 12 of 15 START test source_unique_main_raw_events_event_id ..................... [RUN]
[0m20:17:28.753146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2, now test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc)
[0m20:17:28.753301 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:17:28.756393 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:17:28.756746 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:17:28.758755 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:17:28.758965 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id" cascade
    
[0m20:17:28.759135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.759547 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.760075 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
[0m20:17:28.760527 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:17:28.760693 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:17:28.760921 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.761080 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:17:28.761246 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:17:28.768296 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:17:28.768934 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:17:28.769123 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:17:28.769282 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:17:28.769662 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.770022 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:17:28.770968 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:17:28.771131 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:17:28.771368 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.771542 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:17:28.771708 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:17:28.772192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.772965 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: ROLLBACK
[0m20:17:28.773309 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc'
[0m20:17:28.773474 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: Close
[0m20:17:28.773762 [info ] [Thread-1 (]: 12 of 15 PASS source_unique_main_raw_events_event_id ........................... [[32mPASS[0m in 0.02s]
[0m20:17:28.774014 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:17:28.774192 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:17:28.774385 [info ] [Thread-1 (]: 13 of 15 START test source_unique_main_raw_orders_order_id ..................... [RUN]
[0m20:17:28.774587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc, now test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d)
[0m20:17:28.774754 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:17:28.776942 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:17:28.777349 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:17:28.779548 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:17:28.779742 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id" cascade
    
[0m20:17:28.779914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.780413 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.780986 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
[0m20:17:28.781486 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:17:28.781658 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:17:28.781949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.782133 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:17:28.782314 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:17:28.785188 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:17:28.785874 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:17:28.786079 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:17:28.786253 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:17:28.786697 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.787107 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:17:28.787570 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:17:28.787746 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:17:28.788037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.788246 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:17:28.788446 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:17:28.789062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.790042 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: ROLLBACK
[0m20:17:28.790411 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d'
[0m20:17:28.790586 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: Close
[0m20:17:28.790896 [info ] [Thread-1 (]: 13 of 15 PASS source_unique_main_raw_orders_order_id ........................... [[32mPASS[0m in 0.02s]
[0m20:17:28.791166 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:17:28.791361 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:17:28.791561 [info ] [Thread-1 (]: 14 of 15 START test source_unique_main_raw_users_email ......................... [RUN]
[0m20:17:28.791760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d, now test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc)
[0m20:17:28.791928 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:17:28.794134 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:17:28.794622 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:17:28.796747 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:17:28.796928 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email" cascade
    
[0m20:17:28.797092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.797609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.798157 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
[0m20:17:28.798602 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:17:28.798766 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:17:28.798992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.799153 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:17:28.799315 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:17:28.800893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:17:28.801387 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:17:28.801554 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:17:28.801708 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:17:28.802194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.802518 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:17:28.802868 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:17:28.803022 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:17:28.803229 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.803386 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:17:28.803545 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:17:28.803975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.804700 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: ROLLBACK
[0m20:17:28.805022 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc'
[0m20:17:28.805179 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: Close
[0m20:17:28.805446 [error] [Thread-1 (]: 14 of 15 FAIL 203 source_unique_main_raw_users_email ........................... [[31mFAIL 203[0m in 0.01s]
[0m20:17:28.805702 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:17:28.805880 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:17:28.806076 [info ] [Thread-1 (]: 15 of 15 START test source_unique_main_raw_users_user_id ....................... [RUN]
[0m20:17:28.806276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc, now test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd)
[0m20:17:28.806438 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:17:28.808326 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:17:28.808828 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:17:28.810865 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:17:28.811036 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id" cascade
    
[0m20:17:28.811192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:28.811581 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.812079 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
[0m20:17:28.812512 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:17:28.812670 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:17:28.812883 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.813041 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:17:28.813203 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:17:28.814201 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:17:28.814703 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:17:28.814877 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:17:28.815031 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:17:28.815333 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.815659 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:17:28.816283 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:17:28.816442 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:17:28.816650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.816805 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:17:28.816966 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:17:28.817376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:17:28.818107 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: ROLLBACK
[0m20:17:28.818430 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd'
[0m20:17:28.818589 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: Close
[0m20:17:28.818851 [info ] [Thread-1 (]: 15 of 15 PASS source_unique_main_raw_users_user_id ............................. [[32mPASS[0m in 0.01s]
[0m20:17:28.819100 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:17:28.819683 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:28.819822 [debug] [MainThread]: On master: BEGIN
[0m20:17:28.819939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:17:28.820145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:17:28.820277 [debug] [MainThread]: On master: COMMIT
[0m20:17:28.820402 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:28.820516 [debug] [MainThread]: On master: COMMIT
[0m20:17:28.820689 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:17:28.820819 [debug] [MainThread]: On master: Close
[0m20:17:28.820991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:28.821115 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd' was properly closed.
[0m20:17:28.821258 [info ] [MainThread]: 
[0m20:17:28.821400 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m20:17:28.822571 [debug] [MainThread]: Command end result
[0m20:17:28.838080 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:17:28.839194 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:17:28.843433 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:17:28.843639 [info ] [MainThread]: 
[0m20:17:28.843812 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:17:28.843957 [info ] [MainThread]: 
[0m20:17:28.844141 [error] [MainThread]: [31mFailure in test source_unique_main_raw_users_email (models/_sources.yml)[0m
[0m20:17:28.844308 [error] [MainThread]:   Got 203 results, configured to fail if != 0
[0m20:17:28.844430 [info ] [MainThread]: 
[0m20:17:28.844584 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_main_raw_users_email.sql
[0m20:17:28.844706 [info ] [MainThread]: 
[0m20:17:28.844856 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  -------------------------------------------------------------------------------
[0m20:17:28.844994 [info ] [MainThread]: 
[0m20:17:28.845141 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=15
[0m20:17:28.846548 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.8133393, "process_in_blocks": "0", "process_kernel_time": 0.183238, "process_mem_max_rss": "162168832", "process_out_blocks": "0", "process_user_time": 1.429866}
[0m20:17:28.846767 [debug] [MainThread]: Command `dbt test` failed at 20:17:28.846727 after 0.81 seconds
[0m20:17:28.846943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113725910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144105d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144117b0>]}
[0m20:17:28.847111 [debug] [MainThread]: Flushing usage events
[0m20:17:29.155080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:32.404829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d15a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f3d90>]}


============================== 20:21:32.412096 | b813d36c-fb67-4893-89ae-5aed8a2bb021 ==============================
[0m20:21:32.412096 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:21:32.412441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:21:32.625907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b813d36c-fb67-4893-89ae-5aed8a2bb021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083516e0>]}
[0m20:21:32.667779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b813d36c-fb67-4893-89ae-5aed8a2bb021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8aad0>]}
[0m20:21:32.669528 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:21:32.730113 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:21:32.841911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:21:32.842195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:21:32.846437 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:21:32.870693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b813d36c-fb67-4893-89ae-5aed8a2bb021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109603c50>]}
[0m20:21:32.922185 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:21:32.923684 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:21:32.947231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b813d36c-fb67-4893-89ae-5aed8a2bb021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d3db80>]}
[0m20:21:32.947612 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:21:32.947833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b813d36c-fb67-4893-89ae-5aed8a2bb021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd50f0>]}
[0m20:21:32.949444 [info ] [MainThread]: 
[0m20:21:32.949694 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:21:32.949905 [info ] [MainThread]: 
[0m20:21:32.950212 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:21:32.953488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:21:33.041238 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:21:33.041520 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:21:33.041682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:33.054566 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:21:33.055621 [debug] [ThreadPool]: On list_dev: Close
[0m20:21:33.056045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:21:33.056334 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:21:33.060240 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:21:33.060474 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:21:33.060619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:33.061347 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:33.062559 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:21:33.062722 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:21:33.062944 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:33.063080 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:21:33.063214 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:21:33.063520 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:33.064020 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:21:33.064192 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:21:33.064338 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:21:33.064568 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:33.064721 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:21:33.065980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main)
[0m20:21:33.069963 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:21:33.070462 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:21:33.070618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:33.071013 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:33.071241 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:21:33.071405 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:21:33.081723 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:21:33.082755 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:21:33.083787 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:21:33.083995 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:21:33.084315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:21:33.085338 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:21:33.086100 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:21:33.086245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:33.086627 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:33.086798 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:21:33.086956 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:21:33.089518 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:21:33.090526 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:21:33.090901 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:21:33.091057 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:21:33.092327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b813d36c-fb67-4893-89ae-5aed8a2bb021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe68f0>]}
[0m20:21:33.092594 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:33.092740 [debug] [MainThread]: On master: BEGIN
[0m20:21:33.092875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:21:33.093227 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:21:33.093401 [debug] [MainThread]: On master: COMMIT
[0m20:21:33.093548 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:33.093692 [debug] [MainThread]: On master: COMMIT
[0m20:21:33.093931 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:21:33.094072 [debug] [MainThread]: On master: Close
[0m20:21:33.095628 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:21:33.095843 [info ] [Thread-1 (]: 1 of 15 START test source_not_null_main_raw_events_event_id .................... [RUN]
[0m20:21:33.096065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a)
[0m20:21:33.096240 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:21:33.105416 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:21:33.106029 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:21:33.118926 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:21:33.119185 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id" cascade
    
[0m20:21:33.119369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.120733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.123096 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
[0m20:21:33.133911 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:21:33.134178 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:21:33.134524 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.134700 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:21:33.134874 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:21:33.135903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.136473 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:21:33.136675 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:21:33.136849 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:21:33.137195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.139307 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:21:33.140078 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:21:33.140342 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:21:33.140719 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.140899 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:21:33.141081 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:21:33.142811 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.145535 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: ROLLBACK
[0m20:21:33.145940 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a'
[0m20:21:33.146122 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: Close
[0m20:21:33.146461 [info ] [Thread-1 (]: 1 of 15 PASS source_not_null_main_raw_events_event_id .......................... [[32mPASS[0m in 0.05s]
[0m20:21:33.146746 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:21:33.146945 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:21:33.147131 [info ] [Thread-1 (]: 2 of 15 START test source_not_null_main_raw_events_event_type .................. [RUN]
[0m20:21:33.147370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a, now test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b)
[0m20:21:33.147543 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:21:33.149863 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:21:33.150381 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:21:33.153006 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:21:33.153243 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type" cascade
    
[0m20:21:33.153425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.153920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.154509 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
[0m20:21:33.155124 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:21:33.155373 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:21:33.155688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.155869 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:21:33.156052 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:21:33.156868 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.157945 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:21:33.158330 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:21:33.158572 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:21:33.159019 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.159408 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:21:33.159867 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:21:33.160041 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:21:33.160286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.160452 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:21:33.160622 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
    
      
    ) dbt_internal_test
[0m20:21:33.161224 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.162035 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: ROLLBACK
[0m20:21:33.162373 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b'
[0m20:21:33.162542 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: Close
[0m20:21:33.162830 [info ] [Thread-1 (]: 2 of 15 PASS source_not_null_main_raw_events_event_type ........................ [[32mPASS[0m in 0.02s]
[0m20:21:33.163103 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:21:33.163296 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:21:33.163525 [info ] [Thread-1 (]: 3 of 15 START test source_not_null_main_raw_events_timestamp ................... [RUN]
[0m20:21:33.163776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b, now test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d)
[0m20:21:33.163969 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:21:33.166347 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:21:33.166884 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:21:33.168936 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:21:33.169135 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp" cascade
    
[0m20:21:33.169308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.169820 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.170401 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
[0m20:21:33.170910 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:21:33.171084 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:21:33.171358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.171524 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:21:33.171699 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:21:33.172519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.173602 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:21:33.173898 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:21:33.174087 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:21:33.174591 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.174986 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:21:33.175497 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:21:33.175679 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:21:33.175995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.176170 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:21:33.176343 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
    
      
    ) dbt_internal_test
[0m20:21:33.177105 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.178026 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: ROLLBACK
[0m20:21:33.178413 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d'
[0m20:21:33.178598 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: Close
[0m20:21:33.178925 [info ] [Thread-1 (]: 3 of 15 PASS source_not_null_main_raw_events_timestamp ......................... [[32mPASS[0m in 0.02s]
[0m20:21:33.179212 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:21:33.179411 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:21:33.179589 [info ] [Thread-1 (]: 4 of 15 START test source_not_null_main_raw_events_user_id ..................... [RUN]
[0m20:21:33.179887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d, now test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d)
[0m20:21:33.180069 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:21:33.182653 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:21:33.183193 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:21:33.185333 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:21:33.185554 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id" cascade
    
[0m20:21:33.185735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.186312 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.186965 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
[0m20:21:33.187523 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:21:33.187718 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:21:33.188036 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.188207 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:21:33.188381 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:21:33.188976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.189470 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:21:33.189642 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:21:33.189802 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:21:33.190267 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.190666 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:21:33.191401 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:21:33.191604 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:21:33.191929 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.192103 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:21:33.192281 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
    
      
    ) dbt_internal_test
[0m20:21:33.193163 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.194441 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: ROLLBACK
[0m20:21:33.194856 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d'
[0m20:21:33.195034 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: Close
[0m20:21:33.195378 [info ] [Thread-1 (]: 4 of 15 PASS source_not_null_main_raw_events_user_id ........................... [[32mPASS[0m in 0.02s]
[0m20:21:33.195662 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:21:33.195857 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:21:33.196073 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_main_raw_orders_created_at .................. [RUN]
[0m20:21:33.196348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d, now test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273)
[0m20:21:33.196628 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:21:33.199057 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:21:33.199559 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:21:33.201811 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:21:33.202013 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at" cascade
    
[0m20:21:33.202194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.203284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.203930 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
[0m20:21:33.204463 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:21:33.204713 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:21:33.205022 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.205830 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:21:33.206093 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:21:33.207258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.208000 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:21:33.208215 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:21:33.208392 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:21:33.208875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.209257 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:21:33.209682 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:21:33.209888 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:21:33.210176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.210347 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:21:33.210523 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
    
      
    ) dbt_internal_test
[0m20:21:33.211310 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.212183 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: ROLLBACK
[0m20:21:33.212536 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273'
[0m20:21:33.212710 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: Close
[0m20:21:33.213029 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_main_raw_orders_created_at ........................ [[32mPASS[0m in 0.02s]
[0m20:21:33.213377 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:21:33.213592 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:21:33.213806 [info ] [Thread-1 (]: 6 of 15 START test source_not_null_main_raw_orders_order_id .................... [RUN]
[0m20:21:33.214027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273, now test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68)
[0m20:21:33.214210 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:21:33.216351 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:21:33.216799 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:21:33.219090 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:21:33.219297 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id" cascade
    
[0m20:21:33.219479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.219992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.220646 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
[0m20:21:33.221213 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:21:33.221406 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:21:33.221708 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.221896 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:21:33.222102 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:21:33.222832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.223371 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:21:33.223595 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:21:33.223776 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:21:33.224144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.224518 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:21:33.224949 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:21:33.225122 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:21:33.225369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.225538 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:21:33.225709 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:21:33.226326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.227134 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: ROLLBACK
[0m20:21:33.227482 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68'
[0m20:21:33.227657 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: Close
[0m20:21:33.227951 [info ] [Thread-1 (]: 6 of 15 PASS source_not_null_main_raw_orders_order_id .......................... [[32mPASS[0m in 0.01s]
[0m20:21:33.228225 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:21:33.228419 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:21:33.228617 [info ] [Thread-1 (]: 7 of 15 START test source_not_null_main_raw_orders_total_amount ................ [RUN]
[0m20:21:33.228814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68, now test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681)
[0m20:21:33.228988 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:21:33.231244 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:21:33.235238 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:21:33.237869 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:21:33.238513 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount" cascade
    
[0m20:21:33.238733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.239353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.240982 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
[0m20:21:33.241648 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:21:33.241856 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:21:33.242492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.242763 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:21:33.243008 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:21:33.243879 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.244468 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:21:33.244674 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:21:33.244850 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:21:33.245211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.245576 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:21:33.247622 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:21:33.248043 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:21:33.248416 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.248602 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:21:33.248786 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
    
      
    ) dbt_internal_test
[0m20:21:33.249493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.250418 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: ROLLBACK
[0m20:21:33.254406 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681'
[0m20:21:33.254702 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: Close
[0m20:21:33.255077 [info ] [Thread-1 (]: 7 of 15 PASS source_not_null_main_raw_orders_total_amount ...................... [[32mPASS[0m in 0.03s]
[0m20:21:33.255434 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:21:33.255691 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:21:33.255872 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_main_raw_orders_user_id ..................... [RUN]
[0m20:21:33.256203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681, now test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d)
[0m20:21:33.256405 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:21:33.258664 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:21:33.259160 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:21:33.263346 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:21:33.263563 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id" cascade
    
[0m20:21:33.263739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.264251 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.264820 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
[0m20:21:33.265671 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:21:33.265877 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:21:33.266144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.266315 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:21:33.266484 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:21:33.267200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.267754 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:21:33.267941 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:21:33.268107 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:21:33.268449 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.268786 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:21:33.269574 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:21:33.269776 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:21:33.270018 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.270178 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:21:33.270347 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
    
      
    ) dbt_internal_test
[0m20:21:33.271044 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.271900 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: ROLLBACK
[0m20:21:33.272279 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d'
[0m20:21:33.272469 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: Close
[0m20:21:33.272784 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_main_raw_orders_user_id ........................... [[32mPASS[0m in 0.02s]
[0m20:21:33.273066 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:21:33.273352 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:21:33.273566 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_main_raw_users_created_at ................... [RUN]
[0m20:21:33.273788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d, now test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f)
[0m20:21:33.273973 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:21:33.276416 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:21:33.277164 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:21:33.280296 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:21:33.280569 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at" cascade
    
[0m20:21:33.280762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.281435 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.282094 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
[0m20:21:33.282765 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:21:33.282961 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:21:33.283288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.283457 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:21:33.283633 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:21:33.284246 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.284787 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:21:33.285328 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:21:33.285652 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:21:33.287061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.287925 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:21:33.288597 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:21:33.288834 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:21:33.289248 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.289648 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:21:33.289929 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
    
      
    ) dbt_internal_test
[0m20:21:33.290789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.291904 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: ROLLBACK
[0m20:21:33.292730 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f'
[0m20:21:33.292995 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: Close
[0m20:21:33.293920 [info ] [Thread-1 (]: 9 of 15 PASS source_not_null_main_raw_users_created_at ......................... [[32mPASS[0m in 0.02s]
[0m20:21:33.294302 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:21:33.294510 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:21:33.294716 [info ] [Thread-1 (]: 10 of 15 START test source_not_null_main_raw_users_email ....................... [RUN]
[0m20:21:33.294969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f, now test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2)
[0m20:21:33.295143 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:21:33.298255 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:21:33.299094 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:21:33.301925 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:21:33.302237 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email" cascade
    
[0m20:21:33.302556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.305503 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:33.306660 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
[0m20:21:33.307343 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:21:33.307555 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:21:33.310038 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:21:33.310360 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:21:33.310564 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:21:33.311238 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.311846 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:21:33.312052 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:21:33.312228 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:21:33.312705 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.313132 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:21:33.313675 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:21:33.313862 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:21:33.314243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.314488 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:21:33.314744 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:21:33.315488 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.316477 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: ROLLBACK
[0m20:21:33.316904 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2'
[0m20:21:33.317096 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: Close
[0m20:21:33.317447 [info ] [Thread-1 (]: 10 of 15 PASS source_not_null_main_raw_users_email ............................. [[32mPASS[0m in 0.02s]
[0m20:21:33.317741 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:21:33.317942 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:21:33.318154 [info ] [Thread-1 (]: 11 of 15 START test source_not_null_main_raw_users_user_id ..................... [RUN]
[0m20:21:33.318364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2, now test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2)
[0m20:21:33.318544 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:21:33.322342 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:21:33.324104 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:21:33.326550 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:21:33.326751 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id" cascade
    
[0m20:21:33.326926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.327431 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.328021 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
[0m20:21:33.328802 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:21:33.328984 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:21:33.329243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.329413 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:21:33.329579 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:21:33.330123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.330636 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:21:33.330832 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:21:33.331003 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:21:33.331318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.331638 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:21:33.332071 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:21:33.332240 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:21:33.332461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.332624 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:21:33.332788 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:21:33.333291 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.334060 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: ROLLBACK
[0m20:21:33.334402 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2'
[0m20:21:33.334565 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: Close
[0m20:21:33.334842 [info ] [Thread-1 (]: 11 of 15 PASS source_not_null_main_raw_users_user_id ........................... [[32mPASS[0m in 0.02s]
[0m20:21:33.335111 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:21:33.335302 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:21:33.335496 [info ] [Thread-1 (]: 12 of 15 START test source_unique_main_raw_events_event_id ..................... [RUN]
[0m20:21:33.335687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2, now test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc)
[0m20:21:33.335856 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:21:33.339368 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:21:33.340118 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:21:33.342556 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:21:33.342777 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id" cascade
    
[0m20:21:33.342963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.343540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.344141 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
[0m20:21:33.344656 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:21:33.344830 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:21:33.345089 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.345255 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:21:33.345427 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:21:33.350240 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:21:33.350830 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:21:33.351013 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:21:33.351178 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:21:33.351572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.351969 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:21:33.352416 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:21:33.352597 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:21:33.352840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.353006 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:21:33.353168 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:21:33.353665 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.354469 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: ROLLBACK
[0m20:21:33.354817 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc'
[0m20:21:33.354987 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: Close
[0m20:21:33.355266 [info ] [Thread-1 (]: 12 of 15 PASS source_unique_main_raw_events_event_id ........................... [[32mPASS[0m in 0.02s]
[0m20:21:33.355530 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:21:33.355717 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:21:33.355907 [info ] [Thread-1 (]: 13 of 15 START test source_unique_main_raw_orders_order_id ..................... [RUN]
[0m20:21:33.356096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc, now test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d)
[0m20:21:33.356262 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:21:33.358319 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:21:33.358746 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:21:33.360816 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:21:33.360996 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id" cascade
    
[0m20:21:33.361165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.361607 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.362137 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
[0m20:21:33.362600 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:21:33.362766 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:21:33.363006 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.363170 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:21:33.363341 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:21:33.365714 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:21:33.366263 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:21:33.366446 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:21:33.366610 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:21:33.366965 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.367303 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:21:33.367711 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:21:33.367882 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:21:33.368108 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.368270 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:21:33.368441 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:21:33.368938 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.369730 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: ROLLBACK
[0m20:21:33.370062 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d'
[0m20:21:33.370228 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: Close
[0m20:21:33.370517 [info ] [Thread-1 (]: 13 of 15 PASS source_unique_main_raw_orders_order_id ........................... [[32mPASS[0m in 0.01s]
[0m20:21:33.370782 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:21:33.370968 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:21:33.371167 [info ] [Thread-1 (]: 14 of 15 START test source_unique_main_raw_users_email ......................... [RUN]
[0m20:21:33.371366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d, now test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc)
[0m20:21:33.371536 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:21:33.373627 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:21:33.374017 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:21:33.376193 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:21:33.376388 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email" cascade
    
[0m20:21:33.376554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.377078 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:33.377617 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
[0m20:21:33.378085 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:21:33.378249 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:21:33.378475 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.378637 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:21:33.378806 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:21:33.380591 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:21:33.381080 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:21:33.381259 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:21:33.381419 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:21:33.381835 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.382170 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:21:33.382658 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:21:33.382822 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:21:33.383074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.383272 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:21:33.383451 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:21:33.383943 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.384778 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: ROLLBACK
[0m20:21:33.385163 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc'
[0m20:21:33.385349 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: Close
[0m20:21:33.385664 [error] [Thread-1 (]: 14 of 15 FAIL 195 source_unique_main_raw_users_email ........................... [[31mFAIL 195[0m in 0.01s]
[0m20:21:33.385959 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:21:33.386161 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:21:33.386370 [info ] [Thread-1 (]: 15 of 15 START test source_unique_main_raw_users_user_id ....................... [RUN]
[0m20:21:33.386575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc, now test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd)
[0m20:21:33.386755 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:21:33.388812 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:21:33.389236 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:21:33.391394 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:21:33.391579 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id" cascade
    
[0m20:21:33.391749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:33.392230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.392755 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
[0m20:21:33.393219 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:21:33.393386 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:21:33.393651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.393821 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:21:33.393994 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:21:33.396218 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:21:33.396719 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:21:33.396892 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:21:33.397049 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:21:33.397342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.397666 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:21:33.398038 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:21:33.398200 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:21:33.398410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.398572 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:21:33.398733 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:21:33.399152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:33.399912 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: ROLLBACK
[0m20:21:33.400247 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd'
[0m20:21:33.400424 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: Close
[0m20:21:33.400717 [info ] [Thread-1 (]: 15 of 15 PASS source_unique_main_raw_users_user_id ............................. [[32mPASS[0m in 0.01s]
[0m20:21:33.400981 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:21:33.401574 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:33.401729 [debug] [MainThread]: On master: BEGIN
[0m20:21:33.401859 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:21:33.402081 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:21:33.402217 [debug] [MainThread]: On master: COMMIT
[0m20:21:33.402347 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:33.402466 [debug] [MainThread]: On master: COMMIT
[0m20:21:33.402637 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:21:33.402769 [debug] [MainThread]: On master: Close
[0m20:21:33.402936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:33.403059 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd' was properly closed.
[0m20:21:33.403201 [info ] [MainThread]: 
[0m20:21:33.403341 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m20:21:33.404390 [debug] [MainThread]: Command end result
[0m20:21:33.419821 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:21:33.420869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:21:33.424868 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:21:33.425031 [info ] [MainThread]: 
[0m20:21:33.425209 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:21:33.425349 [info ] [MainThread]: 
[0m20:21:33.425527 [error] [MainThread]: [31mFailure in test source_unique_main_raw_users_email (models/_sources.yml)[0m
[0m20:21:33.425689 [error] [MainThread]:   Got 195 results, configured to fail if != 0
[0m20:21:33.425812 [info ] [MainThread]: 
[0m20:21:33.425969 [info ] [MainThread]:   compiled code at target/compiled/sbdk_project/models/_sources.yml/source_unique_main_raw_users_email.sql
[0m20:21:33.426096 [info ] [MainThread]: 
[0m20:21:33.426252 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------
  select * from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  -------------------------------------------------------------------------------
[0m20:21:33.426389 [info ] [MainThread]: 
[0m20:21:33.426537 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=15
[0m20:21:33.428303 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.0799077, "process_in_blocks": "0", "process_kernel_time": 0.248811, "process_mem_max_rss": "163758080", "process_out_blocks": "0", "process_user_time": 1.572253}
[0m20:21:33.428536 [debug] [MainThread]: Command `dbt test` failed at 20:21:33.428494 after 1.08 seconds
[0m20:21:33.428715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109425910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a810c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a811c80>]}
[0m20:21:33.428887 [debug] [MainThread]: Flushing usage events
[0m20:21:33.946942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:22:35.456811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a885a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcf3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcf3d90>]}


============================== 20:22:35.463961 | 1c8272df-0a69-49f1-9cf2-15e75168f4b7 ==============================
[0m20:22:35.463961 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:22:35.464328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select source:main.raw_users.email', 'send_anonymous_usage_stats': 'True'}
[0m20:22:35.613933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c8272df-0a69-49f1-9cf2-15e75168f4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac516e0>]}
[0m20:22:35.654581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c8272df-0a69-49f1-9cf2-15e75168f4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6faad0>]}
[0m20:22:35.656356 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:22:35.717322 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:22:35.805250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:22:35.805507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:22:35.809540 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:22:35.830954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c8272df-0a69-49f1-9cf2-15e75168f4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be03c50>]}
[0m20:22:35.880967 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:22:35.882331 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:22:35.903085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c8272df-0a69-49f1-9cf2-15e75168f4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c549b80>]}
[0m20:22:35.903404 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:22:35.903581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8272df-0a69-49f1-9cf2-15e75168f4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5dd0f0>]}
[0m20:22:35.903936 [warn ] [MainThread]: The selection criterion 'source:main.raw_users.email' does not match any enabled nodes
[0m20:22:35.904546 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:22:35.905493 [debug] [MainThread]: Command end result
[0m20:22:35.953577 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:22:35.954611 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:22:35.956683 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:22:35.958408 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5603271, "process_in_blocks": "0", "process_kernel_time": 0.204403, "process_mem_max_rss": "125157376", "process_out_blocks": "0", "process_user_time": 1.191072}
[0m20:22:35.958667 [debug] [MainThread]: Command `dbt test` succeeded at 20:22:35.958621 after 0.56 seconds
[0m20:22:35.958853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5d3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd25910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be7f7d0>]}
[0m20:22:35.959027 [debug] [MainThread]: Flushing usage events
[0m20:22:36.622556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:22:45.219327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d85a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f3d90>]}


============================== 20:22:45.223042 | 52e9e189-5cd7-4966-ae64-f8f18d65659c ==============================
[0m20:22:45.223042 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:22:45.223410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --models source:main.raw_users', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:22:45.223674 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m20:22:45.223857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '52e9e189-5cd7-4966-ae64-f8f18d65659c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108250fc0>]}
[0m20:22:45.359951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52e9e189-5cd7-4966-ae64-f8f18d65659c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d1260>]}
[0m20:22:45.400652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52e9e189-5cd7-4966-ae64-f8f18d65659c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a8e50>]}
[0m20:22:45.402260 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:22:45.458581 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:22:45.538485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:22:45.538734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:22:45.542409 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:22:45.564883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52e9e189-5cd7-4966-ae64-f8f18d65659c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095a0230>]}
[0m20:22:45.614992 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:22:45.616505 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:22:45.635994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52e9e189-5cd7-4966-ae64-f8f18d65659c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f75b0>]}
[0m20:22:45.636290 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:22:45.636468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e9e189-5cd7-4966-ae64-f8f18d65659c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096cfc70>]}
[0m20:22:45.637468 [info ] [MainThread]: 
[0m20:22:45.637645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:22:45.637786 [info ] [MainThread]: 
[0m20:22:45.638042 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:22:45.640807 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:22:45.723928 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:22:45.724166 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:22:45.724315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:45.815897 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m20:22:45.816964 [debug] [ThreadPool]: On list_dev: Close
[0m20:22:45.817356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:22:45.817833 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:22:45.821527 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:22:45.821755 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:22:45.821909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:45.822797 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:22:45.823687 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:22:45.823842 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:22:45.824069 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:22:45.824206 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:22:45.824341 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:22:45.824939 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:22:45.825483 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:22:45.825668 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:22:45.825820 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:22:45.826062 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:22:45.826220 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:22:45.827618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main)
[0m20:22:45.831651 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:22:45.831896 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:22:45.832047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:45.832384 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:22:45.832528 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:22:45.832674 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:22:45.844492 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:22:45.845402 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:22:45.846327 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:22:45.846499 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:22:45.846923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:22:45.848707 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:22:45.848886 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:22:45.849020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:45.849419 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:22:45.849612 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:22:45.849772 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:22:45.852334 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:22:45.853180 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:22:45.853523 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:22:45.853675 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:22:45.854835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e9e189-5cd7-4966-ae64-f8f18d65659c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847f4d0>]}
[0m20:22:45.855075 [debug] [MainThread]: Using duckdb connection "master"
[0m20:22:45.855213 [debug] [MainThread]: On master: BEGIN
[0m20:22:45.855340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:45.855601 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:22:45.855738 [debug] [MainThread]: On master: COMMIT
[0m20:22:45.855873 [debug] [MainThread]: Using duckdb connection "master"
[0m20:22:45.856001 [debug] [MainThread]: On master: COMMIT
[0m20:22:45.856211 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:22:45.856345 [debug] [MainThread]: On master: Close
[0m20:22:45.857870 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:22:45.858065 [info ] [Thread-1 (]: 1 of 5 START test source_not_null_main_raw_users_created_at .................... [RUN]
[0m20:22:45.858269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f)
[0m20:22:45.858436 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:22:45.866991 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:22:45.867647 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:22:45.877528 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:22:45.877755 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at" cascade
    
[0m20:22:45.877930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:45.879229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:22:45.880662 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
[0m20:22:45.890566 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:22:45.890835 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:22:45.891217 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.891396 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:22:45.891573 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:22:45.893528 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:22:45.894125 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:22:45.894320 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:22:45.894488 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:22:45.894830 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.896907 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:22:45.897547 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:22:45.897738 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:22:45.898002 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.898174 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:22:45.898351 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
    
      
    ) dbt_internal_test
[0m20:22:45.900177 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:22:45.902300 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: ROLLBACK
[0m20:22:45.902655 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f'
[0m20:22:45.902834 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: Close
[0m20:22:45.903134 [info ] [Thread-1 (]: 1 of 5 PASS source_not_null_main_raw_users_created_at .......................... [[32mPASS[0m in 0.04s]
[0m20:22:45.903416 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:22:45.903613 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:22:45.903793 [info ] [Thread-1 (]: 2 of 5 START test source_not_null_main_raw_users_email ......................... [RUN]
[0m20:22:45.904028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f, now test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2)
[0m20:22:45.904202 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:22:45.906346 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:22:45.906911 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:22:45.909185 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:22:45.909448 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email" cascade
    
[0m20:22:45.909650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:45.910160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:22:45.910732 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
[0m20:22:45.911220 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:22:45.911394 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:22:45.911645 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.912007 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:22:45.912218 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:22:45.913396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.913884 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:22:45.914065 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:22:45.914228 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:22:45.914522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.914851 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:22:45.915272 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:22:45.915435 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:22:45.915665 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.915822 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:22:45.915990 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:22:45.916551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.917387 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: ROLLBACK
[0m20:22:45.917745 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2'
[0m20:22:45.917934 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: Close
[0m20:22:45.918245 [info ] [Thread-1 (]: 2 of 5 PASS source_not_null_main_raw_users_email ............................... [[32mPASS[0m in 0.01s]
[0m20:22:45.918526 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:22:45.918721 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:22:45.918942 [info ] [Thread-1 (]: 3 of 5 START test source_not_null_main_raw_users_user_id ....................... [RUN]
[0m20:22:45.919169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2, now test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2)
[0m20:22:45.919355 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:22:45.921474 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:22:45.922593 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:22:45.925161 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:22:45.925361 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id" cascade
    
[0m20:22:45.925537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:45.926040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.926624 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
[0m20:22:45.927129 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:22:45.927312 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:22:45.927572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.927741 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:22:45.927916 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:22:45.928492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.928995 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:22:45.929176 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:22:45.929339 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:22:45.929675 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.930044 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:22:45.930513 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:22:45.930688 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:22:45.930957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.931158 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:22:45.931345 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:22:45.931917 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.932726 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: ROLLBACK
[0m20:22:45.933154 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2'
[0m20:22:45.933332 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: Close
[0m20:22:45.933635 [info ] [Thread-1 (]: 3 of 5 PASS source_not_null_main_raw_users_user_id ............................. [[32mPASS[0m in 0.01s]
[0m20:22:45.933910 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:22:45.934098 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:22:45.934296 [info ] [Thread-1 (]: 4 of 5 START test source_unique_main_raw_users_email ........................... [RUN]
[0m20:22:45.934691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2, now test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc)
[0m20:22:45.934865 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:22:45.938442 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:22:45.939272 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:22:45.941359 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:22:45.941558 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email" cascade
    
[0m20:22:45.941736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:45.943123 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:22:45.943778 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
[0m20:22:45.944297 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:22:45.944481 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:22:45.944762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.944926 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:22:45.945096 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:22:45.949081 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:22:45.949668 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:22:45.949864 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:22:45.950030 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:22:45.950381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.950733 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:22:45.951341 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:22:45.951533 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:22:45.951932 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:45.952199 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:22:45.952376 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:22:45.953137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:22:45.954018 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: ROLLBACK
[0m20:22:45.954371 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc'
[0m20:22:45.954543 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: Close
[0m20:22:45.954854 [info ] [Thread-1 (]: 4 of 5 PASS source_unique_main_raw_users_email ................................. [[32mPASS[0m in 0.02s]
[0m20:22:45.955131 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:22:45.955329 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:22:45.955534 [info ] [Thread-1 (]: 5 of 5 START test source_unique_main_raw_users_user_id ......................... [RUN]
[0m20:22:45.955862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc, now test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd)
[0m20:22:45.956087 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:22:45.958617 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:22:45.959105 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:22:45.961368 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:22:45.965169 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id" cascade
    
[0m20:22:45.967047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:45.977614 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:22:46.025397 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
[0m20:22:46.026650 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:22:46.026904 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:22:46.027291 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:46.027471 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:22:46.027652 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:22:46.031583 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:22:46.033183 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:22:46.033600 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:22:46.033867 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:22:46.034439 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:46.045088 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:22:46.047391 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:22:46.047667 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:22:46.048053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:46.048251 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:22:46.048440 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:22:46.049029 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:22:46.050048 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: ROLLBACK
[0m20:22:46.050454 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd'
[0m20:22:46.050635 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: Close
[0m20:22:46.050963 [info ] [Thread-1 (]: 5 of 5 PASS source_unique_main_raw_users_user_id ............................... [[32mPASS[0m in 0.10s]
[0m20:22:46.051245 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:22:46.051866 [debug] [MainThread]: Using duckdb connection "master"
[0m20:22:46.052018 [debug] [MainThread]: On master: BEGIN
[0m20:22:46.052145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:22:46.052440 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:22:46.052625 [debug] [MainThread]: On master: COMMIT
[0m20:22:46.052774 [debug] [MainThread]: Using duckdb connection "master"
[0m20:22:46.052909 [debug] [MainThread]: On master: COMMIT
[0m20:22:46.053147 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:22:46.053290 [debug] [MainThread]: On master: Close
[0m20:22:46.053463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:46.053587 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd' was properly closed.
[0m20:22:46.053732 [info ] [MainThread]: 
[0m20:22:46.053879 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m20:22:46.054422 [debug] [MainThread]: Command end result
[0m20:22:46.071591 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:22:46.072882 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:22:46.076518 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:22:46.076692 [info ] [MainThread]: 
[0m20:22:46.076887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:22:46.077036 [info ] [MainThread]: 
[0m20:22:46.077192 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:22:46.077443 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:22:46.079386 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.90868604, "process_in_blocks": "0", "process_kernel_time": 0.234128, "process_mem_max_rss": "155860992", "process_out_blocks": "0", "process_user_time": 1.344477}
[0m20:22:46.079638 [debug] [MainThread]: Command `dbt test` succeeded at 20:22:46.079594 after 0.91 seconds
[0m20:22:46.079822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a113cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972a3f0>]}
[0m20:22:46.080007 [debug] [MainThread]: Flushing usage events
[0m20:22:46.546410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:03.345419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d69a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc7d90>]}


============================== 20:23:03.349337 | 2d5a73ad-bf2c-443b-836d-bd6b6812ecc0 ==============================
[0m20:23:03.349337 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:23:03.349661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:23:03.505413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d5a73ad-bf2c-443b-836d-bd6b6812ecc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080256e0>]}
[0m20:23:03.545409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d5a73ad-bf2c-443b-836d-bd6b6812ecc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076eead0>]}
[0m20:23:03.547001 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:23:03.609681 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:23:03.695225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:23:03.695479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:23:03.699181 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:23:03.720424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d5a73ad-bf2c-443b-836d-bd6b6812ecc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd7c50>]}
[0m20:23:03.768874 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:23:03.770299 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:23:03.789266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d5a73ad-bf2c-443b-836d-bd6b6812ecc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109411b80>]}
[0m20:23:03.789582 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:23:03.789761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d5a73ad-bf2c-443b-836d-bd6b6812ecc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b10f0>]}
[0m20:23:03.791014 [info ] [MainThread]: 
[0m20:23:03.791204 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:23:03.791353 [info ] [MainThread]: 
[0m20:23:03.791621 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:23:03.794398 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:23:03.861985 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:23:03.862217 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:23:03.862368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:03.934180 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m20:23:03.935196 [debug] [ThreadPool]: On list_dev: Close
[0m20:23:03.935568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:23:03.935973 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:23:03.939452 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:23:03.939643 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:23:03.939794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:03.940385 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:23:03.941184 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:23:03.941336 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:23:03.941566 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:23:03.941702 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:23:03.941836 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:23:03.942325 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:23:03.942826 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:23:03.942992 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:23:03.943133 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:23:03.943345 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:23:03.943491 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:23:03.944595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main_dbt_test__audit)
[0m20:23:03.947634 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:23:03.947800 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:23:03.947931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:03.948159 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:23:03.948301 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:23:03.948448 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:23:03.957731 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:23:03.958515 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:23:03.959365 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:23:03.959538 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:23:03.959790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:23:03.961588 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:23:03.961749 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:23:03.961883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:03.962154 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:23:03.962290 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:23:03.962429 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:23:03.964740 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:23:03.965543 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:23:03.965886 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:23:03.966039 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:23:03.966842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d5a73ad-bf2c-443b-836d-bd6b6812ecc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ba750>]}
[0m20:23:03.967099 [debug] [MainThread]: Using duckdb connection "master"
[0m20:23:03.967249 [debug] [MainThread]: On master: BEGIN
[0m20:23:03.967382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:23:03.967665 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:23:03.967808 [debug] [MainThread]: On master: COMMIT
[0m20:23:03.967945 [debug] [MainThread]: Using duckdb connection "master"
[0m20:23:03.968079 [debug] [MainThread]: On master: COMMIT
[0m20:23:03.968293 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:23:03.968463 [debug] [MainThread]: On master: Close
[0m20:23:03.969854 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:23:03.970112 [info ] [Thread-1 (]: 1 of 15 START test source_not_null_main_raw_events_event_id .................... [RUN]
[0m20:23:03.970369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a)
[0m20:23:03.970566 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:23:03.979486 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:03.980223 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:23:03.990228 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:03.990447 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id" cascade
    
[0m20:23:03.990622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:03.991623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:03.992913 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
[0m20:23:04.001302 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:04.001565 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:23:04.001936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.002125 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:04.002304 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:23:04.003409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:04.003954 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:23:04.004145 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:04.004311 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:23:04.004620 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.006576 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:04.007424 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:04.007608 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:23:04.007879 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.008049 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:04.008285 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:23:04.010033 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:23:04.012165 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: ROLLBACK
[0m20:23:04.012521 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a'
[0m20:23:04.012709 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: Close
[0m20:23:04.013016 [info ] [Thread-1 (]: 1 of 15 PASS source_not_null_main_raw_events_event_id .......................... [[32mPASS[0m in 0.04s]
[0m20:23:04.013294 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:23:04.013489 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:23:04.013701 [info ] [Thread-1 (]: 2 of 15 START test source_not_null_main_raw_events_event_type .................. [RUN]
[0m20:23:04.013905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a, now test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b)
[0m20:23:04.014080 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:23:04.016191 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:04.016646 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:23:04.018856 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:04.019046 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type" cascade
    
[0m20:23:04.019210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.019652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.020169 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
[0m20:23:04.020625 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:04.020797 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:23:04.021024 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.021184 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:04.021351 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:23:04.021925 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.022432 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:23:04.022605 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:04.022762 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:23:04.023041 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.023361 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:04.023737 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:04.023897 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:23:04.024108 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.024265 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:04.024432 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
    
      
    ) dbt_internal_test
[0m20:23:04.024969 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.025706 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: ROLLBACK
[0m20:23:04.026030 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b'
[0m20:23:04.026199 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: Close
[0m20:23:04.026478 [info ] [Thread-1 (]: 2 of 15 PASS source_not_null_main_raw_events_event_type ........................ [[32mPASS[0m in 0.01s]
[0m20:23:04.026741 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:23:04.026931 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:23:04.027134 [info ] [Thread-1 (]: 3 of 15 START test source_not_null_main_raw_events_timestamp ................... [RUN]
[0m20:23:04.027324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b, now test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d)
[0m20:23:04.027492 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:23:04.029704 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:04.030140 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:23:04.031973 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:04.032158 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp" cascade
    
[0m20:23:04.032326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.032741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.033281 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
[0m20:23:04.033738 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:04.034062 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:23:04.034342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.034526 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:04.034701 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:23:04.035271 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.035731 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:23:04.035906 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:04.036071 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:23:04.036369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.036679 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:04.037140 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:04.037474 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:23:04.037702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.037865 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:04.038041 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
    
      
    ) dbt_internal_test
[0m20:23:04.038566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.039348 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: ROLLBACK
[0m20:23:04.039694 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d'
[0m20:23:04.039875 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: Close
[0m20:23:04.040155 [info ] [Thread-1 (]: 3 of 15 PASS source_not_null_main_raw_events_timestamp ......................... [[32mPASS[0m in 0.01s]
[0m20:23:04.040429 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:23:04.040626 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:23:04.040838 [info ] [Thread-1 (]: 4 of 15 START test source_not_null_main_raw_events_user_id ..................... [RUN]
[0m20:23:04.041052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d, now test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d)
[0m20:23:04.041224 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:23:04.043499 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:04.043993 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:23:04.045835 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:04.046025 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id" cascade
    
[0m20:23:04.046218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.046677 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.047206 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
[0m20:23:04.047667 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:04.047833 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:23:04.048096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.048268 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:04.048440 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:23:04.049061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.049510 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:23:04.049677 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:04.049835 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:23:04.050129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.050469 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:04.052621 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:04.053538 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:23:04.053795 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.053960 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:04.054124 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
    
      
    ) dbt_internal_test
[0m20:23:04.054670 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.055681 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: ROLLBACK
[0m20:23:04.056008 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d'
[0m20:23:04.056173 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: Close
[0m20:23:04.056453 [info ] [Thread-1 (]: 4 of 15 PASS source_not_null_main_raw_events_user_id ........................... [[32mPASS[0m in 0.02s]
[0m20:23:04.056714 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:23:04.056895 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:23:04.057079 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_main_raw_orders_created_at .................. [RUN]
[0m20:23:04.057265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d, now test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273)
[0m20:23:04.057431 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:23:04.059414 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:04.059843 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:23:04.061843 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:04.062027 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at" cascade
    
[0m20:23:04.062192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.062589 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.063126 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
[0m20:23:04.063591 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:04.063763 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:23:04.063989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.064156 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:04.064327 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:23:04.064970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.065427 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:23:04.065597 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:04.065756 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:23:04.066068 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.066383 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:04.066728 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:04.066893 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:23:04.067110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.067269 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:04.067435 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
    
      
    ) dbt_internal_test
[0m20:23:04.068032 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.068760 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: ROLLBACK
[0m20:23:04.069097 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273'
[0m20:23:04.069266 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: Close
[0m20:23:04.069540 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_main_raw_orders_created_at ........................ [[32mPASS[0m in 0.01s]
[0m20:23:04.069802 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:23:04.069989 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:23:04.070177 [info ] [Thread-1 (]: 6 of 15 START test source_not_null_main_raw_orders_order_id .................... [RUN]
[0m20:23:04.070371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273, now test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68)
[0m20:23:04.070542 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:23:04.072562 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:04.072963 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:23:04.075155 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:04.075344 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id" cascade
    
[0m20:23:04.075512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.075973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.076518 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
[0m20:23:04.076984 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:04.077157 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:23:04.077389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.077559 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:04.077731 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:23:04.078343 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.078792 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:23:04.078959 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:04.079112 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:23:04.079389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.079720 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:04.080119 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:04.080289 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:23:04.080520 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.080681 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:04.080847 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:23:04.081426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.082158 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: ROLLBACK
[0m20:23:04.082478 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68'
[0m20:23:04.082646 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: Close
[0m20:23:04.082928 [info ] [Thread-1 (]: 6 of 15 PASS source_not_null_main_raw_orders_order_id .......................... [[32mPASS[0m in 0.01s]
[0m20:23:04.083192 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:23:04.083376 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:23:04.083567 [info ] [Thread-1 (]: 7 of 15 START test source_not_null_main_raw_orders_total_amount ................ [RUN]
[0m20:23:04.083756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68, now test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681)
[0m20:23:04.083923 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:23:04.085928 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:04.086286 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:23:04.088650 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:04.088950 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount" cascade
    
[0m20:23:04.089178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.089788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:04.090426 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
[0m20:23:04.090955 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:04.091144 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:23:04.091412 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.091579 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:04.091749 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:23:04.092698 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:04.093366 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:23:04.093589 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:04.093777 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:23:04.094287 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.094691 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:04.095109 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:04.095282 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:23:04.095524 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.095689 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:04.095855 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
    
      
    ) dbt_internal_test
[0m20:23:04.096488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.097304 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: ROLLBACK
[0m20:23:04.097656 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681'
[0m20:23:04.097832 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: Close
[0m20:23:04.098114 [info ] [Thread-1 (]: 7 of 15 PASS source_not_null_main_raw_orders_total_amount ...................... [[32mPASS[0m in 0.01s]
[0m20:23:04.098390 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:23:04.098585 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:23:04.098806 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_main_raw_orders_user_id ..................... [RUN]
[0m20:23:04.099057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681, now test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d)
[0m20:23:04.099250 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:23:04.101268 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:04.101646 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:23:04.105328 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:04.105542 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id" cascade
    
[0m20:23:04.105744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.106289 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:04.106866 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
[0m20:23:04.107351 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:04.107522 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:23:04.107761 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.107928 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:04.108097 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:23:04.108733 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.109182 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:23:04.109344 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:04.109495 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:23:04.109795 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.110137 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:04.110759 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:04.110925 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:23:04.111147 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.111309 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:04.111473 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
    
      
    ) dbt_internal_test
[0m20:23:04.112029 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.112736 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: ROLLBACK
[0m20:23:04.113049 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d'
[0m20:23:04.113206 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: Close
[0m20:23:04.113479 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_main_raw_orders_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:23:04.113736 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:23:04.113922 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:23:04.114114 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_main_raw_users_created_at ................... [RUN]
[0m20:23:04.114311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d, now test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f)
[0m20:23:04.114484 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:23:04.116603 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:04.117123 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:23:04.119291 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:04.119480 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at" cascade
    
[0m20:23:04.119641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.120111 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.120669 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
[0m20:23:04.121129 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:04.121298 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:23:04.121527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.121689 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:04.121855 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:23:04.122767 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:04.123307 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:23:04.123496 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:04.123665 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:23:04.124064 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.124419 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:04.124843 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:04.125015 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:23:04.125260 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.125429 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:04.125604 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
    
      
    ) dbt_internal_test
[0m20:23:04.126177 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.126998 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: ROLLBACK
[0m20:23:04.127369 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f'
[0m20:23:04.127549 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: Close
[0m20:23:04.127869 [info ] [Thread-1 (]: 9 of 15 PASS source_not_null_main_raw_users_created_at ......................... [[32mPASS[0m in 0.01s]
[0m20:23:04.128147 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:23:04.128351 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:23:04.128592 [info ] [Thread-1 (]: 10 of 15 START test source_not_null_main_raw_users_email ....................... [RUN]
[0m20:23:04.128804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f, now test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2)
[0m20:23:04.128982 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:23:04.131451 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:04.131941 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:23:04.133922 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:04.134131 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email" cascade
    
[0m20:23:04.134312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.134870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:04.135463 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
[0m20:23:04.135961 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:04.136129 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:23:04.136369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.136534 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:04.136699 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:23:04.137257 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.137761 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:23:04.137943 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:04.138106 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:23:04.138411 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.138730 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:04.139495 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:04.139690 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:23:04.139976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.140155 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:04.140330 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:23:04.140950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.141962 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: ROLLBACK
[0m20:23:04.142428 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2'
[0m20:23:04.142604 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: Close
[0m20:23:04.142931 [info ] [Thread-1 (]: 10 of 15 PASS source_not_null_main_raw_users_email ............................. [[32mPASS[0m in 0.01s]
[0m20:23:04.143211 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:23:04.143405 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:23:04.143619 [info ] [Thread-1 (]: 11 of 15 START test source_not_null_main_raw_users_user_id ..................... [RUN]
[0m20:23:04.143846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2, now test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2)
[0m20:23:04.144026 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:23:04.146719 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:04.147249 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:23:04.151570 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:04.151797 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id" cascade
    
[0m20:23:04.151995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.152781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:04.153366 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
[0m20:23:04.154216 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:04.154402 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:23:04.154698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.154872 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:04.155049 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:23:04.155881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:04.157199 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:23:04.157459 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:04.157641 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:23:04.158104 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.158841 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:04.159520 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:04.159728 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:23:04.160069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.160245 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:04.160429 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:23:04.161072 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.161949 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: ROLLBACK
[0m20:23:04.162336 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2'
[0m20:23:04.162517 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: Close
[0m20:23:04.163081 [info ] [Thread-1 (]: 11 of 15 PASS source_not_null_main_raw_users_user_id ........................... [[32mPASS[0m in 0.02s]
[0m20:23:04.163580 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:23:04.163914 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:23:04.164139 [info ] [Thread-1 (]: 12 of 15 START test source_unique_main_raw_events_event_id ..................... [RUN]
[0m20:23:04.164396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2, now test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc)
[0m20:23:04.164606 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:23:04.173539 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:04.175236 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:23:04.177847 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:04.178083 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id" cascade
    
[0m20:23:04.178269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.178816 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:04.179444 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
[0m20:23:04.180009 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:04.180199 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:23:04.180516 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.180699 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:04.180875 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:23:04.197427 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:23:04.198214 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:23:04.198445 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:04.198631 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:23:04.199070 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.199474 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:04.200143 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:04.200326 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:23:04.200594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.200767 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:04.200948 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:23:04.201509 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.202393 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: ROLLBACK
[0m20:23:04.202767 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc'
[0m20:23:04.202950 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: Close
[0m20:23:04.203257 [info ] [Thread-1 (]: 12 of 15 PASS source_unique_main_raw_events_event_id ........................... [[32mPASS[0m in 0.04s]
[0m20:23:04.203528 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:23:04.203719 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:23:04.203926 [info ] [Thread-1 (]: 13 of 15 START test source_unique_main_raw_orders_order_id ..................... [RUN]
[0m20:23:04.204143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc, now test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d)
[0m20:23:04.204316 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:23:04.206520 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:04.207115 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:23:04.209222 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:04.209417 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id" cascade
    
[0m20:23:04.209590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.210076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.210644 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
[0m20:23:04.211132 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:04.211309 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:23:04.211551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.211721 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:04.211895 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:23:04.215697 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:23:04.216386 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:23:04.216597 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:04.216773 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:23:04.217236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.217625 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:04.218115 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:04.218294 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:23:04.218594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.218774 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:04.218948 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:23:04.219453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.220291 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: ROLLBACK
[0m20:23:04.220665 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d'
[0m20:23:04.220839 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: Close
[0m20:23:04.221162 [info ] [Thread-1 (]: 13 of 15 PASS source_unique_main_raw_orders_order_id ........................... [[32mPASS[0m in 0.02s]
[0m20:23:04.221489 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:23:04.221750 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:23:04.221976 [info ] [Thread-1 (]: 14 of 15 START test source_unique_main_raw_users_email ......................... [RUN]
[0m20:23:04.222210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d, now test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc)
[0m20:23:04.222397 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:23:04.224664 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:04.225112 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:23:04.227236 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:04.227429 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email" cascade
    
[0m20:23:04.227607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.228102 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.228667 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
[0m20:23:04.229186 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:04.229361 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:23:04.229613 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.229781 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:04.229955 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:23:04.232013 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:23:04.232584 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:23:04.232775 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:04.232942 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:23:04.233297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.233656 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:04.234101 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:04.234303 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:23:04.234561 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.234732 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:04.234907 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:23:04.235444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.236538 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: ROLLBACK
[0m20:23:04.236948 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc'
[0m20:23:04.237138 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: Close
[0m20:23:04.237448 [info ] [Thread-1 (]: 14 of 15 PASS source_unique_main_raw_users_email ............................... [[32mPASS[0m in 0.02s]
[0m20:23:04.237722 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:23:04.237916 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:23:04.238133 [info ] [Thread-1 (]: 15 of 15 START test source_unique_main_raw_users_user_id ....................... [RUN]
[0m20:23:04.238362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc, now test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd)
[0m20:23:04.238547 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:23:04.240825 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:04.241333 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:23:04.243487 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:04.243676 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id" cascade
    
[0m20:23:04.243849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:04.244362 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.244903 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
[0m20:23:04.245388 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:04.245556 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:23:04.245789 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.245958 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:04.246127 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:23:04.248649 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:23:04.249260 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:23:04.249456 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:04.249628 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:23:04.249981 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.250330 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:04.250744 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:04.250908 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:23:04.251129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.251293 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:04.251459 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:23:04.251927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:04.252717 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: ROLLBACK
[0m20:23:04.253070 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd'
[0m20:23:04.253244 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: Close
[0m20:23:04.253522 [info ] [Thread-1 (]: 15 of 15 PASS source_unique_main_raw_users_user_id ............................. [[32mPASS[0m in 0.02s]
[0m20:23:04.253797 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:23:04.254402 [debug] [MainThread]: Using duckdb connection "master"
[0m20:23:04.254554 [debug] [MainThread]: On master: BEGIN
[0m20:23:04.254682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:23:04.254953 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:23:04.255105 [debug] [MainThread]: On master: COMMIT
[0m20:23:04.255247 [debug] [MainThread]: Using duckdb connection "master"
[0m20:23:04.255377 [debug] [MainThread]: On master: COMMIT
[0m20:23:04.255595 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:23:04.255743 [debug] [MainThread]: On master: Close
[0m20:23:04.255918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:04.256045 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd' was properly closed.
[0m20:23:04.256192 [info ] [MainThread]: 
[0m20:23:04.256335 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m20:23:04.257408 [debug] [MainThread]: Command end result
[0m20:23:04.273188 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:23:04.274226 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:23:04.277991 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:23:04.278192 [info ] [MainThread]: 
[0m20:23:04.278383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:23:04.278534 [info ] [MainThread]: 
[0m20:23:04.278692 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m20:23:04.280422 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.98438174, "process_in_blocks": "0", "process_kernel_time": 0.221062, "process_mem_max_rss": "163364864", "process_out_blocks": "0", "process_user_time": 1.457433}
[0m20:23:04.280710 [debug] [MainThread]: Command `dbt test` succeeded at 20:23:04.280663 after 0.98 seconds
[0m20:23:04.280908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e7cd0>]}
[0m20:23:04.281098 [debug] [MainThread]: Flushing usage events
[0m20:23:04.776144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:37.935891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103861a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bfd90>]}


============================== 20:23:37.939894 | 6637e076-c8f7-43d7-9c3c-dc3f39d1b8f7 ==============================
[0m20:23:37.939894 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:23:37.940256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:23:38.091737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6637e076-c8f7-43d7-9c3c-dc3f39d1b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b1d6e0>]}
[0m20:23:38.133250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6637e076-c8f7-43d7-9c3c-dc3f39d1b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031e6ad0>]}
[0m20:23:38.135012 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:23:38.192612 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:23:38.279711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:23:38.279965 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:23:38.283702 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:23:38.305469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6637e076-c8f7-43d7-9c3c-dc3f39d1b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cfc50>]}
[0m20:23:38.357500 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:23:38.358864 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:23:38.382463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6637e076-c8f7-43d7-9c3c-dc3f39d1b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f09b80>]}
[0m20:23:38.382770 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:23:38.382938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6637e076-c8f7-43d7-9c3c-dc3f39d1b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa90f0>]}
[0m20:23:38.384228 [info ] [MainThread]: 
[0m20:23:38.384419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:23:38.384556 [info ] [MainThread]: 
[0m20:23:38.384806 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:23:38.387655 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:23:38.482518 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:23:38.482761 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:23:38.482913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:38.498967 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:23:38.500374 [debug] [ThreadPool]: On list_dev: Close
[0m20:23:38.500832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:23:38.501366 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:23:38.505063 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:23:38.505397 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:23:38.505595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:38.506612 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:23:38.507553 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:23:38.507713 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:23:38.507938 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:23:38.508073 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:23:38.508207 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:23:38.509311 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:23:38.509835 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:23:38.510010 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:23:38.510158 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:23:38.510377 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:23:38.510524 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:23:38.511713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main)
[0m20:23:38.514908 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:23:38.515079 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:23:38.515220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:38.515498 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:23:38.515670 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:23:38.515825 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:23:38.527093 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:23:38.528059 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:23:38.528977 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:23:38.529155 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:23:38.529434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:23:38.530871 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:23:38.531021 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:23:38.531149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:38.531457 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:23:38.531650 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:23:38.531813 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:23:38.534143 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:23:38.534948 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:23:38.535256 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:23:38.535405 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:23:38.536543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6637e076-c8f7-43d7-9c3c-dc3f39d1b8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b28f0>]}
[0m20:23:38.536776 [debug] [MainThread]: Using duckdb connection "master"
[0m20:23:38.536916 [debug] [MainThread]: On master: BEGIN
[0m20:23:38.537042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:23:38.537278 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:23:38.537414 [debug] [MainThread]: On master: COMMIT
[0m20:23:38.537545 [debug] [MainThread]: Using duckdb connection "master"
[0m20:23:38.537674 [debug] [MainThread]: On master: COMMIT
[0m20:23:38.537859 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:23:38.537992 [debug] [MainThread]: On master: Close
[0m20:23:38.539490 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:23:38.539718 [info ] [Thread-1 (]: 1 of 15 START test source_not_null_main_raw_events_event_id .................... [RUN]
[0m20:23:38.539945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a)
[0m20:23:38.540124 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:23:38.549663 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:38.550164 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:23:38.560994 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:38.561283 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id" cascade
    
[0m20:23:38.561467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.564373 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:23:38.565916 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
[0m20:23:38.575555 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:38.575831 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:23:38.576236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.576415 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:38.576594 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:23:38.578571 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:23:38.579175 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:23:38.579366 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:38.579533 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:23:38.579892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.581988 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:38.582650 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:38.582830 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:23:38.583084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.583252 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:23:38.583428 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:23:38.584606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.587282 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: ROLLBACK
[0m20:23:38.587739 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a'
[0m20:23:38.587940 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: Close
[0m20:23:38.588306 [info ] [Thread-1 (]: 1 of 15 PASS source_not_null_main_raw_events_event_id .......................... [[32mPASS[0m in 0.05s]
[0m20:23:38.588595 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:23:38.588801 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:23:38.589042 [info ] [Thread-1 (]: 2 of 15 START test source_not_null_main_raw_events_event_type .................. [RUN]
[0m20:23:38.589280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a, now test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b)
[0m20:23:38.589467 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:23:38.592130 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:38.592903 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:23:38.595526 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:38.595753 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type" cascade
    
[0m20:23:38.595935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.596652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.597646 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
[0m20:23:38.598320 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:38.598512 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:23:38.598874 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.599088 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:38.599286 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:23:38.600025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.600607 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:23:38.600834 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:38.601011 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:23:38.601389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.601793 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:38.602332 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:38.602810 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:23:38.603122 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.603290 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:23:38.603463 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
    
      
    ) dbt_internal_test
[0m20:23:38.604189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.605111 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: ROLLBACK
[0m20:23:38.605574 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b'
[0m20:23:38.605795 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: Close
[0m20:23:38.606212 [info ] [Thread-1 (]: 2 of 15 PASS source_not_null_main_raw_events_event_type ........................ [[32mPASS[0m in 0.02s]
[0m20:23:38.606586 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:23:38.606835 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:23:38.607106 [info ] [Thread-1 (]: 3 of 15 START test source_not_null_main_raw_events_timestamp ................... [RUN]
[0m20:23:38.607433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b, now test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d)
[0m20:23:38.607632 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:23:38.611195 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:38.611869 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:23:38.614252 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:38.614475 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp" cascade
    
[0m20:23:38.614658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.615273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.616030 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
[0m20:23:38.616581 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:38.616770 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:23:38.617058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.617300 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:38.617500 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:23:38.618183 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.618766 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:23:38.619366 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:38.619644 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:23:38.620181 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.620625 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:38.621240 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:38.621422 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:23:38.621751 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.621920 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:23:38.622095 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
    
      
    ) dbt_internal_test
[0m20:23:38.622789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.623735 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: ROLLBACK
[0m20:23:38.624161 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d'
[0m20:23:38.624358 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: Close
[0m20:23:38.624725 [info ] [Thread-1 (]: 3 of 15 PASS source_not_null_main_raw_events_timestamp ......................... [[32mPASS[0m in 0.02s]
[0m20:23:38.625010 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:23:38.625212 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:23:38.625421 [info ] [Thread-1 (]: 4 of 15 START test source_not_null_main_raw_events_user_id ..................... [RUN]
[0m20:23:38.625629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d, now test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d)
[0m20:23:38.625810 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:23:38.628839 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:38.629405 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:23:38.631454 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:38.631653 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id" cascade
    
[0m20:23:38.631834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.632360 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.632978 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
[0m20:23:38.633488 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:38.633672 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:23:38.633934 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.634101 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:38.634273 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:23:38.634846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.635338 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:23:38.635515 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:38.635675 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:23:38.636016 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.636360 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:38.636788 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:38.636957 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:23:38.637200 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.637363 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:23:38.637548 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
    
      
    ) dbt_internal_test
[0m20:23:38.638265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.639618 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: ROLLBACK
[0m20:23:38.640067 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d'
[0m20:23:38.640288 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: Close
[0m20:23:38.640640 [info ] [Thread-1 (]: 4 of 15 PASS source_not_null_main_raw_events_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:23:38.640949 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:23:38.641163 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:23:38.641369 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_main_raw_orders_created_at .................. [RUN]
[0m20:23:38.641580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d, now test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273)
[0m20:23:38.641774 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:23:38.644258 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:38.644737 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:23:38.646861 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:38.647050 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at" cascade
    
[0m20:23:38.647219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.647711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.648262 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
[0m20:23:38.648734 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:38.648902 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:23:38.649147 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.649309 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:38.649479 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:23:38.650176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.650649 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:23:38.650828 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:38.650987 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:23:38.651321 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.651650 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:38.652033 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:38.652199 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:23:38.652476 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.652664 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:23:38.652845 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
    
      
    ) dbt_internal_test
[0m20:23:38.653544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.654390 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: ROLLBACK
[0m20:23:38.654766 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273'
[0m20:23:38.654944 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: Close
[0m20:23:38.655251 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_main_raw_orders_created_at ........................ [[32mPASS[0m in 0.01s]
[0m20:23:38.655530 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:23:38.655728 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:23:38.655940 [info ] [Thread-1 (]: 6 of 15 START test source_not_null_main_raw_orders_order_id .................... [RUN]
[0m20:23:38.656169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273, now test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68)
[0m20:23:38.656354 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:23:38.658591 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:38.659057 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:23:38.661545 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:38.661786 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id" cascade
    
[0m20:23:38.661968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.662483 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.663054 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
[0m20:23:38.663543 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:38.663724 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:23:38.663986 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.664151 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:38.664322 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:23:38.665043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.665563 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:23:38.665746 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:38.665910 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:23:38.666230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.666583 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:38.666967 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:38.667132 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:23:38.667362 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.667526 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:23:38.667701 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:23:38.668296 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.669040 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: ROLLBACK
[0m20:23:38.669357 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68'
[0m20:23:38.669520 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: Close
[0m20:23:38.669799 [info ] [Thread-1 (]: 6 of 15 PASS source_not_null_main_raw_orders_order_id .......................... [[32mPASS[0m in 0.01s]
[0m20:23:38.670064 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:23:38.670252 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:23:38.670448 [info ] [Thread-1 (]: 7 of 15 START test source_not_null_main_raw_orders_total_amount ................ [RUN]
[0m20:23:38.670640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68, now test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681)
[0m20:23:38.670810 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:23:38.672903 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:38.673295 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:23:38.675390 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:38.675582 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount" cascade
    
[0m20:23:38.675756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.676209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.676757 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
[0m20:23:38.677226 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:38.677395 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:23:38.677628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.677791 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:38.677961 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:23:38.678596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.679062 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:23:38.679235 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:38.679392 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:23:38.679709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.680072 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:38.680449 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:38.680622 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:23:38.680866 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.681030 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:23:38.681206 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
    
      
    ) dbt_internal_test
[0m20:23:38.681787 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.682531 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: ROLLBACK
[0m20:23:38.683737 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681'
[0m20:23:38.683916 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: Close
[0m20:23:38.684194 [info ] [Thread-1 (]: 7 of 15 PASS source_not_null_main_raw_orders_total_amount ...................... [[32mPASS[0m in 0.01s]
[0m20:23:38.684462 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:23:38.684654 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:23:38.684853 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_main_raw_orders_user_id ..................... [RUN]
[0m20:23:38.685052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681, now test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d)
[0m20:23:38.685223 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:23:38.687372 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:38.687937 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:23:38.692115 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:38.692323 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id" cascade
    
[0m20:23:38.692488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.692991 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.693566 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
[0m20:23:38.694044 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:38.694225 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:23:38.694551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.694726 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:38.694902 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:23:38.695576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.696134 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:23:38.696340 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:38.696514 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:23:38.697019 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.697385 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:38.697894 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:38.698156 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:23:38.698489 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.698670 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:23:38.698847 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
    
      
    ) dbt_internal_test
[0m20:23:38.699493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.700297 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: ROLLBACK
[0m20:23:38.700641 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d'
[0m20:23:38.700812 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: Close
[0m20:23:38.701100 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_main_raw_orders_user_id ........................... [[32mPASS[0m in 0.02s]
[0m20:23:38.701360 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:23:38.701551 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:23:38.701724 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_main_raw_users_created_at ................... [RUN]
[0m20:23:38.701955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d, now test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f)
[0m20:23:38.702142 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:23:38.704222 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:38.704650 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:23:38.707145 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:38.707351 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at" cascade
    
[0m20:23:38.707521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.708018 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.708588 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
[0m20:23:38.709080 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:38.709255 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:23:38.709531 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.709708 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:38.709884 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:23:38.710489 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.710968 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:23:38.711145 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:38.711302 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:23:38.711651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.711986 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:38.712368 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:38.712537 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:23:38.712768 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.712929 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:23:38.713102 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
    
      
    ) dbt_internal_test
[0m20:23:38.713632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.714364 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: ROLLBACK
[0m20:23:38.714689 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f'
[0m20:23:38.714858 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: Close
[0m20:23:38.715134 [info ] [Thread-1 (]: 9 of 15 PASS source_not_null_main_raw_users_created_at ......................... [[32mPASS[0m in 0.01s]
[0m20:23:38.715394 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:23:38.715583 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:23:38.715779 [info ] [Thread-1 (]: 10 of 15 START test source_not_null_main_raw_users_email ....................... [RUN]
[0m20:23:38.715967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f, now test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2)
[0m20:23:38.716129 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:23:38.718330 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:38.718689 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:23:38.720468 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:38.720646 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email" cascade
    
[0m20:23:38.720808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.721204 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.721715 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
[0m20:23:38.722193 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:38.722358 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:23:38.722607 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.722784 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:38.722961 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:23:38.723519 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.724015 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:23:38.724197 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:38.724367 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:23:38.724657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.724983 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:38.725331 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:38.725493 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:23:38.725717 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.725876 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:23:38.726042 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:23:38.726512 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.727232 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: ROLLBACK
[0m20:23:38.727553 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2'
[0m20:23:38.727719 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: Close
[0m20:23:38.727988 [info ] [Thread-1 (]: 10 of 15 PASS source_not_null_main_raw_users_email ............................. [[32mPASS[0m in 0.01s]
[0m20:23:38.728240 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:23:38.728421 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:23:38.728609 [info ] [Thread-1 (]: 11 of 15 START test source_not_null_main_raw_users_user_id ..................... [RUN]
[0m20:23:38.728797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2, now test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2)
[0m20:23:38.728963 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:23:38.731224 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:38.731570 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:23:38.733382 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:38.733564 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id" cascade
    
[0m20:23:38.733730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.734164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.734728 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
[0m20:23:38.735452 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:38.735623 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:23:38.735897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.736068 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:38.736237 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:23:38.736900 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.737410 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:23:38.737599 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:38.737766 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:23:38.738090 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.738424 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:38.738889 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:38.739053 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:23:38.739269 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.739430 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:23:38.739599 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:23:38.740133 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.740885 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: ROLLBACK
[0m20:23:38.741218 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2'
[0m20:23:38.741392 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: Close
[0m20:23:38.741672 [info ] [Thread-1 (]: 11 of 15 PASS source_not_null_main_raw_users_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:23:38.741932 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:23:38.742122 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:23:38.742380 [info ] [Thread-1 (]: 12 of 15 START test source_unique_main_raw_events_event_id ..................... [RUN]
[0m20:23:38.742603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2, now test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc)
[0m20:23:38.742778 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:23:38.745971 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:38.746355 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:23:38.748419 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:38.748617 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id" cascade
    
[0m20:23:38.748792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.749231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.749769 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
[0m20:23:38.750232 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:38.750403 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:23:38.750647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.750808 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:38.750978 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:23:38.757644 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:23:38.758274 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:23:38.758472 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:38.758648 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:23:38.759049 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.759437 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:38.759906 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:38.760075 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:23:38.760308 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.760469 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:23:38.760639 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:23:38.761119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.761922 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: ROLLBACK
[0m20:23:38.762272 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc'
[0m20:23:38.762445 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: Close
[0m20:23:38.762735 [info ] [Thread-1 (]: 12 of 15 PASS source_unique_main_raw_events_event_id ........................... [[32mPASS[0m in 0.02s]
[0m20:23:38.763081 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:23:38.763290 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:23:38.763500 [info ] [Thread-1 (]: 13 of 15 START test source_unique_main_raw_orders_order_id ..................... [RUN]
[0m20:23:38.763934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc, now test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d)
[0m20:23:38.764108 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:23:38.766148 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:38.766555 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:23:38.768611 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:38.768803 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id" cascade
    
[0m20:23:38.768979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.769436 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.770014 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
[0m20:23:38.770524 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:38.770705 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:23:38.770970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.771138 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:38.771314 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:23:38.774627 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:23:38.775210 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:23:38.775388 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:38.775547 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:23:38.775888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.776242 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:38.776707 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:38.776879 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:23:38.777161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.777340 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:23:38.777705 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:23:38.779087 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.780482 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: ROLLBACK
[0m20:23:38.781126 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d'
[0m20:23:38.781339 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: Close
[0m20:23:38.781794 [info ] [Thread-1 (]: 13 of 15 PASS source_unique_main_raw_orders_order_id ........................... [[32mPASS[0m in 0.02s]
[0m20:23:38.782077 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:23:38.782273 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:23:38.782501 [info ] [Thread-1 (]: 14 of 15 START test source_unique_main_raw_users_email ......................... [RUN]
[0m20:23:38.782724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d, now test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc)
[0m20:23:38.782906 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:23:38.785347 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:38.785883 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:23:38.788426 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:38.788676 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email" cascade
    
[0m20:23:38.788863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.789403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.790017 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
[0m20:23:38.790540 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:38.790726 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:23:38.790990 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.791159 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:38.791334 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:23:38.793058 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:23:38.793627 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:23:38.793848 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:38.794024 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:23:38.794825 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.795225 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:38.795718 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:38.795903 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:23:38.796302 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.796586 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:23:38.796780 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:23:38.797349 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.798513 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: ROLLBACK
[0m20:23:38.798897 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc'
[0m20:23:38.799080 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: Close
[0m20:23:38.799582 [info ] [Thread-1 (]: 14 of 15 PASS source_unique_main_raw_users_email ............................... [[32mPASS[0m in 0.02s]
[0m20:23:38.799911 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:23:38.800113 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:23:38.800335 [info ] [Thread-1 (]: 15 of 15 START test source_unique_main_raw_users_user_id ....................... [RUN]
[0m20:23:38.800578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc, now test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd)
[0m20:23:38.800769 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:23:38.803049 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:38.803503 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:23:38.805849 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:38.806065 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id" cascade
    
[0m20:23:38.806249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.806768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:23:38.807362 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
[0m20:23:38.807889 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:38.808075 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:23:38.808373 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.808554 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:38.808739 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:23:38.812288 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:23:38.812904 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:23:38.813106 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:38.813279 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:23:38.813886 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.814363 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:38.814813 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:38.814985 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:23:38.815436 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.815685 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:23:38.815870 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:23:38.816408 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:23:38.817250 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: ROLLBACK
[0m20:23:38.817781 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd'
[0m20:23:38.817960 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: Close
[0m20:23:38.818559 [info ] [Thread-1 (]: 15 of 15 PASS source_unique_main_raw_users_user_id ............................. [[32mPASS[0m in 0.02s]
[0m20:23:38.818960 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:23:38.819666 [debug] [MainThread]: Using duckdb connection "master"
[0m20:23:38.819830 [debug] [MainThread]: On master: BEGIN
[0m20:23:38.820067 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:23:38.820447 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:23:38.820598 [debug] [MainThread]: On master: COMMIT
[0m20:23:38.820756 [debug] [MainThread]: Using duckdb connection "master"
[0m20:23:38.820896 [debug] [MainThread]: On master: COMMIT
[0m20:23:38.821287 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:23:38.821875 [debug] [MainThread]: On master: Close
[0m20:23:38.822168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:38.822313 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd' was properly closed.
[0m20:23:38.822496 [info ] [MainThread]: 
[0m20:23:38.822655 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m20:23:38.824575 [debug] [MainThread]: Command end result
[0m20:23:38.842838 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:23:38.844054 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:23:38.848218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:23:38.848507 [info ] [MainThread]: 
[0m20:23:38.848723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:23:38.848881 [info ] [MainThread]: 
[0m20:23:38.849067 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m20:23:38.851743 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9694155, "process_in_blocks": "0", "process_kernel_time": 0.251583, "process_mem_max_rss": "167608320", "process_out_blocks": "0", "process_user_time": 1.534635}
[0m20:23:38.852023 [debug] [MainThread]: Command `dbt test` succeeded at 20:23:38.851975 after 0.97 seconds
[0m20:23:38.852229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051dfc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051dc5d0>]}
[0m20:23:38.852435 [debug] [MainThread]: Flushing usage events
[0m20:23:39.193758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:15.297710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106195a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f3d90>]}


============================== 20:24:15.301494 | c0aad620-f240-437d-9919-0f9dd2e27b79 ==============================
[0m20:24:15.301494 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:24:15.301822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:24:15.449816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0aad620-f240-437d-9919-0f9dd2e27b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065516e0>]}
[0m20:24:15.492774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0aad620-f240-437d-9919-0f9dd2e27b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105966ad0>]}
[0m20:24:15.494440 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:24:15.553223 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:24:15.641252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:24:15.641506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:24:15.645214 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:24:15.666759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0aad620-f240-437d-9919-0f9dd2e27b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107803d50>]}
[0m20:24:15.714202 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:24:15.715835 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:24:15.730692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0aad620-f240-437d-9919-0f9dd2e27b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a31040>]}
[0m20:24:15.731021 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:24:15.731189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0aad620-f240-437d-9919-0f9dd2e27b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f7bd0>]}
[0m20:24:15.732388 [info ] [MainThread]: 
[0m20:24:15.732586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:15.732725 [info ] [MainThread]: 
[0m20:24:15.732987 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:24:15.742891 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:24:15.810702 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:24:15.811204 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:24:15.811611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:15.832472 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m20:24:15.833606 [debug] [ThreadPool]: On list_dev: Close
[0m20:24:15.834079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:24:15.834545 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:24:15.838599 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:24:15.838872 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:24:15.839105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:15.839746 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:24:15.841099 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:24:15.841357 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:24:15.841945 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:15.842497 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:24:15.842931 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:24:15.844026 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:24:15.844843 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:24:15.845022 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:24:15.845215 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:24:15.845534 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:15.845871 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:24:15.847349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m20:24:15.850702 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:24:15.850951 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:24:15.851104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:15.851491 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:15.851667 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:24:15.851823 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:24:15.861093 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:24:15.931021 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:24:15.932199 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:24:15.932386 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:24:15.932922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:24:15.935935 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:24:15.936157 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:24:15.936428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:15.936919 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:15.937072 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:24:15.937231 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:24:15.940881 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:24:15.941911 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:24:15.942302 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:24:15.942466 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:24:15.944522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0aad620-f240-437d-9919-0f9dd2e27b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11003a680>]}
[0m20:24:15.945115 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:15.945419 [debug] [MainThread]: On master: BEGIN
[0m20:24:15.946063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:15.946711 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:24:15.946877 [debug] [MainThread]: On master: COMMIT
[0m20:24:15.947028 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:15.947167 [debug] [MainThread]: On master: COMMIT
[0m20:24:15.947427 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:15.947592 [debug] [MainThread]: On master: Close
[0m20:24:15.949278 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:24:15.949606 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_events .................................... [RUN]
[0m20:24:15.949864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now model.sbdk_project.stg_events)
[0m20:24:15.950052 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:24:15.955860 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:24:15.956734 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:24:15.975284 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m20:24:15.976498 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:24:15.976757 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m20:24:15.976935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:15.977495 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:15.977679 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:24:15.977954 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_events"
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m20:24:15.979332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:15.983635 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:24:15.983900 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m20:24:15.984650 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:15.986167 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:24:15.986353 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:24:15.986687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:15.993816 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:24:15.994075 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:24:15.994250 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:24:15.995178 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:15.997905 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:24:15.998097 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m20:24:15.998483 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:15.999770 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m20:24:16.000776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0aad620-f240-437d-9919-0f9dd2e27b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787dcd0>]}
[0m20:24:16.001102 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.05s]
[0m20:24:16.001376 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:24:16.001569 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:24:16.001820 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_orders .................................... [RUN]
[0m20:24:16.002020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:24:16.002188 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:24:16.003707 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:24:16.004069 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:24:16.005973 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m20:24:16.006343 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:24:16.006516 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m20:24:16.006672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:16.006989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.007153 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:24:16.007380 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_orders"
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m20:24:16.008427 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:16.009846 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:24:16.010023 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:24:16.010341 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.011697 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:24:16.011894 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:24:16.012202 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.012989 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:24:16.013166 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:24:16.013322 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:24:16.013769 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.015060 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:24:16.015234 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m20:24:16.015568 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.016172 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m20:24:16.016450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0aad620-f240-437d-9919-0f9dd2e27b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107daea40>]}
[0m20:24:16.016749 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.01s]
[0m20:24:16.017004 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:24:16.017184 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:24:16.017419 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_users ..................................... [RUN]
[0m20:24:16.017606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:24:16.017770 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:24:16.019197 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:24:16.019598 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:24:16.021405 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:24:16.021797 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:24:16.021970 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:24:16.022125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:16.022430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.022597 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:24:16.022791 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_users"
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:24:16.025948 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:24:16.027666 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:24:16.027868 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m20:24:16.028229 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.029536 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:24:16.029700 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:24:16.029971 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.030711 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:24:16.030877 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:24:16.031029 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:24:16.031439 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.032739 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:24:16.032922 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m20:24:16.033258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.033862 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:24:16.034120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0aad620-f240-437d-9919-0f9dd2e27b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794c910>]}
[0m20:24:16.034422 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.02s]
[0m20:24:16.034676 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:24:16.035023 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:24:16.035251 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_user_activity ............................. [RUN]
[0m20:24:16.035435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now model.sbdk_project.int_user_activity)
[0m20:24:16.035597 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m20:24:16.037509 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m20:24:16.038099 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m20:24:16.039871 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.int_user_activity"
[0m20:24:16.040288 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:24:16.040469 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: BEGIN
[0m20:24:16.040631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:16.040942 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.041126 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:24:16.041428 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

  
  create view "dev"."main"."int_user_activity__dbt_tmp" as (
    

with users as (
    select * from "dev"."main"."stg_users"
),

events as (
    select * from "dev"."main"."stg_events"
),

orders as (
    select * from "dev"."main"."stg_orders"
),

user_events as (
    select
        user_id,
        count(*) as total_events,
        count(*) filter (where event_type = 'page_view') as pageviews,
        count(*) filter (where event_type = 'click') as clicks,
        count(*) filter (where event_type = 'signup') as signups,
        count(*) filter (where event_type = 'login') as logins,
        count(*) filter (where event_type = 'purchase') as purchase_events,
        count(*) filter (where is_conversion_event = true) as conversion_events,
        count(*) filter (where is_revenue_event = true) as revenue_events,
        coalesce(sum(revenue), 0) as total_event_revenue,
        coalesce(sum(duration_seconds), 0) as total_time_on_site,
        count(distinct session_id) filter (where session_id is not null) as unique_sessions,
        count(distinct event_date) as active_days,
        min(timestamp) as first_event_at,
        max(timestamp) as last_event_at,
        count(distinct traffic_category) as traffic_sources_used
    from events
    group by user_id
),

user_orders as (
    select
        user_id,
        count(*) as total_orders,
        count(*) filter (where is_completed = true) as completed_orders,
        count(*) filter (where is_failed = true) as failed_orders,
        count(*) filter (where is_recurring = true) as recurring_orders,
        coalesce(sum(total_amount) filter (where is_completed = true), 0) as total_order_revenue,
        coalesce(avg(total_amount) filter (where is_completed = true), 0) as avg_order_value,
        coalesce(sum(discount_amount), 0) as total_discounts_used,
        count(distinct product_category) as product_categories_purchased,
        min(created_at) as first_order_at,
        max(created_at) as last_order_at,
        count(distinct payment_method) as payment_methods_used
    from orders
    group by user_id
),

combined as (
    select
        u.user_id,
        u.username,
        u.email,
        u.first_name,
        u.last_name,
        u.created_at as user_created_at,
        u.country,
        u.city,
        u.subscription_tier,
        u.referrer,
        u.is_active,
        u.age,
        u.is_paid_subscriber,
        u.days_since_signup,
        u.has_complete_profile,
        
        -- Event metrics
        coalesce(e.total_events, 0) as total_events,
        coalesce(e.pageviews, 0) as pageviews,
        coalesce(e.clicks, 0) as clicks,
        coalesce(e.signups, 0) as signups,
        coalesce(e.logins, 0) as logins,
        coalesce(e.purchase_events, 0) as purchase_events,
        coalesce(e.conversion_events, 0) as conversion_events,
        coalesce(e.revenue_events, 0) as revenue_events,
        coalesce(e.total_event_revenue, 0) as total_event_revenue,
        coalesce(e.total_time_on_site, 0) as total_time_on_site,
        coalesce(e.unique_sessions, 0) as unique_sessions,
        coalesce(e.active_days, 0) as active_days,
        e.first_event_at,
        e.last_event_at,
        coalesce(e.traffic_sources_used, 0) as traffic_sources_used,
        
        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.failed_orders, 0) as failed_orders,
        coalesce(o.recurring_orders, 0) as recurring_orders,
        coalesce(o.total_order_revenue, 0) as total_order_revenue,
        coalesce(o.avg_order_value, 0) as avg_order_value,
        coalesce(o.total_discounts_used, 0) as total_discounts_used,
        coalesce(o.product_categories_purchased, 0) as product_categories_purchased,
        o.first_order_at,
        o.last_order_at,
        coalesce(o.payment_methods_used, 0) as payment_methods_used,
        
        -- Calculated metrics
        case 
            when e.pageviews > 0 and o.completed_orders > 0 
            then round(o.completed_orders::float / e.pageviews * 100, 2)
            else 0 
        end as purchase_conversion_rate,
        
        case 
            when e.total_events > 0 
            then round(e.conversion_events::float / e.total_events * 100, 2)
            else 0 
        end as event_conversion_rate,
        
        case 
            when e.unique_sessions > 0 
            then round(e.total_events::float / e.unique_sessions, 2)
            else 0 
        end as events_per_session,
        
        case 
            when u.days_since_signup > 0 and e.active_days > 0
            then round(e.active_days::float / u.days_since_signup * 100, 2)
            else 0 
        end as activity_frequency_percentage,
        
        -- Total combined revenue
        coalesce(e.total_event_revenue, 0) + coalesce(o.total_order_revenue, 0) as total_revenue,
        
        -- User activity classification
        case 
            when o.completed_orders > 0 then 'customer'
            when e.signups > 0 then 'signed_up'
            when e.total_events > 10 then 'engaged_visitor'
            when e.total_events > 0 then 'visitor'
            else 'inactive'
        end as user_type
        
    from users u
    left join user_events e on u.user_id = e.user_id
    left join user_orders o on u.user_id = o.user_id
)

select * from combined
  );

[0m20:24:16.044551 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:24:16.045941 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:24:16.046117 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity" rename to "int_user_activity__dbt_backup"
[0m20:24:16.046438 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.047775 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:24:16.047956 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity__dbt_tmp" rename to "int_user_activity"
[0m20:24:16.048257 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.048989 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:24:16.049155 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:24:16.049312 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:24:16.049837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.051074 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:24:16.051249 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

      drop view if exists "dev"."main"."int_user_activity__dbt_backup" cascade
    
[0m20:24:16.051593 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.052201 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: Close
[0m20:24:16.052469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0aad620-f240-437d-9919-0f9dd2e27b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107901850>]}
[0m20:24:16.052771 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_user_activity ........................ [[32mOK[0m in 0.02s]
[0m20:24:16.053030 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:24:16.053325 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:24:16.053569 [info ] [Thread-1 (]: 5 of 5 START sql table model main.user_metrics ................................. [RUN]
[0m20:24:16.053778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m20:24:16.053948 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m20:24:16.055554 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m20:24:16.055966 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m20:24:16.066209 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.user_metrics"
[0m20:24:16.066708 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:24:16.066896 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: BEGIN
[0m20:24:16.067066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:16.067447 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.067633 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:24:16.067921 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

  
    
    

    create  table
      "dev"."main"."user_metrics__dbt_tmp"
  
    as (
      

with user_activity as (
    select * from "dev"."main"."int_user_activity"
),

final as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        user_created_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        age,
        is_paid_subscriber,
        days_since_signup,
        has_complete_profile,
        
        -- Engagement metrics
        total_events,
        pageviews,
        clicks,
        logins,
        unique_sessions,
        active_days,
        traffic_sources_used,
        events_per_session,
        activity_frequency_percentage,
        total_time_on_site,
        
        -- Conversion metrics
        signups,
        purchase_events,
        conversion_events,
        purchase_conversion_rate,
        event_conversion_rate,
        
        -- Revenue metrics
        total_orders,
        completed_orders,
        failed_orders,
        recurring_orders,
        total_order_revenue,
        total_event_revenue,
        total_revenue,
        avg_order_value,
        total_discounts_used,
        product_categories_purchased,
        payment_methods_used,
        
        -- Timing metrics
        first_event_at,
        last_event_at,
        first_order_at,
        last_order_at,
        
        -- User classification
        user_type,
        
        -- Customer lifetime value estimate
        case 
            when recurring_orders > 0 and days_since_signup > 0
            then round(total_revenue * (365.0 / days_since_signup) * 2, 2)  -- Rough 2-year CLV estimate
            else total_revenue 
        end as estimated_clv,
        
        -- Engagement score (0-100)
        least(100, 
            (case when active_days > 0 then least(25, active_days) else 0 end) +
            (case when unique_sessions > 0 then least(25, unique_sessions) else 0 end) +
            (case when total_events > 0 then least(25, least(25, total_events / 10)) else 0 end) +
            (case when completed_orders > 0 then 25 else 0 end)
        ) as engagement_score,
        
        -- Risk classification
        case 
            when last_event_at < current_date - interval '90 days' and total_orders > 0 then 'churn_risk'
            when last_event_at < current_date - interval '30 days' and user_type = 'customer' then 'at_risk'
            when activity_frequency_percentage < 10 and days_since_signup > 30 then 'low_engagement'
            when user_type = 'customer' and recurring_orders = 0 then 'one_time_buyer'
            when user_type = 'customer' and recurring_orders > 0 then 'loyal_customer'
            when user_type = 'engaged_visitor' then 'potential_customer'
            else 'standard'
        end as risk_category,
        
        -- Value tier
        case 
            when total_revenue >= 1000 then 'high_value'
            when total_revenue >= 500 then 'medium_value'
            when total_revenue >= 100 then 'low_value'
            when total_revenue > 0 then 'minimal_value'
            else 'no_value'
        end as value_tier,
        
        -- Recency, Frequency, Monetary (RFM) components
        case 
            when last_order_at >= current_date - interval '30 days' then 5
            when last_order_at >= current_date - interval '60 days' then 4
            when last_order_at >= current_date - interval '90 days' then 3
            when last_order_at >= current_date - interval '180 days' then 2
            when last_order_at is not null then 1
            else 0
        end as recency_score,
        
        case 
            when completed_orders >= 10 then 5
            when completed_orders >= 5 then 4
            when completed_orders >= 3 then 3
            when completed_orders >= 2 then 2
            when completed_orders >= 1 then 1
            else 0
        end as frequency_score,
        
        case 
            when total_revenue >= 1000 then 5
            when total_revenue >= 500 then 4
            when total_revenue >= 200 then 3
            when total_revenue >= 50 then 2
            when total_revenue > 0 then 1
            else 0
        end as monetary_score,
        
        -- Data freshness
        current_timestamp as updated_at
        
    from user_activity
)

select * from final
    );
  
  
[0m20:24:16.125524 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m20:24:16.127176 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:24:16.127368 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics" rename to "user_metrics__dbt_backup"
[0m20:24:16.128056 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:16.129401 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:24:16.129584 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics__dbt_tmp" rename to "user_metrics"
[0m20:24:16.129874 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.132752 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:24:16.132985 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:24:16.133153 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:24:16.139455 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:24:16.141024 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:24:16.141209 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

      drop table if exists "dev"."main"."user_metrics__dbt_backup" cascade
    
[0m20:24:16.141795 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:16.142472 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: Close
[0m20:24:16.142755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0aad620-f240-437d-9919-0f9dd2e27b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015f070>]}
[0m20:24:16.143068 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.user_metrics ............................ [[32mOK[0m in 0.09s]
[0m20:24:16.143326 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:24:16.143900 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:16.144082 [debug] [MainThread]: On master: BEGIN
[0m20:24:16.144225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:24:16.144470 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:16.144615 [debug] [MainThread]: On master: COMMIT
[0m20:24:16.144748 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:16.144875 [debug] [MainThread]: On master: COMMIT
[0m20:24:16.145068 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:16.145202 [debug] [MainThread]: On master: Close
[0m20:24:16.145380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:16.145514 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m20:24:16.145688 [info ] [MainThread]: 
[0m20:24:16.145840 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m20:24:16.146376 [debug] [MainThread]: Command end result
[0m20:24:16.161434 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:24:16.162432 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:24:16.165602 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:24:16.165770 [info ] [MainThread]: 
[0m20:24:16.165952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:24:16.166097 [info ] [MainThread]: 
[0m20:24:16.166260 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:24:16.168034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.92811227, "process_in_blocks": "0", "process_kernel_time": 0.28102, "process_mem_max_rss": "216547328", "process_out_blocks": "0", "process_user_time": 1.561454}
[0m20:24:16.168299 [debug] [MainThread]: Command `dbt run` succeeded at 20:24:16.168252 after 0.93 seconds
[0m20:24:16.168498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059fec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107932bd0>]}
[0m20:24:16.168688 [debug] [MainThread]: Flushing usage events
[0m20:24:16.501601 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:17.852697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f55a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f3d90>]}


============================== 20:24:17.856631 | 84c19e0e-45f3-4409-b8c8-1a3ba6196eb9 ==============================
[0m20:24:17.856631 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:24:17.856971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:24:17.997611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84c19e0e-45f3-4409-b8c8-1a3ba6196eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105516e0>]}
[0m20:24:18.039528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84c19e0e-45f3-4409-b8c8-1a3ba6196eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcaad0>]}
[0m20:24:18.041314 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:24:18.102320 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:24:18.188407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:24:18.188667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:24:18.192436 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:24:18.214364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84c19e0e-45f3-4409-b8c8-1a3ba6196eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113103c50>]}
[0m20:24:18.262539 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:24:18.263793 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:24:18.283877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84c19e0e-45f3-4409-b8c8-1a3ba6196eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113835b80>]}
[0m20:24:18.284182 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:24:18.284353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84c19e0e-45f3-4409-b8c8-1a3ba6196eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d90f0>]}
[0m20:24:18.285569 [info ] [MainThread]: 
[0m20:24:18.285760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:18.285903 [info ] [MainThread]: 
[0m20:24:18.286150 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:24:18.289280 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:24:18.360748 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:24:18.360978 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:24:18.361128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:18.373190 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:24:18.374013 [debug] [ThreadPool]: On list_dev: Close
[0m20:24:18.374377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:24:18.374603 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:24:18.377998 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:24:18.378172 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:24:18.378312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:18.378680 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:18.379299 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:24:18.379441 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:24:18.379635 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:18.379766 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:24:18.379893 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:24:18.380099 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:18.380482 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:24:18.380623 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:24:18.380748 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:24:18.380926 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:18.381055 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:24:18.382133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main)
[0m20:24:18.385175 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:24:18.385366 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:24:18.385511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:18.385813 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:18.385988 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:24:18.386140 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:24:18.393298 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:24:18.394160 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:24:18.395134 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:24:18.395525 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:24:18.396030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:24:18.397157 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:24:18.397314 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:24:18.397448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:18.398213 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:24:18.398358 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:24:18.398503 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:24:18.400855 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:24:18.401649 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:24:18.401966 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:24:18.402103 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:24:18.403225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84c19e0e-45f3-4409-b8c8-1a3ba6196eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ae65b0>]}
[0m20:24:18.403455 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:18.403595 [debug] [MainThread]: On master: BEGIN
[0m20:24:18.403721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:18.403933 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:18.404067 [debug] [MainThread]: On master: COMMIT
[0m20:24:18.404191 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:18.404320 [debug] [MainThread]: On master: COMMIT
[0m20:24:18.404525 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:18.404690 [debug] [MainThread]: On master: Close
[0m20:24:18.406254 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:24:18.406476 [info ] [Thread-1 (]: 1 of 15 START test source_not_null_main_raw_events_event_id .................... [RUN]
[0m20:24:18.406703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a)
[0m20:24:18.406895 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:24:18.415420 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:18.415919 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:24:18.425692 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:18.425913 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id" cascade
    
[0m20:24:18.426091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.426746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:18.427980 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
[0m20:24:18.436292 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:18.436539 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:24:18.436871 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.437046 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:18.437217 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:24:18.437880 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.438442 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:24:18.438633 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:18.438798 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:24:18.439146 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.441044 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:18.441503 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:18.441683 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:24:18.441923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.442092 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:18.442265 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:24:18.443018 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:18.445084 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: ROLLBACK
[0m20:24:18.445428 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a'
[0m20:24:18.445607 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: Close
[0m20:24:18.445909 [info ] [Thread-1 (]: 1 of 15 PASS source_not_null_main_raw_events_event_id .......................... [[32mPASS[0m in 0.04s]
[0m20:24:18.446177 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:24:18.446364 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:24:18.446568 [info ] [Thread-1 (]: 2 of 15 START test source_not_null_main_raw_events_event_type .................. [RUN]
[0m20:24:18.446758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a, now test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b)
[0m20:24:18.446925 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:24:18.448871 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:18.449261 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:24:18.451320 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:18.451499 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type" cascade
    
[0m20:24:18.451662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.452055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.452558 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
[0m20:24:18.453015 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:18.453173 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:24:18.453395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.453556 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:18.453725 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:24:18.454263 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.454762 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:24:18.454938 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:18.455094 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:24:18.455386 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.455699 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:18.456042 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:18.456197 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:24:18.456424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.456584 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:18.456744 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
    
      
    ) dbt_internal_test
[0m20:24:18.457265 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.457978 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: ROLLBACK
[0m20:24:18.458303 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b'
[0m20:24:18.458472 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: Close
[0m20:24:18.458739 [info ] [Thread-1 (]: 2 of 15 PASS source_not_null_main_raw_events_event_type ........................ [[32mPASS[0m in 0.01s]
[0m20:24:18.458989 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:24:18.459169 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:24:18.459357 [info ] [Thread-1 (]: 3 of 15 START test source_not_null_main_raw_events_timestamp ................... [RUN]
[0m20:24:18.459538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b, now test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d)
[0m20:24:18.459700 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:24:18.461819 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:18.462169 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:24:18.463957 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:18.464137 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp" cascade
    
[0m20:24:18.464301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.464681 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.465176 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
[0m20:24:18.465638 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:18.465804 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:24:18.466033 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.466193 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:18.466358 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:24:18.466857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.467296 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:24:18.467462 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:18.467612 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:24:18.467879 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.468183 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:18.468551 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:18.468712 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:24:18.468919 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.469077 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:18.469239 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
    
      
    ) dbt_internal_test
[0m20:24:18.469717 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.470403 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: ROLLBACK
[0m20:24:18.470714 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d'
[0m20:24:18.470886 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: Close
[0m20:24:18.471143 [info ] [Thread-1 (]: 3 of 15 PASS source_not_null_main_raw_events_timestamp ......................... [[32mPASS[0m in 0.01s]
[0m20:24:18.471427 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:24:18.471616 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:24:18.471808 [info ] [Thread-1 (]: 4 of 15 START test source_not_null_main_raw_events_user_id ..................... [RUN]
[0m20:24:18.471999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d, now test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d)
[0m20:24:18.472164 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:24:18.474346 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:18.474727 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:24:18.476540 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:18.476725 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id" cascade
    
[0m20:24:18.476890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.477297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.477800 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
[0m20:24:18.478249 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:18.478408 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:24:18.478629 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.478791 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:18.478954 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:24:18.479487 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.479945 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:24:18.480124 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:18.480283 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:24:18.480564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.480876 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:18.481224 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:18.481380 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:24:18.481600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.481759 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:18.481920 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
    
      
    ) dbt_internal_test
[0m20:24:18.482452 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.483438 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: ROLLBACK
[0m20:24:18.483766 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d'
[0m20:24:18.483937 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: Close
[0m20:24:18.484210 [info ] [Thread-1 (]: 4 of 15 PASS source_not_null_main_raw_events_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:24:18.484464 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:24:18.484647 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:24:18.484839 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_main_raw_orders_created_at .................. [RUN]
[0m20:24:18.485024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d, now test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273)
[0m20:24:18.485189 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:24:18.487129 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:18.487483 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:24:18.489525 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:18.489706 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at" cascade
    
[0m20:24:18.489872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.490273 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.490787 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
[0m20:24:18.491261 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:18.491430 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:24:18.491658 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.491820 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:18.491990 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:24:18.492650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.493126 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:24:18.493302 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:18.493460 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:24:18.493822 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.494151 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:18.494529 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:18.494686 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:24:18.494899 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.495057 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:18.495217 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
    
      
    ) dbt_internal_test
[0m20:24:18.495804 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.496525 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: ROLLBACK
[0m20:24:18.496849 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273'
[0m20:24:18.497014 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: Close
[0m20:24:18.497284 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_main_raw_orders_created_at ........................ [[32mPASS[0m in 0.01s]
[0m20:24:18.497536 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:24:18.497719 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:24:18.497905 [info ] [Thread-1 (]: 6 of 15 START test source_not_null_main_raw_orders_order_id .................... [RUN]
[0m20:24:18.498088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273, now test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68)
[0m20:24:18.498249 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:24:18.500239 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:18.500581 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:24:18.502621 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:18.502808 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id" cascade
    
[0m20:24:18.502977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.503351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.503848 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
[0m20:24:18.504302 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:18.504466 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:24:18.504765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.504945 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:18.505117 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:24:18.505761 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.506235 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:24:18.506412 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:18.506572 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:24:18.506900 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.507276 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:18.507691 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:18.507870 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:24:18.508113 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.508279 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:18.508453 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:24:18.509112 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.509912 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: ROLLBACK
[0m20:24:18.510266 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68'
[0m20:24:18.510434 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: Close
[0m20:24:18.510718 [info ] [Thread-1 (]: 6 of 15 PASS source_not_null_main_raw_orders_order_id .......................... [[32mPASS[0m in 0.01s]
[0m20:24:18.510978 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:24:18.511165 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:24:18.511370 [info ] [Thread-1 (]: 7 of 15 START test source_not_null_main_raw_orders_total_amount ................ [RUN]
[0m20:24:18.511584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68, now test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681)
[0m20:24:18.511755 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:24:18.513769 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:18.514188 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:24:18.516353 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:18.516546 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount" cascade
    
[0m20:24:18.516715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.517163 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.517708 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
[0m20:24:18.518191 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:18.518371 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:24:18.518619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.518787 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:18.518954 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:24:18.519616 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.520084 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:24:18.520265 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:18.520433 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:24:18.520741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.521065 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:18.521471 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:18.521640 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:24:18.521865 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.522029 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:18.522203 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
    
      
    ) dbt_internal_test
[0m20:24:18.523031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:18.523919 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: ROLLBACK
[0m20:24:18.524264 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681'
[0m20:24:18.524431 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: Close
[0m20:24:18.524716 [info ] [Thread-1 (]: 7 of 15 PASS source_not_null_main_raw_orders_total_amount ...................... [[32mPASS[0m in 0.01s]
[0m20:24:18.524978 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:24:18.525160 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:24:18.525368 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_main_raw_orders_user_id ..................... [RUN]
[0m20:24:18.525594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681, now test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d)
[0m20:24:18.525772 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:24:18.527786 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:18.528190 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:24:18.531950 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:18.532139 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id" cascade
    
[0m20:24:18.532299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.532757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.533279 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
[0m20:24:18.533730 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:18.533896 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:24:18.534122 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.534281 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:18.534441 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:24:18.535058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.535506 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:24:18.536243 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:18.536406 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:24:18.536713 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.537025 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:18.537449 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:18.537613 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:24:18.537855 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.538029 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:18.538204 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
    
      
    ) dbt_internal_test
[0m20:24:18.538979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:18.539918 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: ROLLBACK
[0m20:24:18.540277 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d'
[0m20:24:18.540443 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: Close
[0m20:24:18.540731 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_main_raw_orders_user_id ........................... [[32mPASS[0m in 0.02s]
[0m20:24:18.540996 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:24:18.541182 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:24:18.541346 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_main_raw_users_created_at ................... [RUN]
[0m20:24:18.541560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d, now test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f)
[0m20:24:18.541733 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:24:18.543718 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:18.544167 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:24:18.546313 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:18.546496 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at" cascade
    
[0m20:24:18.546662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.547114 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.547621 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
[0m20:24:18.548084 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:18.548251 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:24:18.548523 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.548687 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:18.548858 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:24:18.549374 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.549825 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:24:18.549993 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:18.550151 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:24:18.550478 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.550805 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:18.551154 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:18.551317 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:24:18.552241 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.552408 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:18.552576 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
    
      
    ) dbt_internal_test
[0m20:24:18.553084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.554164 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: ROLLBACK
[0m20:24:18.554513 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f'
[0m20:24:18.554685 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: Close
[0m20:24:18.554959 [info ] [Thread-1 (]: 9 of 15 PASS source_not_null_main_raw_users_created_at ......................... [[32mPASS[0m in 0.01s]
[0m20:24:18.555213 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:24:18.555391 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:24:18.555585 [info ] [Thread-1 (]: 10 of 15 START test source_not_null_main_raw_users_email ....................... [RUN]
[0m20:24:18.555769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f, now test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2)
[0m20:24:18.555932 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:24:18.558197 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:18.558621 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:24:18.560434 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:18.560610 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email" cascade
    
[0m20:24:18.560772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.561183 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.561697 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
[0m20:24:18.562149 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:18.562312 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:24:18.562532 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.562695 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:18.562859 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:24:18.563369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.563859 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:24:18.564039 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:18.564198 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:24:18.564511 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.564840 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:18.565239 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:18.565404 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:24:18.565637 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.565800 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:18.565976 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:24:18.566665 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.567504 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: ROLLBACK
[0m20:24:18.567874 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2'
[0m20:24:18.568054 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: Close
[0m20:24:18.568346 [info ] [Thread-1 (]: 10 of 15 PASS source_not_null_main_raw_users_email ............................. [[32mPASS[0m in 0.01s]
[0m20:24:18.568602 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:24:18.568784 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:24:18.569003 [info ] [Thread-1 (]: 11 of 15 START test source_not_null_main_raw_users_user_id ..................... [RUN]
[0m20:24:18.569237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2, now test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2)
[0m20:24:18.569416 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:24:18.571843 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:18.572304 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:24:18.574222 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:18.574405 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id" cascade
    
[0m20:24:18.574568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.575037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.575577 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
[0m20:24:18.576271 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:18.576438 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:24:18.576669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.576832 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:18.576997 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:24:18.577493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.577939 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:24:18.578107 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:18.578267 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:24:18.578594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.578921 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:18.579280 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:18.579439 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:24:18.579658 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.579816 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:18.579977 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:24:18.580495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.581292 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: ROLLBACK
[0m20:24:18.581638 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2'
[0m20:24:18.581810 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: Close
[0m20:24:18.582094 [info ] [Thread-1 (]: 11 of 15 PASS source_not_null_main_raw_users_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:24:18.582350 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:24:18.582536 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:24:18.582727 [info ] [Thread-1 (]: 12 of 15 START test source_unique_main_raw_events_event_id ..................... [RUN]
[0m20:24:18.582917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2, now test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc)
[0m20:24:18.583083 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:24:18.586245 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:18.586636 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:24:18.588729 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:18.588937 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id" cascade
    
[0m20:24:18.589217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.589918 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:18.590533 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
[0m20:24:18.591031 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:18.591197 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:24:18.591433 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.591594 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:18.591763 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:24:18.597693 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:24:18.598329 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:24:18.598523 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:18.598688 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:24:18.599066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.599437 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:18.599910 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:18.600081 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:24:18.600316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.600478 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:18.600645 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:24:18.601116 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.601879 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: ROLLBACK
[0m20:24:18.602221 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc'
[0m20:24:18.602395 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: Close
[0m20:24:18.602683 [info ] [Thread-1 (]: 12 of 15 PASS source_unique_main_raw_events_event_id ........................... [[32mPASS[0m in 0.02s]
[0m20:24:18.602959 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:24:18.603151 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:24:18.603356 [info ] [Thread-1 (]: 13 of 15 START test source_unique_main_raw_orders_order_id ..................... [RUN]
[0m20:24:18.603570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc, now test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d)
[0m20:24:18.603741 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:24:18.606901 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:18.607508 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:24:18.609983 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:18.610186 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id" cascade
    
[0m20:24:18.610358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.610849 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.611420 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
[0m20:24:18.611923 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:18.612093 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:24:18.612330 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.612495 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:18.612664 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:24:18.617032 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:24:18.617689 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:24:18.618020 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:18.618223 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:24:18.618673 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.619069 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:18.619526 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:18.619711 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:24:18.620008 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.620247 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:18.620515 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:24:18.621325 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.622655 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: ROLLBACK
[0m20:24:18.623288 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d'
[0m20:24:18.623557 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: Close
[0m20:24:18.623999 [info ] [Thread-1 (]: 13 of 15 PASS source_unique_main_raw_orders_order_id ........................... [[32mPASS[0m in 0.02s]
[0m20:24:18.624288 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:24:18.624489 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:24:18.624672 [info ] [Thread-1 (]: 14 of 15 START test source_unique_main_raw_users_email ......................... [RUN]
[0m20:24:18.624910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d, now test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc)
[0m20:24:18.625119 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:24:18.627537 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:18.628042 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:24:18.630680 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:18.630922 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email" cascade
    
[0m20:24:18.631166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.631756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:18.632466 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
[0m20:24:18.633022 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:18.633209 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:24:18.633499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.633668 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:18.633846 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:24:18.636413 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:24:18.638644 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:24:18.639990 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:18.640672 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:24:18.641295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.641757 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:18.642259 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:18.642451 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:24:18.642780 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.642952 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:18.643128 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:24:18.643758 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.644711 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: ROLLBACK
[0m20:24:18.645109 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc'
[0m20:24:18.645296 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: Close
[0m20:24:18.645660 [info ] [Thread-1 (]: 14 of 15 PASS source_unique_main_raw_users_email ............................... [[32mPASS[0m in 0.02s]
[0m20:24:18.645948 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:24:18.646155 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:24:18.646341 [info ] [Thread-1 (]: 15 of 15 START test source_unique_main_raw_users_user_id ....................... [RUN]
[0m20:24:18.646564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc, now test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd)
[0m20:24:18.646766 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:24:18.649267 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:18.649944 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:24:18.652814 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:18.653059 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id" cascade
    
[0m20:24:18.653249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:18.653837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:18.654616 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
[0m20:24:18.655318 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:18.655594 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:24:18.655993 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.656183 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:18.656373 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:24:18.658010 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:18.658698 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:24:18.659025 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:18.659314 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:24:18.659814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.660360 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:18.660994 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:18.661242 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:24:18.661685 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.661906 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:18.662098 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:24:18.662683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:18.663832 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: ROLLBACK
[0m20:24:18.664329 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd'
[0m20:24:18.664543 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: Close
[0m20:24:18.664898 [info ] [Thread-1 (]: 15 of 15 PASS source_unique_main_raw_users_user_id ............................. [[32mPASS[0m in 0.02s]
[0m20:24:18.665184 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:24:18.665957 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:18.666133 [debug] [MainThread]: On master: BEGIN
[0m20:24:18.666276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:24:18.666589 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:18.666733 [debug] [MainThread]: On master: COMMIT
[0m20:24:18.666870 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:18.667001 [debug] [MainThread]: On master: COMMIT
[0m20:24:18.667232 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:18.667371 [debug] [MainThread]: On master: Close
[0m20:24:18.667557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:18.667689 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd' was properly closed.
[0m20:24:18.667849 [info ] [MainThread]: 
[0m20:24:18.667999 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m20:24:18.669132 [debug] [MainThread]: Command end result
[0m20:24:18.685639 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:24:18.687151 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:24:18.695084 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:24:18.695356 [info ] [MainThread]: 
[0m20:24:18.695567 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:24:18.695729 [info ] [MainThread]: 
[0m20:24:18.695899 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m20:24:18.697660 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.89736515, "process_in_blocks": "0", "process_kernel_time": 0.222224, "process_mem_max_rss": "163758080", "process_out_blocks": "0", "process_user_time": 1.50393}
[0m20:24:18.697983 [debug] [MainThread]: Command `dbt test` succeeded at 20:24:18.697933 after 0.90 seconds
[0m20:24:18.698194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112725910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b13c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b105d0>]}
[0m20:24:18.698398 [debug] [MainThread]: Flushing usage events
[0m20:24:19.116220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:20.386335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fbd90>]}


============================== 20:24:20.390067 | 5f333e67-7263-4961-92b9-5d7ab848579a ==============================
[0m20:24:20.390067 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:24:20.390545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:20.613048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f333e67-7263-4961-92b9-5d7ab848579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10875d6e0>]}
[0m20:24:20.654532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f333e67-7263-4961-92b9-5d7ab848579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e22ad0>]}
[0m20:24:20.655857 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:24:20.719178 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:24:20.804422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:24:20.806502 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:24:20.812805 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:24:20.849924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f333e67-7263-4961-92b9-5d7ab848579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950fc50>]}
[0m20:24:20.918420 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:24:20.920051 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:24:20.939937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f333e67-7263-4961-92b9-5d7ab848579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b49b80>]}
[0m20:24:20.940260 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:24:20.940436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f333e67-7263-4961-92b9-5d7ab848579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109be50f0>]}
[0m20:24:20.941717 [info ] [MainThread]: 
[0m20:24:20.941908 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:20.942048 [info ] [MainThread]: 
[0m20:24:20.942304 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:24:20.945131 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:24:21.022305 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:24:21.022690 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:24:21.022879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:21.038512 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:24:21.039499 [debug] [ThreadPool]: On list_dev: Close
[0m20:24:21.039944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:24:21.040312 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:24:21.044201 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:24:21.044478 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:24:21.044636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:21.045227 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:24:21.046049 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:24:21.046260 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:24:21.046538 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:21.046871 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:24:21.047071 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:24:21.047506 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:21.048019 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:24:21.048184 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:24:21.048328 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:24:21.048546 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:21.048703 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:24:21.049950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main)
[0m20:24:21.053943 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:24:21.054186 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:24:21.054372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:21.054977 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:24:21.055157 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:24:21.055361 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:24:21.064623 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:24:21.065553 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:24:21.066385 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:24:21.066558 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:24:21.066828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:24:21.068329 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:24:21.068485 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:24:21.068618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:21.068907 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:21.069045 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:24:21.069187 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:24:21.071565 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:24:21.072534 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:24:21.073038 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:24:21.073228 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:24:21.074433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f333e67-7263-4961-92b9-5d7ab848579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dee8f0>]}
[0m20:24:21.074700 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:21.074850 [debug] [MainThread]: On master: BEGIN
[0m20:24:21.074984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:21.075285 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:21.075443 [debug] [MainThread]: On master: COMMIT
[0m20:24:21.075586 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:21.075717 [debug] [MainThread]: On master: COMMIT
[0m20:24:21.075920 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:21.076062 [debug] [MainThread]: On master: Close
[0m20:24:21.077382 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:24:21.077586 [info ] [Thread-1 (]: 1 of 15 START test source_not_null_main_raw_events_event_id .................... [RUN]
[0m20:24:21.077796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a)
[0m20:24:21.077968 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:24:21.087437 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:21.088377 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:24:21.099908 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:21.100211 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id" cascade
    
[0m20:24:21.100408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.101226 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.102720 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
[0m20:24:21.113001 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:21.113279 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:24:21.113626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.113804 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:21.113978 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:24:21.114614 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.115162 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:24:21.115358 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:21.115530 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:24:21.115853 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.117782 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:21.118199 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:21.118371 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:24:21.118606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.118768 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:24:21.118933 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:24:21.119480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.121582 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: ROLLBACK
[0m20:24:21.121922 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a'
[0m20:24:21.122098 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: Close
[0m20:24:21.122385 [info ] [Thread-1 (]: 1 of 15 PASS source_not_null_main_raw_events_event_id .......................... [[32mPASS[0m in 0.04s]
[0m20:24:21.122648 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:24:21.122834 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:24:21.123034 [info ] [Thread-1 (]: 2 of 15 START test source_not_null_main_raw_events_event_type .................. [RUN]
[0m20:24:21.123225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a, now test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b)
[0m20:24:21.123396 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:24:21.125363 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:21.125743 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:24:21.127828 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:21.128012 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type" cascade
    
[0m20:24:21.128178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.128574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.129082 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
[0m20:24:21.129540 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:21.129711 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:24:21.129947 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.130109 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:21.130275 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:24:21.130825 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.131279 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:24:21.131447 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:21.131607 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:24:21.131880 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.132191 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:21.132510 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:21.132666 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:24:21.132875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.133033 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:24:21.133194 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
    
      
    ) dbt_internal_test
[0m20:24:21.133712 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.134476 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: ROLLBACK
[0m20:24:21.134828 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b'
[0m20:24:21.135017 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: Close
[0m20:24:21.135316 [info ] [Thread-1 (]: 2 of 15 PASS source_not_null_main_raw_events_event_type ........................ [[32mPASS[0m in 0.01s]
[0m20:24:21.135590 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:24:21.135785 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:24:21.135990 [info ] [Thread-1 (]: 3 of 15 START test source_not_null_main_raw_events_timestamp ................... [RUN]
[0m20:24:21.136187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b, now test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d)
[0m20:24:21.136364 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:24:21.138755 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:21.139240 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:24:21.141239 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:21.141441 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp" cascade
    
[0m20:24:21.141619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.142123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.142727 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
[0m20:24:21.143230 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:21.143419 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:24:21.143680 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.143851 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:21.144021 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:24:21.144638 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.145133 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:24:21.145315 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:21.145480 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:24:21.145843 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.146186 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:21.146607 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:21.146778 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:24:21.147010 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.147177 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:24:21.147355 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
    
      
    ) dbt_internal_test
[0m20:24:21.147929 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.148721 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: ROLLBACK
[0m20:24:21.149066 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d'
[0m20:24:21.149233 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: Close
[0m20:24:21.149518 [info ] [Thread-1 (]: 3 of 15 PASS source_not_null_main_raw_events_timestamp ......................... [[32mPASS[0m in 0.01s]
[0m20:24:21.149779 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:24:21.149965 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:24:21.150160 [info ] [Thread-1 (]: 4 of 15 START test source_not_null_main_raw_events_user_id ..................... [RUN]
[0m20:24:21.150367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d, now test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d)
[0m20:24:21.150536 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:24:21.152864 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:21.153256 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:24:21.155148 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:21.155343 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id" cascade
    
[0m20:24:21.155511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.155930 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.156467 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
[0m20:24:21.156948 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:21.157126 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:24:21.157429 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.157624 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:21.157813 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:24:21.158710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.159311 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:24:21.159505 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:21.159676 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:24:21.160044 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.160392 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:21.160884 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:21.161087 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:24:21.161366 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.161545 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:24:21.161722 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
    
      
    ) dbt_internal_test
[0m20:24:21.162382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.163642 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: ROLLBACK
[0m20:24:21.164011 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d'
[0m20:24:21.164191 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: Close
[0m20:24:21.164523 [info ] [Thread-1 (]: 4 of 15 PASS source_not_null_main_raw_events_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:24:21.164852 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:24:21.165083 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:24:21.165413 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_main_raw_orders_created_at .................. [RUN]
[0m20:24:21.165676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d, now test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273)
[0m20:24:21.166105 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:24:21.169922 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:21.170447 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:24:21.173516 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:21.173772 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at" cascade
    
[0m20:24:21.173957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.174863 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.175525 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
[0m20:24:21.176075 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:21.176267 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:24:21.176601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.176775 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:21.176953 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:24:21.177666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.178179 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:24:21.178364 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:21.178529 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:24:21.179192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.179591 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:21.180742 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:21.180941 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:24:21.181201 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.181375 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:24:21.181551 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
    
      
    ) dbt_internal_test
[0m20:24:21.182237 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.183094 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: ROLLBACK
[0m20:24:21.183450 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273'
[0m20:24:21.183631 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: Close
[0m20:24:21.183931 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_main_raw_orders_created_at ........................ [[32mPASS[0m in 0.02s]
[0m20:24:21.184204 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:24:21.184397 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:24:21.184574 [info ] [Thread-1 (]: 6 of 15 START test source_not_null_main_raw_orders_order_id .................... [RUN]
[0m20:24:21.184812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273, now test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68)
[0m20:24:21.185013 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:24:21.187199 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:21.187629 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:24:21.189920 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:21.190124 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id" cascade
    
[0m20:24:21.190302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.190839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.191428 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
[0m20:24:21.192112 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:21.192303 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:24:21.192581 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.192755 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:21.192934 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:24:21.193670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.194264 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:24:21.194454 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:21.194758 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:24:21.195350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.195726 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:21.196191 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:21.196373 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:24:21.196625 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.196801 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:24:21.196977 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:24:21.197674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.198557 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: ROLLBACK
[0m20:24:21.198932 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68'
[0m20:24:21.199110 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: Close
[0m20:24:21.199431 [info ] [Thread-1 (]: 6 of 15 PASS source_not_null_main_raw_orders_order_id .......................... [[32mPASS[0m in 0.01s]
[0m20:24:21.199705 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:24:21.199905 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:24:21.200113 [info ] [Thread-1 (]: 7 of 15 START test source_not_null_main_raw_orders_total_amount ................ [RUN]
[0m20:24:21.200315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68, now test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681)
[0m20:24:21.200494 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:24:21.202633 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:21.203087 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:24:21.205468 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:21.205814 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount" cascade
    
[0m20:24:21.206018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.206532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.207129 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
[0m20:24:21.207650 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:21.207837 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:24:21.208340 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.208524 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:21.208706 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:24:21.209408 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.209907 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:24:21.210082 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:21.210240 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:24:21.210557 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.210881 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:21.211317 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:21.211483 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:24:21.211713 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.211881 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:24:21.212052 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
    
      
    ) dbt_internal_test
[0m20:24:21.212619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.213365 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: ROLLBACK
[0m20:24:21.213702 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681'
[0m20:24:21.213874 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: Close
[0m20:24:21.214156 [info ] [Thread-1 (]: 7 of 15 PASS source_not_null_main_raw_orders_total_amount ...................... [[32mPASS[0m in 0.01s]
[0m20:24:21.214416 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:24:21.214599 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:24:21.214774 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_main_raw_orders_user_id ..................... [RUN]
[0m20:24:21.215017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681, now test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d)
[0m20:24:21.215199 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:24:21.217173 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:21.217521 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:24:21.221504 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:21.221840 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id" cascade
    
[0m20:24:21.222007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.222543 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.223092 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
[0m20:24:21.223584 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:21.223754 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:24:21.223989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.224155 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:21.224318 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:24:21.224945 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.225400 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:24:21.225567 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:21.225722 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:24:21.226006 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.226319 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:21.226711 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:21.226868 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:24:21.227079 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.227238 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:24:21.227399 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
    
      
    ) dbt_internal_test
[0m20:24:21.227984 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.228715 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: ROLLBACK
[0m20:24:21.229039 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d'
[0m20:24:21.229209 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: Close
[0m20:24:21.229483 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_main_raw_orders_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:24:21.229741 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:24:21.229923 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:24:21.230116 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_main_raw_users_created_at ................... [RUN]
[0m20:24:21.230302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d, now test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f)
[0m20:24:21.230471 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:24:21.232432 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:21.232776 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:24:21.234897 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:21.235097 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at" cascade
    
[0m20:24:21.235271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.235812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.236318 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
[0m20:24:21.236843 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:21.237140 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:24:21.237487 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.237662 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:21.237841 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:24:21.238412 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.238932 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:24:21.239125 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:21.239297 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:24:21.239677 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.240019 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:21.240416 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:21.240589 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:24:21.240828 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.240997 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:24:21.241178 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
    
      
    ) dbt_internal_test
[0m20:24:21.241741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.242554 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: ROLLBACK
[0m20:24:21.242910 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f'
[0m20:24:21.243083 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: Close
[0m20:24:21.243384 [info ] [Thread-1 (]: 9 of 15 PASS source_not_null_main_raw_users_created_at ......................... [[32mPASS[0m in 0.01s]
[0m20:24:21.243661 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:24:21.243870 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:24:21.244074 [info ] [Thread-1 (]: 10 of 15 START test source_not_null_main_raw_users_email ....................... [RUN]
[0m20:24:21.244278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f, now test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2)
[0m20:24:21.244455 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:24:21.246809 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:21.247282 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:24:21.249257 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:21.249621 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email" cascade
    
[0m20:24:21.249799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.250336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.251072 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
[0m20:24:21.251670 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:21.251900 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:24:21.252210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.252375 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:21.252549 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:24:21.253123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.253619 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:24:21.253794 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:21.253952 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:24:21.254255 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.254612 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:21.255049 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:21.255219 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:24:21.255462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.255626 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:24:21.255794 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:24:21.256330 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.257072 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: ROLLBACK
[0m20:24:21.257411 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2'
[0m20:24:21.257582 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: Close
[0m20:24:21.257859 [info ] [Thread-1 (]: 10 of 15 PASS source_not_null_main_raw_users_email ............................. [[32mPASS[0m in 0.01s]
[0m20:24:21.258122 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:24:21.258310 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:24:21.258499 [info ] [Thread-1 (]: 11 of 15 START test source_not_null_main_raw_users_user_id ..................... [RUN]
[0m20:24:21.258684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2, now test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2)
[0m20:24:21.258848 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:24:21.261118 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:21.261478 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:24:21.263275 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:21.263455 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id" cascade
    
[0m20:24:21.263623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.264012 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.264519 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
[0m20:24:21.265184 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:21.265349 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:24:21.265585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.265751 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:21.265918 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:24:21.266407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.266876 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:24:21.267052 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:21.267210 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:24:21.267505 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.267822 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:21.268143 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:21.268302 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:24:21.268520 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.268683 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:24:21.268847 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:24:21.269328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.270038 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: ROLLBACK
[0m20:24:21.270338 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2'
[0m20:24:21.270502 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: Close
[0m20:24:21.270758 [info ] [Thread-1 (]: 11 of 15 PASS source_not_null_main_raw_users_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:24:21.271009 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:24:21.271207 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:24:21.271418 [info ] [Thread-1 (]: 12 of 15 START test source_unique_main_raw_events_event_id ..................... [RUN]
[0m20:24:21.271624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2, now test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc)
[0m20:24:21.271797 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:24:21.274892 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:21.275268 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:24:21.277467 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:21.277677 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id" cascade
    
[0m20:24:21.277856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.278337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.278921 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
[0m20:24:21.279437 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:21.279615 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:24:21.279866 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.280030 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:21.280196 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:24:21.290459 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:24:21.291291 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:24:21.291541 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:21.291732 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:24:21.292160 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.292560 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:21.293008 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:21.293188 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:24:21.293442 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.293612 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:24:21.293786 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:24:21.294350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.295241 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: ROLLBACK
[0m20:24:21.295633 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc'
[0m20:24:21.295824 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: Close
[0m20:24:21.296143 [info ] [Thread-1 (]: 12 of 15 PASS source_unique_main_raw_events_event_id ........................... [[32mPASS[0m in 0.02s]
[0m20:24:21.296420 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:24:21.296619 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:24:21.296824 [info ] [Thread-1 (]: 13 of 15 START test source_unique_main_raw_orders_order_id ..................... [RUN]
[0m20:24:21.297023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc, now test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d)
[0m20:24:21.297193 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:24:21.299352 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:21.300909 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:24:21.303450 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:21.303770 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id" cascade
    
[0m20:24:21.304011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.304666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.305436 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
[0m20:24:21.305997 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:21.306186 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:24:21.306514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.306688 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:21.306867 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:24:21.310550 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:24:21.311273 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:24:21.311481 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:21.311665 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:24:21.312086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.312469 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:21.313277 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:21.313460 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:24:21.313717 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.313886 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:24:21.314058 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:24:21.314572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.315414 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: ROLLBACK
[0m20:24:21.315787 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d'
[0m20:24:21.315956 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: Close
[0m20:24:21.316263 [info ] [Thread-1 (]: 13 of 15 PASS source_unique_main_raw_orders_order_id ........................... [[32mPASS[0m in 0.02s]
[0m20:24:21.316544 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:24:21.316735 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:24:21.316939 [info ] [Thread-1 (]: 14 of 15 START test source_unique_main_raw_users_email ......................... [RUN]
[0m20:24:21.317140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d, now test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc)
[0m20:24:21.317312 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:24:21.319525 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:21.319966 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:24:21.322190 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:21.322397 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email" cascade
    
[0m20:24:21.322572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.323038 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.323593 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
[0m20:24:21.324078 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:21.324254 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:24:21.324503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.324668 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:21.324845 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:24:21.326560 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:24:21.327126 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:24:21.327315 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:21.327487 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:24:21.327840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.328246 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:21.328697 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:21.328875 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:24:21.329142 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.329343 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:24:21.329527 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:24:21.330024 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.330786 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: ROLLBACK
[0m20:24:21.331120 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc'
[0m20:24:21.331291 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: Close
[0m20:24:21.331594 [info ] [Thread-1 (]: 14 of 15 PASS source_unique_main_raw_users_email ............................... [[32mPASS[0m in 0.01s]
[0m20:24:21.331870 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:24:21.332066 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:24:21.332268 [info ] [Thread-1 (]: 15 of 15 START test source_unique_main_raw_users_user_id ....................... [RUN]
[0m20:24:21.332467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc, now test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd)
[0m20:24:21.332644 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:24:21.334757 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:21.335174 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:24:21.338726 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:21.339003 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id" cascade
    
[0m20:24:21.339224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:21.339879 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.340701 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
[0m20:24:21.341364 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:21.341579 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:24:21.341920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.342341 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:21.342611 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:24:21.344524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:21.345357 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:24:21.345622 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:21.345825 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:24:21.346474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.346873 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:21.347312 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:21.347491 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:24:21.347762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.347940 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:24:21.348117 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:24:21.348638 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:21.349492 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: ROLLBACK
[0m20:24:21.349860 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd'
[0m20:24:21.350044 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: Close
[0m20:24:21.350360 [info ] [Thread-1 (]: 15 of 15 PASS source_unique_main_raw_users_user_id ............................. [[32mPASS[0m in 0.02s]
[0m20:24:21.350640 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:24:21.351301 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:21.351462 [debug] [MainThread]: On master: BEGIN
[0m20:24:21.351598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:24:21.351882 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:21.352025 [debug] [MainThread]: On master: COMMIT
[0m20:24:21.352160 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:21.352286 [debug] [MainThread]: On master: COMMIT
[0m20:24:21.352472 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:21.352613 [debug] [MainThread]: On master: Close
[0m20:24:21.352794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:21.352933 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd' was properly closed.
[0m20:24:21.353098 [info ] [MainThread]: 
[0m20:24:21.353256 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m20:24:21.354462 [debug] [MainThread]: Command end result
[0m20:24:21.370731 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:24:21.371842 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:24:21.376051 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:24:21.376302 [info ] [MainThread]: 
[0m20:24:21.376636 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:24:21.376796 [info ] [MainThread]: 
[0m20:24:21.376956 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m20:24:21.378917 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0405198, "process_in_blocks": "0", "process_kernel_time": 0.232884, "process_mem_max_rss": "169656320", "process_out_blocks": "0", "process_user_time": 1.5386}
[0m20:24:21.379243 [debug] [MainThread]: Command `dbt test` succeeded at 20:24:21.379185 after 1.04 seconds
[0m20:24:21.379482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e1bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e185d0>]}
[0m20:24:21.379695 [debug] [MainThread]: Flushing usage events
[0m20:24:21.778386 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:13.086502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eada90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0bd90>]}


============================== 20:25:13.090408 | ca14f65f-91bf-4bbf-8281-cfa4392742aa ==============================
[0m20:25:13.090408 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:25:13.090773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:25:13.243043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca14f65f-91bf-4bbf-8281-cfa4392742aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616d6e0>]}
[0m20:25:13.288911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca14f65f-91bf-4bbf-8281-cfa4392742aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105832ad0>]}
[0m20:25:13.290575 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:25:13.355310 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:25:13.434729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:25:13.434984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:25:13.438804 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:25:13.459947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca14f65f-91bf-4bbf-8281-cfa4392742aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f1bc50>]}
[0m20:25:13.507801 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:25:13.509704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:25:13.528630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca14f65f-91bf-4bbf-8281-cfa4392742aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107561b80>]}
[0m20:25:13.528938 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:25:13.529111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca14f65f-91bf-4bbf-8281-cfa4392742aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f50f0>]}
[0m20:25:13.530368 [info ] [MainThread]: 
[0m20:25:13.530549 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:25:13.530693 [info ] [MainThread]: 
[0m20:25:13.530958 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:25:13.533773 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:25:13.602951 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:25:13.603186 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:25:13.603334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:13.709079 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m20:25:13.710074 [debug] [ThreadPool]: On list_dev: Close
[0m20:25:13.710458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:25:13.710733 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:25:13.714165 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:25:13.714342 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:25:13.714483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:13.715212 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:25:13.716027 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:25:13.716174 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:25:13.716382 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:25:13.716522 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:25:13.716660 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:25:13.718769 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:25:13.719191 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:25:13.719338 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:25:13.719469 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:25:13.719668 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:25:13.719809 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:25:13.721047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main)
[0m20:25:13.724147 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:25:13.724316 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:25:13.724451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:13.724706 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:25:13.724847 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:25:13.724989 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:25:13.748987 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:25:13.752885 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:25:13.758789 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:25:13.761654 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:25:13.763221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:25:13.773682 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:25:13.774929 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:25:13.776152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:13.782629 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:25:13.783867 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:25:13.784642 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:25:13.796092 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:25:13.799974 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:25:13.802853 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:25:13.804348 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:25:13.806292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca14f65f-91bf-4bbf-8281-cfa4392742aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078028f0>]}
[0m20:25:13.806777 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:13.807024 [debug] [MainThread]: On master: BEGIN
[0m20:25:13.807350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:13.807873 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:25:13.808056 [debug] [MainThread]: On master: COMMIT
[0m20:25:13.808308 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:13.808467 [debug] [MainThread]: On master: COMMIT
[0m20:25:13.808744 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:25:13.808899 [debug] [MainThread]: On master: Close
[0m20:25:13.811025 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:25:13.811297 [info ] [Thread-1 (]: 1 of 15 START test source_not_null_main_raw_events_event_id .................... [RUN]
[0m20:25:13.811573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a)
[0m20:25:13.811766 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:25:13.821996 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:25:13.822642 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:25:13.835165 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:25:13.835422 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id" cascade
    
[0m20:25:13.835609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:13.837478 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:25:13.838817 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
[0m20:25:13.847089 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:25:13.847309 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:25:13.847623 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.847791 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:25:13.847958 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:25:13.850240 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:25:13.850772 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:25:13.850963 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:25:13.851126 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:25:13.851442 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.853406 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:25:13.853885 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:25:13.854071 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:25:13.854324 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.854492 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:25:13.854667 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:25:13.856236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:13.858338 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: ROLLBACK
[0m20:25:13.858697 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a'
[0m20:25:13.858882 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: Close
[0m20:25:13.859203 [info ] [Thread-1 (]: 1 of 15 PASS source_not_null_main_raw_events_event_id .......................... [[32mPASS[0m in 0.05s]
[0m20:25:13.859481 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:25:13.859683 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:25:13.859899 [info ] [Thread-1 (]: 2 of 15 START test source_not_null_main_raw_events_event_type .................. [RUN]
[0m20:25:13.860103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a, now test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b)
[0m20:25:13.860282 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:25:13.862413 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:25:13.862844 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:25:13.865050 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:25:13.865247 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type" cascade
    
[0m20:25:13.865452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:13.865974 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:13.866551 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
[0m20:25:13.867061 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:25:13.867233 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:25:13.867564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.867744 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:25:13.867922 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:25:13.868558 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.869070 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:25:13.869251 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:25:13.869414 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:25:13.869779 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.870192 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:25:13.870800 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:25:13.871018 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:25:13.871309 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.871484 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:25:13.871663 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
    
      
    ) dbt_internal_test
[0m20:25:13.872334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.873198 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: ROLLBACK
[0m20:25:13.873581 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b'
[0m20:25:13.873759 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: Close
[0m20:25:13.874096 [info ] [Thread-1 (]: 2 of 15 PASS source_not_null_main_raw_events_event_type ........................ [[32mPASS[0m in 0.01s]
[0m20:25:13.874366 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:25:13.874560 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:25:13.874781 [info ] [Thread-1 (]: 3 of 15 START test source_not_null_main_raw_events_timestamp ................... [RUN]
[0m20:25:13.875005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b, now test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d)
[0m20:25:13.875186 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:25:13.877666 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:25:13.878127 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:25:13.880018 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:25:13.880207 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp" cascade
    
[0m20:25:13.880383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:13.880853 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.881417 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
[0m20:25:13.881908 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:25:13.882078 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:25:13.882319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.882483 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:25:13.882654 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:25:13.883244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.883696 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:25:13.883862 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:25:13.884014 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:25:13.884306 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.884623 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:25:13.885025 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:25:13.885184 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:25:13.885400 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.885564 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:25:13.885729 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
    
      
    ) dbt_internal_test
[0m20:25:13.886283 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.887052 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: ROLLBACK
[0m20:25:13.887417 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d'
[0m20:25:13.887598 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: Close
[0m20:25:13.887890 [info ] [Thread-1 (]: 3 of 15 PASS source_not_null_main_raw_events_timestamp ......................... [[32mPASS[0m in 0.01s]
[0m20:25:13.888158 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:25:13.888348 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:25:13.888549 [info ] [Thread-1 (]: 4 of 15 START test source_not_null_main_raw_events_user_id ..................... [RUN]
[0m20:25:13.888754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d, now test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d)
[0m20:25:13.888926 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:25:13.891241 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:25:13.891662 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:25:13.893578 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:25:13.893754 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id" cascade
    
[0m20:25:13.893923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:13.894351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.894891 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
[0m20:25:13.895361 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:25:13.895525 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:25:13.895762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.895924 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:25:13.896091 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:25:13.896652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.897099 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:25:13.897268 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:25:13.897426 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:25:13.897709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.898028 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:25:13.898392 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:25:13.898559 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:25:13.898792 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.898954 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:25:13.899130 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
    
      
    ) dbt_internal_test
[0m20:25:13.899677 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.900680 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: ROLLBACK
[0m20:25:13.901001 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d'
[0m20:25:13.901164 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: Close
[0m20:25:13.901427 [info ] [Thread-1 (]: 4 of 15 PASS source_not_null_main_raw_events_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:25:13.901684 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:25:13.901873 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:25:13.902047 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_main_raw_orders_created_at .................. [RUN]
[0m20:25:13.902270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d, now test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273)
[0m20:25:13.902455 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:25:13.904515 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:25:13.904947 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:25:13.907083 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:25:13.907279 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at" cascade
    
[0m20:25:13.907453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:13.907899 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.908434 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
[0m20:25:13.908910 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:25:13.909077 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:25:13.909299 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.909460 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:25:13.909630 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:25:13.910330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:13.910792 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:25:13.910966 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:25:13.911129 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:25:13.911445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.911765 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:25:13.912164 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:25:13.912328 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:25:13.912546 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.912706 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:25:13.912874 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
    
      
    ) dbt_internal_test
[0m20:25:13.913450 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.914159 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: ROLLBACK
[0m20:25:13.914476 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273'
[0m20:25:13.916037 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: Close
[0m20:25:13.916345 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_main_raw_orders_created_at ........................ [[32mPASS[0m in 0.01s]
[0m20:25:13.916607 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:25:13.916799 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:25:13.916993 [info ] [Thread-1 (]: 6 of 15 START test source_not_null_main_raw_orders_order_id .................... [RUN]
[0m20:25:13.917189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273, now test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68)
[0m20:25:13.917361 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:25:13.919434 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:25:13.919902 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:25:13.922084 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:25:13.922282 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id" cascade
    
[0m20:25:13.922457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:13.922928 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.923468 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
[0m20:25:13.923949 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:25:13.924117 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:25:13.924381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.924562 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:25:13.924736 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:25:13.925603 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.928271 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:25:13.928543 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:25:13.928768 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:25:13.929283 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.929665 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:25:13.930427 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:25:13.930874 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:25:13.931444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.931693 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:25:13.931885 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:25:13.932779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:13.933758 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: ROLLBACK
[0m20:25:13.934168 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68'
[0m20:25:13.934349 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: Close
[0m20:25:13.934674 [info ] [Thread-1 (]: 6 of 15 PASS source_not_null_main_raw_orders_order_id .......................... [[32mPASS[0m in 0.02s]
[0m20:25:13.934941 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:25:13.935142 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:25:13.935346 [info ] [Thread-1 (]: 7 of 15 START test source_not_null_main_raw_orders_total_amount ................ [RUN]
[0m20:25:13.935546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68, now test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681)
[0m20:25:13.935723 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:25:13.938186 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:25:13.938724 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:25:13.941530 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:25:13.941894 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount" cascade
    
[0m20:25:13.942133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:13.942665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:13.943269 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
[0m20:25:13.943811 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:25:13.944149 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:25:13.944529 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.944903 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:25:13.945180 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:25:13.946759 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:13.947626 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:25:13.947840 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:25:13.948019 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:25:13.948495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.948900 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:25:13.949468 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:25:13.949665 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:25:13.949953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.950136 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:25:13.950317 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
    
      
    ) dbt_internal_test
[0m20:25:13.951037 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:13.951945 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: ROLLBACK
[0m20:25:13.952310 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681'
[0m20:25:13.952497 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: Close
[0m20:25:13.952849 [info ] [Thread-1 (]: 7 of 15 PASS source_not_null_main_raw_orders_total_amount ...................... [[32mPASS[0m in 0.02s]
[0m20:25:13.953147 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:25:13.953351 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:25:13.953557 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_main_raw_orders_user_id ..................... [RUN]
[0m20:25:13.953814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681, now test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d)
[0m20:25:13.954063 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:25:13.956716 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:25:13.957243 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:25:13.961797 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:25:13.962078 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id" cascade
    
[0m20:25:13.962289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:13.962895 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:13.963524 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
[0m20:25:13.964041 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:25:13.964220 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:25:13.964550 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.964715 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:25:13.964884 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:25:13.965545 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.966017 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:25:13.966182 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:25:13.966332 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:25:13.966657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.967026 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:25:13.967426 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:25:13.967594 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:25:13.967823 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.967988 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:25:13.968405 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
    
      
    ) dbt_internal_test
[0m20:25:13.969052 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.969848 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: ROLLBACK
[0m20:25:13.970326 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d'
[0m20:25:13.970520 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: Close
[0m20:25:13.970819 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_main_raw_orders_user_id ........................... [[32mPASS[0m in 0.02s]
[0m20:25:13.971084 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:25:13.971275 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:25:13.971469 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_main_raw_users_created_at ................... [RUN]
[0m20:25:13.972000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d, now test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f)
[0m20:25:13.972196 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:25:13.974262 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:25:13.974677 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:25:13.976792 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:25:13.976979 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at" cascade
    
[0m20:25:13.977150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:13.977607 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.978133 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
[0m20:25:13.978593 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:25:13.978759 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:25:13.978988 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.979150 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:25:13.979320 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:25:13.979870 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.980352 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:25:13.980945 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:25:13.981227 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:25:13.981823 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.982202 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:25:13.982717 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:25:13.982912 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:25:13.983208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.983677 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:25:13.983860 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
    
      
    ) dbt_internal_test
[0m20:25:13.984506 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.985340 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: ROLLBACK
[0m20:25:13.985731 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f'
[0m20:25:13.985910 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: Close
[0m20:25:13.986631 [info ] [Thread-1 (]: 9 of 15 PASS source_not_null_main_raw_users_created_at ......................... [[32mPASS[0m in 0.01s]
[0m20:25:13.986922 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:25:13.987122 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:25:13.987341 [info ] [Thread-1 (]: 10 of 15 START test source_not_null_main_raw_users_email ....................... [RUN]
[0m20:25:13.987702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f, now test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2)
[0m20:25:13.988107 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:25:13.990706 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:25:13.991507 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:25:13.993675 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:25:13.993892 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email" cascade
    
[0m20:25:13.994064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:13.994623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:13.995213 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
[0m20:25:13.995718 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:25:13.995892 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:25:13.996157 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.996324 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:25:13.996492 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:25:13.997087 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.997600 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:25:13.997783 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:25:13.997948 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:25:13.998291 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.998633 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:25:13.999072 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:25:13.999244 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:25:13.999492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:13.999655 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:25:13.999818 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:25:14.000346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.001183 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: ROLLBACK
[0m20:25:14.001533 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2'
[0m20:25:14.001707 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: Close
[0m20:25:14.001992 [info ] [Thread-1 (]: 10 of 15 PASS source_not_null_main_raw_users_email ............................. [[32mPASS[0m in 0.01s]
[0m20:25:14.002254 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:25:14.002446 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:25:14.002645 [info ] [Thread-1 (]: 11 of 15 START test source_not_null_main_raw_users_user_id ..................... [RUN]
[0m20:25:14.002838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2, now test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2)
[0m20:25:14.003008 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:25:14.005832 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:25:14.006290 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:25:14.008133 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:25:14.008313 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id" cascade
    
[0m20:25:14.008477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:14.008939 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.009476 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
[0m20:25:14.010181 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:25:14.010355 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:25:14.010598 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.010762 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:25:14.010932 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:25:14.011465 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.011949 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:25:14.012126 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:25:14.012283 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:25:14.012578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.012896 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:25:14.013247 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:25:14.013412 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:25:14.013633 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.013795 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:25:14.013963 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:25:14.014461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.015218 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: ROLLBACK
[0m20:25:14.015563 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2'
[0m20:25:14.015732 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: Close
[0m20:25:14.016002 [info ] [Thread-1 (]: 11 of 15 PASS source_not_null_main_raw_users_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:25:14.016264 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:25:14.016451 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:25:14.016658 [info ] [Thread-1 (]: 12 of 15 START test source_unique_main_raw_events_event_id ..................... [RUN]
[0m20:25:14.016876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2, now test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc)
[0m20:25:14.017055 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:25:14.020163 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:25:14.020802 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:25:14.023072 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:25:14.023267 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id" cascade
    
[0m20:25:14.023439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:14.023888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.024431 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
[0m20:25:14.024886 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:25:14.025051 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:25:14.025288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.025449 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:25:14.025619 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:25:14.037083 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:25:14.037789 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:25:14.037997 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:25:14.038175 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:25:14.038568 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.038941 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:25:14.039389 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:25:14.039570 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:25:14.039810 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.039976 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:25:14.040148 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:25:14.040628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.041438 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: ROLLBACK
[0m20:25:14.041798 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc'
[0m20:25:14.041974 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: Close
[0m20:25:14.042280 [info ] [Thread-1 (]: 12 of 15 PASS source_unique_main_raw_events_event_id ........................... [[32mPASS[0m in 0.03s]
[0m20:25:14.042548 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:25:14.042742 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:25:14.042944 [info ] [Thread-1 (]: 13 of 15 START test source_unique_main_raw_orders_order_id ..................... [RUN]
[0m20:25:14.043142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc, now test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d)
[0m20:25:14.043315 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:25:14.045462 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:25:14.045918 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:25:14.048015 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:25:14.048198 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id" cascade
    
[0m20:25:14.048363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:14.048833 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.049381 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
[0m20:25:14.049842 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:25:14.050017 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:25:14.050243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.050406 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:25:14.050580 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:25:14.054295 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:25:14.054877 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:25:14.055071 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:25:14.055242 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:25:14.055594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.055937 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:25:14.056365 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:25:14.056527 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:25:14.056749 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.056911 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:25:14.057078 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:25:14.057522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.058273 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: ROLLBACK
[0m20:25:14.058603 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d'
[0m20:25:14.058770 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: Close
[0m20:25:14.059045 [info ] [Thread-1 (]: 13 of 15 PASS source_unique_main_raw_orders_order_id ........................... [[32mPASS[0m in 0.02s]
[0m20:25:14.059308 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:25:14.059499 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:25:14.059701 [info ] [Thread-1 (]: 14 of 15 START test source_unique_main_raw_users_email ......................... [RUN]
[0m20:25:14.059923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d, now test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc)
[0m20:25:14.060104 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:25:14.062058 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:25:14.062454 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:25:14.064533 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:25:14.064714 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email" cascade
    
[0m20:25:14.064883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:14.065290 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.065803 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
[0m20:25:14.066250 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:25:14.066412 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:25:14.066632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.066796 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:25:14.066963 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:25:14.068760 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:25:14.069302 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:25:14.069495 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:25:14.069658 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:25:14.069964 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.070310 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:25:14.070729 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:25:14.070894 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:25:14.071114 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.071276 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:25:14.071445 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:25:14.071887 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.072651 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: ROLLBACK
[0m20:25:14.072997 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc'
[0m20:25:14.073168 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: Close
[0m20:25:14.073468 [info ] [Thread-1 (]: 14 of 15 PASS source_unique_main_raw_users_email ............................... [[32mPASS[0m in 0.01s]
[0m20:25:14.073747 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:25:14.073946 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:25:14.074163 [info ] [Thread-1 (]: 15 of 15 START test source_unique_main_raw_users_user_id ....................... [RUN]
[0m20:25:14.074393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc, now test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd)
[0m20:25:14.074584 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:25:14.076732 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:25:14.077223 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:25:14.079539 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:25:14.079753 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id" cascade
    
[0m20:25:14.079929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:14.080440 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.081004 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
[0m20:25:14.081496 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:25:14.081874 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:25:14.082140 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.082304 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:25:14.082480 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:25:14.085535 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:25:14.086140 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:25:14.086327 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:25:14.086489 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:25:14.086860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.087270 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:25:14.087718 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:25:14.087879 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:25:14.088137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.088306 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:25:14.088477 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:25:14.088956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:14.089758 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: ROLLBACK
[0m20:25:14.090112 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd'
[0m20:25:14.090281 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: Close
[0m20:25:14.090563 [info ] [Thread-1 (]: 15 of 15 PASS source_unique_main_raw_users_user_id ............................. [[32mPASS[0m in 0.02s]
[0m20:25:14.090826 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:25:14.091410 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:14.091570 [debug] [MainThread]: On master: BEGIN
[0m20:25:14.091702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:14.091927 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:25:14.092065 [debug] [MainThread]: On master: COMMIT
[0m20:25:14.092201 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:14.092325 [debug] [MainThread]: On master: COMMIT
[0m20:25:14.092502 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:25:14.092636 [debug] [MainThread]: On master: Close
[0m20:25:14.092809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:14.092933 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd' was properly closed.
[0m20:25:14.093079 [info ] [MainThread]: 
[0m20:25:14.093220 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m20:25:14.094318 [debug] [MainThread]: Command end result
[0m20:25:14.109891 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:25:14.111056 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:25:14.114907 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:25:14.115077 [info ] [MainThread]: 
[0m20:25:14.115254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:25:14.115404 [info ] [MainThread]: 
[0m20:25:14.115564 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m20:25:14.117462 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0806592, "process_in_blocks": "0", "process_kernel_time": 0.25115, "process_mem_max_rss": "166772736", "process_out_blocks": "0", "process_user_time": 1.510595}
[0m20:25:14.117712 [debug] [MainThread]: Command `dbt test` succeeded at 20:25:14.117668 after 1.08 seconds
[0m20:25:14.117901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078285d0>]}
[0m20:25:14.118092 [debug] [MainThread]: Flushing usage events
[0m20:25:14.514610 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:26:39.002116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c95a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df3d90>]}


============================== 20:26:39.014917 | 41e0ff38-6469-4dff-bed0-fd66f9165a11 ==============================
[0m20:26:39.014917 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:26:39.015365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/logs', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:26:39.164372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41e0ff38-6469-4dff-bed0-fd66f9165a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058416e0>]}
[0m20:26:39.204846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41e0ff38-6469-4dff-bed0-fd66f9165a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450aad0>]}
[0m20:26:39.206398 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:26:39.263042 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:26:39.343366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:26:39.343617 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:26:39.347313 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:26:39.368948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41e0ff38-6469-4dff-bed0-fd66f9165a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f03c50>]}
[0m20:26:39.417822 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:26:39.419103 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:26:39.441612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41e0ff38-6469-4dff-bed0-fd66f9165a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111541b80>]}
[0m20:26:39.441920 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:26:39.444550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41e0ff38-6469-4dff-bed0-fd66f9165a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115dd0f0>]}
[0m20:26:39.445858 [info ] [MainThread]: 
[0m20:26:39.448419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:26:39.448566 [info ] [MainThread]: 
[0m20:26:39.448826 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:26:39.451593 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:26:39.532967 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:26:39.533199 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:26:39.533345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:39.548200 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:26:39.549165 [debug] [ThreadPool]: On list_dev: Close
[0m20:26:39.549524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:26:39.549788 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:26:39.553193 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:26:39.553368 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:26:39.553504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:39.553902 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:26:39.554704 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:26:39.554872 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:26:39.555091 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:26:39.555239 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:26:39.555379 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:26:39.555606 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:26:39.556035 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:26:39.556178 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:26:39.556303 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:26:39.556485 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:26:39.556625 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:26:39.557726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main)
[0m20:26:39.560795 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:26:39.560966 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:26:39.561091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:39.561343 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:26:39.561484 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:26:39.561629 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:26:39.571832 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:26:39.572954 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:26:39.573895 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:26:39.574071 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:26:39.574350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:26:39.575766 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:26:39.575913 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:26:39.576038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:39.576326 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:26:39.576463 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:26:39.576609 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:26:39.579037 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:26:39.579848 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:26:39.580174 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:26:39.580311 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:26:39.581482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41e0ff38-6469-4dff-bed0-fd66f9165a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117e68f0>]}
[0m20:26:39.581746 [debug] [MainThread]: Using duckdb connection "master"
[0m20:26:39.581890 [debug] [MainThread]: On master: BEGIN
[0m20:26:39.582016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:39.582261 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:26:39.582402 [debug] [MainThread]: On master: COMMIT
[0m20:26:39.582538 [debug] [MainThread]: Using duckdb connection "master"
[0m20:26:39.582672 [debug] [MainThread]: On master: COMMIT
[0m20:26:39.582871 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:26:39.583008 [debug] [MainThread]: On master: Close
[0m20:26:39.584557 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:26:39.584804 [info ] [Thread-1 (]: 1 of 15 START test source_not_null_main_raw_events_event_id .................... [RUN]
[0m20:26:39.585037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a)
[0m20:26:39.585226 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:26:39.594104 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:26:39.594744 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:26:39.604229 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:26:39.604437 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id" cascade
    
[0m20:26:39.604608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.605298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:26:39.606597 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
[0m20:26:39.614656 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:26:39.615018 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:26:39.615430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.615603 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:26:39.615767 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:26:39.616804 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:26:39.617347 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:26:39.617529 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:26:39.617694 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:26:39.618035 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.620261 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:26:39.620790 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:26:39.620972 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:26:39.621262 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.621434 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:26:39.621606 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:26:39.622421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:26:39.624530 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: ROLLBACK
[0m20:26:39.624864 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a'
[0m20:26:39.625037 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: Close
[0m20:26:39.625323 [info ] [Thread-1 (]: 1 of 15 PASS source_not_null_main_raw_events_event_id .......................... [[32mPASS[0m in 0.04s]
[0m20:26:39.625588 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:26:39.625780 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:26:39.625976 [info ] [Thread-1 (]: 2 of 15 START test source_not_null_main_raw_events_event_type .................. [RUN]
[0m20:26:39.626168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a, now test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b)
[0m20:26:39.626340 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:26:39.628264 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:26:39.628649 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:26:39.630685 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:26:39.630864 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type" cascade
    
[0m20:26:39.631026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.631455 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.631976 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
[0m20:26:39.632440 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:26:39.632610 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:26:39.632842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.633002 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:26:39.633160 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:26:39.633708 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.634175 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:26:39.634353 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:26:39.634510 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:26:39.634797 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.635104 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:26:39.635452 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:26:39.635608 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:26:39.635819 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.635977 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:26:39.636175 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
    
      
    ) dbt_internal_test
[0m20:26:39.636741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.637431 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: ROLLBACK
[0m20:26:39.637759 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b'
[0m20:26:39.637926 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: Close
[0m20:26:39.638199 [info ] [Thread-1 (]: 2 of 15 PASS source_not_null_main_raw_events_event_type ........................ [[32mPASS[0m in 0.01s]
[0m20:26:39.638460 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:26:39.638646 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:26:39.638849 [info ] [Thread-1 (]: 3 of 15 START test source_not_null_main_raw_events_timestamp ................... [RUN]
[0m20:26:39.639067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b, now test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d)
[0m20:26:39.639256 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:26:39.641450 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:26:39.642023 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:26:39.643790 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:26:39.643960 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp" cascade
    
[0m20:26:39.644117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.644486 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.644990 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
[0m20:26:39.645457 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:26:39.645620 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:26:39.645836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.645992 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:26:39.646155 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:26:39.646679 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.647114 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:26:39.647279 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:26:39.647434 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:26:39.647706 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.648010 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:26:39.648560 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:26:39.648720 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:26:39.648928 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.649088 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:26:39.649245 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
    
      
    ) dbt_internal_test
[0m20:26:39.649770 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.650481 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: ROLLBACK
[0m20:26:39.650782 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d'
[0m20:26:39.650950 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: Close
[0m20:26:39.651204 [info ] [Thread-1 (]: 3 of 15 PASS source_not_null_main_raw_events_timestamp ......................... [[32mPASS[0m in 0.01s]
[0m20:26:39.651457 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:26:39.651639 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:26:39.651822 [info ] [Thread-1 (]: 4 of 15 START test source_not_null_main_raw_events_user_id ..................... [RUN]
[0m20:26:39.652004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d, now test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d)
[0m20:26:39.652173 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:26:39.654322 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:26:39.654903 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:26:39.656665 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:26:39.656838 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id" cascade
    
[0m20:26:39.656997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.657361 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.657857 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
[0m20:26:39.658302 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:26:39.658462 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:26:39.658681 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.658837 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:26:39.659003 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:26:39.659515 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.659972 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:26:39.660144 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:26:39.660295 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:26:39.660560 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.660863 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:26:39.661328 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:26:39.661484 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:26:39.661693 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.661854 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:26:39.662013 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
    
      
    ) dbt_internal_test
[0m20:26:39.662542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.663514 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: ROLLBACK
[0m20:26:39.663831 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d'
[0m20:26:39.664001 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: Close
[0m20:26:39.664270 [info ] [Thread-1 (]: 4 of 15 PASS source_not_null_main_raw_events_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:26:39.664540 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:26:39.664729 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:26:39.664939 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_main_raw_orders_created_at .................. [RUN]
[0m20:26:39.665159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d, now test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273)
[0m20:26:39.665364 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:26:39.667379 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:26:39.667809 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:26:39.669891 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:26:39.670094 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at" cascade
    
[0m20:26:39.670283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.670771 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.671319 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
[0m20:26:39.671791 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:26:39.671963 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:26:39.672204 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.672367 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:26:39.672564 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:26:39.673341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:26:39.673960 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:26:39.674193 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:26:39.674366 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:26:39.674786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.675132 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:26:39.675516 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:26:39.675682 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:26:39.675905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.676069 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:26:39.676242 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
    
      
    ) dbt_internal_test
[0m20:26:39.676865 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.677597 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: ROLLBACK
[0m20:26:39.677916 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273'
[0m20:26:39.678078 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: Close
[0m20:26:39.678349 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_main_raw_orders_created_at ........................ [[32mPASS[0m in 0.01s]
[0m20:26:39.678607 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:26:39.678799 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:26:39.679006 [info ] [Thread-1 (]: 6 of 15 START test source_not_null_main_raw_orders_order_id .................... [RUN]
[0m20:26:39.679225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273, now test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68)
[0m20:26:39.679402 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:26:39.681381 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:26:39.681747 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:26:39.683762 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:26:39.683945 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id" cascade
    
[0m20:26:39.684105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.684504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.685002 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
[0m20:26:39.685474 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:26:39.685673 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:26:39.685971 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.686136 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:26:39.686308 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:26:39.686944 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.687418 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:26:39.687582 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:26:39.687733 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:26:39.688061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.688410 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:26:39.688962 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:26:39.689134 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:26:39.689359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.689524 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:26:39.689686 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:26:39.690260 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.690992 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: ROLLBACK
[0m20:26:39.691317 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68'
[0m20:26:39.691479 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: Close
[0m20:26:39.691753 [info ] [Thread-1 (]: 6 of 15 PASS source_not_null_main_raw_orders_order_id .......................... [[32mPASS[0m in 0.01s]
[0m20:26:39.692012 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:26:39.692197 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:26:39.692382 [info ] [Thread-1 (]: 7 of 15 START test source_not_null_main_raw_orders_total_amount ................ [RUN]
[0m20:26:39.692582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68, now test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681)
[0m20:26:39.692763 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:26:39.694777 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:26:39.695247 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:26:39.697296 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:26:39.697481 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount" cascade
    
[0m20:26:39.697644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.698047 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.698552 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
[0m20:26:39.699003 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:26:39.699164 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:26:39.699381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.699542 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:26:39.699704 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:26:39.700276 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.700715 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:26:39.700884 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:26:39.701034 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:26:39.701329 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.701655 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:26:39.701998 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:26:39.702161 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:26:39.702385 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.702546 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:26:39.702715 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
    
      
    ) dbt_internal_test
[0m20:26:39.703306 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.704011 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: ROLLBACK
[0m20:26:39.704330 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681'
[0m20:26:39.705160 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: Close
[0m20:26:39.705439 [info ] [Thread-1 (]: 7 of 15 PASS source_not_null_main_raw_orders_total_amount ...................... [[32mPASS[0m in 0.01s]
[0m20:26:39.705700 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:26:39.705885 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:26:39.706079 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_main_raw_orders_user_id ..................... [RUN]
[0m20:26:39.706266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681, now test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d)
[0m20:26:39.706435 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:26:39.708336 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:26:39.709108 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:26:39.712877 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:26:39.713070 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id" cascade
    
[0m20:26:39.713235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.714220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:26:39.714721 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
[0m20:26:39.715172 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:26:39.715328 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:26:39.715549 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.715709 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:26:39.715872 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:26:39.716479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.716908 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:26:39.717071 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:26:39.717227 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:26:39.717523 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.717833 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:26:39.718392 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:26:39.718575 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:26:39.718800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.718963 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:26:39.719125 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
    
      
    ) dbt_internal_test
[0m20:26:39.719741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.720461 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: ROLLBACK
[0m20:26:39.720786 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d'
[0m20:26:39.720952 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: Close
[0m20:26:39.721215 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_main_raw_orders_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:26:39.721468 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:26:39.721652 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:26:39.721837 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_main_raw_users_created_at ................... [RUN]
[0m20:26:39.722026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d, now test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f)
[0m20:26:39.722196 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:26:39.724150 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:26:39.724656 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:26:39.726826 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:26:39.727017 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at" cascade
    
[0m20:26:39.727182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.727684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.728268 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
[0m20:26:39.728766 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:26:39.728953 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:26:39.729222 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.729398 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:26:39.729575 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:26:39.730121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.730608 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:26:39.730781 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:26:39.730939 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:26:39.731269 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.731583 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:26:39.731949 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:26:39.732111 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:26:39.732328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.732491 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:26:39.732655 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
    
      
    ) dbt_internal_test
[0m20:26:39.733150 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.733965 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: ROLLBACK
[0m20:26:39.734292 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f'
[0m20:26:39.734449 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: Close
[0m20:26:39.734744 [info ] [Thread-1 (]: 9 of 15 PASS source_not_null_main_raw_users_created_at ......................... [[32mPASS[0m in 0.01s]
[0m20:26:39.735007 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:26:39.735189 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:26:39.735374 [info ] [Thread-1 (]: 10 of 15 START test source_not_null_main_raw_users_email ....................... [RUN]
[0m20:26:39.735565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f, now test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2)
[0m20:26:39.735737 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:26:39.738307 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:26:39.738769 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:26:39.740654 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:26:39.740832 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email" cascade
    
[0m20:26:39.740994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.741452 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.741976 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
[0m20:26:39.742449 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:26:39.742615 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:26:39.742836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.742997 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:26:39.743158 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:26:39.743652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.744093 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:26:39.744253 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:26:39.744402 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:26:39.744676 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.744985 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:26:39.745335 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:26:39.745492 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:26:39.745700 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.745859 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:26:39.746021 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:26:39.746534 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.747274 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: ROLLBACK
[0m20:26:39.747628 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2'
[0m20:26:39.747807 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: Close
[0m20:26:39.748081 [info ] [Thread-1 (]: 10 of 15 PASS source_not_null_main_raw_users_email ............................. [[32mPASS[0m in 0.01s]
[0m20:26:39.748343 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:26:39.748533 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:26:39.748737 [info ] [Thread-1 (]: 11 of 15 START test source_not_null_main_raw_users_user_id ..................... [RUN]
[0m20:26:39.748946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2, now test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2)
[0m20:26:39.749118 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:26:39.751334 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:26:39.751849 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:26:39.754046 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:26:39.754292 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id" cascade
    
[0m20:26:39.754489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.755058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:26:39.755670 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
[0m20:26:39.756494 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:26:39.756670 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:26:39.756953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.757117 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:26:39.757292 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:26:39.757996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:26:39.758559 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:26:39.758797 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:26:39.758964 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:26:39.759334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.759705 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:26:39.760196 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:26:39.760371 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:26:39.760637 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.760804 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:26:39.760981 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:26:39.761538 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.762304 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: ROLLBACK
[0m20:26:39.762637 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2'
[0m20:26:39.762798 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: Close
[0m20:26:39.763093 [info ] [Thread-1 (]: 11 of 15 PASS source_not_null_main_raw_users_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:26:39.763354 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:26:39.763541 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:26:39.763750 [info ] [Thread-1 (]: 12 of 15 START test source_unique_main_raw_events_event_id ..................... [RUN]
[0m20:26:39.763978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2, now test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc)
[0m20:26:39.764164 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:26:39.767232 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:26:39.767616 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:26:39.769672 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:26:39.769871 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id" cascade
    
[0m20:26:39.770036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.770433 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.770950 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
[0m20:26:39.771403 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:26:39.771567 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:26:39.771783 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.771945 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:26:39.772116 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:26:39.778010 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:26:39.778668 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:26:39.778865 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:26:39.779033 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:26:39.779440 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.779798 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:26:39.780458 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:26:39.780652 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:26:39.780919 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.781088 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:26:39.781260 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:26:39.781783 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.782617 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: ROLLBACK
[0m20:26:39.782984 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc'
[0m20:26:39.783163 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: Close
[0m20:26:39.783481 [info ] [Thread-1 (]: 12 of 15 PASS source_unique_main_raw_events_event_id ........................... [[32mPASS[0m in 0.02s]
[0m20:26:39.783757 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:26:39.783958 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:26:39.784161 [info ] [Thread-1 (]: 13 of 15 START test source_unique_main_raw_orders_order_id ..................... [RUN]
[0m20:26:39.784364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc, now test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d)
[0m20:26:39.784541 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:26:39.786785 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:26:39.787246 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:26:39.789298 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:26:39.789482 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id" cascade
    
[0m20:26:39.789641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.790084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.790605 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
[0m20:26:39.791057 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:26:39.791220 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:26:39.791443 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.791603 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:26:39.791770 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:26:39.793915 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:26:39.794457 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:26:39.794642 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:26:39.794803 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:26:39.795164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.795535 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:26:39.795966 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:26:39.796140 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:26:39.796390 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.796561 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:26:39.796733 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:26:39.797228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.798022 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: ROLLBACK
[0m20:26:39.798370 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d'
[0m20:26:39.798546 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: Close
[0m20:26:39.798846 [info ] [Thread-1 (]: 13 of 15 PASS source_unique_main_raw_orders_order_id ........................... [[32mPASS[0m in 0.01s]
[0m20:26:39.799125 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:26:39.799318 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:26:39.799516 [info ] [Thread-1 (]: 14 of 15 START test source_unique_main_raw_users_email ......................... [RUN]
[0m20:26:39.799711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d, now test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc)
[0m20:26:39.799883 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:26:39.801835 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:26:39.802232 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:26:39.804323 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:26:39.804504 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email" cascade
    
[0m20:26:39.804664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.805095 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.805607 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
[0m20:26:39.806067 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:26:39.806228 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:26:39.806454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.806616 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:26:39.806777 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:26:39.808145 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:26:39.808614 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:26:39.808781 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:26:39.808932 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:26:39.809236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.809566 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:26:39.810089 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:26:39.810253 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:26:39.810473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.810634 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:26:39.810801 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:26:39.811195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.811917 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: ROLLBACK
[0m20:26:39.812242 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc'
[0m20:26:39.812405 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: Close
[0m20:26:39.812669 [info ] [Thread-1 (]: 14 of 15 PASS source_unique_main_raw_users_email ............................... [[32mPASS[0m in 0.01s]
[0m20:26:39.812927 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:26:39.813114 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:26:39.813300 [info ] [Thread-1 (]: 15 of 15 START test source_unique_main_raw_users_user_id ....................... [RUN]
[0m20:26:39.813491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc, now test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd)
[0m20:26:39.813662 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:26:39.815611 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:26:39.816183 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:26:39.818204 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:26:39.818391 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id" cascade
    
[0m20:26:39.818558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:39.818963 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.819516 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
[0m20:26:39.820008 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:26:39.820184 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:26:39.820426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.820595 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:26:39.820765 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:26:39.823063 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:26:39.823528 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:26:39.823699 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:26:39.823853 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:26:39.824144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.824468 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:26:39.824976 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:26:39.825139 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:26:39.825351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.825511 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:26:39.825673 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:26:39.826070 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:26:39.826778 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: ROLLBACK
[0m20:26:39.827119 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd'
[0m20:26:39.827297 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: Close
[0m20:26:39.827578 [info ] [Thread-1 (]: 15 of 15 PASS source_unique_main_raw_users_user_id ............................. [[32mPASS[0m in 0.01s]
[0m20:26:39.827839 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:26:39.828482 [debug] [MainThread]: Using duckdb connection "master"
[0m20:26:39.828632 [debug] [MainThread]: On master: BEGIN
[0m20:26:39.828759 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:26:39.828988 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:26:39.829122 [debug] [MainThread]: On master: COMMIT
[0m20:26:39.829252 [debug] [MainThread]: Using duckdb connection "master"
[0m20:26:39.829372 [debug] [MainThread]: On master: COMMIT
[0m20:26:39.829556 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:26:39.829688 [debug] [MainThread]: On master: Close
[0m20:26:39.829855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:39.829982 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd' was properly closed.
[0m20:26:39.830130 [info ] [MainThread]: 
[0m20:26:39.830275 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m20:26:39.831335 [debug] [MainThread]: Command end result
[0m20:26:39.846010 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/manifest.json
[0m20:26:39.846984 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/semantic_manifest.json
[0m20:26:39.851065 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mattstrautmann/Documents/GitHub/sbdk-dev/my_project/dbt/target/run_results.json
[0m20:26:39.851261 [info ] [MainThread]: 
[0m20:26:39.851440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:26:39.851589 [info ] [MainThread]: 
[0m20:26:39.851744 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m20:26:39.853650 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9038858, "process_in_blocks": "0", "process_kernel_time": 0.224794, "process_mem_max_rss": "163823616", "process_out_blocks": "0", "process_user_time": 1.460265}
[0m20:26:39.853902 [debug] [MainThread]: Command `dbt test` succeeded at 20:26:39.853859 after 0.90 seconds
[0m20:26:39.854092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e25910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111813c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118105d0>]}
[0m20:26:39.854268 [debug] [MainThread]: Flushing usage events
[0m20:26:40.326867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:40.009983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104895a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f3d90>]}


============================== 20:28:40.021559 | 4c7a2eb6-633d-464e-a8a5-71a5d13069c3 ==============================
[0m20:28:40.021559 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:28:40.022450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:28:40.195483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c7a2eb6-633d-464e-a8a5-71a5d13069c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d416e0>]}
[0m20:28:40.245588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c7a2eb6-633d-464e-a8a5-71a5d13069c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040baad0>]}
[0m20:28:40.247201 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:28:40.303712 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:28:40.387086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:40.387336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:40.391119 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:28:40.412684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c7a2eb6-633d-464e-a8a5-71a5d13069c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106603d50>]}
[0m20:28:40.461406 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:28:40.463890 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:28:40.479120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c7a2eb6-633d-464e-a8a5-71a5d13069c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106831040>]}
[0m20:28:40.479410 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:28:40.479573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c7a2eb6-633d-464e-a8a5-71a5d13069c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f7bd0>]}
[0m20:28:40.480639 [info ] [MainThread]: 
[0m20:28:40.480813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:40.480943 [info ] [MainThread]: 
[0m20:28:40.481183 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:28:40.483754 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:28:40.531745 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:28:40.531988 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:28:40.532143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:40.544960 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:28:40.546151 [debug] [ThreadPool]: On list_dev: Close
[0m20:28:40.546751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:28:40.547196 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:28:40.551689 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:28:40.551946 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:28:40.552097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:40.552650 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:28:40.554963 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:28:40.555171 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:28:40.555432 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:40.555571 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:28:40.555702 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:28:40.555933 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:40.556362 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:28:40.556505 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:28:40.556627 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:28:40.556849 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:40.556998 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:28:40.558168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_dbt_test__audit)
[0m20:28:40.561024 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:28:40.561189 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:28:40.561320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:40.561569 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:40.561705 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:28:40.561842 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:28:40.571734 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:28:40.612253 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:28:40.613132 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:28:40.613293 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:28:40.613575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main)
[0m20:28:40.615438 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:28:40.615578 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:28:40.615703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:40.616016 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:40.616167 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:28:40.616310 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:28:40.618665 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:28:40.619366 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:28:40.619649 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:28:40.619783 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:28:40.620488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c7a2eb6-633d-464e-a8a5-71a5d13069c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3a5b0>]}
[0m20:28:40.620724 [debug] [MainThread]: Using duckdb connection "master"
[0m20:28:40.620862 [debug] [MainThread]: On master: BEGIN
[0m20:28:40.620986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:40.621197 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:28:40.621329 [debug] [MainThread]: On master: COMMIT
[0m20:28:40.621449 [debug] [MainThread]: Using duckdb connection "master"
[0m20:28:40.621566 [debug] [MainThread]: On master: COMMIT
[0m20:28:40.621732 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:28:40.621854 [debug] [MainThread]: On master: Close
[0m20:28:40.623190 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_events
[0m20:28:40.623428 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_events .................................... [RUN]
[0m20:28:40.623624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.sbdk_project.stg_events)
[0m20:28:40.623779 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_events
[0m20:28:40.628140 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_events"
[0m20:28:40.628952 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_events
[0m20:28:40.644415 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_events"
[0m20:28:40.644881 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:28:40.645063 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: BEGIN
[0m20:28:40.645220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:40.645571 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.645732 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:28:40.645929 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

  
  create view "dev"."main"."stg_events__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_events"
),

cleaned as (
    select
        event_id,
        user_id,
        session_id,
        event_type,
        timestamp,
        utm_source,
        utm_medium,
        utm_campaign,
        page_url,
        referrer_url,
        user_agent,
        ip_address,
        country,
        device_type,
        browser,
        os,
        screen_resolution,
        is_mobile,
        duration_seconds,
        revenue,
        
        -- Calculated fields
        date(timestamp) as event_date,
        extract(hour from timestamp) as event_hour,
        extract(dow from timestamp) as day_of_week,
        
        case 
            when event_type in ('signup', 'purchase') then true
            else false 
        end as is_conversion_event,
        
        case 
            when utm_source in ('google', 'bing') then 'search'
            when utm_source in ('facebook', 'instagram', 'twitter', 'linkedin') then 'social'
            when utm_source = 'email' then 'email'
            when utm_source = 'direct' then 'direct'
            else 'other'
        end as traffic_category,
        
        -- Session indicators
        case 
            when session_id is not null then true
            else false 
        end as has_session_tracking,
        
        -- Revenue events
        case 
            when revenue > 0 then true
            else false 
        end as is_revenue_event
        
    from source_data
    where timestamp is not null
      and user_id is not null
      and event_type is not null
)

select * from cleaned
  );

[0m20:28:40.646771 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:40.650242 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:28:40.650474 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m20:28:40.651213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:40.652679 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:28:40.652851 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */
alter view "dev"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:28:40.653152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.660071 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:28:40.660324 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:28:40.660485 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: COMMIT
[0m20:28:40.661301 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:40.664064 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_events"
[0m20:28:40.664253 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_events"} */

      drop view if exists "dev"."main"."stg_events__dbt_backup" cascade
    
[0m20:28:40.664636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.665974 [debug] [Thread-1 (]: On model.sbdk_project.stg_events: Close
[0m20:28:40.666988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c7a2eb6-633d-464e-a8a5-71a5d13069c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667dcd0>]}
[0m20:28:40.667305 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.04s]
[0m20:28:40.667566 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_events
[0m20:28:40.667751 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_orders
[0m20:28:40.668022 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_orders .................................... [RUN]
[0m20:28:40.668272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_events, now model.sbdk_project.stg_orders)
[0m20:28:40.668458 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_orders
[0m20:28:40.670028 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_orders"
[0m20:28:40.670611 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_orders
[0m20:28:40.672404 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_orders"
[0m20:28:40.672868 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:28:40.673031 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: BEGIN
[0m20:28:40.673182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:40.673503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.673665 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:28:40.673885 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_orders"
),

cleaned as (
    select
        order_id,
        user_id,
        order_number,
        created_at,
        completed_at,
        status,
        product_category,
        product_sku,
        quantity,
        unit_price,
        subtotal,
        discount_amount,
        discount_code,
        tax_amount,
        total_amount,
        currency,
        payment_method,
        payment_processor,
        billing_country,
        billing_state,
        billing_city,
        billing_postal_code,
        is_recurring,
        subscription_period,
        utm_source,
        utm_campaign,
        referral_code,
        customer_notes,
        shipping_required,
        shipping_cost,
        estimated_delivery,
        
        -- Calculated fields
        date(created_at) as order_date,
        extract(hour from created_at) as order_hour,
        extract(dow from created_at) as day_of_week,
        extract(month from created_at) as order_month,
        extract(year from created_at) as order_year,
        
        case 
            when completed_at is not null 
            then date_diff('hour', created_at, completed_at)
            else null 
        end as hours_to_completion,
        
        case 
            when discount_amount > 0 then true
            else false 
        end as has_discount,
        
        case 
            when discount_amount > 0 
            then round(discount_amount / subtotal * 100, 2)
            else 0 
        end as discount_percentage,
        
        case 
            when status = 'completed' then true
            else false 
        end as is_completed,
        
        case 
            when status in ('cancelled', 'refunded') then true
            else false 
        end as is_failed,
        
        case 
            when total_amount >= 100 then 'high_value'
            when total_amount >= 50 then 'medium_value'
            else 'low_value'
        end as order_value_tier,
        
        -- Payment categorization
        case 
            when payment_method in ('credit_card', 'stripe') then 'card'
            when payment_method in ('paypal', 'bank_transfer') then 'alternative'
            when payment_method = 'crypto' then 'crypto'
            else 'other'
        end as payment_category
        
    from source_data
    where created_at is not null
      and user_id is not null
      and total_amount > 0
)

select * from cleaned
  );

[0m20:28:40.674901 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:40.676334 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:28:40.676503 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:28:40.676802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.678092 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:28:40.678264 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:28:40.678558 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.679313 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:28:40.679483 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:28:40.679634 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: COMMIT
[0m20:28:40.680083 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.681364 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_orders"
[0m20:28:40.681555 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m20:28:40.681877 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.682481 [debug] [Thread-1 (]: On model.sbdk_project.stg_orders: Close
[0m20:28:40.682741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c7a2eb6-633d-464e-a8a5-71a5d13069c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106caea40>]}
[0m20:28:40.683027 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.01s]
[0m20:28:40.683272 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_orders
[0m20:28:40.683445 [debug] [Thread-1 (]: Began running node model.sbdk_project.stg_users
[0m20:28:40.683674 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_users ..................................... [RUN]
[0m20:28:40.683864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_orders, now model.sbdk_project.stg_users)
[0m20:28:40.684025 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.stg_users
[0m20:28:40.685524 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.stg_users"
[0m20:28:40.686108 [debug] [Thread-1 (]: Began executing node model.sbdk_project.stg_users
[0m20:28:40.687985 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.stg_users"
[0m20:28:40.688511 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:28:40.688686 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: BEGIN
[0m20:28:40.688843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:40.689187 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.689350 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:28:40.689539 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    

with source_data as (
    select * from "dev"."main"."raw_users"
),

cleaned as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        created_at,
        updated_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        date_of_birth,
        phone,
        company,
        job_title,
        
        -- Calculated fields
        case 
            when date_of_birth is not null 
            then date_diff('year', date_of_birth, current_date)
            else null 
        end as age,
        
        case 
            when subscription_tier in ('premium', 'enterprise') then true
            else false 
        end as is_paid_subscriber,
        
        date_diff('day', created_at, current_date) as days_since_signup,
        
        -- Data quality flags
        case 
            when email is null or email = '' then false
            when first_name is null or first_name = '' then false  
            when last_name is null or last_name = '' then false
            else true 
        end as has_complete_profile
        
    from source_data
)

select * from cleaned
  );

[0m20:28:40.692078 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:28:40.693488 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:28:40.693652 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m20:28:40.693924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.695177 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:28:40.695342 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:28:40.695595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.696291 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:28:40.696448 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:28:40.696595 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: COMMIT
[0m20:28:40.696968 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.698195 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.stg_users"
[0m20:28:40.698382 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m20:28:40.698726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.699348 [debug] [Thread-1 (]: On model.sbdk_project.stg_users: Close
[0m20:28:40.699608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c7a2eb6-633d-464e-a8a5-71a5d13069c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674c910>]}
[0m20:28:40.699900 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.02s]
[0m20:28:40.700143 [debug] [Thread-1 (]: Finished running node model.sbdk_project.stg_users
[0m20:28:40.700460 [debug] [Thread-1 (]: Began running node model.sbdk_project.int_user_activity
[0m20:28:40.700713 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_user_activity ............................. [RUN]
[0m20:28:40.700922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.stg_users, now model.sbdk_project.int_user_activity)
[0m20:28:40.701088 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.int_user_activity
[0m20:28:40.702979 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.int_user_activity"
[0m20:28:40.704983 [debug] [Thread-1 (]: Began executing node model.sbdk_project.int_user_activity
[0m20:28:40.706678 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.int_user_activity"
[0m20:28:40.707177 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:28:40.707347 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: BEGIN
[0m20:28:40.707557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:40.707920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.708092 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:28:40.708395 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

  
  create view "dev"."main"."int_user_activity__dbt_tmp" as (
    

with users as (
    select * from "dev"."main"."stg_users"
),

events as (
    select * from "dev"."main"."stg_events"
),

orders as (
    select * from "dev"."main"."stg_orders"
),

user_events as (
    select
        user_id,
        count(*) as total_events,
        count(*) filter (where event_type = 'page_view') as pageviews,
        count(*) filter (where event_type = 'click') as clicks,
        count(*) filter (where event_type = 'signup') as signups,
        count(*) filter (where event_type = 'login') as logins,
        count(*) filter (where event_type = 'purchase') as purchase_events,
        count(*) filter (where is_conversion_event = true) as conversion_events,
        count(*) filter (where is_revenue_event = true) as revenue_events,
        coalesce(sum(revenue), 0) as total_event_revenue,
        coalesce(sum(duration_seconds), 0) as total_time_on_site,
        count(distinct session_id) filter (where session_id is not null) as unique_sessions,
        count(distinct event_date) as active_days,
        min(timestamp) as first_event_at,
        max(timestamp) as last_event_at,
        count(distinct traffic_category) as traffic_sources_used
    from events
    group by user_id
),

user_orders as (
    select
        user_id,
        count(*) as total_orders,
        count(*) filter (where is_completed = true) as completed_orders,
        count(*) filter (where is_failed = true) as failed_orders,
        count(*) filter (where is_recurring = true) as recurring_orders,
        coalesce(sum(total_amount) filter (where is_completed = true), 0) as total_order_revenue,
        coalesce(avg(total_amount) filter (where is_completed = true), 0) as avg_order_value,
        coalesce(sum(discount_amount), 0) as total_discounts_used,
        count(distinct product_category) as product_categories_purchased,
        min(created_at) as first_order_at,
        max(created_at) as last_order_at,
        count(distinct payment_method) as payment_methods_used
    from orders
    group by user_id
),

combined as (
    select
        u.user_id,
        u.username,
        u.email,
        u.first_name,
        u.last_name,
        u.created_at as user_created_at,
        u.country,
        u.city,
        u.subscription_tier,
        u.referrer,
        u.is_active,
        u.age,
        u.is_paid_subscriber,
        u.days_since_signup,
        u.has_complete_profile,
        
        -- Event metrics
        coalesce(e.total_events, 0) as total_events,
        coalesce(e.pageviews, 0) as pageviews,
        coalesce(e.clicks, 0) as clicks,
        coalesce(e.signups, 0) as signups,
        coalesce(e.logins, 0) as logins,
        coalesce(e.purchase_events, 0) as purchase_events,
        coalesce(e.conversion_events, 0) as conversion_events,
        coalesce(e.revenue_events, 0) as revenue_events,
        coalesce(e.total_event_revenue, 0) as total_event_revenue,
        coalesce(e.total_time_on_site, 0) as total_time_on_site,
        coalesce(e.unique_sessions, 0) as unique_sessions,
        coalesce(e.active_days, 0) as active_days,
        e.first_event_at,
        e.last_event_at,
        coalesce(e.traffic_sources_used, 0) as traffic_sources_used,
        
        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.failed_orders, 0) as failed_orders,
        coalesce(o.recurring_orders, 0) as recurring_orders,
        coalesce(o.total_order_revenue, 0) as total_order_revenue,
        coalesce(o.avg_order_value, 0) as avg_order_value,
        coalesce(o.total_discounts_used, 0) as total_discounts_used,
        coalesce(o.product_categories_purchased, 0) as product_categories_purchased,
        o.first_order_at,
        o.last_order_at,
        coalesce(o.payment_methods_used, 0) as payment_methods_used,
        
        -- Calculated metrics
        case 
            when e.pageviews > 0 and o.completed_orders > 0 
            then round(o.completed_orders::float / e.pageviews * 100, 2)
            else 0 
        end as purchase_conversion_rate,
        
        case 
            when e.total_events > 0 
            then round(e.conversion_events::float / e.total_events * 100, 2)
            else 0 
        end as event_conversion_rate,
        
        case 
            when e.unique_sessions > 0 
            then round(e.total_events::float / e.unique_sessions, 2)
            else 0 
        end as events_per_session,
        
        case 
            when u.days_since_signup > 0 and e.active_days > 0
            then round(e.active_days::float / u.days_since_signup * 100, 2)
            else 0 
        end as activity_frequency_percentage,
        
        -- Total combined revenue
        coalesce(e.total_event_revenue, 0) + coalesce(o.total_order_revenue, 0) as total_revenue,
        
        -- User activity classification
        case 
            when o.completed_orders > 0 then 'customer'
            when e.signups > 0 then 'signed_up'
            when e.total_events > 10 then 'engaged_visitor'
            when e.total_events > 0 then 'visitor'
            else 'inactive'
        end as user_type
        
    from users u
    left join user_events e on u.user_id = e.user_id
    left join user_orders o on u.user_id = o.user_id
)

select * from combined
  );

[0m20:28:40.711450 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:28:40.712886 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:28:40.713053 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity" rename to "int_user_activity__dbt_backup"
[0m20:28:40.713364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.714621 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:28:40.714803 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */
alter view "dev"."main"."int_user_activity__dbt_tmp" rename to "int_user_activity"
[0m20:28:40.715112 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.715821 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:28:40.715986 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:28:40.716139 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: COMMIT
[0m20:28:40.716687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.717996 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.int_user_activity"
[0m20:28:40.718170 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.int_user_activity"} */

      drop view if exists "dev"."main"."int_user_activity__dbt_backup" cascade
    
[0m20:28:40.718514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.719123 [debug] [Thread-1 (]: On model.sbdk_project.int_user_activity: Close
[0m20:28:40.719390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c7a2eb6-633d-464e-a8a5-71a5d13069c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106714850>]}
[0m20:28:40.719685 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_user_activity ........................ [[32mOK[0m in 0.02s]
[0m20:28:40.719937 [debug] [Thread-1 (]: Finished running node model.sbdk_project.int_user_activity
[0m20:28:40.720239 [debug] [Thread-1 (]: Began running node model.sbdk_project.user_metrics
[0m20:28:40.720482 [info ] [Thread-1 (]: 5 of 5 START sql table model main.user_metrics ................................. [RUN]
[0m20:28:40.720691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sbdk_project.int_user_activity, now model.sbdk_project.user_metrics)
[0m20:28:40.720855 [debug] [Thread-1 (]: Began compiling node model.sbdk_project.user_metrics
[0m20:28:40.722440 [debug] [Thread-1 (]: Writing injected SQL for node "model.sbdk_project.user_metrics"
[0m20:28:40.722984 [debug] [Thread-1 (]: Began executing node model.sbdk_project.user_metrics
[0m20:28:40.734702 [debug] [Thread-1 (]: Writing runtime sql for node "model.sbdk_project.user_metrics"
[0m20:28:40.735380 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:28:40.735574 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: BEGIN
[0m20:28:40.735756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:40.736158 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.736352 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:28:40.736641 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

  
    
    

    create  table
      "dev"."main"."user_metrics__dbt_tmp"
  
    as (
      

with user_activity as (
    select * from "dev"."main"."int_user_activity"
),

final as (
    select
        user_id,
        username,
        email,
        first_name,
        last_name,
        user_created_at,
        country,
        city,
        subscription_tier,
        referrer,
        is_active,
        age,
        is_paid_subscriber,
        days_since_signup,
        has_complete_profile,
        
        -- Engagement metrics
        total_events,
        pageviews,
        clicks,
        logins,
        unique_sessions,
        active_days,
        traffic_sources_used,
        events_per_session,
        activity_frequency_percentage,
        total_time_on_site,
        
        -- Conversion metrics
        signups,
        purchase_events,
        conversion_events,
        purchase_conversion_rate,
        event_conversion_rate,
        
        -- Revenue metrics
        total_orders,
        completed_orders,
        failed_orders,
        recurring_orders,
        total_order_revenue,
        total_event_revenue,
        total_revenue,
        avg_order_value,
        total_discounts_used,
        product_categories_purchased,
        payment_methods_used,
        
        -- Timing metrics
        first_event_at,
        last_event_at,
        first_order_at,
        last_order_at,
        
        -- User classification
        user_type,
        
        -- Customer lifetime value estimate
        case 
            when recurring_orders > 0 and days_since_signup > 0
            then round(total_revenue * (365.0 / days_since_signup) * 2, 2)  -- Rough 2-year CLV estimate
            else total_revenue 
        end as estimated_clv,
        
        -- Engagement score (0-100)
        least(100, 
            (case when active_days > 0 then least(25, active_days) else 0 end) +
            (case when unique_sessions > 0 then least(25, unique_sessions) else 0 end) +
            (case when total_events > 0 then least(25, least(25, total_events / 10)) else 0 end) +
            (case when completed_orders > 0 then 25 else 0 end)
        ) as engagement_score,
        
        -- Risk classification
        case 
            when last_event_at < current_date - interval '90 days' and total_orders > 0 then 'churn_risk'
            when last_event_at < current_date - interval '30 days' and user_type = 'customer' then 'at_risk'
            when activity_frequency_percentage < 10 and days_since_signup > 30 then 'low_engagement'
            when user_type = 'customer' and recurring_orders = 0 then 'one_time_buyer'
            when user_type = 'customer' and recurring_orders > 0 then 'loyal_customer'
            when user_type = 'engaged_visitor' then 'potential_customer'
            else 'standard'
        end as risk_category,
        
        -- Value tier
        case 
            when total_revenue >= 1000 then 'high_value'
            when total_revenue >= 500 then 'medium_value'
            when total_revenue >= 100 then 'low_value'
            when total_revenue > 0 then 'minimal_value'
            else 'no_value'
        end as value_tier,
        
        -- Recency, Frequency, Monetary (RFM) components
        case 
            when last_order_at >= current_date - interval '30 days' then 5
            when last_order_at >= current_date - interval '60 days' then 4
            when last_order_at >= current_date - interval '90 days' then 3
            when last_order_at >= current_date - interval '180 days' then 2
            when last_order_at is not null then 1
            else 0
        end as recency_score,
        
        case 
            when completed_orders >= 10 then 5
            when completed_orders >= 5 then 4
            when completed_orders >= 3 then 3
            when completed_orders >= 2 then 2
            when completed_orders >= 1 then 1
            else 0
        end as frequency_score,
        
        case 
            when total_revenue >= 1000 then 5
            when total_revenue >= 500 then 4
            when total_revenue >= 200 then 3
            when total_revenue >= 50 then 2
            when total_revenue > 0 then 1
            else 0
        end as monetary_score,
        
        -- Data freshness
        current_timestamp as updated_at
        
    from user_activity
)

select * from final
    );
  
  
[0m20:28:40.808365 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m20:28:40.809963 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:28:40.810145 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics" rename to "user_metrics__dbt_backup"
[0m20:28:40.810864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:40.812217 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:28:40.812392 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */
alter table "dev"."main"."user_metrics__dbt_tmp" rename to "user_metrics"
[0m20:28:40.812676 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.815341 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:28:40.815533 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:28:40.815691 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: COMMIT
[0m20:28:40.821262 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:28:40.822974 [debug] [Thread-1 (]: Using duckdb connection "model.sbdk_project.user_metrics"
[0m20:28:40.823176 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "model.sbdk_project.user_metrics"} */

      drop table if exists "dev"."main"."user_metrics__dbt_backup" cascade
    
[0m20:28:40.823843 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:40.824565 [debug] [Thread-1 (]: On model.sbdk_project.user_metrics: Close
[0m20:28:40.824852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c7a2eb6-633d-464e-a8a5-71a5d13069c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705d8d0>]}
[0m20:28:40.825157 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.user_metrics ............................ [[32mOK[0m in 0.10s]
[0m20:28:40.825411 [debug] [Thread-1 (]: Finished running node model.sbdk_project.user_metrics
[0m20:28:40.825981 [debug] [MainThread]: Using duckdb connection "master"
[0m20:28:40.826128 [debug] [MainThread]: On master: BEGIN
[0m20:28:40.826254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:40.826524 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:28:40.826654 [debug] [MainThread]: On master: COMMIT
[0m20:28:40.826779 [debug] [MainThread]: Using duckdb connection "master"
[0m20:28:40.826895 [debug] [MainThread]: On master: COMMIT
[0m20:28:40.827075 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:28:40.827199 [debug] [MainThread]: On master: Close
[0m20:28:40.827373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:40.827498 [debug] [MainThread]: Connection 'model.sbdk_project.user_metrics' was properly closed.
[0m20:28:40.827672 [info ] [MainThread]: 
[0m20:28:40.827824 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m20:28:40.828395 [debug] [MainThread]: Command end result
[0m20:28:40.844078 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:28:40.845294 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:28:40.848822 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:28:40.848999 [info ] [MainThread]: 
[0m20:28:40.849171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:40.849308 [info ] [MainThread]: 
[0m20:28:40.849458 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:28:40.851074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.90041506, "process_in_blocks": "0", "process_kernel_time": 0.240297, "process_mem_max_rss": "211353600", "process_out_blocks": "0", "process_user_time": 1.466581}
[0m20:28:40.851293 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:40.851252 after 0.90 seconds
[0m20:28:40.851465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dc0bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106781130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0bd70>]}
[0m20:28:40.851627 [debug] [MainThread]: Flushing usage events
[0m20:28:41.291715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:42.669584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b35a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f3d90>]}


============================== 20:28:42.673922 | 1183667c-6ffc-49ab-93ef-1ced71fc9100 ==============================
[0m20:28:42.673922 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:28:42.674337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mattstrautmann/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir dbt --profiles-dir /Users/mattstrautmann/.dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:28:42.815803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1183667c-6ffc-49ab-93ef-1ced71fc9100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051416e0>]}
[0m20:28:42.856140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1183667c-6ffc-49ab-93ef-1ced71fc9100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049aaad0>]}
[0m20:28:42.857665 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:28:42.915183 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:28:42.995716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:42.995957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:42.999968 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:28:43.021685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1183667c-6ffc-49ab-93ef-1ced71fc9100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b03c50>]}
[0m20:28:43.070043 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:28:43.071263 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:28:43.090591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1183667c-6ffc-49ab-93ef-1ced71fc9100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c31b80>]}
[0m20:28:43.090905 [info ] [MainThread]: Found 5 models, 15 data tests, 3 sources, 429 macros
[0m20:28:43.091074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1183667c-6ffc-49ab-93ef-1ced71fc9100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd90f0>]}
[0m20:28:43.092400 [info ] [MainThread]: 
[0m20:28:43.092600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:43.092741 [info ] [MainThread]: 
[0m20:28:43.093046 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:28:43.096006 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:28:43.168366 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:28:43.168590 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:28:43.168736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:43.180250 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:28:43.181014 [debug] [ThreadPool]: On list_dev: Close
[0m20:28:43.181354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m20:28:43.181575 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m20:28:43.185126 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:28:43.185335 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:28:43.185485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:43.185982 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:43.186675 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:28:43.186825 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m20:28:43.187060 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:43.187206 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:28:43.187340 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m20:28:43.187618 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:43.188141 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:28:43.188286 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m20:28:43.188412 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m20:28:43.188604 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:43.188735 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m20:28:43.189920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main)
[0m20:28:43.193031 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:28:43.193208 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:28:43.193378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:43.193633 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:43.193762 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:28:43.193891 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:28:43.201548 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:28:43.202421 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:28:43.203312 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:28:43.203481 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:28:43.203755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_dbt_test__audit)
[0m20:28:43.204651 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:28:43.204794 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m20:28:43.204920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:43.205652 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:28:43.205784 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m20:28:43.205922 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m20:28:43.208483 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:28:43.209388 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m20:28:43.211225 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m20:28:43.211542 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m20:28:43.212702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1183667c-6ffc-49ab-93ef-1ced71fc9100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee6c30>]}
[0m20:28:43.212942 [debug] [MainThread]: Using duckdb connection "master"
[0m20:28:43.213079 [debug] [MainThread]: On master: BEGIN
[0m20:28:43.213200 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:43.213492 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:28:43.213671 [debug] [MainThread]: On master: COMMIT
[0m20:28:43.213820 [debug] [MainThread]: Using duckdb connection "master"
[0m20:28:43.213947 [debug] [MainThread]: On master: COMMIT
[0m20:28:43.214157 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:28:43.214293 [debug] [MainThread]: On master: Close
[0m20:28:43.215682 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:28:43.215899 [info ] [Thread-1 (]: 1 of 15 START test source_not_null_main_raw_events_event_id .................... [RUN]
[0m20:28:43.216283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a)
[0m20:28:43.216501 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:28:43.225144 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:28:43.225948 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:28:43.236686 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:28:43.236926 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id" cascade
    
[0m20:28:43.237104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.237828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:43.239159 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
[0m20:28:43.247439 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:28:43.247848 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:28:43.248207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.248381 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:28:43.248556 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_id is null



  
  
    );
  
  
    
[0m20:28:43.249364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:43.249951 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:28:43.250205 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:28:43.250386 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: COMMIT
[0m20:28:43.251357 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:43.253414 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:28:43.254070 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:28:43.254241 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: BEGIN
[0m20:28:43.254486 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.254648 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"
[0m20:28:43.254814 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:28:43.255680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:43.257724 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: ROLLBACK
[0m20:28:43.258061 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a'
[0m20:28:43.258226 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a: Close
[0m20:28:43.258516 [info ] [Thread-1 (]: 1 of 15 PASS source_not_null_main_raw_events_event_id .......................... [[32mPASS[0m in 0.04s]
[0m20:28:43.258783 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a
[0m20:28:43.258974 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:28:43.259176 [info ] [Thread-1 (]: 2 of 15 START test source_not_null_main_raw_events_event_type .................. [RUN]
[0m20:28:43.259370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_id.7658ea813a, now test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b)
[0m20:28:43.259533 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:28:43.261493 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:28:43.261988 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:28:43.264050 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:28:43.264228 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type" cascade
    
[0m20:28:43.264391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.264802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.265336 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
[0m20:28:43.265823 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:28:43.265997 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:28:43.266237 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.266395 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:28:43.266595 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where event_type is null



  
  
    );
  
  
    
[0m20:28:43.267181 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.267676 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:28:43.267853 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:28:43.268012 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: COMMIT
[0m20:28:43.268314 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.268630 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:28:43.269140 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:28:43.269296 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: BEGIN
[0m20:28:43.269499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.269652 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"
[0m20:28:43.269805 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_event_type"
    
      
    ) dbt_internal_test
[0m20:28:43.270345 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.271109 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: ROLLBACK
[0m20:28:43.271905 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b'
[0m20:28:43.272072 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b: Close
[0m20:28:43.272351 [info ] [Thread-1 (]: 2 of 15 PASS source_not_null_main_raw_events_event_type ........................ [[32mPASS[0m in 0.01s]
[0m20:28:43.272611 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b
[0m20:28:43.272797 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:28:43.272989 [info ] [Thread-1 (]: 3 of 15 START test source_not_null_main_raw_events_timestamp ................... [RUN]
[0m20:28:43.273172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_event_type.508678e62b, now test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d)
[0m20:28:43.273334 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:28:43.275556 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:28:43.276055 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:28:43.277897 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:28:43.278080 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp" cascade
    
[0m20:28:43.278248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.278660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.279170 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
[0m20:28:43.279609 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:28:43.279767 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:28:43.279988 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.280145 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:28:43.280302 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where timestamp is null



  
  
    );
  
  
    
[0m20:28:43.280897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.281350 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:28:43.281528 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:28:43.281689 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: COMMIT
[0m20:28:43.282002 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.282362 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:28:43.283082 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:28:43.283250 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: BEGIN
[0m20:28:43.283489 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.283649 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"
[0m20:28:43.283810 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_timestamp"
    
      
    ) dbt_internal_test
[0m20:28:43.284399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.285200 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: ROLLBACK
[0m20:28:43.285557 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d'
[0m20:28:43.285717 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d: Close
[0m20:28:43.285996 [info ] [Thread-1 (]: 3 of 15 PASS source_not_null_main_raw_events_timestamp ......................... [[32mPASS[0m in 0.01s]
[0m20:28:43.286259 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d
[0m20:28:43.286441 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:28:43.286630 [info ] [Thread-1 (]: 4 of 15 START test source_not_null_main_raw_events_user_id ..................... [RUN]
[0m20:28:43.286813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_timestamp.97a020290d, now test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d)
[0m20:28:43.286972 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:28:43.289242 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:28:43.290160 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:28:43.292096 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:28:43.292281 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id" cascade
    
[0m20:28:43.292476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.292934 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.293482 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
[0m20:28:43.293942 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:28:43.294116 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:28:43.294379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.294678 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:28:43.294847 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_events"
where user_id is null



  
  
    );
  
  
    
[0m20:28:43.295407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.295863 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:28:43.296031 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:28:43.296182 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: COMMIT
[0m20:28:43.296475 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.296778 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:28:43.297337 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:28:43.297492 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: BEGIN
[0m20:28:43.297732 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.297919 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"
[0m20:28:43.298092 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_events_user_id"
    
      
    ) dbt_internal_test
[0m20:28:43.298664 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.300420 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: ROLLBACK
[0m20:28:43.300918 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d'
[0m20:28:43.301094 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d: Close
[0m20:28:43.301433 [info ] [Thread-1 (]: 4 of 15 PASS source_not_null_main_raw_events_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:28:43.301705 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d
[0m20:28:43.301900 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:28:43.302113 [info ] [Thread-1 (]: 5 of 15 START test source_not_null_main_raw_orders_created_at .................. [RUN]
[0m20:28:43.302343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_events_user_id.68848aa62d, now test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273)
[0m20:28:43.302526 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:28:43.304653 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:28:43.305463 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:28:43.307527 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:28:43.307719 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at" cascade
    
[0m20:28:43.307888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.308577 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:43.309100 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
[0m20:28:43.309550 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:28:43.309712 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:28:43.309945 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.310105 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:28:43.310264 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where created_at is null



  
  
    );
  
  
    
[0m20:28:43.310973 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:43.311421 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:28:43.311590 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:28:43.311744 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: COMMIT
[0m20:28:43.312091 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.312400 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:28:43.312802 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:28:43.312962 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: BEGIN
[0m20:28:43.313185 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.313343 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"
[0m20:28:43.313509 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_created_at"
    
      
    ) dbt_internal_test
[0m20:28:43.314130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.314876 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: ROLLBACK
[0m20:28:43.315205 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273'
[0m20:28:43.315367 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273: Close
[0m20:28:43.315672 [info ] [Thread-1 (]: 5 of 15 PASS source_not_null_main_raw_orders_created_at ........................ [[32mPASS[0m in 0.01s]
[0m20:28:43.315941 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273
[0m20:28:43.316144 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:28:43.316731 [info ] [Thread-1 (]: 6 of 15 START test source_not_null_main_raw_orders_order_id .................... [RUN]
[0m20:28:43.316956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_created_at.53f6b14273, now test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68)
[0m20:28:43.317129 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:28:43.319216 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:28:43.319681 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:28:43.322193 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:28:43.322391 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id" cascade
    
[0m20:28:43.322569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.323082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.323667 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
[0m20:28:43.324178 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:28:43.324353 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:28:43.324622 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.324788 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:28:43.324961 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where order_id is null



  
  
    );
  
  
    
[0m20:28:43.325728 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:43.326224 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:28:43.326402 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:28:43.326594 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: COMMIT
[0m20:28:43.326921 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.327258 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:28:43.328009 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:28:43.328176 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: BEGIN
[0m20:28:43.328399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.328559 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"
[0m20:28:43.328717 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:28:43.329333 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.330101 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: ROLLBACK
[0m20:28:43.330434 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68'
[0m20:28:43.330601 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68: Close
[0m20:28:43.330877 [info ] [Thread-1 (]: 6 of 15 PASS source_not_null_main_raw_orders_order_id .......................... [[32mPASS[0m in 0.01s]
[0m20:28:43.331128 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68
[0m20:28:43.331308 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:28:43.331502 [info ] [Thread-1 (]: 7 of 15 START test source_not_null_main_raw_orders_total_amount ................ [RUN]
[0m20:28:43.331705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_order_id.0446f9be68, now test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681)
[0m20:28:43.331870 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:28:43.333983 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:28:43.334523 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:28:43.336634 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:28:43.336818 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount" cascade
    
[0m20:28:43.336984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.337448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.337969 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
[0m20:28:43.338423 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:28:43.338587 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:28:43.338822 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.338981 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:28:43.339145 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where total_amount is null



  
  
    );
  
  
    
[0m20:28:43.339800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.340249 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:28:43.340416 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:28:43.340564 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: COMMIT
[0m20:28:43.340858 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.341179 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:28:43.341666 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:28:43.341830 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: BEGIN
[0m20:28:43.342046 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.342205 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"
[0m20:28:43.342362 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_total_amount"
    
      
    ) dbt_internal_test
[0m20:28:43.342956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.343751 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: ROLLBACK
[0m20:28:43.344089 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681'
[0m20:28:43.344256 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681: Close
[0m20:28:43.344541 [info ] [Thread-1 (]: 7 of 15 PASS source_not_null_main_raw_orders_total_amount ...................... [[32mPASS[0m in 0.01s]
[0m20:28:43.344807 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681
[0m20:28:43.344988 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:28:43.345195 [info ] [Thread-1 (]: 8 of 15 START test source_not_null_main_raw_orders_user_id ..................... [RUN]
[0m20:28:43.345407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_total_amount.7520870681, now test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d)
[0m20:28:43.345574 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:28:43.347507 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:28:43.348016 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:28:43.352160 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:28:43.352363 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id" cascade
    
[0m20:28:43.352524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.353004 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.353522 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
[0m20:28:43.353979 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:28:43.354145 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:28:43.354383 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.354546 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:28:43.354700 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_orders"
where user_id is null



  
  
    );
  
  
    
[0m20:28:43.355319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.355794 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:28:43.355967 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:28:43.356121 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: COMMIT
[0m20:28:43.356414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.356714 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:28:43.357300 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:28:43.357456 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: BEGIN
[0m20:28:43.357668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.357822 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"
[0m20:28:43.357982 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_orders_user_id"
    
      
    ) dbt_internal_test
[0m20:28:43.358592 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.359304 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: ROLLBACK
[0m20:28:43.359621 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d'
[0m20:28:43.359780 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d: Close
[0m20:28:43.360042 [info ] [Thread-1 (]: 8 of 15 PASS source_not_null_main_raw_orders_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:28:43.360291 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d
[0m20:28:43.360469 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:28:43.360653 [info ] [Thread-1 (]: 9 of 15 START test source_not_null_main_raw_users_created_at ................... [RUN]
[0m20:28:43.360834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_orders_user_id.f191ee621d, now test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f)
[0m20:28:43.360995 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:28:43.362892 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:28:43.363407 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:28:43.365515 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:28:43.365713 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at" cascade
    
[0m20:28:43.365893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.366331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.366931 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
[0m20:28:43.367417 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:28:43.367593 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:28:43.367839 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.368000 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:28:43.368161 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where created_at is null



  
  
    );
  
  
    
[0m20:28:43.368680 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.369123 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:28:43.369284 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:28:43.369432 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: COMMIT
[0m20:28:43.369762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.370085 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:28:43.370450 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:28:43.370609 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: BEGIN
[0m20:28:43.370822 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.370979 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"
[0m20:28:43.371141 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_created_at"
    
      
    ) dbt_internal_test
[0m20:28:43.371659 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.372382 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: ROLLBACK
[0m20:28:43.372699 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f'
[0m20:28:43.372857 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f: Close
[0m20:28:43.373114 [info ] [Thread-1 (]: 9 of 15 PASS source_not_null_main_raw_users_created_at ......................... [[32mPASS[0m in 0.01s]
[0m20:28:43.373362 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f
[0m20:28:43.373537 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:28:43.373729 [info ] [Thread-1 (]: 10 of 15 START test source_not_null_main_raw_users_email ....................... [RUN]
[0m20:28:43.373929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_created_at.acc13fd31f, now test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2)
[0m20:28:43.374091 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:28:43.376192 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:28:43.378306 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:28:43.380092 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:28:43.380259 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email" cascade
    
[0m20:28:43.380413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.380787 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.381262 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
[0m20:28:43.381712 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:28:43.381870 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:28:43.382091 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.382251 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:28:43.382413 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where email is null



  
  
    );
  
  
    
[0m20:28:43.382933 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.383414 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:28:43.383582 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:28:43.383738 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: COMMIT
[0m20:28:43.384048 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.384364 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:28:43.384728 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:28:43.384880 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: BEGIN
[0m20:28:43.385103 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.385262 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"
[0m20:28:43.385420 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:28:43.385916 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.386646 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: ROLLBACK
[0m20:28:43.386966 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2'
[0m20:28:43.387118 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2: Close
[0m20:28:43.387386 [info ] [Thread-1 (]: 10 of 15 PASS source_not_null_main_raw_users_email ............................. [[32mPASS[0m in 0.01s]
[0m20:28:43.387643 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2
[0m20:28:43.387823 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:28:43.388006 [info ] [Thread-1 (]: 11 of 15 START test source_not_null_main_raw_users_user_id ..................... [RUN]
[0m20:28:43.388186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_email.d8c1c6e3b2, now test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2)
[0m20:28:43.388345 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:28:43.390584 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:28:43.391090 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:28:43.392836 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:28:43.393007 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id" cascade
    
[0m20:28:43.393163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.393584 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.394094 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
[0m20:28:43.394757 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:28:43.394914 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:28:43.395134 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.395289 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:28:43.395450 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
  
    as (
      
    
  
    
    



select *
from "dev"."main"."raw_users"
where user_id is null



  
  
    );
  
  
    
[0m20:28:43.395947 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.396417 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:28:43.396589 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:28:43.396753 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: COMMIT
[0m20:28:43.397073 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.397390 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:28:43.397737 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:28:43.397891 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: BEGIN
[0m20:28:43.398101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.398257 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"
[0m20:28:43.398420 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_not_null_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:28:43.398892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.399657 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: ROLLBACK
[0m20:28:43.400040 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2'
[0m20:28:43.400229 [debug] [Thread-1 (]: On test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2: Close
[0m20:28:43.400615 [info ] [Thread-1 (]: 11 of 15 PASS source_not_null_main_raw_users_user_id ........................... [[32mPASS[0m in 0.01s]
[0m20:28:43.400886 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2
[0m20:28:43.401088 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:28:43.401276 [info ] [Thread-1 (]: 12 of 15 START test source_unique_main_raw_events_event_id ..................... [RUN]
[0m20:28:43.401459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_not_null_main_raw_users_user_id.7bc8ea36d2, now test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc)
[0m20:28:43.401618 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:28:43.404797 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:28:43.405215 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:28:43.407246 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:28:43.407425 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id" cascade
    
[0m20:28:43.407587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.408024 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.408557 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
[0m20:28:43.408997 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:28:43.409161 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:28:43.409390 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.409548 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:28:43.409709 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
  
    as (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:28:43.415364 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:28:43.416114 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:28:43.416375 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:28:43.416582 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: COMMIT
[0m20:28:43.417015 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.417380 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:28:43.417957 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:28:43.418133 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: BEGIN
[0m20:28:43.418366 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.418527 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"
[0m20:28:43.418685 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_events_event_id"
    
      
    ) dbt_internal_test
[0m20:28:43.419158 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.419908 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: ROLLBACK
[0m20:28:43.420241 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc'
[0m20:28:43.420404 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc: Close
[0m20:28:43.420671 [info ] [Thread-1 (]: 12 of 15 PASS source_unique_main_raw_events_event_id ........................... [[32mPASS[0m in 0.02s]
[0m20:28:43.420927 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc
[0m20:28:43.421109 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:28:43.421307 [info ] [Thread-1 (]: 13 of 15 START test source_unique_main_raw_orders_order_id ..................... [RUN]
[0m20:28:43.421514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_events_event_id.286284c0fc, now test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d)
[0m20:28:43.421681 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:28:43.423617 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:28:43.423966 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:28:43.425946 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:28:43.426118 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id" cascade
    
[0m20:28:43.426275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.426668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.427254 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
[0m20:28:43.427735 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:28:43.427898 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:28:43.428140 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.428302 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:28:43.428463 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
  
    as (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:28:43.431061 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:28:43.431604 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:28:43.431777 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:28:43.431930 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: COMMIT
[0m20:28:43.432287 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.432644 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:28:43.433105 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:28:43.433269 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: BEGIN
[0m20:28:43.433508 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.433664 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"
[0m20:28:43.433821 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m20:28:43.434293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.435058 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: ROLLBACK
[0m20:28:43.435387 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d'
[0m20:28:43.435541 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d: Close
[0m20:28:43.435808 [info ] [Thread-1 (]: 13 of 15 PASS source_unique_main_raw_orders_order_id ........................... [[32mPASS[0m in 0.01s]
[0m20:28:43.436065 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d
[0m20:28:43.436243 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:28:43.436440 [info ] [Thread-1 (]: 14 of 15 START test source_unique_main_raw_users_email ......................... [RUN]
[0m20:28:43.436645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_orders_order_id.059f8b303d, now test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc)
[0m20:28:43.436810 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:28:43.438721 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:28:43.439191 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:28:43.441180 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:28:43.441351 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email" cascade
    
[0m20:28:43.441510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.441915 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.442420 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
[0m20:28:43.442875 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:28:43.443037 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:28:43.443258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.443420 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:28:43.443584 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
  
    as (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where email is not null
group by email
having count(*) > 1



  
  
    );
  
  
    
[0m20:28:43.445375 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:28:43.445867 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:28:43.446030 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:28:43.446176 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: COMMIT
[0m20:28:43.446465 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.446778 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:28:43.447370 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:28:43.447521 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: BEGIN
[0m20:28:43.447723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.447875 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"
[0m20:28:43.448029 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_email"
    
      
    ) dbt_internal_test
[0m20:28:43.448424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.449253 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: ROLLBACK
[0m20:28:43.449594 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc'
[0m20:28:43.449754 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc: Close
[0m20:28:43.450029 [info ] [Thread-1 (]: 14 of 15 PASS source_unique_main_raw_users_email ............................... [[32mPASS[0m in 0.01s]
[0m20:28:43.450281 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc
[0m20:28:43.450459 [debug] [Thread-1 (]: Began running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:28:43.450642 [info ] [Thread-1 (]: 15 of 15 START test source_unique_main_raw_users_user_id ....................... [RUN]
[0m20:28:43.450823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sbdk_project.source_unique_main_raw_users_email.72ceb57bfc, now test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd)
[0m20:28:43.450983 [debug] [Thread-1 (]: Began compiling node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:28:43.452886 [debug] [Thread-1 (]: Writing injected SQL for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:28:43.453379 [debug] [Thread-1 (]: Began executing node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:28:43.455396 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:28:43.455574 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

      drop table if exists "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id" cascade
    
[0m20:28:43.455742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:43.456178 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.456685 [debug] [Thread-1 (]: Applying CREATE to: "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
[0m20:28:43.457135 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:28:43.457292 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:28:43.457511 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.457668 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:28:43.457828 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

        
  
    
    

    create  table
      "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
  
    as (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."raw_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
    );
  
  
    
[0m20:28:43.458933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:43.459378 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:28:43.459534 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:28:43.459682 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: COMMIT
[0m20:28:43.459977 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.460300 [debug] [Thread-1 (]: Writing runtime sql for node "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:28:43.460816 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:28:43.460982 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: BEGIN
[0m20:28:43.461198 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.461356 [debug] [Thread-1 (]: Using duckdb connection "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"
[0m20:28:43.461516 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "sbdk_project", "target_name": "dev", "node_id": "test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dev"."main_dbt_test__audit"."source_unique_main_raw_users_user_id"
    
      
    ) dbt_internal_test
[0m20:28:43.461915 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:43.462634 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: ROLLBACK
[0m20:28:43.462948 [debug] [Thread-1 (]: Failed to rollback 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd'
[0m20:28:43.463105 [debug] [Thread-1 (]: On test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd: Close
[0m20:28:43.463360 [info ] [Thread-1 (]: 15 of 15 PASS source_unique_main_raw_users_user_id ............................. [[32mPASS[0m in 0.01s]
[0m20:28:43.463611 [debug] [Thread-1 (]: Finished running node test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd
[0m20:28:43.464177 [debug] [MainThread]: Using duckdb connection "master"
[0m20:28:43.464316 [debug] [MainThread]: On master: BEGIN
[0m20:28:43.464433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:43.464631 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:28:43.464759 [debug] [MainThread]: On master: COMMIT
[0m20:28:43.464881 [debug] [MainThread]: Using duckdb connection "master"
[0m20:28:43.464995 [debug] [MainThread]: On master: COMMIT
[0m20:28:43.465159 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:28:43.465285 [debug] [MainThread]: On master: Close
[0m20:28:43.465446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:43.465591 [debug] [MainThread]: Connection 'test.sbdk_project.source_unique_main_raw_users_user_id.53e7a6ffbd' was properly closed.
[0m20:28:43.465742 [info ] [MainThread]: 
[0m20:28:43.465886 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m20:28:43.466931 [debug] [MainThread]: Command end result
[0m20:28:43.481650 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m20:28:43.482660 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m20:28:43.486878 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m20:28:43.487092 [info ] [MainThread]: 
[0m20:28:43.487284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:43.487432 [info ] [MainThread]: 
[0m20:28:43.487587 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m20:28:43.489269 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8747469, "process_in_blocks": "0", "process_kernel_time": 0.222098, "process_mem_max_rss": "162217984", "process_out_blocks": "0", "process_user_time": 1.477884}
[0m20:28:43.489527 [debug] [MainThread]: Command `dbt test` succeeded at 20:28:43.489479 after 0.88 seconds
[0m20:28:43.489721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a25910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f13c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f105d0>]}
[0m20:28:43.489911 [debug] [MainThread]: Flushing usage events
[0m20:28:44.106062 [debug] [MainThread]: An error was encountered while trying to flush usage events
